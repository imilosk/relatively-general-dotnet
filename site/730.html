
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 730 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-7291">
            <a href="https://ardalis.com/being-agile-means-understanding-when-to-change/" target="_blank">
                <h2 class="title mb-6" id="article-7291">Being Agile Means Understanding When to Change</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 12, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">While I was completing my drive into work this morning, I was thinking about a book I read recently, Cryptonomicon (highly recommended&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-7292">
            <a href="https://ardalis.com/regexlib-redesign-complete/" target="_blank">
                <h2 class="title mb-6" id="article-7292">RegExLib Redesign Complete</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 12, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We&#x2019;ve done some design work on the Regular Expression Library, and cleaned up the code base significantly to get rid of some cruft and fix a&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-7293">
            <a href="https://ayende.com/blog/3041/the-consequences-of-web-services-architecture" target="_blank">
                <h2 class="title mb-6" id="article-7293">The consequences of web services architecture</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 12, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I mentioned before that MS CRM&#x27;s decision to build all its external API based on web services (that cannot be accessed outside of ASMX proxies) was a big mistake. It is a mistake because you are handing the developer a really clumsy, stupid, API. I just spent an hour trying to figure out how to set a value to null. An hour! It couldn&#x27;t be as simple as this: customer.new_employeeintouch = null;&#xA;&#xA;It has to be:&#xA;customer.new_employeeintouch = new Lookup();&#xA;customer.new_employeeintouch.IsNull = true;&#xA;customer.new_employeeintouch.IsNullSpecified = true;</p>
        </article>
        <article id="article-7294">
            <a href="https://ayende.com/blog/3040/building-an-external-dsl" target="_blank">
                <h2 class="title mb-6" id="article-7294">Building an External DSL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 12, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Over in the Alt.net mailing list, Glenn said:  If I was really being verbose in the way a business user would expect to define this I would say &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; When customer is preferred and the order exceeds 1000 then apply a .05 discount and apply free shipping.  Now do that in a DSL&#x2026;. Now, I am sucker for this kind of things, and I can probably use the practice. So I decided to go ahead with this. Just to be clear, this is supposedly a natural language processing, only we are going to cheat and get around that. First, let us analyze the structure of the statement that we need to handle: When customer is preferred and the order exceeds 1000 then apply a .05 discount and apply free shipping.  I put strike through all the fluff stuff, the things that doesn&#x27;t really means anything for the language. Keywords are marked in blue, operators in red. We have the following keywords:  When And Then And the following operators:  Is Exceeds Discount Shipping Everything else is a variable. This language follows the following syntax:  When [parameter] [operator] [value] (and [parameter] [operator] [value])&#x2B; then [parameter] [value] [operator] (and [parameter] [value] [operator] ) Note that the syntax between the when clause and the then clause is different. The operator is the last word there. This is because on the when we would usually do comparisons, while on the then we will perform actions. Now, to the actual building of the language. We have the following model:   Let us take a look at the parser, it is a stupid, single purpose one, but it works. The main parts are to extract a list of ActionExpressions from the language. public WhenThenClause SplitToWhenThenClause(string text)&#xA;{&#xA;&#x9;if (text.StartsWith(&quot;when&quot;, StringComparison.InvariantCultureIgnoreCase) == false)&#xA;&#x9;&#x9;throw new InvalidOperationException(&quot;statement should start with a when&quot;);&#xA;&#x9;int thenIndex = text.IndexOf(&quot;then&quot;, StringComparison.InvariantCultureIgnoreCase);&#xA;&#x9;if (thenIndex == -1)&#xA;&#x9;&#x9;throw new InvalidOperationException(&quot;statement should have a then&quot;);&#xA;&#x9;WhenThenClause clause = new WhenThenClause();&#xA;&#x9;string whenClause = text.Substring(4, thenIndex - 4).Trim();&#xA;&#x9;ParseClause(whenClause,&#xA;&#x9;            delegate(string[] parts)&#xA;&#x9;            {&#xA;&#x9;            &#x9;ActionExpression item = new ActionExpression();&#xA;&#x9;            &#x9;item.Left = parts[0];&#xA;&#x9;            &#x9;item.Operator = parts[1];&#xA;&#x9;            &#x9;item.Right = parts[2];&#xA;&#x9;            &#x9;clause.When.Add(item);&#xA;&#x9;            });&#xA;&#x9;string thenClause = text.Substring(thenIndex &#x2B; 4);&#xA;&#x9;ParseClause(thenClause,&#xA;&#x9;            delegate(string[] parts)&#xA;&#x9;            {&#xA;&#x9;            &#x9;ActionExpression item = new ActionExpression();&#xA;&#x9;            &#x9;item.Left = parts[0];&#xA;&#x9;            &#x9;item.Right= parts[1];&#xA;&#x9;            &#x9;item.Operator = parts[2];&#xA;&#x9;            &#x9;clause.Then.Add(item);&#xA;&#x9;            });&#xA;&#xA;&#x9;return clause;&#xA;}&#xA;&#xA;&#xA;private static void ParseClause(string clause,&#xA;                                Action&lt;string[]&gt; action)&#xA;{&#xA;&#x9;foreach (string subClauses in&#xA;&#x9;&#x9;clause.Split(new string[] { &quot;and&quot; }, StringSplitOptions.RemoveEmptyEntries))&#xA;&#x9;{&#xA;&#x9;&#x9;if (subClauses.Trim().Length == 0)&#xA;&#x9;&#x9;&#x9;continue;&#xA;&#xA;&#x9;&#x9;string[] parts = subClauses.Split(new char[] {&#x27; &#x27;, &#x27;\t&#x27;}, StringSplitOptions.RemoveEmptyEntries);&#xA;&#x9;&#x9;if (parts.Length != 3)&#xA;&#x9;&#x9;&#x9;throw new InvalidOperationException(&quot;A clause should have three parts &quot;&#x2B;                             &quot;[object] [operation] [value], found: &quot; &#x2B; subClauses);&#xA;&#xA;&#x9;&#x9;action(parts);&#xA;&#x9;}&#xA;}&#xA;Now we need to look at the DslExecuter. This is the one that will take an ActionExpression and actually execute it. We are using reflection to avoid having to do all the work ourselves, so we have this:&#xA;public class DslExecuter&#xA;{&#xA;&#x9;private readonly Hashtable parameters = new Hashtable(StringComparer.InvariantCultureIgnoreCase);&#xA;&#xA;&#x9;public void AddParameter(string name, object parameter)&#xA;&#x9;{&#xA;&#x9;&#x9;parameters[name] = parameter;&#xA;&#x9;}&#xA;&#xA;&#x9;public object Invoke(ActionExpression expression)&#xA;&#x9;{&#xA;&#x9;&#x9;object obj = parameters[expression.Left];&#xA;&#x9;&#x9;if (obj == null)&#xA;&#x9;&#x9;&#x9;throw new InvalidOperationException(&quot;Could not find parameter with name: &quot; &#x2B; expression.Left);&#xA;&#x9;&#x9;MethodInfo method = obj.GetType().GetMethod(expression.Operator, BindingFlags.IgnoreCase                           | BindingFlags.Instance | BindingFlags.Public);&#xA;&#x9;&#x9;if (method == null)&#xA;&#x9;&#x9;&#x9;throw new InvalidOperationException(&quot;Could not find method operator &quot; &#x2B;                                             expression.Operator &#x2B; &quot; on &quot; &#x2B; expression.Left);&#xA;&#x9;&#x9;ParameterInfo[] methodParams = method.GetParameters();&#xA;&#x9;&#x9;if(methodParams.Length!=1)&#xA;&#x9;&#x9;&#x9;throw new InvalidOperationException(expression.Operator &#x2B; &quot; should accept a single parameter&quot;);&#xA;&#x9;&#x9;object converted;&#xA;&#x9;&#x9;Type paramType = methodParams[0].ParameterType;&#xA;&#x9;&#x9;if(paramType.IsEnum)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;converted = Enum.Parse(paramType, expression.Right,true);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;else&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;converted = Convert.ChangeType(expression.Right, paramType);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;return method.Invoke(obj, new object[] {converted});&#xA;&#x9;}&#xA;}&#xA;Now that we have those two building blocks, it is very easy actually build the DSL itself.&#xA0;Here is the relevant code:&#xA;public void Execute()&#xA;{&#xA;&#x9;bool result = true;&#xA;&#x9;foreach (ActionExpression expression in parsed.When)&#xA;&#x9;{&#xA;&#x9;&#x9;bool clauseResult = (bool) this.executer.Invoke(expression);&#xA;&#x9;&#x9;result &amp;= clauseResult;&#xA;&#x9;}&#xA;&#xA;&#x9;if(result)&#xA;&#x9;{&#xA;&#x9;&#x9;foreach (ActionExpression expression in parsed.Then)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;executer.Invoke(expression);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;&#xA;We build a domain model to aid us here:&#xA; &#xA;Basically this translate directly to the parameters that the DSL needs. This means that all we have left is just the setup of the DSL. &#xA;[Test]&#xA;public void CanExecuteThenStatement()&#xA;{&#xA;&#x9;ExternalDSLDemo dsl = new ExternalDSLDemo(sentence);&#xA;&#x9;Customer customer = new Customer();&#xA;&#x9;customer.CustomerStatus = CustomerStatus.Preferred;&#xA;&#x9;dsl.AddParameter(&quot;customer&quot;, customer);&#xA;&#x9;Order order = new Order();&#xA;&#x9;order.TotalCost = 5000;&#xA;&#x9;order.ShippingType = ShippingType.Fast;&#xA;&#x9;dsl.AddParameter(&quot;order&quot;, order);&#xA;&#x9;dsl.AddParameter(&quot;apply&quot;, new ApplyCommands(order));&#xA;&#x9;dsl.Execute();&#xA;&#xA;&#x9;Assert.AreEqual(4750, order.TotalCost);&#xA;&#x9;Assert.AreEqual(ShippingType.Free, order.ShippingType);&#xA;}&#xA;&#xA;But I am pretty sure that I explained that this external DSL are very hard. This doesn&#x27;t seem very hard all.&#xA;No, this external DSL is not really hard. But try to do support something like:&#xA;&#xA;when (customer is preferred) and (order exceeds 1000 or order is new) then ...&#xA;This is when it gets suddenly much more complex... and why I think that External DSL are rarely worth the time to fully develop them. It is much easier to build on top of an existing infrastructure.&#xA;You can get the code for this here:&#xA;https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/rhino-dsl/Rhino.DSL.Tests/ExternalDSL</p>
        </article>
        <article id="article-7295">
            <a href="https://ayende.com/blog/3039/dogmatic-who-me" target="_blank">
                <h2 class="title mb-6" id="article-7295">Dogmatic? Who, me?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 11, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Jacob Proffitt calls me up to task for being inconsistent:  In this, Ole Friis is echoing the response I got from the intimidating Oren Eini when I suggested that TypeMock makes arguments that couple DI with unit testing go away.  The main weakness of Type Mock is its power, it allow me to take shortcuts that I don&#x2019;t want to take, I want to get a system with low coupling and high cohesion. The implication is that he wouldn&#x2019;t be developer enough to create a system with low coupling and high cohesion if he used powerful tools like TypeMock. Oren is inconsistent here because he&#x2019;s otherwise all for developer empowerment as illustrated by his support for Jeffrey Palermo&#x2019;s excellent post regarding treating developers as professionals. How can I support the idea of alt.net as &quot;running with scissors&quot;, responsible adults that are trusted to know what we are doing, with my comments on Type Mock having &quot;too much power&quot;? It is a good thing that I never felt the need to be self consistent. It makes things much more... invigorating.  I&#x27;ll start by saying that I often write bad code. What is bad code? In DevTeach, I showed James Kovacks a 150 lines methods that involved threading, anonymous delegates and exception handling in a ingeniously unmaintainable form. Bad as in you will get the axe and come after me with froth coming out of your mouth if you ever see it. I have a certain style that works for me. It comes with a set of tools and practices that are built to encourage that style and mindset. Being a lazy bastard, I am careful to make sure that I cannot be too lazy, because otherwise it is usually me who needs to clean up my mess. I believe that the choice of tool has a profound affect on my ability to work. That comes both at the tooling level (IDE, extensions, R#, etc) and the frameworks sides (IoC, OR/M, DSL, etc). Tools &amp; frameworks should guide me where I want to go, and make it harder to do the wrong thing. This is a decision that I made based on my experience and observations. After dealing with tools that do not encourage best practices, or tools that forces you to work harder to get there, it is a very important consideration to me. I don&#x27;t see an inherent disconnect between the two. I believe that the term is that &quot;with great power comes great responsibility&quot;. Recognizing that, I intentionally limit my own choices, in order to get things done using the approach that I believe is the best for what I am doing. Does this mean that this approach is a one size fit all? Absolutely not.  In fact, I can tell you that from each and every project I come out with a profound understanding of how stupid I was when I got into the project, and how many mistakes I made in that project. But, I do believe that this approach is applicable for a broad set of scenarios. Not all, but a broad set of scenarios.</p>
        </article>
        <article id="article-7296">
            <a href="https://ayende.com/blog/3038/i-feel-it-in-my-waters" target="_blank">
                <h2 class="title mb-6" id="article-7296">I feel it in my waters</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 11, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A few days ago I was listening to a recording of a design discussion, and I was at two minds about what was going on in my mind when I said some of the things that I said. I found myself in the odd position of both remembering my reasoning and listening to them as an outsider. It gave me some insight to the way I think. It is not really an analytical process. There is a lot based on the taste of the idea. I am sorry, I am not sure how to express it in any other way. I decide on the idea/design based on how it feel. There was a lot of that in the discussion, for instance. I can usually explain my initial response when I give it some thought, luckily. At one point there were about two minutes of failed design attempts, we can do X and then... hm, not that is too complex, so we will do Y which would... no, that doesn&#x27;t handle the Foo requirement, etc. It is partly preference, partly experience and partly the appliance of good habits learned from painful experiments. Interesting experience...</p>
        </article>
        <article id="article-7297">
            <a href="https://ayende.com/blog/3037/fuzzy-smart-selections" target="_blank">
                <h2 class="title mb-6" id="article-7297">Fuzzy smart selections</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 11, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Not, I am not particulary hungry at the moment, despite what this image may suggest.   &#xA0; Let us assume that I am hungry, and I would like some sort of a Vegetable to eat. Now, I know that I would really like to eat a carrot.   Problem. I don&#x27;t want to try all the possibilities in the kitchen. That would be real horror. But do I have any other choice? Assume that I have the time to do whatever I want, how would you handle the question of &quot;give me something like carrot&quot;. Please remember that simplicity is a value. And yes, I do have an idea about this.</p>
        </article>
        <article id="article-7298">
            <a href="https://ayende.com/blog/3036/dsl-styles-imperative-vs-declarative" target="_blank">
                <h2 class="title mb-6" id="article-7298">DSL Styles - Imperative vs. Declarative</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 11, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I posted yesterday about building a rule engine using a DSL. After I wrote that, I tried to think about what style it was. That made me realize that I had no clear distinction between imperative and declarative DSL. At least not a coherent, internally consistent one. I asked the Alt.net mailing list, and a lively discussion enthused. Contrary to my opinion, a lot of people disagreed with my opinion that this is a declarative style DSL:  when User.IsPreferred and Order.TotalCost &gt; 1000:&#xA0;&#xA0;&#xA0; addDiscountPrecentage&#xA0; 5 &#xA0;&#xA0;&#xA0; &#xA0;applyFreeShippingwhen not User.IsPreferred and Order.TotalCost &gt; 1000:suggestUpgradeToPreferred &#xA0;&#xA0;&#xA0; &#xA0;applyFreeShippingwhen User.IsNotPreferred and Order.TotalCost &gt; 500:&#xA0;&#xA0;&#xA0; &#xA0;applyFreeShipping It looks too much like code apperantely.&#xA0;After some debate, we now have the following candidates for declarative DSL: From Chad:  about User&#xA0; &#xA0; &#xA0; &#xA0;when Preferred and OrderTotal &gt; 1000:&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;Discount is 0.05&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;And Shipping is FREE;&#xA0; &#xA0; &#xA0; &#xA0;when not Preferred and OrderTotal &gt; 1000:&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;Upgrade Suggested&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;And Shipping is FREE;&#xA0; &#xA0; &#xA0; &#xA0;when not Preferred and OrderTotal &gt; 500:&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;Shipping is FREE; Based on Berry&#x27;s ideas:  applyDiscount 5.precent:&#xA0;&#xA0;&#xA0; when User.IsPreferred and Order.TotalCost &gt; 1000suggestPreferred:&#xA0;&#xA0;&#xA0;&#xA0; when not User.IsPreferred and Order.TotalCost &gt; 1000freeShipping:&#xA0;&#xA0;&#xA0;&#xA0; when Order.TotalCost &gt; 500 The really interesting thing to me, so far, is that they are all functionality equivalents. From the point of view of the implementer, there isn&#x27;t much difference at all betwee them.  My own, loosely defined and likely wrong definition was based on what the DSL actually did. If the DSL performed all the work internally, I would call it imperative. If the DSL performed some work that produced an object graph, which another part of the system would tehn consume, I would call it declarative. Thoughts?</p>
        </article>
        <article id="article-7299">
            <a href="https://ayende.com/blog/3035/complexity-through-good-intentions" target="_blank">
                <h2 class="title mb-6" id="article-7299">Complexity through good intentions</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 11, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After I got some input from Scott Allen&#xA0;about my Rule Engine post, I took a look at PolicyActivity.  Take a look at the image, my commentary is below it:   Can someone please explain me who thought about this idea? When you get something like that, how are you supposed to actually look at this and figure out what is going on? You have no way to look at it and get an idea about what is going on in there. You have to go and look at those sub rules one by one. For that matter, take a look at the text boxes here. You want me to write code there? There is actually intellisense on those text boxes, which scares me to no end. How am I supposed to be able to get an idea on what is going on here? An overall view, not just inspecting a single leaf of grass at a time. How am I to do code review on that? For that matter, how am I going to use source control with that. The answer, sadly, is again, binary source control. No diffs for you, nasty spoiled code driven developer. Take a look at this snippet. &lt;Rule.Condition&gt;&#xA;&#x9;&lt;RuleExpressionCondition Name=&quot;{p3:Null}&quot;&gt;&#xA;&#x9;&#x9;&lt;RuleExpressionCondition.Expression&gt;&#xA;&#x9;&#x9;&#x9;&lt;ns0:CodeBinaryOperatorExpression Operator=&quot;ValueEquality&quot;&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&lt;ns0:CodeBinaryOperatorExpression.Left&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;ns0:CodePrimitiveExpression&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;ns0:CodePrimitiveExpression.Value&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;ns1:Int32 &gt;1&lt;/ns1:Int32&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/ns0:CodePrimitiveExpression.Value&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/ns0:CodePrimitiveExpression&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&lt;/ns0:CodeBinaryOperatorExpression.Left&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&lt;ns0:CodeBinaryOperatorExpression.Right&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;ns0:CodePrimitiveExpression&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;ns0:CodePrimitiveExpression.Value&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;ns1:Int32&gt;2&lt;/ns1:Int32&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/ns0:CodePrimitiveExpression.Value&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/ns0:CodePrimitiveExpression&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&lt;/ns0:CodeBinaryOperatorExpression.Right&gt;&#xA;&#x9;&#x9;&#x9;&lt;/ns0:CodeBinaryOperatorExpression&gt;&#xA;&#x9;&#x9;&lt;/RuleExpressionCondition.Expression&gt;&#xA;&#x9;&lt;/RuleExpressionCondition&gt;&#xA;&lt;/Rule.Condition&gt;&#xA;I actually had to cut some name space definitions from there, just to make it fit the screen.&#xA;Now, please guess what this translate to. Imagine a slightly more complex rule, and then try to do a diff on the changes when someone modify it.&#xA;I am waiting to be educated how this is a good thing.</p>
        </article>
        <article id="article-7300">
            <a href="https://ayende.com/blog/3034/dont-like-the-api-go-ahead-fix-it-or-not" target="_blank">
                <h2 class="title mb-6" id="article-7300">Don&#x27;t like the API, go ahead fix it, or not?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 11, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Over in the alt.net mailing list, Charlie Poole has said that he thinks that the Playback() method for Rhino Mocks would be better named Monitor(). Without thinking about it, I sent this reply: public class CharliePreferences&#xA;{&#xA;     public static IDisposable Monitor(this MockRepository mocks)&#xA;     {&#xA;              return mocks.Playback();&#xA;     }&#xA;}&#xA;After I sent it, I started thinking about the implications. Both for legacy code and for preferences. I am not sure whatever this is a good approach is a good way to go. Thoughts?</p>
        </article>
        <div class="button flex justify-between">
            <a href="729.html"><span class="back arrow"></span></a>

            <a href="731.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
