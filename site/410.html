
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 410 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4091">
            <a href="https://benfoster.io/blog/saaskit-multi-tenancy-made-easy/" target="_blank">
                <h2 class="title mb-6" id="article-4091">Introducing SaasKit - Multi-tenancy made easy</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 05, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post introduces SaasKit, a new project I&#x2019;m working on to help developers build SAAS based applications, covering common challenges such as Multi-tenancy.</p>
        </article>
        <article id="article-4092">
            <a href="https://ayende.com/blog/165249/self-flagellation-and-the-barbarians-are-at-the-gate" target="_blank">
                <h2 class="title mb-6" id="article-4092">Self flagellation and the barbarians are at the gate</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 04, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We got a report from a user about severe issues with RavenDB. It reports resource exhaustion with plenty of resources still available, and once that happens, it will refuse to even restart itself, forcing a process kill. As you can imagine, that was a pretty big deal for us, so we set out to investigate. And we found some interesting results. One of the things that we like to keep in mind with RavenDB is that it is a safe choice. Whenever we need to make a decision between various tradeoffs, we&#x2019;ll always chose the safe choice. That means, among other things, that we are pretty careful about the way that we approach external input. And in this case, we are actively protecting ourselves from the outside world. One of the ways we do that is by limiting the number of requests that we will concurrently process. The idea is that it is better to flat out reject requests than put such a load on the system that it will eventually crash. Indeed, that has been such a successful tactic that to this day, there has been exactly zero production issues with it. To my knowledge, it hasn&#x2019;t ever been even noticed by any of our users.  The actual issue is that we have an internal limit that is set by default to 256 concurrent transactions. And by default, we will accept up to 192 concurrent requests. Then I looked at the actual logs, and I found:  And that explains much, but not nearly all. We had this in our code base for roughly 8 months. There are still other things that protect us from those issues, not the least of which is that it is actually hard to generate that number of requests against us (you really have to try very hard, usually from multiple machines). But there was one scenario that we didn&#x2019;t consider for the purpose of protecting ourselves from the barbarians at the gate. Multi Get requests.  Multi Get requests allows you to package multiple requests to RavenDB into a single physical request. Those requests are going to cost you a single round trip to the server, and you can run as many of those as you want. In the dump we received, we could see 17 pending Multi Get request, and about 400 queries being executed, each of them requiring their own session. No wonder we got out of session errors. Final note: for what it is worth, I changed our limits to 1,024 concurrent sessions and 512 concurrent requests, which is more reasonable considering the kind of hardware we usually run on. Multi Get has another 192 sessions that it can utilize, and the rest are dedicated for background processes.</p>
        </article>
        <article id="article-4093">
            <a href="https://ayende.com/blog/165409/voron-time-series-data-getting-real-data-outputs" target="_blank">
                <h2 class="title mb-6" id="article-4093">Voron &amp; time series data: Getting real data outputs</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 03, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">So far, we have just put the data in and out. And we have had a pretty good track record doing so. However, what do we do with the data now that we have it? As you can expect, we need to read it out. Usually by specific date ranges. The interesting thing is that we usually are not interested in just a single channel, we care about multiple channels. And for fun, those channel might be synchronized or not. An example of the first might be the current speed and the current engine temperature in a car. They are generally share the exact same timestamps. An example of out of sync is when you have a sensor on a rooftop measuring rainfall, and another sensor in the sewer measuring water flow rates. (Again, thanks to Dan for helping me with the domain). This is interesting, because it present quite a few interesting problems:  We need to merge different streams into a unified view. We need to handle both matching and non matching sequences. We need to handle erroneous data, what happens when we have two reading for the same time for the same sensor? Yes, that shouldn&#x2019;t happen, but it does. I solved this with the following API: public class RangeEntry&#xA;{&#xA;    public DateTime Timestamp;&#xA;    public double?[] Values;&#xA;}IEnumerable&lt;RangeEntry&gt; results = dts.ScanRanges(DateTime.MinValue, DateTime.MaxValue, new[]&#xA;                {&#xA;                    &quot;6febe146-e893-4f64-89f8-527f2dbaae9b&quot;,&#xA;                    &quot;707dcb42-c551-4f1a-9203-e4b0852516cf&quot;,&#xA;                    &quot;74d5bee8-9a7b-4d4e-bd85-5f92dfc22edb&quot;,&#xA;                    &quot;7ae29feb-6178-4930-bc38-a90adf99cfd3&quot;,&#xA;                });&#xA;&#xA;&#xA;This API gives me the results in the time order, with the same positions as the ids requested for the values. With nulls if there isn&#x2019;t a value matching the value from that time in that particular sensor channel.&#xA;The actual implementation relies on this method:&#xA;IEnumerable&lt;Entry&gt; ScanRange(DateTime start, DateTime end, string id)&#xA;&#xA;&#xA;All this does it provide the entries all the entries in a particular date range, for a particular channel. Let us see how we implement multi channel scanning on top of this:&#xA;private class PendingEnumerator&#xA;{&#xA;    public IEnumerator&lt;Entry&gt; Enumerator;&#xA;    public int Index;&#xA;}&#xA;&#xA;private class PendingEnumerators&#xA;{&#xA;    private readonly SortedDictionary&lt;DateTime, List&lt;PendingEnumerator&gt;&gt; _values =&#xA;        new SortedDictionary&lt;DateTime, List&lt;PendingEnumerator&gt;&gt;();&#xA;&#xA;    public void Enqueue(PendingEnumerator entry)&#xA;    {&#xA;        List&lt;PendingEnumerator&gt; list;&#xA;        var dateTime = entry.Enumerator.Current.Timestamp;&#xA;        if (_values.TryGetValue(dateTime, out list) == false)&#xA;        {&#xA;            _values.Add(dateTime, list = new List&lt;PendingEnumerator&gt;());&#xA;        }&#xA;        list.Add(entry);&#xA;    }&#xA;&#xA;    public bool IsEmpty { get { return _values.Count == 0; } }&#xA;&#xA;    public List&lt;PendingEnumerator&gt; Dequeue()&#xA;    {&#xA;        if (_values.Count == 0)&#xA;            return new List&lt;PendingEnumerator&gt;();&#xA;&#xA;        var kvp = _values.First();&#xA;        _values.Remove(kvp.Key);&#xA;        return kvp.Value;&#xA;    }&#xA;}&#xA;&#xA;public IEnumerable&lt;RangeEntry&gt; ScanRanges(DateTime start, DateTime end, string[] ids)&#xA;{&#xA;    if (ids == null || ids.Length == 0)&#xA;        yield break;&#xA;&#xA;    var pending = new PendingEnumerators();&#xA;    for (int i = 0; i &lt; ids.Length; i&#x2B;&#x2B;)&#xA;    {&#xA;        var enumerator = ScanRange(start, end, ids[i]).GetEnumerator();&#xA;        if(enumerator.MoveNext() == false)&#xA;            continue;&#xA;        pending.Enqueue(new PendingEnumerator&#xA;        {&#xA;            Enumerator = enumerator,&#xA;            Index = i&#xA;        });&#xA;    }&#xA;&#xA;    var result = new RangeEntry&#xA;    {&#xA;        Values = new double?[ids.Length]&#xA;    };&#xA;    while (pending.IsEmpty == false)&#xA;    {&#xA;        Array.Clear(result.Values,0,result.Values.Length);&#xA;        var entries = pending.Dequeue();&#xA;        if (entries.Count == 0)&#xA;            break;&#xA;        foreach (var entry in entries)&#xA;        {&#xA;            var current = entry.Enumerator.Current;&#xA;            result.Timestamp = current.Timestamp;&#xA;            result.Values[entry.Index] = current.Value;&#xA;            if(entry.Enumerator.MoveNext())&#xA;                pending.Enqueue(entry);&#xA;        }&#xA;        yield return result;&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;We are getting a single entry from each channel into the pending enumerators. Then, we collate all the entries that share the same time into a single entry. &#xA;We use the Index property to track the actual expected index of the entry in the output. And we handle duplicate times in the same channel by outputting multiple entries.&#xA;Testing this on my 1.1 million records data set, we can get 185 thousands records back in 0.15 seconds.</p>
        </article>
        <article id="article-4094">
            <a href="https://ayende.com/blog/164929/maximum-addressable-virtual-memory" target="_blank">
                <h2 class="title mb-6" id="article-4094">Maximum addressable virtual memory</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 31, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I wonder what is says about what I am doing right now that I really wish that I could have the OS give me more control over virtual memory allocation. At any rate, the point of this post is to point out something quite important to people writing databases, especially databases that make use of virtual memory a lot. There isn&#x2019;t quite as much of it as I thought it would be. Oh, on 32 bits the 4GB limits is really hard to swallow. But on 64 bits, the situation is much better, but still constrained. On Windows, using x64, you are actually limited to merely 8TB of address space. In Windows 8.1, (and I assume, but couldn&#x2019;t verify, Windows 2012 R2) you can use up to 128TB of virtual address space. With Linux, at least since 2.6.32, and probably earlier, the limit is 128TB per process. Implications for Voron, by the way, is that the total size of of all databases in a single process can be up to 8TB (probably somewhat less than that, the other stuff will also need memory). Currently the biggest RavenDB database that I am aware of was approaching the 1.5 &#x2013; 2.0 TB mark last I checked (several months ago), and Esent, our current technology, is limited to 16TB per database. So it isn&#x2019;t great news, but it is probably something that I can live with. And at least I can give proper recommendations. In practice, I don&#x2019;t think that this would be an issue. But that is good to know.</p>
        </article>
        <article id="article-4095">
            <a href="https://ayende.com/blog/165377/voron-time-series-working-with-real-data" target="_blank">
                <h2 class="title mb-6" id="article-4095">Voron &amp; Time Series: Working with real data</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 30, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Dan Liebster has been kind enough to send me a real world time series database. The data has been sanitized to remove identifying issues, but this is actually real world data, so we can learn a lot more about this. This is what this looks like:  The first thing that I did was take the code in this post, and try it out for size. I wrote the following:      1: int i = 0;   2: using (var parser = new TextFieldParser(@&quot;C:\Users\Ayende\Downloads\TimeSeries.csv&quot;))   3: {   4:    parser.HasFieldsEnclosedInQuotes = true;   5:    parser.Delimiters = new[] {&quot;,&quot;};   6:    parser.ReadLine();//ignore headers   7:    var startNew = Stopwatch.StartNew();   8:    while (parser.EndOfData == false)   9:    {  10:        var fields = parser.ReadFields();  11:        Debug.Assert(fields != null);  12:&#xA0;   13:        dts.Add(fields[1], DateTime.ParseExact(fields[2], &quot;o&quot;, CultureInfo.InvariantCulture), double.Parse(fields[3]));  14:        i&#x2B;&#x2B;;  15:        if (i == 25*1000)  16:        {  17:            break;  18:        }  19:        if (i%1000 == 0)  20:            Console.Write(&quot;\r{0,15:#,#}          &quot;, i);  21:    }  22:    Console.WriteLine();  23:    Console.WriteLine(startNew.Elapsed);  24: }&#xA;Note that we are using a separate transaction per line, which means that we are really doing a lot of extra work. But this simulate very well incoming events coming one at a time. We were able to process 25,000 events in 8.3 seconds. At a rate of just over 3 events per millisecond.&#xA;Now, note that we have in here the notion of &#x201C;channels&#x201D;. From my investigation, it seems clear that some form of separation is actually very common in time series data. We are usually talking about sensors or some such, and we want to track data across different sensors over time. And there is little if any call for working over multiple sensors / channels at the same time.&#xA;Because of that, I made a relatively minor change in Voron, that allows it to have an infinite number of separate trees. That means that I can use as many trees as you want, and we can model a channel as a tree in Voron. I also changed things so we instead of doing a single transaction per line, we will do a transaction per 1000 lines. That dropped the time to insert 25,000 lines to 0.8 seconds. Or a full order of magnitude faster.&#xA;That done, I inserted the full data set, which is just over 1,096,384 records. That took 36 seconds. In the data set I have, there are 35 channels.&#xA;I just tried, and reading all the entries in a channel with 35,411 events takes 0.01 seconds. That allows doing things like doing averages over time, comparing data, etc.&#xA;You can see the code implementing this in the following link.</p>
        </article>
        <article id="article-4096">
            <a href="https://ayende.com/blog/165505/a-ravendb-hackaton" target="_blank">
                <h2 class="title mb-6" id="article-4096">A RavenDB Hackaton</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 29, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I just had what I think is a great idea. As you know by now, we are going to do a full blown conference to celebrate RavenDB 3.0 We are going to do a lot of talking about RavenDB, but I think that a more active experience would also be good. So what I&#x2019;m planning is to have at least three RavenDB Core Dev Team present and do something. Right now I am torn between doing something that the people showing up want to do and build an application using RavenDB and doing a major new feature live with everyone pitching in. Or any combination of the two.  Thoughts and suggestions are welcome&#x2026;</p>
        </article>
        <article id="article-4097">
            <a href="https://ayende.com/blog/165378/fail-can-impress-too" target="_blank">
                <h2 class="title mb-6" id="article-4097">FAIL can impress, too</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 29, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I mentioned that a quick way to setup things for me to think that a candidate is a bad idea is to send us a UI project. This is usually a very strong indication that the candidate doesn&#x2019;t really have any idea what they are doing. They have been doing Win Forms projects, so they write the code for the task at hand in buttom1_Click event handler. Or inside the Page_Load code in an ASP.Net WebForms application if they are &#x201C;web developers&#x201D;.  On the other hand, here is a strong counter example. We had a candidate send in a WinForms project, as I said, that is usually a bad sign. But then I actually looked at his code:  And here is a single method:  This code is several levels of too complex for the task.&#xA0; It can be easily simplified to a great degree quite easily. But the key point from this, and the reason that this candidate has an interview later this week, is that this demonstrate a bunch of things:  Understanding of separation of concerns. Code that actually does what it is supposed to do. Proper integration between UI &amp; backend code (for example, we are working with large files, so we have progress bars and off-the-UI-thread work). The UI doesn&#x2019;t look like it was put together by a hiccupping monkey.  I can work with this. There are things that need to be improved for what we do, but there appears to be a SOLID foundation here.</p>
        </article>
        <article id="article-4098">
            <a href="https://ayende.com/blog/165473/fail-fail-fail" target="_blank">
                <h2 class="title mb-6" id="article-4098">Fail, fail, fail</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 28, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Sometimes, reading candidates answer is just something that I know is going to piss me off. We have a question that goes something like this (the actual question is much more detailed):   We have a 15TB csv file that contains web log, the entries are sorted by date (since this is how they were entered). Find all the log entries within a given date range. You may not read more than 32 MB. A candidate replied with an answered that had the following code:      1: string line = string.Empty;   2: StreamReader file;   3:&#xA0;    4: try   5: {   6:     file = new StreamReader(filename);   7: }   8: catch (FileNotFoundException ex)   9: {  10:     Console.WriteLine(&quot;The file is not found.&quot;);  11:     Console.ReadLine();  12:     return;  13: }  14:&#xA0;   15: while ((line = file.ReadLine()) != null)  16: {  17:     var values = line.Split(&#x27;,&#x27;);  18:     DateTime date = Convert.ToDateTime(values[0]);  19:     if (date.Date &gt;= startDate &amp;&amp; date.Date &lt;= endDate)  20:         output.Add(line);  21:&#xA0;   22:     // Results size in MB  23:     double size = (GetObjectSize(output) / 1024f) / 1024f;  24:     if (size &gt;= 32)  25:     {  26:         Console.WriteLine(&quot;Results size exceeded 32MB, the search will stop.&quot;);  27:         break;  28:     }  29: }&#xA;My reply was:&#xA;&#xA;The data file is 15TB in size, if the data is beyond the first 32MB, it won&#x27;t be found.&#xA;The candidate then fixed his code. It now includes:&#xA;&#xA;&#xA;   1: var lines = File.ReadLines(filename);&#xA;Yep, this is on a 15TB file. &#xA;Now I&#x2019;m going to have to lie down for a bit, I am not feeling so good.</p>
        </article>
        <article id="article-4099">
            <a href="https://ardalis.com/passing-default-parameter-objects-in-javascript/" target="_blank">
                <h2 class="title mb-6" id="article-4099">Passing Default Parameter Objects in JavaScript</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 27, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">You can use the jQuery extend() functionto elegantly configure your functions to accept a single parameter object, while providing default&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4100">
            <a href="https://ayende.com/blog/165281/quick-fails-in-code-questions" target="_blank">
                <h2 class="title mb-6" id="article-4100">Quick FAILs in code questions</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 27, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Sometimes it takes very little time to know that a candidate is going to be pretty horrible. As you can probably guess, the sort of questions we ask tend to be &#x201C;find me this data in this sort of file&#x201D;.  Probably the fastest indication is when they send me projects like this:   Now, it is possible that someone skilled will send us real projects like that, but the experience so far has been that this isn&#x2019;t going to be the case. If you have someone sending a UI project, it usually indicates that they can&#x2019;t think about it in any other way. The code they send pretty much justify this concern. Some code snippets from those projects:  Yup, this is the kind of error handling I want to see. Just for fun, if there hasn&#x2019;t been an error, this function would return a comma separated string of values. Which make it just slightly worse than:  And then we have this:   I guess someone really like O(N**2) on 15 TB files. And then there is this:  I guess we have different definitions on what configurable means. And then there was this person:  Yes, they did send me code inside a PDF file. That was the only way that they could find to send code around, I&#x2019;m guessing.</p>
        </article>
        <div class="button flex justify-between">
            <a href="409.html"><span class="back arrow"></span></a>

            <a href="411.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
