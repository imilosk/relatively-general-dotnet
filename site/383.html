
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 383 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-3821">
            <a href="https://ayende.com/blog/166273/last-ravendb-conference-tickets" target="_blank">
                <h2 class="title mb-6" id="article-3821">Last RavenDB Conference tickets</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 03, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We still have a couple of tickets available for the RavenDB conference. And sale of them ends tomorrow. You can buy them here. I&#x2019;m already at the states (writing this from JFK right now), and getting ready to show you some very cool stuff next week.</p>
        </article>
        <article id="article-3822">
            <a href="https://ayende.com/blog/166241/my-distributed-build-system" target="_blank">
                <h2 class="title mb-6" id="article-3822">My distributed build system</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 02, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Yes, I know that you are probably getting geared up to hear about some crazy setup, and in some manner, it is crazy. My distributed build system is this:  Yep, that is me manually distributing the build to do a cross check on a reasonable time frame. I&#x2019;ve mentioned before that our build time is atrocious. With over 3,500 tests, this is no longer a feasible alternative to just run them normally. So we started parallel efforts (pun intended), to reduce the time it takes the system to build and reduce individual test times as well as the ability to parallelize things. We are actually at the point where we can run concurrent tests, even those we previously had to distribute. And we can even do that with replicated tests, which are the ones usually taking the longest. But what we&#x2019;ll probably have in the end is just a bunch of test projects (currently we have ~5) that we will run on different machines at the same time. We are using Team City for build system, and I know that it has capabilities in this regard, but I&#x2019;ve never actually looked into that. We&#x2019;re going to be pretty busy in the next couple of weeks, so I thought that this would be a good time to ask.  My current thinking is:  One build that would actually do the compilation, etc. Then branch off that to a build per test project, which can run on different agents Then a build on top of that that can actually deploy the build. Any recommendations on that? We are going to need 5 &#x2013; 7 agents to run the tests in parallel. Any recommendations on how to get those? Ideally I would like to avoid having to pay for those machines to sit idle 60% &#x2013; 80% of the time. Any other alternatives?</p>
        </article>
        <article id="article-3823">
            <a href="https://ayende.com/blog/166210/hibernating-rhinos-the-movie" target="_blank">
                <h2 class="title mb-6" id="article-3823">Hibernating Rhinos</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 01, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Well, it is finally here, it has been ten years since I started blogging. My first blog was on April&#x2019;s 1st 2004, and somehow, we are a decade later. Usually it is time for introspective, and careful thought about what was and what will be, but I&#x2019;m having no time for that. Instead, I wanted to let you know that we just finished signing with Lucas Film (well, it said Disney on the contract, but I&#x2019;m a geek, so I&#x2019;ll go with the more impressive title) for a movie about Hibernating Rhinos. The idea is basically similar to the Social Network, but much better. I&#x2019;m trying to see if I can get Jesse Eisenberg to play there. And I got a budget for 999 ravens to be released in a flock at one of the scenes! We&#x2019;ll show a trailer for the movie (purely computer generated, so far) at our Conference in a week.</p>
        </article>
        <article id="article-3824">
            <a href="https://ayende.com/blog/166209/the-lucene-disk-format" target="_blank">
                <h2 class="title mb-6" id="article-3824">The Lucene disk format</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 31, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I realized lately that I wanted to know a lot more about exactly how Lucene is storing data on disk. Oh, I know the general stuff about segments and files, etc. But I wanted to know the actual bits &amp; bytes. So I started tracing into Lucene and trying to figure out what it is doing. And, by the way, the only thing that the Lucene.NET codebase is missing is this sign:  At any rate, this is how Lucene writes the segment file. Note that this is done in a CRC32 signed file:  And the info write method is:      Today, I would probably use a JSON file for something like that (bonus point, you know if it is corrupted and it is human readable), but this code was written in 2001, so that explains it. This is the format of the format of a segment file, and the segments.gen file is generated using:  Moving on to actually writing data, I created ten Lucene documents and wrote them. Then just debugged through the code to see what will happen. It started by creating _0.fdx and _0.fdt files. The .fdt is for fields, the fdx is for field indexes. Both of those files are used when writing the stored fields. This is the empty operation, writing an unstored field.   This is how fields are actually stored:  And then it ends up in:   Note that this particular data goes in the fdt file, while the fdx appears to be a quick way to go from a known document id to the relevant position in the fdx file. As I was going through the code, I did some searches, and found a very detailed explanation of the actual file format in the docs. That is really nice and quite informative, however, just seeing how the &#x201C;let us take the documents and make them searchable&#x201D; part is quite interesting. Lucene has a lot of chains of responsibilities going through. And it is also quite interesting to see the design choices that were made. Unfortunately, Lucene is very much wedded to its file format, and making changes to it isn&#x2019;t going to be possible, which is a shame, since it impacts quite a lot of the way Lucene works in general.</p>
        </article>
        <article id="article-3825">
            <a href="https://ayende.com/blog/166178/reduce-2-in-ravendb" target="_blank">
                <h2 class="title mb-6" id="article-3825">Reduce ^ 2 in RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 28, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">An interesting question that keeps popping up is how to re-reduce the results of a map/reduce. That is really nice feature on the surface, but it has a lot of implications, for example, when / how you run the 2nd reduce, can you chain only 1 time, or multiple times , what happens when there are a lot of reduce results, etc. But most of the time, what people want is to be able to do aggregation on the map/reduce results without too much hassle, and they don&#x2019;t have a lot of aggregated results or they are fine with waiting for them if they are very large. And we have a really nice solution for that scenario. You start by defining the base map/reduce operation, like so:  Note that we need to also output the fields that we care about reducing further. In this case, we start by reducing to postal code, but we keep the city, region and country options as well. Then, we define a transformer. Note that this is a special transformer, in that it has a group by in it, and it takes some parameters from outside.  Using those two together, we can now get the following results&#x2026; Raw map/reduce output:  With loc = City, we get:  With loc = Country, we get:  Tada, we have reduced further the result of a map/reduce operation. Now, this is subject to the usual limitations of RavenDB paging, in that it will only go through the only 1024 results. That can be a problem, but that is why RavenDB has the Streaming API. You can use streaming on a map/reduce index with a transformer (and even apply parameters on top of that). That end up giving you the ability to run a re-reduction on top of a map/reduce index regardless of size.  Of course, on very large result sets, that can take quite a while, but that is expected and usually fine. For that matter, if you need to, you can chain the stream into a bulk insert, and get the re-reduction in that manner.</p>
        </article>
        <article id="article-3826">
            <a href="https://ayende.com/blog/166177/incremental-map-reduce-in-mongodb-isnt" target="_blank">
                <h2 class="title mb-6" id="article-3826">&#x201C;Incremental&#x201D; map/reduce in MongoDB isn&#x2019;t</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 27, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Rafal&#xA0; an Ben Foster commented on my previous post with some ideas on how to deal with incremental updates to map/reduce indexes. Rafal said:  Actually, it&#x27;s quite simple if you can &#x27;reverse&#x27; the mapping operation (for given key find all documents matching that key): you just delete aggregate record with specified key and run incremental map-reduce on all matching documents. In today&#x27;s example, you would delete the aggregate with key=&#x27;oren&#x27; and then run map reduce with a query: db.items.mapReduce(map,reduce, { out: {reduce: &#x2018;distinct_item_names&#x2019;}, query: {name: &#x27;oren&#x27; } }); And Ben said:  It&#x27;s worth mentioning that I was able to get the MongoDB map-reduce collections updating automatically (insert/update/delete) by monitoring the MongoDB OpLog &#x2026; &#x2026;and listen for new documents in the OpLog which could then be used to re-execute an incremental Map-Reduce. And while this looks right, this actually can&#x2019;t possibly work. I&#x2019;ll start from Rafal&#x2019;s suggestion first. He suggest just issuing the following set of commands whenever we delete something from the database:      1: db.distinct_item_names.remove({name: &#x27;oren&#x27; } });   2: db.items.mapReduce(map,reduce, { out: {reduce: &#x2018;distinct_item_names&#x2019;}, query: {name: &#x27;oren&#x27; } });&#xA;And yes, that will actually work, as long as you are careful to never do this concurrently. Because if you do run this concurrently&#x2026; well, the best you can hope is no data, but the liker scenario is data corruption.&#xA;But this actually gets better, deletes are annoying, but they are a relatively simple case to process. You have updates to deal with too. We&#x2019;ll assume that we are watching the oplog to get notified when this happens. Here is an MongoDB oplog entry&#xA;&#xA;&#xA;   1: {   2:   &quot;ts&quot;: {   3:     &quot;t&quot;: 1286821984000,   4:     &quot;i&quot;: 1   5:   },   6:   &quot;h&quot;: &quot;1633487572904743924&quot;,   7:   &quot;op&quot;: &quot;u&quot;,   8:   &quot;ns&quot;: &quot;items&quot;,   9:   &quot;o2&quot;: {  10:     &quot;_id&quot;: &quot;4cb35859007cc1f4f9f7f85d&quot;  11:   },  12:   &quot;o&quot;: {  13:     &quot;$set&quot;: {  14:       &quot;Name&quot;: &quot;Eini&quot;  15:     }  16:   }  17: }&#xA;As you can see, we an update operation (op: u) on a specific document (o2._id) with the specified update (o.$set). That is really great, and it is utterly useless for our purposes. In this case, we updated the name from Oren to Eini, so we would like to be able to run this:&#xA;&#xA;&#xA;   1: db.distinct_item_names.remove({name: &#x27;oren&#x27; } });   2: db.distinct_item_names.remove({name: eini&#x27; } });   3: db.items.mapReduce(map,reduce, { out: {reduce: &#x2018;distinct_item_names&#x2019;}, query: {name: &#x27;oren&#x27; } });   4: db.items.mapReduce(map,reduce, { out: {reduce: &#x2018;distinct_item_names&#x2019;}, query: {name: eini&#x27; } });&#xA;Except that we don&#x2019;t have any way to get the old value out from the oplog. And this still isn&#x2019;t going to work concurrently. &#xA;But let us say that we decided to have a watcher process monitor the oplog somehow, and it will ensure no concurrency of those requests. Now you have to deal with fun issues like: &#x201C;what happens if the watcher process recycle?&#x201D;&#xA0; How do you keep your place in the oplog (and remember, the oplog is capped, stuff you haven&#x2019;t seen might be removed if they are beyond the specified size. &#xA;And&#x2026; to be frank, once we have done all of that, this is still the easy part. One of the reasons that you want to do this work in the first place is to deal with large amount of data. But you cannot assume that you&#x2019;ll have even distribution of the data. &#xA;One bug request that came against the RavenDB map/reduce implementation was a map/reduce index on the US Census data. That is ~300 million documents, and the index the user wanted to build was a map/reduce group by the state. You have states like California, with more than 30 million people in it, and you realize that you don&#x2019;t want to have to re-do the map/reduce over the entire 30&#x2B; million documents that you have there. In RavenDB, under this scenario, you&#x2019;ll have to issue about 3,073 operations, by the way. Versus the 30 millions you would need for this approach. &#xA;So yeah, &#x201C;incremental&#x201D; map/reduce can&#x2019;t handle concurrent work, can&#x2019;t handle deletes, can&#x2019;t handle updates, and definitely shouldn&#x2019;t be used on large data sets. And that is after you went to the trouble of setting up the watcher process, monitoring the oplog, etc.&#xA;Or, you can use RavenDB and you get a true incremental map/reduce without having to worry about any of that.</p>
        </article>
        <article id="article-3827">
            <a href="https://www.meziantou.net/access-the-winrt-api-from-a-desktop-application.htm" target="_blank">
                <h2 class="title mb-6" id="article-3827">Access the WinRT API from a desktop application</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 27, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When looking at MSDN help for a Windows 8 API class, such as PasswordVault, it is indicated that this class can be used from a Windows Store application or a Desktop application (Console, WinForms or WPF):In the case of a Windows Store application, you have no references to add. Just add the specif</p>
        </article>
        <article id="article-3828">
            <a href="https://ayende.com/blog/166145/differences-in-map-reduce-between-ravendb-mongodb" target="_blank">
                <h2 class="title mb-6" id="article-3828">Differences in Map/Reduce between RavenDB &amp; MongoDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 26, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Ben Foster has a really cool article showing some of the similarities and differences between MongoDB &amp; RavenDB with regards to their map/reduce implementation. However, there is a very important distinction that was missed. Map/reduce operations are run online in MongoDB, that means that for large collections, map/reduce is going to be very expensive. MongoDB has the option of taking the result of a map/reduce operation and writing it to a collection, so you don&#x2019;t need to run map/reduce jobs all the time. However, that is a snapshot view of the data, not a live view. Ben mentioned that you can do something called incremental map/reduce, but that isn&#x2019;t actually really good idea at all. Let us look at the following sequence of operations:      1: db.items.insert({name: &#x27;oren&#x27;, ts: 1 });   2: db.items.insert({name: &#x27;ayende&#x27;, ts: 2});   3:&#xA0;    4: var map = function Map() { emit(this.name,null); };   5: var reduce = function(key, val) { return key; };   6:&#xA0;    7: db.items.mapReduce(map,reduce, { out: &#x27;distinct_item_names&#x27; });&#xA;This creates two items, and give me the distinct names in a separate collection. Now, let us see how that works with updates&#x2026;&#xA;&#xA;&#xA;   1: db.items.insert({name: &#x27;eini&#x27;, ts: 3 });   2:&#xA0;    3: db.items.mapReduce(map,reduce, { out: {reduce: &#x27;distinct_item_names&#x27;}, query: {ts: {$gt: 2} } });&#xA;This is actually nice, mongo is able to merge the previous results with the new results, so you only have to do the work on the new data. But this has several implications:&#xA;&#xA;You have to kick something like &#x2018;ts&#x2019; property around to check for new stuff. And you have to _udpate_ that ts property on every update.&#xA;You have to run this on a regular basis yourself, mongo won&#x2019;t do that for you.&#xA;It can&#x2019;t work with deletes.&#xA;It is the last part that is really painful:&#xA;&#xA;&#xA;   1: db.items.remove({name: &#x27;oren&#x27;});&#xA;Now, there is just no way for you to construct a map/reduce job that would remove the name when it is gone. &#xA;This sort of thing works very nicely when what you want is to just append stuff. That is easy. It is PITA when we are talking about actually using it for live data, that can change and be modified. &#xA;Contrast that with the map/reduce implementation in RavenDB:&#xA;&#xA;No need to manually maintain state, the database does it for you.&#xA;No need to worry about updates &amp; deletes, the database does it for you.&#xA;No need to schedule map/reduce job updates, database does it for you.&#xA;Map/reduce queries are very fast, regardless of data size.&#xA;To be frank, the map/reduce implementation in RavenDB is complex, and pretty much all of it comes down to the fact that we don&#x2019;t do stupid stuff like run a map/reduce operation on a large database on every query, and that we support edge cases scenarios like data that is actually updated or deleted.&#xA;Naturally I&#x2019;m biased, but it seems to me that trying to use map/reduce in Mongo just means that you have to do a lot of hand holding yourself, while with RavenDB, we take care of everything and leaving you to actually do stuff.</p>
        </article>
        <article id="article-3829">
            <a href="https://ayende.com/blog/166113/my-poor-little-blameless-voron" target="_blank">
                <h2 class="title mb-6" id="article-3829">My poor little blameless Voron</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 25, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;m currently working on a project using Voron (although only incidentally), and I was horrified to get the FatalExecutionEngineException that was discussed previously. Naturally, I assumed that this is something that I did wrong in Voron.  After a lot of work, I managed to narrow it down to&#x2026; not Voron. To be rather more exact, it is Voron that is causing it, but it isn&#x2019;t Voron&#x2019;s fault.  The actual issue is the fact that I&#x2019;ve accidently using Json.NET to serialize a Stream that I got from Voron. And Voron is giving us an UnmanagedMemoryStream. I kept thinking that I was doing something wrong with releasing memory, but as it turns out, here is a very small repro:  unsafe static void Main(string[] args)&#xA; {&#xA;     JsonConvert.SerializeObject(new Foo { Ptr = (byte*)0 });&#xA;&#xA; }&#xA;&#xA; public unsafe class Foo&#xA; {&#xA;     public byte* Ptr { get; set; }&#xA; }&#xA;&#xA;&#xA;&#xA;And that is enough to get the above mentioned error.&#xA;What actually happens is that Json.NET is using dynamic IL generation to optimize accessing properties. And it just doesn&#x2019;t know how to handle pointer properties. What it ended up doing is to generate invalid IL, which resulted in a crash when we tried to actually use it.&#xA;Nothing to do with Voron at all, just a class that has a pointer property that was attempting serialization.&#xA0; Nasty bug, and very annoying to try to figure out.</p>
        </article>
        <article id="article-3830">
            <a href="https://ayende.com/blog/166081/todays-work-is" target="_blank">
                <h2 class="title mb-6" id="article-3830">Today&#x2019;s work is&#x2026;</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 24, 2014
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">It isn&#x2019;t enough to have just an ExecutionEngineException, I had to have this:</p>
        </article>
        <div class="button flex justify-between">
            <a href="382.html"><span class="back arrow"></span></a>

            <a href="384.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>