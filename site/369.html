
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 369 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-3681">
            <a href="https://ardalis.com/configuring-asp-net-core-environment-variables/" target="_blank">
                <h2 class="title mb-6" id="article-3681">Configuring ASP.NET Core Environment Variables</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 20, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Whether you&#x2019;re developing on Windows or a Mac/Linux machine, you can control the behavior of your ASP.NET 5 application by setting&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-3682">
            <a href="https://ayende.com/blog/170914/the-ravendb-comic-strip-part-ii-a-team-in-trouble" target="_blank">
                <h2 class="title mb-6" id="article-3682">The RavenDB Comic Strip</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 20, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20"></p>
        </article>
        <article id="article-3683">
            <a href="https://www.meziantou.net/debugging-an-assembly-without-the-original-source-code.htm" target="_blank">
                <h2 class="title mb-6" id="article-3683">Debugging a .NET assembly without the original source code using DotPeek</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 20, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When using an external closed-source library, it can sometimes be useful to understand how it works. There are quite a few decompilers on the market: Reflector, DotPeek, JustDecompile, ILSpy. These allow you to decompile a .NET DLL or EXE to understand how they work. It&#x27;s very convenient but someti</p>
        </article>
        <article id="article-3684">
            <a href="https://ayende.com/blog/170913/accepting-code-from-the-community-means-accepting-full-responsibility-for-all-time" target="_blank">
                <h2 class="title mb-6" id="article-3684">Accepting code from the community means accepting full responsibility for all time</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 19, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Sometimes, we&#x2019;ll reject a certain pull request from the community, not because it doesn&#x2019;t meet our standards, or doesn&#x2019;t do things properly. We&#x2019;ll reject it because we don&#x2019;t want to accept the responsibility for this. This seems obvious, but I got a comment on my recent post saying:  If you e.g. say that you&#x27;re willing to accept a new F# module within RavenDB that does scripted deploys and automation of various tasks, I bet people would jump in with enthusiasm. I wouldn&#x2019;t accept such a PR. Not because there is anything wrong with F#, or because it wouldn&#x2019;t be valuable. I wouldn&#x2019;t accept such a PR because none of the core team of RavenDB has great expertise in F#. Oh, we have a few guys that played with it, and would love to do some more. In fact, I&#x2019;ve got a guy that is pushing hard for allowing RavenDB to run computations via F#. It is a pretty cool feature, and I&#x2019;ll talk about that in detail in a future post. But imagine the scenario outline in the comment. A F# module that does some automation, scripted deploys, etc in F#. We go over the code, we are happy with it, we have a need for this feature. And at that point, we would have to make sure that it is written in C#.  Why? What is wrong with F#?  Pretty much nothing, except that any piece of code we ship (yes, even pieces that were contributed) has support requirements. A 2 AM call for one of the support team on that component means that the person answering the phone need to: Figure out the problem, decide if this is a misuse / feature / bug, fix this by either suggesting work around or supplying a hot fix.  And if the component with the issue is written in F#, that means that you need to have all the support group (now just over 20 people) be able to understand and work with that. And to the nitpickers, yes, it doesn&#x2019;t take a long while to learn a new language, but it takes a good long while before you can be effective with it, especially at 2AM. Now multiple that by 20&#x2B; people, and you might see where we are starting to have an issue. There is also the community angle to consider, code that is written in a language more people know gets more contributors.  Now, I&#x2019;ve actually have run an real live study on that. In 2005 I wrote a view engine for MonoRail (MVC framework for ASP.Net) written in Boo. (You can read all about that here). Naturally, building a DSL that is based on Boo, I wrote that in Boo. And it was mildly successful. It was a pure OSS project, with multiple contributors. And I was the sole person that would actually modify the Boo code. Boo code looks pretty much like Python, and there isn&#x2019;t any FP aspect to it. I find it imminently approachable and easy to work with. The Brail codebase had pretty much zero outside contributions. At that point, I ported the Brail codebase to C#, the post is from 2006. Note the discussion around the reasoning. After that happened, we started getting more outside contributors and people were actually willing to take a look at the code. For fun, this is actually in a situation where anyone using Brail was actually writing Boo code. It isn&#x2019;t like they weren&#x2019;t aware of how it worked. They pretty much had to, because Brail was a very thin DSL over Boo code. But moving the codebase to C# significantly improved the level of involvement. Something that I think people miss is the fact that this kind of decision has pretty much nothing to do with the language or its merits. It is all about the implications on the project as a whole.</p>
        </article>
        <article id="article-3685">
            <a href="https://enterprisecraftsmanship.com/posts/return-the-most-specific-type/" target="_blank">
                <h2 class="title mb-6" id="article-3685">Return the most specific type, accept the most generic type</h2>
            </a>
            <p class="mb-2">by Vladimir Khorikov</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 18, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I guess most developers heard the guideline stating that, when designing methods, you should return the most specific type and accept the most generic one. Is it always applicable? Let&#x2019;s try to look at it from different perspectives.</p>
        </article>
        <article id="article-3686">
            <a href="https://ayende.com/blog/170881/ravendb-sharding-enabling-shards-for-existing-database" target="_blank">
                <h2 class="title mb-6" id="article-3686">RavenDB Sharding</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 18, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A question came up in the mailing list, how do we enable sharding for an existing database. I&#x2019;ll deal with data migration in this scenario at a later post.  The scenario is that we have a very successful application, and we start to feel the need to move the data to multiple shards. Currently all the data is sitting in the RVN1 server. We want to add RVN2 and RVN3 to the mix. For this post, we&#x2019;ll assume that we have the notion of Customers and Invoices. Previously, we access the database using a simple document store:  var documentStore = new DocumentStore&#xA;{&#xA;&#x9;Url = &quot;http://RVN1:8080&quot;,&#xA;&#x9;DefaultDatabase = &quot;Shop&quot;&#xA;};&#xA;&#xA;&#xA;Now, we want to move to a sharded environment, so we want to write it like this. Existing data is going to stay where it is at, and new data will be sharded according to geographical location.&#xA;&#xA;var shards = new Dictionary&lt;string, IDocumentStore&gt;&#xA;{&#xA;&#x9;{&quot;Origin&quot;, new DocumentStore {Url = &quot;http://RVN1:8080&quot;, DefaultDatabase = &quot;Shop&quot;}},//existing data&#xA;&#x9;{&quot;ME&quot;, new DocumentStore {Url = &quot;http://RVN2:8080&quot;, DefaultDatabase = &quot;Shop_ME&quot;}},&#xA;&#x9;{&quot;US&quot;, new DocumentStore {Url = &quot;http://RVN3:8080&quot;, DefaultDatabase = &quot;Shop_US&quot;}},&#xA;};&#xA;&#xA;var shardStrategy = new ShardStrategy(shards)&#xA;&#x9;.ShardingOn&lt;Customer&gt;(c =&gt; c.Region)&#xA;&#x9;.ShardingOn&lt;Invoice&gt; (i =&gt; i.Customer);&#xA;&#xA;var documentStore = new ShardedDocumentStore(shardStrategy).Initialize();&#xA;&#xA;This wouldn&#x2019;t actually work. We are going to have to do a bit more. To start with, what happens when we don&#x2019;t have a 1:1 match between region and shard? That is when the translator become relevant:&#xA;&#xA;.ShardingOn&lt;Customer&gt;(c =&gt; c.Region, region =&gt;&#xA;{&#xA;    switch (region)&#xA;    {&#xA;        case &quot;Middle East&quot;:&#xA;            return &quot;ME&quot;;&#xA;        case &quot;USA&quot;:&#xA;        case &quot;United States&quot;:&#xA;        case &quot;US&quot;:&#xA;            return &quot;US&quot;;&#xA;        default:&#xA;            return &quot;Origin&quot;;&#xA;    }&#xA;})&#xA;&#xA;&#xA;We basically say that we map several values into a single region. But that isn&#x2019;t enough. Newly saved documents are going to have the shard prefix, so saving a new customer and invoice in the US shard will show up as:&#xA;&#xA;But existing data doesn&#x2019;t have this (created without sharding). &#xA;&#xA;So we need to take some extra effort to let RavenDB know about them. We do this using the following two functions:&#xA;&#xA; Func&lt;string, string&gt; potentialShardToShardId = val =&gt;&#xA; {&#xA;     var start = val.IndexOf(&#x27;/&#x27;);&#xA;     if (start == -1)&#xA;         return val;&#xA;     var potentialShardId = val.Substring(0, start);&#xA;     if (shards.ContainsKey(potentialShardId))&#xA;         return potentialShardId;&#xA;     // this is probably an old id, let us use it.&#xA;     return &quot;Origin&quot;;&#xA;&#xA; };&#xA; Func&lt;string, string&gt; regionToShardId = region =&gt;&#xA; {&#xA;     switch (region)&#xA;     {&#xA;         case &quot;Middle East&quot;:&#xA;             return &quot;ME&quot;;&#xA;         case &quot;USA&quot;:&#xA;         case &quot;United States&quot;:&#xA;         case &quot;US&quot;:&#xA;             return &quot;US&quot;;&#xA;         default:&#xA;             return &quot;Origin&quot;;&#xA;     }&#xA; };&#xA;&#xA;&#xA;We can then register our sharding configuration so:&#xA;&#xA;  var shardStrategy = new ShardStrategy(shards)&#xA;      .ShardingOn&lt;Customer, string&gt;(c =&gt; c.Region, potentialShardToShardId, regionToShardId)&#xA;      .ShardingOn&lt;Invoice, string&gt;(x =&gt; x.Customer, potentialShardToShardId, regionToShardId); &#xA;&#xA;&#xA;That takes care of handling both new and old ids, and let RavenDB understand how to query things in an optimal fashion. For example, a query on all invoices for &#x2018;customers/1&#x2019; will only hit the RVN1 server.&#xA;However, we aren&#x2019;t done yet. New customers that don&#x2019;t belong to the Middle East or USA will still go to the old server, and we don&#x2019;t want any modification to the id there. We can tell RavenDB how to handle it like so:&#xA;&#xA;var defaultModifyDocumentId = shardStrategy.ModifyDocumentId;&#xA;shardStrategy.ModifyDocumentId = (convention, shardId, documentId) =&gt;&#xA;{&#xA;    if(shardId == &quot;Origin&quot;)&#xA;        return documentId;&#xA;&#xA;    return defaultModifyDocumentId(convention, shardId, documentId);&#xA;};&#xA;&#xA;&#xA;That is almost the end. There is one final issue that we need to deal with, and that is the old documents, before we used sharding, don&#x2019;t have the required sharding metadata. We can fix that using a store listener. So we have:&#xA;&#xA; var documentStore = new ShardedDocumentStore(shardStrategy);&#xA; documentStore.RegisterListener(new AddShardIdToMetadataStoreListener());&#xA; documentStore.Initialize();&#xA;&#xA;&#xA;Where the listener looks like this:&#xA;&#xA; public class AddShardIdToMetadataStoreListener : IDocumentStoreListener&#xA; {&#xA;     public bool BeforeStore(string key, object entityInstance, RavenJObject metadata, RavenJObject original)&#xA;     {&#xA;         if (metadata.ContainsKey(Constants.RavenShardId) == false)&#xA;         {&#xA;             metadata[Constants.RavenShardId] = &quot;Origin&quot;;// the default shard id&#xA;         }&#xA;         return false;&#xA;     }&#xA;&#xA;     public void AfterStore(string key, object entityInstance, RavenJObject metadata)&#xA;     {&#xA;     }&#xA; }&#xA;&#xA;&#xA;And that is it. I know that there seems to be quite a lot going on in here, but it basically can be broken down to three actions that we take:&#xA;&#xA;Modify the existing metadata to add the sharding server id via the listener.&#xA;Modify the document id convention so documents on the old server won&#x2019;t have a designation (optional).&#xA;Modify the sharding configuration so we&#x2019;ll understand that documents without a shard prefix actually belong to the Origin shard.&#xA;And that is pretty much it.</p>
        </article>
        <article id="article-3687">
            <a href="https://ayende.com/blog/170849/why-ravendb-isnt-written-in-f-or-the-cost-of-the-esoteric-choice" target="_blank">
                <h2 class="title mb-6" id="article-3687">Why RavenDB isn&#x2019;t written in F#, or the cost of the esoteric choice</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 15, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In a recent post, a commenter suggested that using F# rather than C# would dramatically reduce the code size (measured in line numbers). My reply to that was:  F# would also lead to a lot more complexity, reduced participation in the community, harder to find developers and increased costs all around. And the data to back up this statement:     C# Developers F# Developers      Nitpicker corner: Now, I realize that this is a sensitive topic, so I&#x2019;ll note that this isn&#x2019;t meant to be a scientific observation. It is a data point that amply demonstrate my point. I&#x2019;m not going to run a full bore study.&#xA0; And yes, those numbers are about jobs, not people, but I&#x2019;m assuming that the numbers are at least roughly comparable. The reply to this was:  You have that option to hire cheaper developers. I think that the cheapest developers usually will actually increase your costs. But if that is your way, then I wish you good luck, and I accept that as an answer. How about &quot;a lot more complexity&quot;? Now, let me try to explain my thinking. In particular, I would strongly disagree with the &#x201C;cheapest developers&#x201D; mentality. That is very far from what I&#x2019;m trying to achieve. You usually get what you pay for, and trying to save on software development costs when your product is software is pretty much the definition of penny wise and pound foolish.  But let us ignore such crass terms as money and look at availability. There are less than 500 jobs for F# developers (with salary ranges implications that there isn&#x2019;t a whole lot of F# developers queuing up for those jobs). There are tens of thousands of jobs for C# developers, and again, the salary range suggest that there isn&#x2019;t a dearth of qualified candidates that would cause demand to raise the costs. From those numbers, and my own experience, I can say the following. There are a lot more C# developers than there are F# developers. I know that this is a stunning conclusion, likely to shatter the worldview of certain people. But I think that you would find it hard to refute that. Now, let us try to build on this conclusion.  First, there was the original point, that F# lead to reduced number of lines. I&#x2019;m not going to argue that, mostly&#xA0; because software development isn&#x2019;t an issue of who can type the most. The primary costs for development is design, test, debugging, production proofing, etc. The act of actually typing is pretty unimportant. For fun, I checked out the line count numbers for similar projects (RavenDB &amp; CouchDB). The count of lines in the Raven.Database project is roughly 100K. The count of lines in CouchDB src folder is roughly 45K. CouchDB is written in Erlang, which is another functional language, so we are at least not comparing apples to camels here. We&#x2019;ll ignore things like different feature set, different platforms, and the different languages for now. And just say that an F# program can deliver with 25% lines of code of a comparable C# program. Note that I&#x2019;m not actually agreeing with this statement, I&#x2019;m just using this as a basis for the rest of this post. And to (try to) forestall nitpickers. It is easy to show great differences in development time and line of code in specific cases where F# is ideally suited to the task. But we are talking about general purpose usage here. Now, for the sake of argument, we&#x2019;ll even assume that the cost of F# development is 50% of the cost of C# development. That is, that the reduction in line count actually has a real effect on the time and efficiency. In other words, if an F# program is 25% smaller than a similar C# program, we&#x2019;ll not assume that it takes 4 times as much time to write. Where does this leave us? It leave us with a potential pool of people to hire that is vanishingly small. What are the implications of writing software in a language that have fewer people familiar with it? Well, it is harder to find people to hire. That is true not only for people that your hire &#x201C;as is&#x201D;. Let us assume that you&#x2019;re going to give those people additional training after hiring them, so they would know F# and can work on your product. An already steep learning curve has just became that much steeper. Not only that, but this additional training means that the people you hire are more expensive (there is an additional period in which they are only learning). In addition to all of that, it will be harder to hire people, not just because you can&#x2019;t find people already experienced with F#, but because people don&#x2019;t want to work for you. Most developers at least try to pay attention to the market, and they make a very simple calculation. If I spend the next 2 &#x2013; 5 years working in F#, what kind of hirability am I going to have in the end? Am I going to be one of those trying to get the &lt; 500 F# jobs, or am I going to be in the position to find a job among the tens of thousands of C# jobs? Now, let us consider another aspect of this. The community around a project. I actually have a pretty hard time finding any significant F# OSS projects. But leaving that aside, looking at the number of contributors, and the ability of users to go into your codebase and look for themselves is a major advantage. We have had users skip the bug report entirely and just send us a Pull Request for an issue they run into, others have contributed (significantly) to the project. That is possible only because there is a wide appeal. If the language is not well known, the number of people that are going to spend the time and do something with it is going to be dramatically lower. Finally, there is the complexity angle. Consider any major effort required. Recently, we are working on porting RavenDB to Linux. Now, F# work on Linux, but anyone that we would go to in order to help us port RavenDB to Linux would have this additional (rare) requirement, need to understand F# as well as Linux &amp; Mono. Any problem that we would run into would have to first be simplified to a C# sample so it could be readily understood by people who aren&#x2019;t familiar with F#, etc. To go back to the beginning, using F# might have reduce the lines of code counter, but it wouldn&#x2019;t reduce the time to actually build the software and it would limit the number of people that can participate in the project, either as employees or Open Source contributors.</p>
        </article>
        <article id="article-3688">
            <a href="https://ayende.com/blog/170817/the-ravendb-comic-strip-part-i-finding-the-hero" target="_blank">
                <h2 class="title mb-6" id="article-3688">The RavenDB Comic Strip</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 12, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A while ago I posted the first draft of the RavenDB Comic Strip. Here is the final version.</p>
        </article>
        <article id="article-3689">
            <a href="https://enterprisecraftsmanship.com/posts/3-misuses-of-operator-in-c-6/" target="_blank">
                <h2 class="title mb-6" id="article-3689">3 misuses of ?. operator in C# 6</h2>
            </a>
            <p class="mb-2">by Vladimir Khorikov</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 11, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I guess you already know about the safe navigation operator (?. operator) coming up in C# 6. While it&#x2019;s a nice syntactic sugar for quite a few cases, I&#x2019;d like to point out some misuses of it I&#x2019;m sure we will see when C# 6 is released.</p>
        </article>
        <article id="article-3690">
            <a href="https://benfoster.io/blog/aspnet-webapi-cors/" target="_blank">
                <h2 class="title mb-6" id="article-3690">Enabling CORS in ASP.NET Web API 2</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 11, 2015
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post looks at the different ways you can enable CORS (Cross Origin Resource Sharing) in Web API 2.</p>
        </article>
        <div class="button flex justify-between">
            <a href="368.html"><span class="back arrow"></span></a>

            <a href="370.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
