
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 445 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4441">
            <a href="https://ayende.com/blog/154465/watch-your-6-or-is-it-your-i-o-it-is-the-i-o-yes" target="_blank">
                <h2 class="title mb-6" id="article-4441">Watch your 6, or is it your I/O? It is the I/O, yes</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 28, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">As I said in my previous post, tasked with having to load 3.1 million files into RavenDB, most of them in the 1 &#x2013; 2 KB range.  Well, the first thing I did had absolutely nothing to do with RavenDB, it had to do with avoiding dealing with this:  As you can see, that is a lot.  But when the freedb dataset is distributed, what we have is actually:   This is a tar.bz2, which we can read using the SharpZipLib library. The really interesting thing is that reading the archive (even after adding the cost of decompressing it) is far faster than reading directly from the file system. Most file systems do badly on large amount of small files, and at any rate, it is very hard to optimize the access pattern to a lot of small files. However, when we are talking about something like reading a single large file? That is really easy to optimize and significantly reduces the cost on the input I/O. Just this step has reduced the cost of importing by a significant factor, we are talking about twice as much as before, and with a lot less disk activity.</p>
        </article>
        <article id="article-4442">
            <a href="https://ardalis.com/configuring-web-apps-to-behave-like-native-apps-on-ios/" target="_blank">
                <h2 class="title mb-6" id="article-4442">Configuring Web Apps To Behave Like Native Apps on iOS</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 27, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">There are a number of things you can do with your web-based application to have it behave like a native iOS application. One of these I&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4443">
            <a href="https://ardalis.com/asus-zen-ultrabook-revisited/" target="_blank">
                <h2 class="title mb-6" id="article-4443">Asus Zen Ultrabook Revisited</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 27, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A couple of months ago I got an Asus Zen ultrabook, which I posted about when I first got it, and a month or so later. Now that I&#x2019;ve had it&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4444">
            <a href="https://ayende.com/blog/154433/watch-your-6-or-is-it-your-i-o" target="_blank">
                <h2 class="title mb-6" id="article-4444">Watch your 6, or is it your I/O?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 27, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the interesting things about the freedb dataset is that it is distributed as a 3.1 million separate files, most of them in the 1 &#x2013; 2 KB range. Loading that to RavenDB took a while, so I set out to fix that. Care to guess what is the absolutely the first thing that I did?</p>
        </article>
        <article id="article-4445">
            <a href="https://ardalis.com/how-do-i-disable-zoom-in-an-ipad-iphone-mobile-web-app/" target="_blank">
                <h2 class="title mb-6" id="article-4445">How Do I Disable Zoom in an iPad iPhone Mobile Web App?</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 26, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">If you&#x2019;re building web-based applications for mobile devices like the iPad/iPhone and you want to mimic native applications&#x2019; look and feel&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4446">
            <a href="https://ayende.com/blog/154337/ravendb-self-optimizing-ids" target="_blank">
                <h2 class="title mb-6" id="article-4446">RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 26, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the things that is really important for us in RavenDB is the notion of Safe by Default and Zero Admin. What this means is that we want to make sure that you don&#x2019;t really have to think about what you are doing for the common cases, RavenDB will understand what you mean and figure out what is the best way to do things. One of the cases where RavenDB does that is when we need to generate new ids. There are several ways to generate new ids in RavenDB, but the most common one, and the default, is to use the hilo algorithm. It basically (ignoring concurrency handling) works like this: var currentMax = GetMaxIdValueFor(&quot;Disks&quot;);&#xA;var limit = currentMax &#x2B; 32;&#xA;SetMaxIdValueFor(&quot;Disks&quot;);&#xA;&#xA;&#xA;And now we can generate ids in the range of currentMax to currentMax&#x2B;32, and we know that no one else can generate those ids. Perfect! &#xA;The good thing about it is that now we have a reserved range, we can create ids without going to the server. The bad thing about it is that we now reserved a range of 32. If we create just one or two documents and then restart, we would need to request a new range, and the rest of that range would be lost. That is why the default range value is 32. It is small enough that gaps aren&#x2019;t that important*, but it since in most applications, you usually create entities on an infrequent basis and when you do, you usually generate just one, then it is big enough to still provide a meaningful optimization with regards to the number of times you have to go to the server.&#xA;&#xA;* What does it means, &#x201C;gaps aren&#x2019;t important&#x201D;? The gaps are never important to RavenDB, but people tend to be bothered when they see disks/1 and disks/2132 with nothing in the middle. Gaps are only important for humans.&#xA;So this is perfect for most scenarios. Except one very common scenario, bulk import.&#xA;When you need to load a lot of data into RavenDB, you will very quickly note that most of the time is actually spent just getting new ranges. More time than actually saving the new documents takes, in fact.&#xA;Now, this value is configurable, so you can set it to a higher value if you care for it, but still, that was annoying. &#xA;Hence, what we have now. Take a look at the log below:&#xA;&#xA;It details the requests pattern in a typical bulk import scenario. We request an id range for disks, and then we request it again, and again, and again.&#xA;But, notice what happens as times goes by (and not that much time) before RavenDB recognizes that you need bigger ranges, and it gives you them. In fact, very quickly we can see that we only request a single range per batch, because RavenDB have optimized itself based on our own usage pattern.&#xA;Kinda neat, even if I say so myself.</p>
        </article>
        <article id="article-4447">
            <a href="https://ayende.com/blog/153698/searching-aint-simple-solution" target="_blank">
                <h2 class="title mb-6" id="article-4447">Searching ain&#x2019;t simple: solution</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 23, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">On my last post, I descried the following problem:  And stated that the following trivial solution is the wrong approach to the problem: select d.* from Designs d &#xA; join ArchitectsDesigns da on d.Id = da.DesignId&#xA; join Architects a on da.ArchitectId = a.Id&#xA;where a.Name = @name&#xA;&#xA;&#xA;The most obvious reason is actually that we are thinking too linearly. I intentionally showed the problem statement in terms of UI, not in terms of a document specifying what should be done.&#xA;The reason for that is that in many cases, a spec document is making assumptions that the developer should not. When working on a system, I like to have drafts of the screens with rough ideas about what is supposed to happen, and not much more.&#xA;In this case, let us consider the problem from the point of view of the user. Searching by the architect name makes sense to the user, that is usually how they think about it.&#xA;But does it makes sense from the point of view of the system? We want to provide good user experience, which means that we aren&#x2019;t just going to provide the user with a text box to plug in some values. For one thing, they would have to put in the architect full name as it is stored in our system. That is going to be a tough call in many cases. Ask any architect what the first name of Gaudi is, and see what sort of response you&#x2019;ll get. &#xA;Another problem is how to deal with misspelling, partial names, and other information. What if we actually have the architect id, and are used to type that? I would much rather type 1831 than Mies Van Der Rohe, and most users that work with the application day in and day out would agree.&#xA;From the system perspective, we want to divide the problem into two separate issues, finding the architect and finding the appropriate designs. From a user experience perspective, that means that the text box is going to be an ajax suggest box, and the results would be loaded based on valid id.&#xA;Using RavenDB and ASP.Net MVC, we would have the following solution. First, we need to define the search index:&#xA;&#xA;&#xA;&#xA;This gives us the ability to search across both name and id easily, and it allows us to do full text searches as well. The next step is the actual querying for architect by name:&#xA;&#xA;&#xA;Looks complex, doesn&#x2019;t it? Well, there is certainly a lot of code there, at least.&#xA;First, we look for an a matching result in the index. If we find anything, we send just the name and the id of the matching documents to the user. that part is perfectly simple.&#xA;The interesting bits happen when we can&#x2019;t find anything at all. In that case, we ask RavenDB to find us results that might be the things that the user is looking for. It does that by running a string distance algorithm over the data in the database already and providing us with a list of suggestions about what the user might have meant.&#xA;We take it one step further. If there is just one suggestion, we assume that this is what the user meant, and just return the results for that value. If there is more than that, we sent an empty result set to the client along with a list of alternatives that they can suggest to the user.&#xA;From here, the actual task of getting the designs for this architect becomes as simple as:&#xA;&#xA;&#xA;And it turns out that when you think about it right, searching is simple.</p>
        </article>
        <article id="article-4448">
            <a href="https://ayende.com/blog/153665/searching-aint-simple" target="_blank">
                <h2 class="title mb-6" id="article-4448">Searching ain&#x2019;t simple</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 22, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The problem statement is best described using:  This seems like a nice and easy problem, right? We join the architects table to the designs table and we are done. select d.* from Designs d &#xA; join ArchitectsDesigns da on d.Id = da.DesignId&#xA; join Architects a on da.ArchitectId = a.Id&#xA;where a.Name = @name&#xA;&#xA;&#xA;This is a trivial solution, and shouldn&#x2019;t take a lot of time to build&#x2026; &#xA;It is also the entirely wrong approach for the problem, can you tell me why?</p>
        </article>
        <article id="article-4449">
            <a href="https://ayende.com/blog/155361/ravendb-sharding-map-reduce-in-a-cluster" target="_blank">
                <h2 class="title mb-6" id="article-4449">RavenDB Sharding&#x2013;Map/Reduce in a cluster</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 21, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In my previous post, I introduced RavenDB Sharding and discussed how we can use sharding in RavenDB. We discussed both blind sharding and data driven sharding. Today I want to introduce another aspect of RavenDB Sharding. The usage of Map/Reduce to&#xA0; gather information from multiple shards. We start by defining a map/reduce index. In this case, we want to look at the invoice totals per date. We define the index like this: public class InvoicesAmountByDate : AbstractIndexCreationTask&lt;Invoice, InvoicesAmountByDate.ReduceResult&gt;&#xA;{&#xA;    public class ReduceResult&#xA;    {&#xA;        public decimal Amount { get; set; }&#xA;        public DateTime IssuedAt { get; set; }&#xA;    }&#xA;&#xA;    public InvoicesAmountByDate()&#xA;    {&#xA;        Map = invoices =&gt;&#xA;              from invoice in invoices&#xA;              select new&#xA;              {&#xA;                  invoice.Amount,&#xA;                invoice.IssuedAt&#xA;              };&#xA;&#xA;        Reduce = results =&gt;&#xA;                 from result in results&#xA;                 group result by result.IssuedAt&#xA;                 into g&#xA;                 select new&#xA;                 {&#xA;                     Amount = g.Sum(x =&gt; x.Amount),&#xA;                    IssuedAt = g.Key&#xA;                 };&#xA;    }&#xA;}&#xA;&#xA;&#xA;And then we execute the following code:&#xA;using (var session = documentStore.OpenSession())&#xA;{&#xA;    var asian = new Company { Name = &quot;Company 1&quot;, Region = &quot;Asia&quot; };&#xA;    session.Store(asian);&#xA;    var middleEastern = new Company { Name = &quot;Company 2&quot;, Region = &quot;Middle-East&quot; };&#xA;    session.Store(middleEastern);&#xA;    var american = new Company { Name = &quot;Company 3&quot;, Region = &quot;America&quot; };&#xA;    session.Store(american);&#xA;&#xA;    session.Store(new Invoice { CompanyId = american.Id, Amount = 3, IssuedAt = DateTime.Today.AddDays(-1)});&#xA;    session.Store(new Invoice { CompanyId = asian.Id, Amount = 5, IssuedAt = DateTime.Today.AddDays(-1) });&#xA;    session.Store(new Invoice { CompanyId = middleEastern.Id, Amount = 12, IssuedAt = DateTime.Today });&#xA;    session.SaveChanges();&#xA;}&#xA;&#xA;&#xA;We use a three way sharding, based on the region of the company, so we actually have the following document sin three different servers:&#xA;First server, Asia:&#xA;&#xA;&#xA;Second server, Middle East:&#xA;&#xA;&#xA;Third server, America:&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;Now, let us see what happen when we use the map/reduce query:&#xA;using (var session = documentStore.OpenSession())&#xA;{&#xA;    var reduceResults = session.Query&lt;InvoicesAmountByDate.ReduceResult, InvoicesAmountByDate&gt;()&#xA;        .ToList();&#xA;&#xA;    foreach (var reduceResult in reduceResults)&#xA;    {&#xA;        string dateStr = reduceResult.IssuedAt.ToString(&quot;MMM dd, yyyy&quot;, CultureInfo.InvariantCulture);&#xA;        Console.WriteLine(&quot;{0}: {1}&quot;, dateStr, reduceResult.Amount);&#xA;    }&#xA;    Console.WriteLine();&#xA;}&#xA;&#xA;&#xA;&#xA;As you can see, again, we make no distinction in our code about using sharding, we just query it normally. The results, however, are quite interesting:&#xA;&#xA;&#xA;As you can see, we got the correct results, cluster wide.&#xA;RavenDB was able to query all the servers in the cluster for their results, reduce them again, and get us the total across all three servers.&#xA;And that, my friends, it truly awesome.</p>
        </article>
        <article id="article-4450">
            <a href="https://ayende.com/blog/155329/ravendb-sharding-data-driven-sharding" target="_blank">
                <h2 class="title mb-6" id="article-4450">RavenDB Sharding&#x2013;Data Driven Sharding</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 20, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In my previous post, I introduced RavenDB Sharding and discussed how we can use Blind Sharding to a good effect. I also mentioned that this approach is somewhat lacking, because we don&#x2019;t have enough information at hand to be able to really understand what is going on. Let me show you how we can define a proper sharding function that shards your documents based on their actual data.&#xA;&#xA;&#x9;We are still going to run the exact same code as we have done before:&#xA;&#xA;&#x9;string asianId, middleEasternId, americanId;&#xA;&#xA;using (var session = documentStore.OpenSession())&#xA;{&#xA;    var asian = new Company { Name = &quot;Company 1&quot;, Region = &quot;Asia&quot; };&#xA;    session.Store(asian);&#xA;    var middleEastern = new Company { Name = &quot;Company 2&quot;, Region = &quot;Middle-East&quot; };&#xA;    session.Store(middleEastern);&#xA;    var american = new Company { Name = &quot;Company 3&quot;, Region = &quot;America&quot; };&#xA;    session.Store(american);&#xA;&#xA;    asianId = asian.Id;&#xA;    americanId = american.Id;&#xA;    middleEasternId = middleEastern.Id;&#xA;&#xA;    session.Store(new Invoice { CompanyId = american.Id, Amount = 3 });&#xA;    session.Store(new Invoice { CompanyId = asian.Id, Amount = 5 });&#xA;    session.Store(new Invoice { CompanyId = middleEastern.Id, Amount = 12 });&#xA;    session.SaveChanges();&#xA;&#xA;}&#xA;&#xA;using (var session = documentStore.OpenSession())&#xA;{&#xA;    session.Query&lt;Company&gt;()&#xA;        .Where(x =&gt; x.Region == &quot;America&quot;)&#xA;        .ToList();&#xA;&#xA;    session.Load&lt;Company&gt;(middleEasternId);&#xA;&#xA;    session.Query&lt;Invoice&gt;()&#xA;        .Where(x =&gt; x.CompanyId == asianId)&#xA;        .ToList();&#xA;}&#xA;&#x9;&#xA;&#xA;&#xA;&#x9;What is different now is how we initialize the document store:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;What we have done is given RavenDB the information about how our entities are structured and how we should shard them. We should shard the companies based on their regions, and the invoices based on their company id.&#xA;&#xA;&#x9;Let us see how the code behaves now, shall we? As before, we will analyze the output of the HTTP logs from execute this code. Here is the first server output:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;As before, we can see the first four request are there to handle the hilo generation, and they are only there for the first server.&#xA;&#xA;&#x9;The 5th request is saving two documents. Note that this is the Asia server, and unlike the previous example, we don&#x2019;t get companies/1 and invoices/1 in the first shard.&#xA;&#xA;&#x9;Instead, we have companies/1 and invoice/2. Why is that? Well, RavenDB detected that invoices/2 belongs to a company that is associated with this shard, so it placed it in the same shard. This ensures that we have good locality and that we can utilize features such as Includes or Live Projections even when using sharding.&#xA;&#xA;&#x9;Another interesting aspect is that we don&#x2019;t see a request for companies in the America region. Because this is what we shard on, RavenDB was able to figure out that there is no way that we will have a company in the America region in the Asisa shard, so we can skip this call.&#xA;&#xA;&#x9;Conversely, when we need to find an invoice for an asian company, we can see that this request gets routed to the proper shard.&#xA;&#xA;&#x9;Exciting, isn&#x2019;t it?&#xA;&#xA;&#x9;Let us see what we have in the other two shards.&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;In the second shard, we can see that we have just two requests, one to save two documents (again, a company and its associated invoice) and the second to load a particular company by id.&#xA;&#xA;&#x9;We were able to optimize all the other queries away, because we actually understand the data that you save.&#xA;&#xA;&#x9;And here is the final shard results:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;Again, we got a save for the two documents, and then we can see that we routed the appropriate query to this shard, because this is the only place that can answer this question.&#xA;&#xA;&#x9;Data Driven Sharding For The Win!&#xA;&#xA;&#x9;But so far we have seen how RavenDB can optimize the queries made to the shards when it has enough information to do so. But what happens when it can&#x2019;t?&#xA;&#xA;&#x9;For example, let us say that I want to get the 2 highest value invoices. Since I didn&#x2019;t specify a region, what would RavenDB do? Let us look at the code:&#xA;&#xA;&#x9;var topInvoices = session.Query&lt;Invoice&gt;()&#xA;    .OrderByDescending(x =&gt; x.Amount)&#xA;    .Take(2)&#xA;    .ToList();&#xA;&#xA;foreach (var invoice in topInvoices)&#xA;{&#xA;    Console.WriteLine(&quot;{0}\t{1}&quot;, invoice.Amount, invoice.CompanyId);&#xA;}&#xA;&#x9;&#xA;&#xA;&#xA;&#x9;This code outputs:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;So we were actually able to get just the two highest invoices. But what actually happened?&#xA;&#xA;&#x9;Shard 1 (Asia):&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;Shard 2 (Middle-East):&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;Shard 3 (America):&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;As you can see, we have actually made 3 queries, asking the same question from each of the shards. Each shard returned its own results. On the client side, we merged those results, and gave you back exactly the information that requested, across the entire cluster.</p>
        </article>
        <div class="button flex justify-between">
            <a href="444.html"><span class="back arrow"></span></a>

            <a href="446.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2024<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>