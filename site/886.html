
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 886 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-8851">
            <a href="https://ayende.com/blog/1607/thinking-about-rhino-mocks-3-0" target="_blank">
                <h2 class="title mb-6" id="article-8851">Thinking about Rhino Mocks 3.0</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 13, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am thinking about the Rhino Mocks 3.0 release, and I wondered what features &#xA0;or bug fixes you think would be good for it. Rhino Mocks has a vastly under utilized bug tracking here, so feel free to use it.    One thing that is definately going to be is a Wiki so users can add their own content to the documentation. I just can&#x27;t keep the docs updated anymore.</p>
        </article>
        <article id="article-8852">
            <a href="https://ayende.com/blog/1606/reflection-emit-vs-codedom" target="_blank">
                <h2 class="title mb-6" id="article-8852">Reflection.Emit vs. CodeDOM</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 13, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Both technologies allow you to generate executable code at runtime (even though CodeDOM may not have been originally intended for this). This opens up some interesting possibilities (Rhino Mocks&#xA0;and NHibernate, for instnace, uses Dynamic Proxy, which uses Reflection.Emit to generate proxies for object at runtime).    Reflection.Emit gives you complete control of the generated IL, while CodeDOM leaves you creating source code dynamically.    Reflection.Emit has the following advantages:            You can generate new classes directly into an existing assembly, this helps reduce memory consumtion.            You can generate new methods in a class (.Net 2.0, dynamic methods).            Significanty faster than any other alternative.    And disadvantages:            It is rocket science mixed with the black arts. The common path is merely hard, but try doing something like support out/ref values, or handling sealed methods, and you are thrown into a mire of special cases. That is completely ignoring the new stuff in .Net 2.0, like generics, which are such a fun to try to support.            It is not debuggable, at all.            It is very easy to produce invalid code, and there isn&#x27;t much information about what is wrong, nor is there much information about how you should go about it.            Side note: Even the C# Compiler can be presuded to produce invalid code in certain instances, just to give you an idea about how hard this thing is.    CodeDOM has the following advantages:            Very easy to understand and use.            The generated code is debuggable.            You get a lot more information about the errors, often with how to fix them.    And disadvantages:            You can&#x27;t incremently add classes to assembly (important for things like Dynamic Proxy). Every time you generate code, it has its own own assembly.            You are limited to what you can do within the langauge. There are things you just can&#x27;t do in code, which are easily possible in Reflection.Emit. There are usually other ways around it, though.            Slower than Reflection.Emit, because we are generating the code and then compiling it on the fly. This is usually very little code, so it doesn&#x27;t really matter, and caching helps quite a bit.    Given that caching is going to be used anyway, I think that I can ignore most of the performance benefits of using Reflection.Emit, in favor of a much simpler programming model offered by CodeDOM. The only thing that really needs Reflection.Emit is dynamically adding methods to a class, and that is not something that you often need.</p>
        </article>
        <article id="article-8853">
            <a href="https://ayende.com/blog/1605/and-there-was-much-rejoicing-for-the-exception-was-raised" target="_blank">
                <h2 class="title mb-6" id="article-8853">And there was much rejoicing, for the Exception was raised</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 13, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A lot of programmers seems to be afraid of exceptions. The moment they get one they throw their hands up in dispair and exclaim &quot;This piece of shit doesn&#x27;t work.&quot; And then they come to me to help. They usually start with &quot;It threw an error&quot;, &quot;It doesn&#x27;t work&quot;, etc.    At first I try to hone my clairvoyant skills, and give them an answer anyway, but after being accused for using KGB interrogation technique* I decided to stop that. Nowadays, I refuse to help them unless they tell me what the exception is.&#xA0;And in 97% of the cases, it is a simple thing like a bad connection string, trying to do things wrong, etc.    I like exceptions, they give you information about the error. They are descriptive, they stop you from carrying on with an error. I just worked on a codebase that looked mostly like this:            public&#xA0;bool&#xA0;DoWork()        {        &#xA0;&#xA0;try                &#xA0;&#xA0;{&#xA0;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;do&#xA0;work                &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;true;        &#xA0;&#xA0;&#xA0;}&#xA0;        &#xA0;&#xA0;&#xA0;catch&#xA0;(Exception&#xA0;e)        &#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//maybe&#xA0;log&#xA0;exception                &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;false;&#xA0;        &#xA0;&#xA0;&#xA0;}        }        A fair warning, if you are writing code like this, it has better be in a method called IsPossibleToXXXX(), and it should be called once. Failing to do will result in me coming after your with a big stick. I    The calling code was sometimes check the return code, and sometimes didn&#x27;t, and when it failed, it took forever to hunt it down. It is nice that you are showing off you C master level skills, but it&#x27;s not C anymore. No, logging the exception doesn&#x27;t help. I don&#x27;t want to look at the log when I am running the app. And don&#x27;t even get me started on logging exceptions like this:            catch(Exception&#xA0;e)        {        &#xA0;&#xA0; logger.Error(e.Message);                }        Talk about useless logging. The most common exception in NHibernate is &quot;unable to perform find&quot;, with all the nice juicy details hidden about two layers down. Logging just the message is wrong. Log everything, you wouldn&#x27;t believe the amount of information just the call stack can give you.    I had a devil of a time removing a lot of that exception handling, and you wouldn&#x27;t believe my excitement when I got the first exception (Null Reference Exception) throught all the layers in that application. Now I could work properly.    A proper application should have only a couple try/catch blocks, and those should be at the very top of the call chain.I just finish writing an app that needed to be exceptions harden, this meant that nothing should take it down, DB down, collaborators down, etc. I had to add a lot of try / catch blocks in a single class. I didn&#x27;t litter my code with them like a prankster on drugs.    Oh, and no matter what you think, exceptions are so much better than ERROR 0x030984542 OCCURED!    * I got some key parses in Russian tphat roll of the tongue just nicely. The Russian speaking guys here are shocked each time I am saying it. But they refuse to translate it. It is something about a cow and your mother, I think. Great for relieving pressure. There is blat in it somewhere too.</p>
        </article>
        <article id="article-8854">
            <a href="https://ayende.com/blog/1604/where-did-my-file-go" target="_blank">
                <h2 class="title mb-6" id="article-8854">Where did my file go?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">What happen if you are doing something like this in ASP.Net:File.WriteAllText(&quot;fun.txt&quot;, &quot;Foo Fum&quot;);    On my machine, it goes to: c:\windows\system32\inetsrv\fun.txt    Remember that the current directory in ASP.Net is wherever the server process has decided it should be, if you want the directory that your application is on, use AppDomain.Current.BaseDirectory for it.</p>
        </article>
        <article id="article-8855">
            <a href="https://ayende.com/blog/1603/someone-here-doesnt-get-test-driven-development" target="_blank">
                <h2 class="title mb-6" id="article-8855">Someone here doesn&#x27;t get Test Driven Development</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Trying to get a report of a test run, a shady guy around here has wrote the following code, included in full:            private&#xA0;DataSet&#xA0;ExtractResult(TestSuiteResult&#xA0;result)        {        &#xA0;&#xA0;&#xA0;&#xA0;DataSet&#xA0;res&#xA0;=&#xA0;new&#xA0;DataSet(&quot;AllResult&quot;);        &#xA0;&#xA0;&#xA0;&#xA0;res.Tables.Add&#xA0;(&#xA0;&quot;Diagnostics&quot;&#xA0;);        &#xA0;&#xA0;&#xA0;&#xA0;res.Tables[&quot;Diagnostics&quot;].Columns.Add(new&#xA0;DataColumn(&quot;Description&quot;,&#xA0;typeof(string)));        &#xA0;&#xA0;&#xA0;&#xA0;res.Tables[&quot;Diagnostics&quot;].Columns.Add(new&#xA0;DataColumn(&quot;Passed&quot;,&#xA0;typeof(bool)));        &#xA0;&#xA0;&#xA0;&#xA0;res.Tables[&quot;Diagnostics&quot;].Columns.Add(new&#xA0;DataColumn(&quot;Message&quot;,&#xA0;typeof(string)));        &#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestSuiteResult&#xA0;o&#xA0;in&#xA0;result.Results)        &#xA0;&#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestSuiteResult&#xA0;o1&#xA0;in&#xA0;o.Results)        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestSuiteResult&#xA0;o2&#xA0;in&#xA0;o1.Results)        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestSuiteResult&#xA0;o3&#xA0;in&#xA0;o2.Results)        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestSuiteResult&#xA0;o4&#xA0;in&#xA0;o3.Results)        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestSuiteResult&#xA0;o5&#xA0;in&#xA0;o4.Results)        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(TestCaseResult&#xA0;o6&#xA0;in&#xA0;o5.Results)        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;{        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;DataRow&#xA0;row&#xA0;=&#xA0;res.Tables[&quot;Diagnostics&quot;].NewRow();        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;row[&quot;Description&quot;]&#xA0;=&#xA0;o6.Name.Substring&#xA0;(&#xA0;o6.Name.LastIndexOf&#xA0;(&#xA0;&#x27;.&#x27;)&#x2B;1);        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;row[&quot;Passed&quot;]&#xA0;=&#xA0;o6.IsSuccess;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;row&#xA0;[&quot;Message&quot;]&#xA0;=&#xA0;o6.Message;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;res.Tables[&quot;Diagnostics&quot;].Rows.Add(row);        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;        &#xA0;&#xA0;&#xA0;&#xA0;}        &#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;res;        }        After thumping him on the head, I replaced the code with this:StringWriter&#xA0;sw&#xA0;=&#xA0;new&#xA0;StringWriter();    XmlResultVisitor&#xA0;visitor&#xA0;=&#xA0;new&#xA0;XmlResultVisitor(sw,&#xA0;result);    result.Accept(visitor);    visitor.Write();    If it take more than 15 lines to do something, think again. And for crying out LOUD, open reflector, have a look. Please!    And on the same note, do read carefully the exception messages that you get, including the stack. &quot;It fails&quot; is utterly meaningless to me.</p>
        </article>
        <article id="article-8856">
            <a href="https://ayende.com/blog/1602/minimal-configuration-for-rhino-common-repository" target="_blank">
                <h2 class="title mb-6" id="article-8856">Minimal Configuration for Rhino Common Repository</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is the bare minimum that you need to do in order to use the repositories:            &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;                        &lt;configuration&gt;                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;components&gt;                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;component id=&quot;default.repository&quot;                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0; service =&quot;Rhino.Commons.IRepository`1, Rhino.Commons&quot;                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0; type=&quot;Rhino.Commons.NHRepository`1, Rhino.Commons&quot;/&gt;                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/components&gt;                        &lt;/configuration&gt;        Just put it in windor.config in the current directory add the appropriate hibernate.cfg.xml&#xA0;and call initialize.</p>
        </article>
        <article id="article-8857">
            <a href="https://ayende.com/blog/1601/and-sometimes-i-dont-want-to-use-generics" target="_blank">
                <h2 class="title mb-6" id="article-8857">And sometimes I don&#x27;t want to use generics</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 09, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Take a look at this:            IList list = UnitOfWork.CurrentNHibernateSession                        &#xA0;&#xA0;&#xA0; .CreateCriteria(state.RecordType).List();                RecordType is a System.Type that is loaded from the database as one of the properties of the state. This means that I literally switch stuff around just by adding to records to a table.    Combine that with a Layer Super Type and dynamic data binding, and you have got a winner combination with regard to speed of changing things.</p>
        </article>
        <article id="article-8858">
            <a href="https://ayende.com/blog/1600/from-nhibernate-sessions-to-repository-t" target="_blank">
                <h2 class="title mb-6" id="article-8858">From NHibernate Sessions to Repository&lt;T&gt;</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 09, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Before:            using (ISession session = _sessionManager.OpenSession())                        {                        &#xA0;&#xA0;&#xA0; IList list = session.CreateCriteria(typeof (State))                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .SetFirstResult(Settings.Default.LogsPageSize*currentPage)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .SetMaxResults(Settings.Default.LogsPageSize)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .Add(Expression.Eq(&quot;Connection.Id&quot;, interfaceId))                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .AddOrder(new Order(&quot;ArrivedAt&quot;, false))                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; .List();                        &#xA0;&#xA0;&#xA0; return Util.ToArray&lt;FileState&gt;(list);                        }         After:            return Repository&lt;FileState&gt;.FindAll(                        &#xA0;&#xA0;&#xA0; Settings.Default.LogsPageSize*currentPage,                        &#xA0;&#xA0;&#xA0; Settings.Default.LogsPageSize,                        &#xA0;&#xA0;&#xA0; Order.Asc(&quot;ArrivedAt&quot;),                        &#xA0;&#xA0;&#xA0; Where.FileState.Connection.IdIs(interfaceId)                        &#xA0;&#xA0;&#xA0; );         Update: Changed new Order() to use clearer factory method.</p>
        </article>
        <article id="article-8859">
            <a href="https://ayende.com/blog/1599/how-to-use-rhino-commons-in-asp-net" target="_blank">
                <h2 class="title mb-6" id="article-8859">How to use Rhino Commons in ASP.Net</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 09, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In the web space, the Unit of Work pattern is usually mapped to a unit of work per web request. This translate very easily to an http module, which you can find here. It configures the container automatically from a file named (by defauly) &quot;windsor.config&quot;, and starts / dispose unit of works as part of the http pipeline.     Basically, this means that you never need to worry about this.     The configuration is simply:             &lt;    httpModules&gt;    &#xA0;&#xA0;&#xA0;&#xA0; &lt;add name=&quot;UnitOfWorkModule&quot;    &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;type=&quot;Rhino.Commons.HttpModules.UnitOfWorkModule&quot;/&gt;    &lt;/httpModules&gt;        &#xA0;Important note: currently, I do not allow nesting of unit of works, don&#x27;t enter Unit Of Work explicitly if you use this http module.</p>
        </article>
        <article id="article-8860">
            <a href="https://ayende.com/blog/1598/visual-studio-riddle" target="_blank">
                <h2 class="title mb-6" id="article-8860">Visual Studio Riddle</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 09, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have the following project structure:                                                                                                \Configuration                                                                            \Database                                                                            \Lib                                                                            \Executioner                                                                            \Executioner.IntegrationTests                                                                            \Executioner.Service                                                                            \Executioner.Tests                                                                            \Executioner.Web                                                                                                                                                    Executioner.sln                                                                            Default.build                                                                            Documentation.docx                                                                            hibernate.cfg.xml                                            What I want is to be able to add the Configuration &amp; Database to the solution, but (and this is important) keep them in the same location as they are at the moment. I tried creating a solution folder and dragging stuff there, but creating a new stuff there creates them in the solution root, instead of the request directory.</p>
        </article>
        <div class="button flex justify-between">
            <a href="885.html"><span class="back arrow"></span></a>

            <a href="887.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>