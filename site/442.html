
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 442 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4411">
            <a href="https://ayende.com/blog/159297/optimization-story-getnextidentityvaluewithoutoverwritingonexistingdocuments" target="_blank">
                <h2 class="title mb-6" id="article-4411">Optimization story: GetNextIdentityValueWithoutOverwritingOnExistingDocuments</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 30, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A customer had a problem. They were mostly using the RavenDB HiLo algorithm for saving documents to the database, which is very fast &amp; cheap. That client, however, chose to use the identity method. Which means that RavenDB will assign the value.  This is usually used if you need to have sequential values. The identity is actually being managed internally by RavenDB, and that works perfectly fine.  Except&#x2026; What happens when you enter replication to the mix. The documents with the identity values are replicated to the secondary server, and there we don&#x2019;t have the identity value, we just have the docs being written with their full id. (users/1, users/2, users/3, etc). So far, so good. But what happens when you have a failover and you need to write to the secondary, and you use the identity? Well, RavenDB ain&#x2019;t stupid, and it won&#x2019;t overwrite the users/1 document. Instead, it will search for the next available opening from the smallest identity value generated and use that. The code looks like this:      1: private long GetNextIdentityValueWithoutOverwritingOnExistingDocuments(string key,    2:     IStorageActionsAccessor actions,    3:     TransactionInformation transactionInformation)   4: {   5:     long nextIdentityValue;   6:     do   7:     {   8:         nextIdentityValue = actions.General.GetNextIdentityValue(key);   9:     } while (actions.Documents.DocumentMetadataByKey(key &#x2B; nextIdentityValue, transactionInformation) != null);  10:     return nextIdentityValue;  11: }&#xA;This works, great. Except when you have large number of documents that have already been written. Instead of the brute force search, we now use the following approach:&#xA;&#xA;&#xA;   1: public long GetNextIdentityValueWithoutOverwritingOnExistingDocuments(string key,   2:     IStorageActionsAccessor actions,   3:     TransactionInformation transactionInformation,   4:     out int tries)   5: {   6:     long nextIdentityValue = actions.General.GetNextIdentityValue(key);   7:&#xA0;    8:     if (actions.Documents.DocumentMetadataByKey(key &#x2B; nextIdentityValue, transactionInformation) == null)   9:     {  10:         tries = 1;  11:         return nextIdentityValue;  12:     }  13:     tries = 1;  14:     // there is already a document with this id, this means that we probably need to search  15:     // for an opening in potentially large data set.   16:     var lastKnownBusy = nextIdentityValue;  17:     var maybeFree = nextIdentityValue*2;  18:     var lastKnownFree = long.MaxValue;  19:     while (true)  20:     {  21:         tries&#x2B;&#x2B;;  22:         if(actions.Documents.DocumentMetadataByKey(key &#x2B; maybeFree, transactionInformation) == null)  23:         {  24:             if (lastKnownBusy &#x2B; 1 == maybeFree)  25:             {  26:                 actions.General.SetIdentityValue(key, maybeFree);  27:                 return maybeFree;  28:             }  29:             lastKnownFree = maybeFree;  30:             maybeFree = Math.Max(maybeFree - (maybeFree - lastKnownBusy) / 2, lastKnownBusy &#x2B; 1);  31:&#xA0;   32:         }  33:         else  34:         {  35:             lastKnownBusy = maybeFree;  36:             maybeFree = Math.Min(lastKnownFree, maybeFree*2);  37:         }  38:     }  39: }&#xA;This can figure out the first free item in a range of billion documents in under 100 tries, which I am pretty sure if good enough.</p>
        </article>
        <article id="article-4412">
            <a href="https://ayende.com/blog/159393/design-patterns-in-the-test-of-time-prototype" target="_blank">
                <h2 class="title mb-6" id="article-4412">Design patterns in the test of time</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 29, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Create objects based on a template of an existing object through cloning.   More about this pattern. This is how it looks like:  Surprisingly enough, there are very few useful concrete examples of this, even in the literature. A lot of the time you see reference to ConcreteImplA and ConcreteImplB. The original impetus for the Prototype pattern was actually:  avoid subclasses of an object creator in the client application, like the abstract factory pattern does.  avoid the inherent cost of creating a new object in the standard way (e.g., using the &#x27;new&#x27; keyword) when it is prohibitively expensive for a given application. That is actually quite interesting. As I mentioned in the Factory Method analysis post, I like the notion of using Factory Delegate (and thus avoiding subclassing) quite a lot. This is usually useful for behavioral objects, that contains little state (it would be more accurate to say that their state is behavior, such as a class that mostly contains delegate members for different things). But for those sort of things, you usually don&#x2019;t really need to modify them after the fact, so there isn&#x2019;t much of a prototype here. The second reasoning is not relevant for most things today. The cost of new is so near zero to be effectively meaningless. But something that isn&#x2019;t mentioned about this pattern is that it is very useful for multi threading. The notion of being able to handle a cloned object that can be modified independently of its original is key in things like caches, as you can see in the code above. We make heavy use of that internally inside RavenDB, for example, although we choose a slight more complex (and performant) route.  A key observation about this is that Prototype assumes long lives objects. Because otherwise, there wouldn&#x2019;t be the prototype instance to clone from. In wide variety of applications today, that is simply not the case. Most of our objects live only for a single request. And anything whose lifetime is longer than a single request is usually persisted to a stable storage, rendering the basis for the Prototype pattern existence moot. Recommendation: This is still a useful pattern for a limited number of scenarios. In particular, the ability to hand out a copy of the instance from a cache means that we don&#x2019;t have to worry about multi threading. That said, beyond this scenario, I haven&#x2019;t found many other uses for this.</p>
        </article>
        <article id="article-4413">
            <a href="https://ayende.com/blog/159521/ravendb-studio-feature-patching" target="_blank">
                <h2 class="title mb-6" id="article-4413">RavenDB Studio Feature</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 28, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The full details are here.</p>
        </article>
        <article id="article-4414">
            <a href="https://ayende.com/blog/159522/ravendb-studio-feature-address-to-geo-location" target="_blank">
                <h2 class="title mb-6" id="article-4414">RavenDB Studio Feature</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 27, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Full details in out company blog.</p>
        </article>
        <article id="article-4415">
            <a href="https://ardalis.com/justcode-justrocks/" target="_blank">
                <h2 class="title mb-6" id="article-4415">JustCode JustRocks</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 26, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have been a ReSharper fanboy for a long, long time. I have recommended it in user group and conference talks and on my blog. It was one of&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4416">
            <a href="https://ayende.com/blog/159363/design-patterns-in-the-test-of-time-factory-method" target="_blank">
                <h2 class="title mb-6" id="article-4416">Design patterns in the test of time</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 26, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Define an interface for creating an object, but let the classes that implement the interface decide which class to instantiate. The Factory method lets a class defer instantiation to subclasses.  More on this pattern. Here is some sample code:      1: public class MazeGame {   2:   public MazeGame() {   3:      Room room1 = MakeRoom();   4:      Room room2 = MakeRoom();   5:      room1.Connect(room2);   6:      AddRoom(room1);   7:      AddRoom(room2);   8:   }   9:    10:   protected virtual Room MakeRoom() {  11:      return new OrdinaryRoom();  12:   }  13: }&#xA;This pattern is quite useful, and is in fairly moderate use. For example, you can take a look at WebClient.GetWebRequest, which is an exact implementation of this pattern. I like this pattern because this allows me to keep the Open Closed Principle, I don&#x2019;t need to modify the class, I can just inherit and override it to change things.&#xA;Still, this is the class method. I like to mix things up a bit and not use a virtual method, instead, I do things like this:&#xA;&#xA;   1: public class MazeGame {   2:    public Func&lt;Room&gt; MakeRoom = () =&gt; new OrdinaryRoom();   3: }&#xA;This allows me change how we are creating the room without even having to create a new subclass. In fact, it allows me to change this per instance. &#xA;I make quite a heavy use of this in RavenDB, for example. The DocumentConventions class is basically built of nothing else.&#xA;Recommendation: Go for the lightweight Factory Delegate approach. As with all patterns, use with caution and watch for overuse &amp; abuse. In particular, if you need to manage state between multiple delegate, fall back to the overriding approach, because you can keep the state in the subclass.</p>
        </article>
        <article id="article-4417">
            <a href="https://ayende.com/blog/159362/design-patterns-in-the-test-of-time-builder" target="_blank">
                <h2 class="title mb-6" id="article-4417">Design patterns in the test of time</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 25, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The intent of the Builder design pattern is to separate the construction of a complex object from its representation. By doing so, the same construction process can create different representations.  More about this pattern. The sample code that usually comes with this pattern is something like this:      1: PizzaBuilder hawaiianPizzaBuilder = new HawaiianPizzaBuilder();   2: Cook cook = new Cook();   3: cook.SetPizzaBuilder(hawaiianPizzaBuilder);   4: cook.ConstructPizza();   5: // create the product   6: Pizza hawaiian = cook.GetPizza();&#xA;I find this sort of code to be extremely verbose and hard to read. Especially when we have a lot of options and things to do. Fluent Interfaces, however, are just an instance of the Builder pattern, and they are basically adding a modern API look &amp; feel to the way we are actually constructing objects. Another thing to remember is that we are dealing with C#, and we have things like object initializers to do a lot of the heavy lifting for building objects. You should use that, for most cases.&#xA;NHibernate, for example, has the notion of a Builder, using the NHibernate.Cfg.Configuration object. It allows us to put all of the construction / validation code in one spot, and then the actual runtime code in a different place (and can assume a lot about its invariants). It also allows to do a lot of interesting things, like serializing the builder object (to save building time), which is something that you usually can&#x2019;t / hard to do with real objects.&#xA;That said, you should be careful of code like the one listed above .What you have there is an overly abstract system. Requiring multiple steps to just get somewhere. If you find yourself feeding builders into builders, please stop and think about what you are doing. If you got there, you have not simplified the construction process.&#xA;Recommendation: This is still a very useful pattern. It should absolutely not be used if all you need to do is just setting some values. Reserve the Builder patterns where you actually have logic and behavior associated with the building process.</p>
        </article>
        <article id="article-4418">
            <a href="https://ayende.com/blog/159586/a-week-in-london-ravendb-nhibernate-training" target="_blank">
                <h2 class="title mb-6" id="article-4418">A week in London: RavenDB &amp; NHibernate training</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 24, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;ll be spending the last week on November in London, at the Skills Matter offices.&#xA;&#xA;&#x9;On the 26 Nov, I&#x2019;ll be giving a 3 days NHibernate course.&#xA;&#xA;&#x9;And on the 29 Nov, I&#x2019;ll be giving 2 full days of RavenDB awesomeness. This course is scheduled to run along the same time as the RavenDB 1.2 release, which leads me to the In The Brains session I&#x2019;ll be giving along the way.&#xA;&#xA;&#x9;What is new in RavenDB 1.2&#xA;&#xA;&#x9;RavenDB 1.0 was exciting and fun. RavenDB 1.2 builds on top of that and adds a whole host of really nice features.&#xA;&#x9;Come to hear about the new Changes API, or how you can use evil patching to make the database bow to your wished. Learn how you can add encryption and compression to your database in a few minutes, and watch how operational tasks became even simpler. In short, come and see all of the new stuff for RavenDB!</p>
        </article>
        <article id="article-4419">
            <a href="https://ayende.com/blog/159585/design-patterns-in-the-test-of-time-a-modern-alternative-to-abstract-factory-filtered-dependencies" target="_blank">
                <h2 class="title mb-6" id="article-4419">Design patterns in the test of time</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 24, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In my Abstract Factory post, I mentioned that I really don&#x2019;t like the pattern, and in particular, code like this:      1: static IGUIFactory CreateOsSpecificFactory()   2: {   3:    string sysType = ConfigurationSettings.AppSettings[&quot;OS_TYPE&quot;];   4:    if (sysType == &quot;Win&quot;)    5:    {   6:        return new WindowsFactory();   7:    }    8:    else    9:    {  10:        return new MacFactory();  11:    }  12: }&#xA;One of the comments mentioned that this might no be ideal, but it is still better than:&#xA;&#xA;&#xA;   1: if(RunningOnWindows)   2: {   3:     // code   4: }   5: else if(RunningOnMac)   6: {   7:    // code   8: }   9: else if(RunningOnLinux)  10: {  11:    // code  12: }&#xA;And I agree. But I think that, as the comment mentioned, a far better alternative would be using the container. You can do this using:&#xA;&#xA;&#xA;   1: [OperationSystem(&quot;Windows&quot;)]   2: public class WindowsFactory : IGUIFactory   3: {   4: }   5:&#xA0;    6: [OperationSystem(&quot;Linux&quot;)]   7: public class LinuxFactory : IGUIFactory   8: {   9: }  10:&#xA0;   11: [OperationSystem(&quot;Mac&quot;)]  12: public class MacFactory : IGUIFactory  13: {  14: }  15:&#xA0; &#xA;Then you just need to wire things through the container. Among other things, this means that we respect the open / closed principle. If we need to support a new system, we can just add a new class, we don&#x2019;t need to modify code.&#xA;Remember, the Go4 book was written in the age of C&#x2B;&#x2B;. Reflection didn&#x2019;t exists, and that means that a lot of patterns do by hands things that can happen automatically.</p>
        </article>
        <article id="article-4420">
            <a href="https://ayende.com/blog/159361/design-patterns-in-the-test-of-time-abstract-factory" target="_blank">
                <h2 class="title mb-6" id="article-4420">Design patterns in the test of time</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 23, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The essence of the Abstract Factory method Pattern is to &quot;Provide an interface for creating families of related or dependent objects without specifying their concrete classes&quot;.&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;More about this pattern.&#xA;&#xA;&#xA;&#x9;Here is some sample code:&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   1: static IGUIFactory CreateOsSpecificFactory()&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   2: {&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   3:     string sysType = ConfigurationSettings.AppSettings[&quot;OS_TYPE&quot;];&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   4:     if (sysType == &quot;Win&quot;) &#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   5:     {&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   6:         return new WindowsFactory();&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   7:     } &#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   8:     else &#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;   9:     {&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;  10:         return new MacFactory();&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;  11:     }&#xA;&#x9;&#x9;&#x9;&#xA0; 12: }&#xA;&#x9;&#xA;&#xA;&#xA;&#x9;I am in two minds about this pattern. On the one hand, we have pretty damning evidence that this has been really bad for the industry at large. For details, you can see Why I Hate Frameworks post. When I first saw that, just shortly after reading the Go4 for the first time, I was in tears from laughing. But the situation he describe is true, accurate and still painful today.&#xA;&#xA;&#x9;Case in point, WCF suffers from a serious overuse of abstract factories. For example, IInstanceProvider (and I just love that in order to wire that in you usually have to implement IServiceBehavior).&#xA;&#xA;&#x9;As the I Hate Frameworks post mentioned:&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;Each hammer factory factory is built for you by the top experts in the hammer factory factory business, so you don&#x27;t need to worry about all the details that go into building a factory.&#xA;&#xA;&#xA;&#x9;Awesome, or not, as the case may be.&#xA;&#xA;&#x9;Then again, it is a useful pattern. The problem is that in the general case, creating objects that create objects (that create even more objects) is a pretty good indication that your architecture is already pretty hosed.&#xA0; You should strive to an architecture that has minimal amount of levels, and an abstract factory is a whole new level even on its own.&#xA;&#xA;&#x9;Recommendation: Avoid if you can. If you run into a place where you think that needs this, consider if you can simplify your architecture to the point where this is not required.</p>
        </article>
        <div class="button flex justify-between">
            <a href="441.html"><span class="back arrow"></span></a>

            <a href="443.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>