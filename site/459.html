
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 459 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4581">
            <a href="https://ayende.com/blog/155393/the-ravendb-indexing-process-optimization-de-parallelizing-work" target="_blank">
                <h2 class="title mb-6" id="article-4581">The RavenDB indexing process</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 20, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the major dangers in doing perf work is that you have a scenario, and you optimize the hell out of that scenario. It is actually pretty easy to do without even noticing it. The problem is that when you do things like that, you are likely to be optimizing a single scenario to perform really well, but you are hurting the overall system performance. In this example, we have moved heaven and earth to make sure that we are indexing things as fast as possible, and we tested with 3 indexes, on an 4 cores machine. As it turned out, we actually had improved things, for that particular scenario. Using the same test case on a single core machine was suddenly far more heavy weight, because we were pushing a lot of work at the same time. More than the machine could process. The end result was that it actually got there, but much more slowly than if we would have run things sequentially. Of course, I give you the outliers, but those are good indicators for what we found out. Initially, we thought that we could resolve that by using the TPL&#x2019;s MaxDegreeOfParallelism, but it turned out to be more complex than that. We have IO bound and we have CPU bound tasks that we need to execute, and trying to execute IO heavy tasks with this would actually cause issues in this scenario. We had to manually throttle things ourselves, both to ensure limited number of parallel work, and because we have a lot more information about the actual tasks than the TPL have. We can schedule them in a way that is far more efficient because we can tell what is actually going on. The end result is that we are actually using less parallelism, overall, but in a more efficient manner. In my next post, I&#x2019;ll discuss the auto batch tuning support, which allows us to do some really amazing things from the point of view of system performance.</p>
        </article>
        <article id="article-4582">
            <a href="https://ayende.com/blog/155233/the-ravendb-indexing-process-optimization-parallelizing-work" target="_blank">
                <h2 class="title mb-6" id="article-4582">The RavenDB indexing process</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 19, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the things that we are doing during the index process for RavenDB is applying triggers and deciding what, if and how a document will be indexed. The actual process is a bit more involved, because we have to do additional things (like figure out which indexes have already indexed those particular documents).&#xA;&#xA;&#x9;At any rate, the interesting thing is that this is a process which is pretty basic:&#xA;&#xA;&#x9;for doc in docs:&#xA;    matchingIndexes = FindIndexesFor(doc)&#xA;    if matchingIndexes.Count &gt; 0:&#xA;       doc = ExecuteTriggers(doc) &#xA;       if doc != null:&#xA;          yield doc&#xA;&#xA;&#xA;&#x9;&#xA;&#xA;&#xA;&#x9;The interesting thing about this is that this is a set of operations that only works on a single document at a time, and the result is the modified documents.&#xA;&#xA;&#x9;We were able to gain significant perf boost by simply moving to a Parallel.ForEach call.&#xA0; This seems simple enough, right? Parallelize the work, get better benefits.&#xA;&#xA;&#x9;Except that there are issues with this as well, which I&#x2019;ll touch on my next post.</p>
        </article>
        <article id="article-4583">
            <a href="https://ayende.com/blog/154721/the-ravendb-indexing-process-optimization" target="_blank">
                <h2 class="title mb-6" id="article-4583">The RavenDB indexing process</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 18, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The actual process done by RavenDB to index documents is a fairly complex one. In order to understand what exactly happened, I decided to break it apart to pseudo code. It looks something like this: while database_is_running:&#xA;  stale = find_stale_indexes()&#xA;  lastIndexedEtag = find_last_indexed_etag(stale)&#xA;  docs_to_index = get_documents_since(lastIndexedEtag, batch_size)&#xA;  &#xA;  filtered_docs = execute_read_filters(docs_to_index)&#xA;  &#xA;  indexing_work = []&#xA;  &#xA;  for index in stale:&#xA;    &#xA;    index_docs = select_matching_docs(index, filtered_docs)&#xA;    &#xA;    if index_docs.empty:&#xA;      set_indexed(index, lastIndexedEtag)&#xA;    else&#xA;      indexing_work.add(index, index_docs)&#xA;      &#xA;  for work in indexing_work:&#xA;  &#xA;     work.index(work.index_docs)&#xA;&#xA;&#xA;And now let me show you the areas in which we did some perf work:&#xA;while database_is_running:&#xA;  stale = find_stale_indexes()&#xA;  lastIndexedEtag = find_last_indexed_etag(stale)&#xA;  docs_to_index = get_documents_since(lastIndexedEtag, batch_size)&#xA;  &#xA;  filtered_docs = execute_read_filters(docs_to_index)&#xA;  &#xA;  indexing_work = []&#xA;  &#xA;  for index in stale:&#xA;    &#xA;    index_docs = select_matching_docs(index, filtered_docs)&#xA;    &#xA;    if index_docs.empty:&#xA;      set_indexed(index, lastIndexedEtag)&#xA;    else&#xA;      indexing_work.add(index, index_docs)&#xA;      &#xA;  for work in indexing_work:&#xA;  &#xA;     work.index(work.index_docs)&#xA;&#xA;&#xA;All of which gives us a major boost in the system performance. I&#x2019;ll discuss each part of that work in detail, don&#x2019;t worry</p>
        </article>
        <article id="article-4584">
            <a href="https://ayende.com/blog/154913/ravendb-freedb-an-optimization-story" target="_blank">
                <h2 class="title mb-6" id="article-4584">RavenDB &amp; FreeDB: An optimization story</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 17, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">So, as I noted in a previous post, we loaded RavenDB with all of the music CDs in existence (or nearly so). A total of 3.1 million disks and 43 million tracks. And we had some performance problems. But we got over them, and I am proud to give you the results:    &#xA0; Old New  Importing Data Couple of hours 42 minutes  Raven/DocumentsByEntityName And hour and a half 23.5 minutes  Simple index over disks Two hours and twenty minutes 24.1 minutes  Full text index over disks and tracks More than seven hours 37.5 minutes  Tests were run on the same machine, and the database HD was&#xA0; a single 300 GB 7200 RPM drive. I then decided to take this one step further, and check what would happen when we already had the indexes. So we created three indexes. One Raven/DocumentsByEntityName, one for doing simple querying over disks and one for full text searches on top of all disks and tracks. With 3.1 million documents streaming in, and three indexes (at least one of them decidedly non trivial), the import process took an hour and five minutes. Even more impressive, the indexing process was fast enough to keep up with the incoming data so we only had about 1.5 seconds latency between inserting a document and having it indexed. (Note that we usually seem much lower times for indexing latencies, usually in the low tens of milliseconds, when we aren&#x2019;t being bombarded with documents).  Next up, and something that we did not optimize, was figuring out how costly it would be to query this. I decided to go for the big guns, and tested querying the full text search index. Testing &#x201C;Query:Adele&#x201D; returned a result (from a cold booted database) in less than 0.8 seconds. But remember, this is after a cold boot. So let us see what happen when we issue a few other queries?  Query:Pearl - 0.65 seconds Query:Abba &#x2013; 0.67 seconds Query:Queen &#x2013; 0.56 seconds Query:Smith &#x2013; 0.55 seconds Query:James &#x2013; 0.77 seconds Note that I am querying radically different values, so I force different parts of the index to load.  Querying for &#x201C;Query:Adele&#x201D; again? 32 milliseconds. Let us see a few more:  Query:Adams &#x2013; 0.55 seconds Query:Abrahams &#x2013; 0.6 seconds Query:Queen &#x2013; 85 milliseconds Query:James &#x2013; 0.1 seconds Now here are a few things that you might want to consider:  We have done no warm up to the database, just started it up from cold boot and started querying. I actually think that we can do better than this, and this is likely to be the next place we are going to focus our optimization efforts. We are doing a query here over 3.1 million documents, using full text search. There is no caching involved in the speed increases. More goodies are coming in.</p>
        </article>
        <article id="article-4585">
            <a href="https://ayende.com/blog/154401/ravendb-freedb-an-optimization-opportunity" target="_blank">
                <h2 class="title mb-6" id="article-4585">RavenDB &amp; FreeDB: An optimization opportunity</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 16, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Update: The numbers in this post are not relevant. I include them here solely so you would have a&#xA0;frame of reference. We have done a&#xA0;lot&#xA0;of optimization work, and the numbers are orders of magnitude faster now. See the next post for details.&#xA;&#xA;&#x9;The purpose of this post is to setup a scenario, see how RavenDB do with it, and then optimize the parts that we don&#x2019;t like. This post is scheduled to go about two months after it was written, so anything that you see here is likely already fixed. In future posts, I&#x2019;ll talk about the optimizations, what we did, and what was the result.&#xA;&#xA;&#x9;System note: I run those tests on a year old desktop, with all the database activity happening on a single 7200 RPM 300GB disk with 8 GB of RAM. Please don&#x2019;t get to hung up on the actual numbers, I include them for reference, but real hardware on production system should kick this drastically higher. Another thing to remember is that this was an active system, while all of those operations were running, I was actively working and developing on the machine. The main point is to give us some sort of a metric about where we are, and to see whatever we like this or not.&#xA;&#xA;&#x9;We keep looking at additional things that we can do with RavenDB, and having large amount of information to tests things with is awesome. Having non fake data is even awesomer, because fake data is predictable data, while real data tend to be much more&#x2026; interesting.&#xA;&#xA;&#x9;That is why I decided to load the entire freedb database into RavenDB and see what is happening.&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;What is freedb?&#xA;&#x9;&#xA;&#x9;&#x9;freedb is a database to look up CD information using the internet. This is done by a client (a freedb aware application) which calculates a (nearly) unique disc ID for a CD in your CD-Rom and then queries the database. As a result, the client displays the artist, CD-title, tracklist and some additional info.&#xA;&#xA;&#xA;&#x9;The nice thing about freedb is that you can download their data* and make use of it yourself.&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;* The not so nice thing is that the data is in free form text format. I wrote a parser for it if you really want to use it, which you can find here: https://github.com/ayende/XmcdParser&#xA;&#xA;&#xA;&#x9;&#xA0;&#xA;&#xA;&#x9;So I decided to push all of this data into RavenDB. The import process took a couple of hours (didn&#x2019;t actually measure, so I am not sure exactly how much), and we ended up with a RavenDB database with: 3,133,903 documents. Memory usage during the import process was ~100&#xA0; MB &#x2013; 150 MB (no indexes were present).&#xA;&#xA;&#x9;The actual size in RavenDB is 3.59 GB with 3.69 GB reserved on the file system.&#xA;&#xA;&#x9;Starting the database from cold boot takes about 4 seconds.&#xA;&#xA;&#x9;This is what the document looks like:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;A full backup of the database took about 3 minutes, with all of the time dedicate for pure I/O.&#xA;&#xA;&#x9;Doing an export, using smuggler (on the local machine, 128 document batches) took about 18 minutes and resulted in a 803MB file (not surprising, smuggler output is a compressed file).&#xA;&#xA;&#x9;Note that we created this in a completely empty database, so the next step was to actually create an index and see how the database behaves. We create the default Raven/DocumentsByEntityName index, and got 5,870 seconds, so just over an hour and a half. For what it worth, this resulted in on disk index with a size of 125MB.&#xA;&#xA;&#x9;I then tried a much more complex index:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;Just to give you some idea, this index gives you full text search support over just about every music cd that was ever made. To be frank, this index scares me, because it means that we have to have index entry for every single track in the world.&#xA;&#xA;&#x9;After indexing was completed, we ended up with a 700 MB on disk presence. Indexing took about 7 hours to complete. That is a lot, but remember what we are dealing with, we indexed 3.1 million documents, but we actually indexed, 52,561,894 values (remember, we index each and every track).&#xA0; The interesting bit is that while it took a lot of CPU (full text indexing usually does) memory usage was relatively low, it peaked about 300 MB and usually was around the 180MB).&#xA;&#xA;&#x9;Searching over this index is not as fast as I would like, taking about a second to complete. Then again, the results are quite impressive:&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;Well, given that this is the equivalent of a 52 million records (in this case, literally records ) , and we are performing full text search, quite nice.&#xA;&#xA;&#x9;Let us see what happens when do something a little simpler, shall we?&#xA;&#xA;&#x9;&#xA;&#xA;&#x9;In this case, we are only indexing 3.1 millions documents, and we don&#x2019;t do full text searches. This index took 2.3 hours to run.&#xA;&#xA;&#x9;Queries on that are a much more satisfactory rate of starting out at 75 ms and dropping to 5 ms very quickly.</p>
        </article>
        <article id="article-4586">
            <a href="https://www.meziantou.net/iis-ftp-with-passive-ports.htm" target="_blank">
                <h2 class="title mb-6" id="article-4586">IIS - FTP with passive ports</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 16, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After configuring my FTP server to accept passive connections (ports 10000-11000), I can not connect with filezilla:copyResponse: 200 Type set to I.&#xA;Command: PASV:&#xA;Response: 227 Entering Passive Mode (1,2,3,4,212,169).&#xA;Command: LIST&#xA;Response: 150 Opening BINARY mode data connection.&#xA;Error: Connecti</p>
        </article>
        <article id="article-4587">
            <a href="https://ayende.com/blog/156129/re-kiips-mongodbs-experience" target="_blank">
                <h2 class="title mb-6" id="article-4587">re</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 15, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We got asked several times to respond to this post, about the reason Kiip moved away from MongoDB:  On the surface, RavenDB and MongoDB are really similar, looking at the Good parts of the Kiip post, we have schemalessness, easy replication, rich query langauge and we can be access from multiple languages. But under the hood, RavenDB operates in a completely different way than MongoDB does. A vast majority of the issues that Kiip run into are actually low level (really low level, is some cases) issues that shouldn&#x2019;t really be visible to the user.  Non-counting B-Trees The fact that MongoDB uses non counting B-Trees? The only reason that the user care about that is that it actually impacts performance, but the Kiip blog mentions a bunch of other issues related to that.  In RavenDB, we use Lucene as the indexing format, and we really don&#x2019;t care about the actual format of the indexes. We natively support Count() and limit / skip, because we feel that those are actually core parts of what most users need. In fact, our API allows us to get the total count of results of a paged query as a by product of actually making the query. There isn&#x2019;t any additional cost for doing this. Poor Memory Management  MongoDB relies on the OS to do the memory management, by letting the OS memory manager to do its work. That is actually quite a smart decision, because I can guarantee that more work has gone into optimizing the OS memory manager than could have been invested by the MongoDB project. But that is just part of the work. In RavenDB, we are actually a managed application, so we don&#x2019;t have directly control over memory. That doesn&#x2019;t mean that we don&#x2019;t actually manage it. We have several layers of caching in place, exactly because we know more than the OS about our own usage scenarios. In many cases, even if you are making a totally new request, it would never hit the disk, because we are keeping track on hot data and making sure that it resides in memory. This applies to both indexes and documents, mind. And during the indexing process we are very careful about memory management.  Sure, the OS memory manager is more optimized, but the database knows what is going on, and can predict its own usage patterns. That is how RavenDB does a lot of magic relating to auto configuration. Uncompressed field names In MongoDB, it is considered good practice to shorten field names for space optimization. But MongoDB doesn&#x2019;t do it for you automatically. RavenDB doesn&#x2019;t compress field names, but at the same time, it isn&#x2019;t a good practice to do so. In fact, I think that this is a horrible little mess. There are a lot of arguments against compressing field names, not the least of which is that it makes it pretty hard to figure out what it is that you are actually trying to do. Looking at the raw data, something that is done fairly frequently when debugging and troubleshooting becomes harder to work with and manage: {&#xA;  &quot;a2&quot;: &quot;nathan &quot;,&#xA;  &quot;d3&quot;: &quot;&quot;,&#xA;  &quot;a2&quot;: &quot;2012-05-17T00:00:00.0000000&quot;,&#xA;  &quot;h3&quot;: &quot;2012-04-15T00:00:00.0000000&quot;,&#xA;  &quot;r2&quot;: &quot;archanid@sample.com&quot;,&#xA;  &quot;o2&quot;: &quot;8169cd4a-babf-4015-a3c7-4d503642e021&quot;,&#xA;  &quot;o1&quot;: &quot;products/NHProf&quot;&#xA;}&#xA;&#xA;&#xA;Anyone wants to figure out what this document is about? And at least in this one, the data itself tells you a lot about the actual content. &#xA;There are far better alternatives in place. In RavenDB, we do full response / request compression, and we allow to do document compression on disk as well. If we were ever to get to the point where this would be a serious problem (and so far, it isn&#x2019;t, even on large data sets), it would be less than a week of work to implement string interning inside RavenDB, so we would use the same string references for field values.&#xA;Global write lock&#xA;MongoDB (as of the current version at the time of writing: 2.0), has a process-wide write lock. &#x2026; At this point, all other operations including reads are blocked because of the write lock.&#xA;Now, to be fair, also have a write lock, but it isn&#x2019;t nearly as bad as it is in MongoDB. RavenDB write lock is actually for&#x2026; writes, and it doesn&#x2019;t interfere with the either reads or indexes. It is on the list of things to remove, but the crazy part is. So far, and we have really demanding users, no one cares. The reason that no one cares is that this is really small lock, and it only affects writes, it is not Stop the World type of thing.&#xA;Safe off by default&#xA;I am just going to let Kiip&#x2019;s words stand for themselves (emphasis mine): &#xA;&#xA;This is a crazy default, although useful for benchmarks. As a general analogy: it&#x2019;s like a car manufacturer shipping a car with air bags off, then shrugging and saying &#x201C;you could&#x2019;ve turned it on&#x201D; when something goes wrong. &#xA;RavenDB entire philosophy is around Safe by Default. That is the only thing that really make sense, because otherwise&#x2026; Well&#x2026; here is what happenned at Kiip:&#xA;&#xA;We lost a sizable amount of data at Kiip for some time before realizing what was happening and using safe saves where they made sense (user accounts, billing, etc.).&#xA;Offline table compaction&#xA;Every now and then, you need to take down MongoDB and let it compact its on disk data. This is another Stop the World operation, and the only way to keep up when you do so is to have a hot standby ready.&#xA;RavenDB does all maintenance task while the server is up and serving requests. You don&#x2019;t need any downtime just because RavenDB need to arrange some data on disk, we take care of that live, and with no interruption in service.&#xA;Secondaries do not keep hot data in RAM&#xA;As Kiip explains it:&#xA;&#xA;The primary doesn&#x2019;t relay queries to secondary servers, preventing secondaries from maintaining hot data in memory. This severely hinders the &#x201C;hot-standby&#x201D; feature of replica sets, since the moment the primary fails and switches to a secondary, all the hot data must be once again faulted into memory.&#xA;RavenDB doesn&#x2019;t do so either, but for a drastically different reason. As I mentioned earlier, the way RavenDB works is quite different. When you are running a hot standby node, it will get the new data from the server and index it. We keep the index open, so for a lot of the data, it is already going to be in memory. For the rest, as I mentioned, we have several layers of caches that would help prevent needing to page gigabytes on data into memory.&#xA;Conclusion&#xA;As an utterly unbiased observer (), I can say that RavenDB rocks.&#xA;What we are actually seeing here is that RavenDB put different emphasis on different things. I really care for making the common application level scenarios easy and nice to work with. And I had enough time supporting production level apps that I tried very hard to make sure that RavenDB can take care of itself for most scenarios without any hand holding.</p>
        </article>
        <article id="article-4588">
            <a href="https://ardalis.com/modifying-and-disabling-hyperlinks-using-jquery/" target="_blank">
                <h2 class="title mb-6" id="article-4588">Modifying and Disabling Hyperlinks using jQuery</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 13, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have a simple menu in an ASP.NET MVC application allows a user to take one of several actions after first selecting a resource to work&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4589">
            <a href="https://ardalis.com/new-is-glue/" target="_blank">
                <h2 class="title mb-6" id="article-4589">New is Glue</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 13, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When you&#x2019;re working in a strongly typed language like C# or Visual Basic, instantiating an object is done with the new keyword. It&#x2019;s&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4590">
            <a href="https://ayende.com/blog/154882/explain-this-code-answers" target="_blank">
                <h2 class="title mb-6" id="article-4590">Explain this code: Answers</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: April 13, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The reason this code is useful? Because it allows you to write this sort of code: class Program&#xA;{&#xA;    private static Collection&lt;int&gt; nums;&#xA;&#xA;    static void Main(string[] args)&#xA;    {&#xA;        nums.Add(1);&#xA;        Console.WriteLine(nums.Count);&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;I was aiming for that, and still this code strikes me as wrong.</p>
        </article>
        <div class="button flex justify-between">
            <a href="458.html"><span class="back arrow"></span></a>

            <a href="460.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>