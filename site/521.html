
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 521 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-5201">
            <a href="https://ayende.com/blog/4669/you-saved-5-cents-and-your-code-is-not-readable-congrats" target="_blank">
                <h2 class="title mb-6" id="article-5201">You saved 5 cents, and your code is not readable, congrats!</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 22, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I found myself reading this post, and at some point, I really wanted to cry:     We had relatively long, descriptive names in MySQL such as timeAdded or valueCached. For a small number of rows, this extra storage only amounts to a few bytes per row, but when you have 10 million rows, each with maybe 100 bytes of field names, then you quickly eat up disk space unnecessarily. 100 * 10,000,000 = ~900MB just for field names!    We cut down the names to 2-3 characters. This is a little more confusing in the code but the disk storage savings are worth it. And if you use sensible names then it isn&#x2019;t that bad e.g. timeAdded -&gt; tA. A reduction to about 15 bytes per row at 10,000,000 rows means ~140MB for field names &#x2013; a massive saving.   Let me do the math for a second, okay?  A two terabyte hard drive now costs 120 USD. By my math, that makes:     1 TB = 60 USD    1 GB = 0.058 USD   In other words, that massive saving that they are talking about? 5 cents!  Let me do another math problem, oaky?  Developer costs about 75,000 USD per year.     (52 weeks &#x2013; 2 vacation weeks) x 40 work hours = 2,000 work hours per year.    75,000 / 2,000 = 37.5 $ / hr    37.5 / 60 minutes = 62 cents per minutes.   In other words, assuming that this change cost a single minute of developer time, the entire saving is worse than moot.  And it is going to take a lot more than one minute.&#xA;&#xA;&#xA;Update: Fixed decimal placement error in the cost per minute. Fixed mute/moot issue. &#xA;&#xA;&#xA;To those of you pointing out that real server storage space is much higher. You are correct, of course. I am trying to make a point. Even assuming that it costs two orders of magnitudes higher than what I said, that is still only 5$. Are you going to tell me that saving the price of a single cup of coffee is actually meaningful?&#xA;&#xA;To those of you pointing out that MongoDB effectively stores the entire DB in memory. The post talked about disk size, not about memory, but even so, that is still not relevant. Mostly because MongoDB only requires indexes to fit in memory, and (presumably) indexes don&#x27;t really need to store the field name per each indexed entry. If they do, then there is something very wrong with the impl.</p>
        </article>
        <article id="article-5202">
            <a href="https://ayende.com/blog/4668/ravendb-defining-indexes" target="_blank">
                <h2 class="title mb-6" id="article-5202">RavenDB &#x2013; Defining indexes</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 21, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the more powerful features of RavenDB is the notion of indexes. Indexes allow you to query RavenDB efficiently and they stand at the core of RavenDB&#x2019;s philosophy of &#x201C;we shall never make you wait&#x201D; and they are the express way to a lot of RavenDB&#x2019;s capabilities (spatial searches and full text searches, to name just a few).  Unfortunately, indexes require that you pre-define them before you can use them. That led to a problem. A big one. It meant that in addition for simply deploying RavenDB, you had to manage additional assets, the index definitions. In essence, that is very similar to having to worry about the database schema.&#xA0; That, in turn, made deploying that bit more complex, and that was unacceptable.   So we implemented the Code Only Indexes, which allow you to define your indexes as part of your project, and have them automatically created the first time the application starts.  Defining the indexes is pretty simple:     public class Movies_ByActor : AbstractIndexCreationTask&lt;Movie&gt;&#xA;{&#xA;    public Movies_ByActor()&#xA;    {&#xA;        Map = movies =&gt; from movie in movies&#xA;                        select new {movie.Name};&#xA;        Index(x=&gt;x.Name, FieldIndexing.Analyzed);&#xA;    }&#xA;}&#xA;&#xA;public class Users_CountByCountry : AbstractIndexCreationTask&lt;User&gt;&#xA;{&#xA;    public Users_CountByCountry()&#xA;    {&#xA;        Map = users =&gt; from user in users&#xA;              select new {user.Country, Count = 1};&#xA;        Reduce= results =&gt; from result in results&#xA;                           group result by result.Country into g&#xA;                           select new { Country = g.Key, Count = g.Sum(x=&gt;x.Count)}&#xA;&#xA;    }&#xA;}&#xA;  &#xA;&#xA;But this is just the first step, the next is to tell RavenDB about them:&#xA;&#xA;&#xA;  IndexCreation.CreateIndexes(typeof(Movies_ByActor).Assembly, store);&#xA;  &#xA;&#xA;If you put this in your Global.asax, you would never have to think about indexing or deployment issues again.</p>
        </article>
        <article id="article-5203">
            <a href="https://ayende.com/blog/4667/ravens-dynamic-queries" target="_blank">
                <h2 class="title mb-6" id="article-5203">Raven&#x2019;s dynamic queries</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 20, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the pieces of feedback that we got from people frequently enough to be annoying is that the requirement to define indexes upfront before you can query is annoying. For a while, I thought that yes, it is annoying, but so is the need to sleep. And that there isn&#x2019;t anything much you can do about it.  Then Rob and asked, why do we require users to define indexes when we can gather enough information to do this ourselves? And since I couldn&#x2019;t think of a good reason why, he went ahead and implemented this.     var activeUsers = from user in session.Query&lt;User&gt;()&#xA;                  where user.IsActive == true&#xA;                  select user;&#xA;  &#xA;&#xA;You don&#x2019;t have to define anything, it just works. &#xA;&#xA;There are a few things to note, though.&#xA;&#xA;First, unindexed queries are notorious for working on small data sets and killing systems in production. That was one of the main reasons that I didn&#x2019;t want to run &#xA;&#xA;Moreover, since RavenDB philosophy is that it should make it pretty hard to shoot yourself in the foot, we figured out how to make this efficient.&#xA;&#xA;&#xA;  RavenDB will look at the query, see that there is no matching index, and create one for you.&#xA;&#xA;  &#xA;    Currently, it will create an index per each query type. In the future (as in, by the time you read this, most probably) we will have a query optimizer that can deal with selecting the appropriate index.&#xA;  &#xA;&#xA;  Those indexes are going to be temporary indexes, maintained for a short amount of time.&#xA;&#xA;  However, if RavenDB notice that you are making a large number of queries to a particular index, it will materialize it and turn it into a permanent index.&#xA;&#xA;&#xA;In other words, based on your actual system behavior, RavenDB will optimize itself for you :-) !&#xA;&#xA;This feature actually had us stop and think, because it fundamentally changed the way that you work with RavenDB. We actually had to stop and think why you would want to create indexes manually.&#xA;&#xA;As it turned out, there are still a number of reasons why you would want to do that, but they become far more rare:&#xA;&#xA;&#xA;  You want to do apply complex filtering logic or do something to the index output. (For example, you may be interested in aggregating several fields into one searchable item)&#xA;&#xA;  You want to use RavenDB&#x2019;s spatial support.&#xA;&#xA;  Aggregations still require defining a map/reduce query.&#xA;&#xA;  You want to use the Live Projections feature, which I&#x2019;ll discuss in my next post.</p>
        </article>
        <article id="article-5204">
            <a href="https://ayende.com/blog/4666/ravendb-in-comparison-to-couchdb" target="_blank">
                <h2 class="title mb-6" id="article-5204">RavenDB in comparison to CouchDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 19, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I run into this question, and I thought that this is an important enough topic to put it on the blog as well.      A cursory dig suggests CouchDB is more mature, with a larger community to support it. That aside, what do you consider to be the significant differences?    RavenDB was heavily inspired by CouchDB. But when I sat down to build it, I tried to find all the places where you would have friction in using CouchDB and eliminating them, as well as try to build a product that would be a natural fit to the .NET ecosystem. That isn&#x27;t just being able to run easily on Windows, btw. It is about being a product that fits the thought processes, requirements and environment in which it is used.  Here are some of the things that distinguish RavenDB:     Transactions - support for single document, document batch, multi request, multi node transactions. Include support for DTC. To my knowledge, CouchDB supports transaction only on a single document.    Patching - you can perform a PATCH op against a document, instead of having to send the entire document to the server.    Set based operations - basically, a way to do things like: &quot;update active = false where last_login &lt; &#x27;2010-10-01&#x27;&quot;    Deployment options - can run embedded, separate executable, windows service, iis, windows azure.    Client API - comes with a client API for .NET that is very mature. Supports things like unit of work, change tracking, etc.    Safe by default - both the server and the client have builtin limits (overrdable) that prevent you from doing things that will kill your app.    Queries - Support the following querying options:         Indexes - similar to couch&#x27;s views. Define by specifying a linq query.       Just do a search - doesn&#x27;t have to have an index. RavenDB will analyze the query and create a temporary index for you. However, unlike couch temp views. This is meant for production use. And those temp indexes will automatically become permanent ones based on usage. Note that you don&#x27;t have to define anything, just issue the actual query: Name:ayende will give you back the correct result. Tags,Name:raven will also do the same, including when you have to deal with extracting information directly from the composite docs.       Run a linq query - this is similar to the way temp view works, it is an O(n) operation, but it allows you to do whatever you want with the full power of linq. (For the non .NET guys, it allows you to run a SQL query against the data store) Mostly meant for testing.       Index backing store - Raven puts the index information in Lucene, which means we get full text searching OOTB. We can also do spatial queries OOTB.    Searching - It is very easy to say &quot;index users by first name and last name&quot;, then search for them by either one. (As I understand it, I would have to define two separate views in couch for this).    Scaling - Raven comes with replication builtin, including master/master. Sharding is natively supported by the client API and requires you to simply define your sharding strategy.    Authorization - Raven has an auth system that allows defining queries based on user / role on document, set of documents (based on the doc data) and globally. You can define something like: &quot;Only Senior Engineers can Support Strategic Clients&quot;    Triggers - Raven gives you the option to register triggers that will run on document PUT/READ/DELETE/INDEX    Extensibility - Raven is intended to be customized by the user for typical deployment. That mean that you would typically have some sort of customization, such as triggers, additional operations that the DB can do.    Includes&#xA0; &amp; Live projections -&#xA0; Let us say that we have the following set of documents: { &quot;name&quot;: &quot;ayende&quot;, &quot;partner&quot;: &quot;docs/123&quot; }, { &quot;name&quot;: &quot;arava&quot; }         Includes means that you can load the &quot;ayende&quot; document, while asking RavenDB to load the document referred to by the partner property. That means that you have only a single request to make, vs. 2 of them without this feature.      Live projections means that we can ask for the document name and the name of the partner&#x27;s name. Effectively joining the two together.              Those two features will only work on local data, obviously.      And I am probably forgetting some stuff, to be honest. Oh, and I am naturally the most unbiased of observers :-)</p>
        </article>
        <article id="article-5205">
            <a href="https://ayende.com/blog/4665/re-diverse-net" target="_blank">
                <h2 class="title mb-6" id="article-5205">re</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 18, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post is a reply for this post, you probably want to read that one first.  Basically, the problem is pretty simple. It is the chicken &amp; the egg problem. There is a set of problems where it doesn&#x2019;t matter. Rhino Mocks is a good example where it doesn&#x2019;t really matter how many users there are for the framework. But there are projects where it really does matters.   A package management tool is almost the definition of the chicken &amp; egg problem. Having a tool coming from Microsoft pretty much solve this, because you get a fried chicken pre-prepared.  If you look at other projects, you can see that the result has been interesting.     Unity / MEF didn&#x2019;t have a big impact on the OSS containers.    ASP.Net MVC pretty much killed a lot of the interest in MonoRail.    Entity Framework had no impact on NHibernate.   In NHibernate&#x2019;s case, it is mostly because it already moved beyond the chicken &amp; egg problem, I think. In MonoRail&#x2019;s case, it was that there wasn&#x2019;t enough outside difference, and most people bet on the MS solution. For Unity / MEF, there wasn&#x2019;t any push to use something else, because you really didn&#x2019;t depended on that.  In short, it depends :-)  There are some projects that really need critical mass to succeed. And for those projects, having Microsoft get behind them and push is going to make all the difference in the world.  And no, I don&#x2019;t really see anything wrong with that.</p>
        </article>
        <article id="article-5206">
            <a href="https://ayende.com/blog/4664/presentation-intro-to-nosql" target="_blank">
                <h2 class="title mb-6" id="article-5206">Presentation: Intro to NoSQL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 17, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">My session with the .NET user group in Aarhus, Denmark was recorded and is available.  I tried to discuss (in the space of an hour) about the major types of NoSQL databases. It is a bit rush, but I think it is pretty good.</p>
        </article>
        <article id="article-5207">
            <a href="https://ayende.com/blog/4663/ravendb-the-great-simplification" target="_blank">
                <h2 class="title mb-6" id="article-5207">RavenDB &#x2013; The great simplification</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 16, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">There is always a tension between giving users an interface that is simple to use and giving them something that is powerful.  With RavenDB, we run into a problem with the session interface. I mean, just take a look&#x2026;     Look how many operations you can do here! Yes, it is powerful, but it is also very complex to talk about &amp; explain. For that matter, look at the interface:    We have 4(!) different ways of querying (actually, we have more, but that is beside the point).  Something had to be done, but we didn&#x2019;t want to lose any power. So we decided on the following method:              Basically, we grouped all the common methods into a super simple session interface. This means that when you need to use the session, you see only:     4 of those methods (Equals, GetHashCode, GetType, ToString) are from System.Object and one is from IDisposable. Users pretty much are going to not see those methods.&#xA0; The CRUD interface is there, as well as the starting point for querying. And that is it.  I think that it makes it very easy to get started with RavenDB. And all those operations that are important but uncommonly used are still there, they just require an explicit step to access them.</p>
        </article>
        <article id="article-5208">
            <a href="https://ayende.com/blog/4662/ravendb-managed-storage" target="_blank">
                <h2 class="title mb-6" id="article-5208">RavenDB &amp; Managed Storage</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 15, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the things that I really wanted with to do with RavenDB is to create something that is really easy to use for .NET developers. I think that I have managed to do that. But the one big challenge that we still had was running everything using managed storage.   As you can imagine, building transactional, crash-safe, data stores isn&#x2019;t particularly easy, but we actually did that, and now RavenDB can run in managed core. That has other implications, like being able to run completely in memory. Which means that you can test your RavenDB code simply by using:     var store = new DocumentStore { RunInMemory = true; }&#xA;  &#xA;&#xA;And just use this as you normally would. For that matter, you can ask the RavenDB server to run in memory as well (extremely useful for demos):&#xA;&#xA;&#xA;  Raven.Server.exe /ram&#xA;&#xA;&#xA;As a side note, I am going to be posting a lot about the recent storm of features that were just added to RavenDB.</p>
        </article>
        <article id="article-5209">
            <a href="https://ayende.com/blog/4661/ravendb-live-projections-or-how-to-do-joins-in-a-non-relational-database" target="_blank">
                <h2 class="title mb-6" id="article-5209">RavenDB &#x2013; Live projections, or how to do joins in a non relational database</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 14, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This feature has me really excited, because it solves a pretty big problem and it does so in a really elegant fashion.  Let us start from the beginning. Documents are independent, which means that processing a single document should not require loading additional documents. This, in turn, leads to denormalization, so we can keep the data that we need about our associations in the same document.   The problem, of course, is that there are many cases where this denormalization is annoying. In particular, it means that you have to take responsibility for handling the updates to the denormalized data. There are good reasons to want to do that, particularly if you are working on a sharded data store. And yet&#x2026; many people don&#x2019;t run in a sharded store, so why make them pay for that?  I found it hard to answer, especially since we already introduced the includes feature. For a while, I thought that just doing the include was enough, but then I got into a discussion with Rob about this. And we had the chance to talk about projections vs. documents. We agreed that we wanted a solution, and we started throwing a lot of crazy ideas (multi sourced, background updated, materialized views &#x2013; to name one) around. Until we finally realized that we were being really stupid. The data is already there!   It was just that I was too blind to see how we can push it out.  Let us talk in code for a minute, since it would be easier to demonstrate how things work:     using (var s = ds.OpenSession())&#xA;{&#xA;    var entity = new User { Name = &quot;Ayende&quot; };&#xA;    s.Store(entity);&#xA;    s.Store(new User { Name = &quot;Oren&quot;, AliasId = entity.Id });&#xA;    s.SaveChanges();&#xA;}&#xA;  &#xA;&#xA;This creates two documents and links between them.&#xA;&#xA;Now, let us say that we want to display the following grid:&#xA;&#xA;&#xA;  &#xA;      &#xA;        User&#xA;&#xA;        Alias&#xA;      &#xA;&#xA;      &#xA;        Oren&#xA;&#xA;        Ayende&#xA;      &#xA;    &#xA;&#xA;&#xA;Well, we need to query for all the users that has an alias, then include the associated document. Something like this:&#xA;&#xA;&#xA;  var usersWithAliases = from user in session.Query&lt;User&gt;().Include(x=&gt;x.AliasId)&#xA;                       where user.AliasId != null&#xA;                       select user;&#xA;&#xA;&#xA;var results = new List&lt;UserAndAlias&gt;();&#xA;&#xA;foreach(var user in usersWithAliases)&#xA;{&#xA;    results.Add(&#xA;        new UserAndAlias&#xA;        {&#xA;            User = user.Name&#xA;            Alias = session.Load&lt;User&gt;(user.AliasId).Name&#xA;        }&#xA;    );&#xA;}&#xA;  &#xA;&#xA;Here is the deal, this is very efficient in terms of calling the database only once, but it does means that we are passing the full document back, which may be something that we may not want to do.&#xA;&#xA;Not to mention that there is a whole lot of code here.&#xA;&#xA;Okay, so far we have introduced the problem. Let us see how we can solve it. We can do that by applying a live projection at the server side. A live projection transforms the results of a query on the server side, and it has access to other documents as well. Let us see what I mean by that:&#xA;&#xA;&#xA;  public class Users_ByAlias : AbstractIndexCreationTask&lt;User&gt;&#xA;{&#xA;    public Users_ByAlias()&#xA;    {&#xA;        Map =&#xA;            users =&gt; from user in users&#xA;                     select new {user.AliasId};&#xA;&#xA;        TransformResults =&#xA;            (database, users) =&gt; from user in users&#xA;                                 let alias= database.Load&lt;User&gt;(user.AliasId)&#xA;                                 select new {Name = user.Name, Alias = alias.Name};&#xA;    }&#xA;}&#xA;  &#xA;&#xA;It is important to understand exactly what is going on here. The TransformResults will be executed on the results on the query, which gives it the change to modify, extend or filter them. In this case, it gives you the ability to look at data from another document.&#xA;&#xA;&#xA;  For the DB guys among you, this performs a nested loop join.&#xA;&#xA;&#xA;Now, we can just write:&#xA;&#xA;&#xA;  var usersWithAliases = &#xA;     (from user in session.Query&lt;User, Users_ByAlias&gt;()&#xA;     where user.AliasId != null&#xA;     select user).As&lt;UserAndAlias&gt;();&#xA;  &#xA;&#xA;This will query the index, transform the results on the server side, and give us the UserAndAlias colelction that we can just use.&#xA;&#xA;Did I mention that I am really excited about this feature?</p>
        </article>
        <article id="article-5210">
            <a href="https://ayende.com/blog/4660/small-optimizations-did-you-check-that-idiot-checkbox-yet" target="_blank">
                <h2 class="title mb-6" id="article-5210">Small optimizations? Did you check that idiot checkbox yet?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 13, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I started to write the following code:     operationsInTransactions.GetOrAdd(txId,  new List&lt;Command&gt;())&#xA;    .Add(new Command&#xA;    {&#xA;        Key = key,&#xA;        Position = position,&#xA;        Type = CommandType.Put&#xA;    });&#xA;  &#xA;&#xA;But then I realized that in the happy path, I would always allocate a list, even if I don&#x2019;t need it, and I changed it to this:&#xA;&#xA;&#xA;  operationsInTransactions.GetOrAdd(txId, guid =&gt; new List&lt;Command&gt;())&#xA;    .Add(new Command&#xA;    {&#xA;        Key = key,&#xA;        Position = position,&#xA;        Type = CommandType.Put&#xA;    });&#xA;  &#xA;&#xA;Why am I being stupid?&#xA;&#xA;Hint: It has nothing to do with the stupidity associated with trying to do micro optimizations&#x2026;</p>
        </article>
        <div class="button flex justify-between">
            <a href="520.html"><span class="back arrow"></span></a>

            <a href="522.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>