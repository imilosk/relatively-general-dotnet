
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 740 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-7391">
            <a href="https://ayende.com/blog/2835/patents-trademarks-and-copyright-urgh" target="_blank">
                <h2 class="title mb-6" id="article-7391">Patents, Trademarks and Copyright, Urgh!</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I never understood why developers are supposed not to know about such things. This is what we do for a living, we have better known what ground we tread upon. Here is the short guide from a developer point of view:   Patent - I thought of it, was the first to get to the patent office, therefor, I get a monopoly on the idea, if you try to use this, even if you never heard of me and mine, you can&#x27;t use it unless I agree to it (and you pay me many gobs of money, of course).The critical part is that you are violating a patent even if you had created it all on your own. A patent is a method to do something, if you use the same method, regardless how you got to it, you are violating it. Software Patent - a get-rich-quick scheme that should die already, the ability to patent idiotic stuff and then sue other people.Amazon OneClick patent is such, or the recent IBM patent on the checkbox.I have no problem with algorithms being patented, that usually represent the result of a real research, but software should apply to the same rules of math, and be unpatentable by default. Trademarks - A phrase, word, picture, etc that have been reserved for the use of a certain party in a specific industry. For instance,&#xA0;if I wanted to create&#xA0;a computer hardware company, I probably shouldn&#x27;t choose the image on the right as my logo, because Apple may object, reasoning that this would be violating their trademark.Basically, a trademark is supposed to protect a party from someone else that is trying to use recognizable things to fool customers to think that they are the original party.Trademarks have to be in the same field, so having that logo for a fruit store is perfectly fine.Trademarks needs to be depended. If I used this logo for some time with Apple knowingly ignoring it, then I can say that they have let the trademark expire, and I am allowed to use it. Copyright -&#xA0;copyright means that as the creator of something, I am the one that is in charge of deciding what to do with it. For instance, this blog post is copyrighted, and if someone was to reprint it without permission, it is likely that I wouldn&#x27;t like it, and ask them to take it down.Copyright is the most common way to control what happens with software, and indeed, this is what most software license deal with, allowing copies of the software to be distributed.Here you also get into the part of copyright violations, which may simply copying without rights :-) or more complex, creating a derivative work without a license.For instance, de-compiling a commercial control using Reflector, renaming the namespace and then offering it to sale under your own name is such a case. Other stuff - there are all sort of other things out there that I didn&#x27;t take the effort to name, a specific design may be challenged, Apple&#x27;s suing over the Mac design comes to mind, and even on the trash can in the corner, or Microsoft claims that they own the Ribbon UI design, and that you need a license for that. Now, after all of that, where am I getting at? There isn&#x27;t much that you can do about patents, except ignore them. If you actively go looking for them, in some places (US), you are then considered liable for more damages.  Trademarks, that is a place where a bit of research. For instance, creating a company called Rhino Software is probably not a good idea, because it already exists. This is not something that should really concern developers, although ISVs should probably pay attention there. Copyright, now this is the more interesting part. Here is where we get into &quot;tainted eye balls&quot;, and this is especially relevant as a result of MS making the source for the BCL available. Ignoring such blatant theft example as above, there is the problem of having to solve a problem, going into such a codebase, seeing how they solved it, and solving your own problem in a similar fashion. Even assuming that you did not copy&#xA0;&amp; paste the code from there, it can still be said that you are in violation of their copyright because you have residual knowledge from looking at the code. This is why I agree with Frans Bouma&#x27;s statements about the license, that this is not something that you want to look at. Until such time as it comes out with a&#xA0; clause that says that you are not tainted&#xA0;by reading the code, you really don&#x27;t want to touch this. &#xA0;But wait, I hear you say, you don&#x27;t say that about Reflector, and that is the same thing, no? As a matter of fact, no, it is not the same thing at all. Reflector is Reverse Engineering the code to source form, that is not at all like looking at the source code itself. Yes, for many practical purposes, they are one and the same, but they are not the same from a legal point of view. Reverse Engineering is allowed (in some places, the EU for one, and IL as well, I think. Probably not in the US, but I have no clue) and it means that you can are not tainted from that knowledge. Looking at the actual source code is not reverse engineering, and it removes the reverse engineering defense that you may be able to use.  To put it in other terms, the Samba project works by reverse engineering windows&#x27; protocols, that is allowed, but if MS makes available the networking protocol code, and one of Samba&#x27;s team members look at it, then commit a change, that is a violation of the copyright. In fact, I know that Mono has stricter policy, of not using the BCL reflectored code, or knowledge gained from Reflectoring over the BCL, but writing from scratch. That is probably wise, cautious, move from them. Anyway, that is my interpretation of the whole deal, and the bare minimum that you need to know about his matters.</p>
        </article>
        <article id="article-7392">
            <a href="https://ayende.com/blog/2834/open-source-forking" target="_blank">
                <h2 class="title mb-6" id="article-7392">Open Source &amp; Forking</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Joe raises an interesting question&#xA0;as a result of my post about Dunn &amp; Churchill forking a commercial version of Active Record. I mentioned that I am alright, personally, with this behavior, and he asks:  Why would you be alright with that? Hammett, yourself and others have put countless hours in to the project and then these two dopes repackage and sell your work. I understand that legally it may be OK, but it doesn&#x27;t pass muster in any way at all ethically. We have two different things going on here at once.  I certainly don&#x27;t like it, I would much rather that instead of selling &quot;DunnChurchill.Data.DiamondBinding.ActiveRecord&quot;, which is a copy of Castle ActiveRecord, they would package their product with Castle ActiveRecord. Just in terms of allowing their users to know that they can go to the Castle Forums and ask a question, or google for a question regarding that, it would be a significant difference. Quite a side from the matter of giving credit where it is due. But, and this is important, when I worked on Castle, I explicitly decided that my contributions should go under an open source license. Let us look at the definition of that, shall we? Here are the two relevant clauses for this discussion:  1. Free Redistribution  The license shall not restrict any party from selling or giving away the software as a component of an aggregate software distribution containing programs from several different sources. The license shall not require a royalty or other fee for such sale.  3. Derived Works  The license must allow modifications and derived works, and must allow them to be distributed under the same terms as the license of the original software.  Most often, the discussion of open source revolves around the free redistribution (well, just the free part of it :-) ), but derived work is just as relevant.  If we go to the Apache license, which is what Castle is released under, we will find:   2. Grant of Copyright License.  Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such Derivative Works in Source or Object form. So, this it where I (Contributor) grants&#xA0;you the rights to do a whole lots of things on Castle and any derived work from it, in both source and object form. Section 4 of the same license deals with the steps you must take to ensure that you have the right to redistribute, and from a cursory glance, it looks like Dunn &amp; Churchill has done what they are required to do. Let us go over it again:  The OSS definition allows it, in fact, it sees it as a core part of what OSS is about. The specific license allows it. I have agreed to both of those when I contributed. I don&#x27;t think that after saying:  You can redistribute this software and/or your modifications. You can use this software in commercial products.  We can also add, but if you do all both we will be angry. There is no stealing involved, because it is allowed. Now, all of that said, I mentioned already that I don&#x27;t like it. I don&#x27;t like it because while it is permitted, is it usually not... done. Perhaps I should say that it is not polite to do so? I think that this is a good distinction, it is legal, but not polite. It is certainly not the Right Thing To Do as far as I am concerned.  There are reasons for forking a code base, which move from politics and personal vendettas to disagreeing about code styles to stagnated project or actual wishing to take a code base in a different direction. Without commenting on the validity of these, and keeping in mind that I don&#x27;t personally like forking in general, all of the above are considered &quot;normal&quot; reasons for forking. Usually a fork die off, or the parent project die off, but those are what considered to be the acceptable reasons for forking. Forking in order to change the name and sell the product is not, in my opinion, an acceptable reason. Mainly because as far as I can see, the only reason to do that was to be able to package the whole thing under their name. The value added in this product is the VS integration, I would imagine, and I doubt that any would have a problem with them selling such a product if they kept using Castle ActiveRecord. As it is, it looks like they are trying to offer in their product more than they actually have built, probably because there isn&#x27;t that much of a need for VS integration alone. In short, legal, but not polite, and it goes quite outside the usual accepted practices of what you can usually do. I am fine with it because when I contributed, I agreed what can be done legally to my contributions, not just what is considered accepted. Nevertheless, I still don&#x27;t like it, and I have no problem holding both opinions at the same time.</p>
        </article>
        <article id="article-7393">
            <a href="https://ayende.com/blog/2833/imitation-is-the-sincerest-form-of-flattery" target="_blank">
                <h2 class="title mb-6" id="article-7393">Imitation is the sincerest form of flattery</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Well, I guess that Castle Active Record just a whole shower of flattery. This&#xA0;was just posted to the Castle Forums, apparently Dunn &amp; Churchill have a product called Diamond Binding that looks very much like Castle Active Record. There is a code project article about it here, and from the API and the license files, it looks like they have taken the Castle Active Record source and repackaged it.&#xA0; Now, this is allowed by the license, and this is something that I am perfectly fine at. It looks like they did some nice things with VS integration, but that is just looking at their example, I haven&#x27;t installed it.</p>
        </article>
        <article id="article-7394">
            <a href="https://ayende.com/blog/2832/trying-to-mimic-erlang-style-tasks-in-c" target="_blank">
                <h2 class="title mb-6" id="article-7394">Trying to mimic Erlang style tasks in C#</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After I lamented about missing key features for Erlang style tasks, Avish has told me about ThreadPool.RegisterWaitForSingleObject, which I was unaware of. I bang out this implementation of parallel sort as an example. Hacking code, proof of concept, written at 3AM in the morning, etc. public static WaitHandle ParQuickSort&lt;T&gt;(T[] domain, int lo, int hi)&#xA;&#x9;where T : IComparable&lt;T&gt;&#xA;{&#xA;&#x9;if (hi - lo &lt;= 1)&#xA;&#x9;{&#xA;&#x9;&#x9;return new ManualResetEvent(true); //already signalled, no wait&#xA;&#x9;}&#xA;&#x9;ManualResetEvent manualResetEvent = new ManualResetEvent(false);&#xA;&#x9;Semaphore semaphore = new Semaphore(0, 2);&#xA;&#xA;&#x9;int pivot = Partition(domain, lo, hi);&#xA;&#xA;&#x9;WaitOrTimerCallback releaseSemapore = delegate&#xA;&#x9;{&#xA;&#x9;&#x9;int release = semaphore.Release();&#xA;&#x9;&#x9;if (release == 1)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;manualResetEvent.Set();&#xA;&#x9;&#x9;}&#xA;&#x9;};&#xA;&#x9;ThreadPool.QueueUserWorkItem(&#xA;&#x9;&#x9;delegate&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;WaitHandle leftWaitHandle = ParQuickSort(domain, lo, pivot - 1);&#xA;&#x9;&#x9;&#x9;ThreadPool.RegisterWaitForSingleObject(leftWaitHandle,&#xA;&#x9;&#x9;&#x9;                                       releaseSemapore, null, TimeSpan.FromDays(1), true);&#xA;&#x9;&#x9;});&#xA;&#x9;ThreadPool.QueueUserWorkItem(&#xA;&#x9;&#x9;delegate&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;WaitHandle rightWaitHandle = ParQuickSort(domain, pivot &#x2B; 1, hi);&#xA;&#xA;&#x9;&#x9;&#x9;ThreadPool.RegisterWaitForSingleObject(rightWaitHandle,&#xA;&#x9;&#x9;&#x9;                                       releaseSemapore, null, TimeSpan.FromDays(1), true);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;);&#xA;&#x9;return manualResetEvent;&#xA;}&#xA;&#xA0;&#xA;Yes, it is ugly, but bear with me.&#xA;The usage pattern is simple:&#xA;WaitHandle sort = ParQuickSort(data, 0, count - 1);&#xA;sort.WaitOne();&#xA;Obviously we can use a Future here instead.&#xA;What is interesting is that hacking approach thought me several things, RegisterWaitForSingleObject will crash &amp; burn if you try to wait for over 369,846 objects, since at that point you will get this lovely exception:&#xA;&#xA;Unhandled Exception: System.ApplicationException: Not enough storage is available to process this command. (Exception from HRESULT: 0x80070008) &#xA0;&#xA0; at System.Threading.ThreadPool.RegisterWaitForSingleObjectNative(WaitHandle waitHandle, Object state, UInt32 timeOutInterval, Boolean executeOnlyOnce, RegisteredWaitHandle registeredWaitHandle, StackCrawlMark&amp; stackMark, Boolean compressStack)&#xA;...&#xA;Second, performance here is really a bitch, it took the impl above 5 seconds to sort through 100,000 items, while Array.Sort did it in a few milliseconds.&#xA0;In fact here are the numbers:&#xA;&#xA;Parallel: 00:00:06.2656250Array.Sort: 00:00:00.0156250&#xA;I actually had to get to 100,000 items before I could catch Array.Sort actually taking any time. &#xA;I am going to bet that what skews the problem is all the calls to events and semaphores, those are kernel calls, which are taking long time. Not nearly wake enough to try to implement user mode locking strategy that would work here.&#xA;At any rate, it looks like this approach, at least, is not really going to be a worthwhile one.</p>
        </article>
        <article id="article-7395">
            <a href="https://ayende.com/blog/2831/refactoring-threading-code" target="_blank">
                <h2 class="title mb-6" id="article-7395">Refactoring threading code</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Let us start by saying that threading is complex, hard and complicated. A while ago I was asked to do a code review of a JoinAll() method, it looked somewhat like this: public void JoinAll(IEnumerable&lt;Thread&gt; threads)&#xA;{&#xA;&#x9;foreach (Thread thread in threads)&#xA;&#x9;{&#xA;&#x9;&#x9;if(thread.Join(500)==false)&#xA;&#x9;&#x9;&#x9;thread.Abort();&#xA;&#x9;}&#xA;}&#xA;I was properly horrified by the use of thread.Abort(), but as you know, all rules have exceptions, so instead of commenting on the implementation details of the method, I asked to understand the entire scenario. This piece of code will probably easier than me trying to explain:&#xA;List&lt;Thread&gt; threads = new List&lt;Thread&gt;();&#xA;List&lt;string&gt; results = new List&lt;string&gt;();&#xA;&#xA;foreach (string urlParam in GetUrlsToQuery())&#xA;{&#xA;&#x9;string url = urlParam;&#xA;&#x9;Thread thread = new Thread(delegate()&#xA;&#x9;{&#xA;&#x9;&#x9;WebRequest wr = WebRequest.Create(url);&#xA;&#x9;&#x9;WebResponse response = wr.GetResponse();&#xA;&#x9;&#x9;using (Stream stream = response.GetResponseStream())&#xA;&#x9;&#x9;using (StreamReader sr = new StreamReader(stream))&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;string result = sr.ReadToEnd();&#xA;&#x9;&#x9;&#x9;lock (results)&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;results.Add(result);&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;});&#xA;&#x9;threads.Add(thread);&#xA;&#x9;thread.Start();&#xA;}&#xA;&#xA;foreach (Thread thread in threads)&#xA;{&#xA;&#x9;if(thread.Join(500)==false)&#xA;&#x9;&#x9;thread.Abort();&#xA;}&#xA;&#xA;ProcessResults(results);&#xA;That piece of code is in the Page_Load method of a page. The scenario was querying remote servers for information (15 - 20 of them, most often), and there was a time limit to how long we needed to wait before we need to display the results to the user.&#xA;The code above actually works, but it is tremendously wasteful of resources (creating a thread is expensive) and not really nice way to behave to a thread, it is entirely possible to get to a point where you break up the lock mechanism and remains with a broken app because of aborted threads that were in the middle of supposedly atomic operation. Not to mention that we are likely not going to cleanup the resources very well if we abort the thread.&#xA;The hard constraint that the page must be rendered in a second or so. But here, if even two of those servers are not playing well, it is not going to render fast enough.&#xA;In short, do write code like the above.&#xA;I took the code and change it a bit, instead of explicit threading, let us use the async API instead, so we get this piece of code:&#xA0;&#xA;List&lt;string&gt; results = new List&lt;string&gt;();&#xA;List&lt;WaitHandle&gt; waitHandles = new List&lt;WaitHandle&gt;();&#xA;foreach (string url in GetUrlToQuery())&#xA;{&#xA;&#x9;WebRequest wr = WebRequest.Create(url);&#xA;&#x9;IAsyncResult asyncResult = wr.BeginGetResponse(delegate(IAsyncResult ar)&#xA;&#x9;{&#xA;&#x9;&#x9;WebResponse response = wr.EndGetResponse(ar);&#xA;&#x9;&#x9;using (Stream stream = response.GetResponseStream())&#xA;&#x9;&#x9;using (StreamReader sr = new StreamReader(stream))&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;string result = sr.ReadToEnd();&#xA;&#x9;&#x9;&#x9;lock (results)&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;results.Add(result);&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;},null);&#xA;&#x9;waitHandles.Add(asyncResult.AsyncWaitHandle);&#xA;}&#xA;&#xA;WaitHandle.WaitAll(waitHandles.ToArray(), TimeSpan.FromMilliseconds(700),false);&#xA;string[] resultsCopy;&#xA;lock(results)&#xA;{&#xA;&#x9;resultsCopy  = results.ToArray();&#xA;}&#xA;ProcessResults(resultsCopy);&#xA;Now, instead of having a lot of blocked threads, we have moved it to the framework responsibility, we then gather all the wait handles and wait on all of them (remember, there aren&#x27;t more than 20, but if more than 64 are required, we can manage as well).&#xA;The important part comes when we decide that we want to give up, we make a copy of the results so far, and then start to process them. In the meantime, any request that was completed can go along its merry way and add the newly got result to the results list, but that is no longer relevant, because it got there too late.&#xA;If I wanted to get really deep into it, ASP.Net has the notions of the async request handling, which is very cool, but it doesn&#x27;t have an expiration time (that I know of, at least), and we didn&#x27;t want to get into it in the first place. &#xA;Anxiously awaiting your comments, telling me how wrong I am.</p>
        </article>
        <article id="article-7396">
            <a href="https://ayende.com/blog/2830/a-good-days-work-cleaning-up-the-mail-pile" target="_blank">
                <h2 class="title mb-6" id="article-7396">A good day&#x27;s work: cleaning up the mail pile</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">For the last three months or so I have been in a race to keep up with my mail. I tend to star &amp; mark as unread as ways to remind me that I need to do something with them, but I am bothered if I have things to do that are marked in this fashion. Especially since some of those have rotted there since August. I kept meaning to do something about it, and more interesting things kept coming up. I dedicated today to handling this once and for all, I went from over 60 items that needed taking care of to 4. More importantly, I have no unread mails in my mailbox, which means that I am much happier. Oh, and if you sent me an email recently that I never replied to, that probably means that I won&#x27;t answer it unless you will ping me again.</p>
        </article>
        <article id="article-7397">
            <a href="https://ayende.com/blog/2829/active-record-monorail-web-casts" target="_blank">
                <h2 class="title mb-6" id="article-7397">Active Record &amp; MonoRail web casts</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Here are the rehearsal sessions for Hammett &amp; me at JAOO. Hammett has just published them. Not anything really new, frankly, and the quality is all over the spectrum. I was having a nasty case of the flu, especially on the MR screen cast, and that one was recorded close to midnight. You can see me&#xA0;recording the screen cast, that is a weird movie, I tend to move a lot when I talk, but I don&#x27;t think Hammett&#x27;s laptop was very impressed. Ten points if you can find the part when I kicked it.</p>
        </article>
        <article id="article-7398">
            <a href="https://ayende.com/blog/2828/redefining-if" target="_blank">
                <h2 class="title mb-6" id="article-7398">Redefining If</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I had time today to sit on several Brail bugs. I keep getting more and more and more amazed by the power that Boo is giving me. In order to fix some of those bugs, I had to literally change the meaning of the if statement. (I defined my own nullable propagator, which&#xA0;I had to implement deeply into the language).  Damn, I love this language. Oh, and FYI,&#xA0;if 2&#x2B;2 == 4 will not do the expected thing anymore :-)</p>
        </article>
        <article id="article-7399">
            <a href="https://ayende.com/blog/2827/microsoft-and-opening-the-code-damned-if-you-do-damned-if-you-dont" target="_blank">
                <h2 class="title mb-6" id="article-7399">Microsoft and opening the code: damned if you do, damned if you don&#x27;t</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Here is another perspective&#xA0;of the results of making the source available. At that point, Microsoft really doesn&#x27;t have a good way to get out of it. People want to get the source (I am one of them), but at the same time, they are fearful of legal actions as a result of looking at the source and doing any sort of development (again, I am one of them). What is required is trust, and Microsoft is still paying for its actions of old (and its actions as of few months ago, patents &amp; OSS, for example) in that regard.</p>
        </article>
        <article id="article-7400">
            <a href="https://ayende.com/blog/2826/book-review-making-money" target="_blank">
                <h2 class="title mb-6" id="article-7400">Book Review</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have no idea how he does it, but Terry Prachett is so consistently funny, amusing and a very good writer. Making Money&#xA0;is a continuation to the Going Postal book, with the main hero being Moist, again thrust into an unwilling job description, and raising to the occasion. It was both hilarious and a good read, two distinct qualities, but Prachett is combining them masterfully. Highly recommended, and more than worth a second read, which I need to make time to. There is also the shred of a promise to have Moist as the tax collector for the city, which would make for an interesting story, considering he is a thief.</p>
        </article>
        <div class="button flex justify-between">
            <a href="739.html"><span class="back arrow"></span></a>

            <a href="741.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>