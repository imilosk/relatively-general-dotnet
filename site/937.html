
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 937 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-9361">
            <a href="https://ayende.com/blog/1047/great-site-bug-me-not" target="_blank">
                <h2 class="title mb-6" id="article-9361">Great site: Bug Me Not</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is a great site, it supplies default name &amp; password for sites that require registering to see their content.    http://www.bugmenot.com/</p>
        </article>
        <article id="article-9362">
            <a href="https://ayende.com/blog/1046/circular-dependencies" target="_blank">
                <h2 class="title mb-6" id="article-9362">Circular Dependencies</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">So, I need to copy a set of tables from one database to another, the issue is that the source database keeps changing, so, in a true developer fashion, I added another layer of indirection and instead of writing scripts to copy the database I wrote a program that would write scripts that would copy the database.    I&#x27;m pretty proud of it, it uses the SQL Runner tool that I mentioned earlier, and it work in stages, so the first thing that copied is tables with no foreign keys, then the tables that depended on those, and then the tables that depend on those, and so on. The issue is that I&#x27;ve a couple of tables that have circular dependencies (sometimes a dependency on itself). This presents an interesting problem since I don&#x27;t want to start special casing for each table type.     I can see several options there:            Drop the foreign keys, copy the tables and recreate from scratch - On general I don&#x27;t like this, especially since generating the code to recreate the foreign key is not trivial.            Try to copy anyway, maybe I would get lucky or there aren&#x27;t any real references between the tables.            Leave it as a totally manual process (which is a real option, since this is a mostly one off thing).    Ideas?</p>
        </article>
        <article id="article-9363">
            <a href="https://ayende.com/blog/1045/signs-of-troubles-reflector-single-quote-strings-etc" target="_blank">
                <h2 class="title mb-6" id="article-9363">Signs Of Troubles: Reflector, Single Quote Strings, Etc</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">To the best of my knowledge, Reflector still work just fine, it&#x27;s just that I can no longer find it on&#xA0;the favoraite programs in the XP start menu. Considerring the fact that I&#xA0;usually head to Reflector before I go to MSDN, that says something. I&#x27;m&#xA0;not doing enough real programming these days, it got to the point where I wrote a bit of C# code today, and I started to use &#x27; all over the place to mark strings, instead of the proper &quot;. I&#x27;m thinking of moving entirely to Boo (never a bad idea), since it support both single &amp; double quoted strings.    More signs of trouble:            SQL Plus (Oracle Client) compete with SQL Management (SQL Client) for top place in the favoraite programs.            Visual Studio.Net is way behind those two.            I moved to a second machine and I was truly lost without grep, but I never missed the fact that it doesn&#x27;t have VS.Net Installed.</p>
        </article>
        <article id="article-9364">
            <a href="https://ayende.com/blog/1044/justdate-striping-the-time-part-from-datetime-variables" target="_blank">
                <h2 class="title mb-6" id="article-9364">JustDate: Striping the time part from datetime variables</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In oracle, there is a handy little function call trunc. That function is a real work hourse, it can truncate numbers, dates, programmers life time, etc. In the most basic form trunc(sysdate) will return the current day without the time part, it has quite a few options that are fairly nice as well. Anyone, for some reason this bulitin functionality is missing in T-SQL, so of course I had to implement it three times. The first was a scratch function that used string manipulation to do its work. The second was a SQL CLR function that just did:[SqlFunction]    public&#xA0;DateTime&#xA0;JustDate(DateTime&#xA0;dateTime)    {    &#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;dateTime.Date;    }    This has so many problems that I won&#x27;t begin to count them just yet. Let&#x27;s just say that I finally realized how bad this is when I started to get errors about &quot;can&#x27;t accept null values&quot;. And then came enlightment, and I wrote this function:            CREATE FUNCTION JustDate(@date DATETIME)                        RETURNS DATETIME                        AS                        BEGIN                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; RETURN DATEADD(day,day(@date)-1,&#xA0;&#xA0;&#xA0;                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATEADD(month,month(@date)-1,                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATEADD(year,year(@date)-1900,0)))                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; RETURN DATEADD(dd, 0, DATEDIFF(dd, 0, @date))                                             END         It uses the same technique as the previous one.     I think that this one is much better :-D    Update: Anatoly has a much simpler version, I updated the post to show the new method (the old method is striked through.</p>
        </article>
        <article id="article-9365">
            <a href="https://ayende.com/blog/1043/using-data-ranges" target="_blank">
                <h2 class="title mb-6" id="article-9365">Using Data Ranges</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Okay, let&#x27;s see some use for having a date range, let&#x27;s assume that I&#x27;ve the following employees table:                                                                                                EmpId                                            Name                                                                            1                                            Ayende                                                                            2                                            Rahien                                                                            3                                            Bar                                            And an EmpHours tables with the following data:                                                                                                            EmpHourId                                            EmpId                                            Start                                            End                                                                            3                                            1                                            01/01/2006 08:00                                            01/01/2006 17:00                                                                            4                                            1                                            02/01/2006 08:00                                            02/01/2006 17:00                                                                            5                                            1                                            03/01/2006 09:00                                            03/01/2006 16:00                                                                            6                                            2                                            01/01/2006 09:00                                            01/01/2006 16:00                                                                            7                                            2                                            02/01/2006 07:00                                            02/01/2006 16:00                                                                            8                                            2                                            03/01/2006 07:00                                            03/01/2006 18:00                                                                            9                                            3                                            03/01/2006 07:00                                            03/01/2006 18:00                                            Our goal is to produce a report that shows how much hours a day each of those employees worked for the first week of 2006.    Anatoly suggested something like this (Refactored a bit to match my table structure):            SELECT e.Name, AVG(DATEDIFF(hh, StartHour, EndHour)) AS AvgHoursPerDay                        &#xA0; FROM EmpHours eh join Employees e on eh.EmployeeId = e.EmployeeId                        &#xA0;WHERE DATEPART(week, StartHour) = 1                        &#xA0;GROUP BY eh.EmployeeId, e.Name        The result of this query is this table:                                                                                                Name                                            AvgHoursPerDay                                                                            Ayende                                                                        &#xA0;8                                                                                                                                                    Rahien                                                                                                                     &#xA0;9                                                                                                                                                    Bar                                                                                                                     &#xA0;11                                                                                        Okay, this gives me the average, but it doesn&#x27;t gives me the number of hours per day, for that I need to join against a date range, which is where my previous post comes into play, here is the query:            SELECT                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EmpInDate.EmployeeId,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EmpInDate.Name,                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EmpInDate.Date,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUM(DATEDIFF(hour,eh.StartHour,&#xA0;eh.EndHour)) HoursPerDay                        FROM                        (                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EmployeeId,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Name,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; CurrentDate as Date                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FROM Employees e, DateRange(&#x27;20060101&#x27;,&#x27;20060107&#x27;)                        )&#xA0;&#xA0;&#xA0;&#xA0; EmpInDate LEFT JOIN EmpHours eh                                 ON&#xA0;&#xA0;&#xA0; EmpInDate.Date = dbo.JustDate(eh.StartHour)                        AND EmpInDate.EmployeeId = eh.EmployeeId                        GROUP BY EmpInDate.EmployeeId, EmpInDate.Name, EmpInDate.Date        This simply return the number of hours that an employee worked in a spesific date in the range, in this case, from the 01/01/2006 to 06/01/2006 (DateRange does not include the last date), then we join against the number of hours an employee worked in that date, and sum the result.    Here is the result of this query:                                                                                                                        EmployeeId                                            Name                                            Date                                            HoursPerDay                                                                            1                                            Ayende                                            01/01/2006                                            9                                                                            2                                            Rahien                                            01/01/2006                                            7                                                                            3                                            Bar                                            01/01/2006                                            NULL                                                                            1                                            Ayende                                            02/01/2006                                            9                                                                            2                                            Rahien                                            02/01/2006                                            9                                                                            3                                            Bar                                            02/01/2006                                            NULL                                                                            1                                            Ayende                                            03/01/2006                                            7                                                                            2                                            Rahien                                            03/01/2006                                            11                                                                            3                                            Bar                                            03/01/2006                                            11                                                                            1                                            Ayende                                            04/01/2006                                            NULL                                                                            2                                            Rahien                                            04/01/2006                                            NULL                                                                            3                                            Bar                                            04/01/2006                                            NULL                                                                            1                                            Ayende                                            05/01/2006                                            NULL                                                                            2                                            Rahien                                            05/01/2006                                            NULL                                                                            3                                            Bar                                            05/01/2006                                            NULL                                                                            1                                            Ayende                                            06/01/2006                                            NULL                                                                            2                                            Rahien                                            06/01/2006                                            NULL                                                                            3                                            Bar                                            06/01/2006                                            NULL                                            If we add another entry for three more hours on the 01/01/2006 to Employee Ayende, we will get the same number of hours, but the first row will have HoursPerDay of 11. Still, this isn&#x27;t something that is nice to look at (nor does it let you see which of your workers is lazy :-)), so let&#x27;s keep making the query better by pivoting it:            SELECT                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Name,                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; [1] as [Day #1],[2] as [Day #2],[3] as [Day #3],                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; [4] as [Day #4],[5] as [Day #5],[6] as [Day #6]                        FROM                                 (                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EmpInDate.Name,                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; day(EmpInDate.Date) day,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DATEDIFF(hour,eh.StartHour, eh.EndHour) Hours                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FROM                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; (                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; EmployeeId,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Name,                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; CurrentDate as Date                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FROM Employees e, DateRange(&#x27;20060101&#x27;,&#x27;20060107&#x27;)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; )&#xA0;&#xA0;&#xA0;&#xA0; EmpInDate LEFT JOIN EmpHours eh                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ON&#xA0;&#xA0;&#xA0; EmpInDate.Date = dbo.JustDate(eh.StartHour)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; AND EmpInDate.EmployeeId = eh.EmployeeId                        ) Source                        PIVOT                                 (                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SUM(Hours)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FOR [DAY] IN                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; (                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;[1],[2],[3],[4],[5],[6]                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; )                        ) as PVT                        And the result:                                                                                                                        Name                                            Day #1                                            Day #2                                            Day #3                                            Day #4                                            Day #5                                            Day #6                                                                            Ayende                                            11                                            9                                            7                                            NULL                                            NULL                                            NULL                                                                            Bar                                            NULL                                            NULL                                            11                                            NULL                                            NULL                                            NULL                                                                            Rahien                                            7                                            9                                            11                                            NULL                                            NULL                                            NULL                                            I talked about pivoting&#xA0;before, btw. Now, like I said, in a serious application, you&#x27;ll want to do this only on business days, and that isn&#x27;t likely to be calculated in a function, most likely you&#x27;ll have a table of pre-calculated dates that you&#x27;ll use, but it&#x27;s can be cool to do it on an ad-hoc basis, or maybe when you really need all the dates. One thing that I can easily think about is having a MonthlyDateRange that you use for joining to create reports for things that happened within that month (that is assuming that you&#x27;re not working in a place where it&#x27;s customary for the whole company to take a month long vacations).</p>
        </article>
        <article id="article-9366">
            <a href="https://ayende.com/blog/1042/the-value-of-parallelism" target="_blank">
                <h2 class="title mb-6" id="article-9366">The value of parallelism</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I said that I used the little script that I posted about for short tasks.The reason for that is that it will run the files serially. This isn&#x27;t very good if you want to get the maximum from your server. I actually wrote a multi threaded sql running that connects to a database and runs multiply queries in parallel. I&#x27;m using that for long queries (where long is thousands of files and the whole process takes hours).&#xA;Running it in parallel (and from a different computer than the one the server is running on) improved the performance by a factor of three (think about going from days to hours). It&#x27;s so useful that I started to bulid an infra-structure around it.&#xA;What is basically does is to scan a directory (recursively) and put all the SQL files it finds in a queue, they are then run by a ThreadPool thread. I arrange it so that it must complete running all the files in a directory before it can move to the next one, so I can now arrange my scripts in directories and they will execute in the order of the directories names.&#xA;It&#x27;s what I call a Me-Ware, it requires the task manager to close if you need to shut it down before it is done, the connection strings are hard coded, etc. Nevertheless, I find it incredibly useful.&#xA;In fact, I built the tool while waiting for the @#$% scripts to finish running :-)</p>
        </article>
        <article id="article-9367">
            <a href="https://ayende.com/blog/1041/the-lost-art-of-batch-files" target="_blank">
                <h2 class="title mb-6" id="article-9367">The lost art of batch files</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Here is a quick &amp; dirty way to execute a command on all the files in a directory.for %f in (*.sql) do sqlcmd -E -S . -d DataBase_Name&#xA0; &lt; %f &gt; %f.log&#xA;In this case, I execute all the sql files in a directory and write the results to a log.&#xA;This is useful if you&#x27;ve a common set of scripts that you need to run. I&#x27;m using it to get results of short operations.&#xA;Why short? Well, this is for the next post.</p>
        </article>
        <article id="article-9368">
            <a href="https://ayende.com/blog/1040/the-difference-between-a-class-and-an-instance-of-a-class" target="_blank">
                <h2 class="title mb-6" id="article-9368">The difference between a class and an instance of a class</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">There is a discussion in the TDD Yahoo Email group about class vs. instance of a class with regard to its design. Spesifically, the issue is the difference between:&#xA;Employee emp = Employee.Find(&quot;John&quot;); Vs.Employee emp = employeeFinder.Find(&quot;John&quot;);&#xA;The discussion revolves around managing the responsabilities of a class. For myself, I stand firmly on the first sentence, the responsability for locating an object of the class should be in the hand of the class. After all, it&#x27;s an object as well (not a very dynamic one in C based language, but it does exists), why should we let it avoid any responsabilities? I don&#x27;t really see a point with creating a finder object that is strongly tied to its findee type.&#xA;This is one of the reasons that I like Active Record so much, I guess. &#xA;That said, I would make an exception for a generic Finder / Repository object, like this one:&#xA;Employee emp = Repository&lt;Employee&gt;.Find(&quot;John&quot;);&#xA;Since this type isn&#x27;t coupled to the Employee type. If fact, I make an extensive use of this in a one of my projects (where the data is persisted via Active Record, but I needed to insert more checks along the way).</p>
        </article>
        <article id="article-9369">
            <a href="https://ayende.com/blog/1039/more-on-date-ranges" target="_blank">
                <h2 class="title mb-6" id="article-9369">More on date ranges</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Like I said, I didn&#x27;t really like my solution to date ranges using Common Table Expression and recursion. It is very limiting in many ways, performance not the least of them.&#xA;So I set out to find a better way, and found it with table valued functions, like this:&#xA;ALTER FUNCTION DateRange&#xA;(&#xA0;&#xA0;&#xA0;&#xA0; &#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; @start datetime,&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; @end datetime&#xA;)&#xA;RETURNS @DateRange TABLE&#xA;(&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; CurrentDate datetime&#xA;) &#xA;AS&#xA;BEGIN&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; WHILE (@start &lt; @end)&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; BEGIN&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; INSERT INTO @DateRange(CurrentDate)&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; VALUES(@start)&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT @start = DATEADD(day,1,@start)&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; END&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; RETURN&#xA;END&#xA;Like the previous function, this take two date ranges, and return a set of all the dates between them, useful for joining against in many cases.&#xA;This function, however, doesn&#x27;t require you to do anything special (like increasing the recursion depth) and it quite performant.&#xA;Again, on a highly loaded server, this function gave me a set of all the dates between 2000 and 2300 in 15 seconds (over 100,000 results!), at the same time that the previous function was still struggling with merely 10 years difference (3,000 results).</p>
        </article>
        <article id="article-9370">
            <a href="https://ayende.com/blog/1038/sql-date-ranges" target="_blank">
                <h2 class="title mb-6" id="article-9370">SQL Date Ranges</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When you&#x27;re working with SQL, it&#x27;s often best to work with sets of data, but when you&#x27;re working with dates, it&#x27;s not always possible. Especially if you need to work with date ranges.&#xA;For instance, how do you find out how many hours each employee worked per day over the last month? Well, you can have a BusinessDays table, which you can join against, but often you will want to so some ad-hoc date ranges, or you don&#x27;t have a BusinessDays table and you don&#x27;t want to create one.&#xA;I was playing with ideas about generating sets from start - end values and I finally came up with this function:&#xA;CREATE FUNCTION DateRange(@start DATETIME, @end DATETIME)&#xA;RETURNS TABLE&#xA;AS&#xA;RETURN &#xA;(&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; WITH DateRange(CurrentDate) AS&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; (&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT @start as CurrentDate&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; union all&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT DATEADD(day,1,CurrentDate)&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; FROM DateRange &#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; WHERE CurrentDate &lt; @end&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; )&#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; SELECT CurrentDate FROM DateRange &#xA;);&#xA;&#xA;As you can see, it&#x27;s using Common Table Expression, so it&#x27;s 2005 only, but the nice thing about it is that it takes two dates, and return all the dates between them (inclusive).&#xA;Some words of caution:&#xA;&#xA;I tested it on a highly loaded machine, and it&#x27;s not the most light-wieght solution in the world. For ten years period, it took over 15 seconds to run.&#xA;To compare, I inserted the results to a temp table and selected that. I got the results instantly.&#xA;For dates that are further than 100 days apart, you need to specify high range of MAXRECURSION, often more than I&#x27;m comportable with.&#xA;Usage:&#xA;SELECT CurrentDate FROM DateRange(&#x27;20010101&#x27;,&#x27;20120901&#x27;)OPTION(MAXRECURSION 10000)&#xA;I&#x27;m still looking for a better alternative, though.</p>
        </article>
        <div class="button flex justify-between">
            <a href="936.html"><span class="back arrow"></span></a>

            <a href="938.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>