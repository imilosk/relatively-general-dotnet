
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 530 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-5291">
            <a href="https://ayende.com/blog/4657/the-other-side-of-chasing-the-money" target="_blank">
                <h2 class="title mb-6" id="article-5291">The other side of chasing the money</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 11, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When I started doing my own consulting, I realized that sometimes I would have to chase after a client in order to get paid. Luckily, it hasn&#x2019;t happened often.  I did not expect the reverse to happen, but it did. I just had to send the following formal notice to someone who does work for me:     Hi guys!     I am pretty sure that I owe you money. Would you mind terribly if I paid you?   And yes, this post is here to serve as a kick to the people in question.</p>
        </article>
        <article id="article-5292">
            <a href="https://ayende.com/blog/4656/a-murder-of-ravens" target="_blank">
                <h2 class="title mb-6" id="article-5292">A murder of Ravens</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 11, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In the last 96 hours, I slept a total of 6 (all of them while I was on a plane and had no electricity, so I couldn&#x2019;t work).  All the rest of my time was pretty much focused on doing crazy stuff with RavenDB. I am very happy to say that I (with a lot of help from Rob Ashton), have managed to really push what RavenDB can do. In particular, about 5 minutes ago I finished the last touch required to get RavenDB to run using fully managed storage.  And yes, this means that we will have a Mono build shortly.  The crazy part is that a week ago I would have said that managed storage would be the feature for RavenDB, but it is actually the case that it is on an equal footing with a few others that we recently added. We have been so busy adding those features, and working through the implication of having those features, that we didn&#x2019;t have time to sit down and document &amp; explain them properly.   No worries, this is coming. In fact, this is what I intend to do for most of tomorrow (at least, as soon as I wake up).  Ayende the excited.</p>
        </article>
        <article id="article-5293">
            <a href="https://ayende.com/blog/4655/disabling-linq" target="_blank">
                <h2 class="title mb-6" id="article-5293">Disabling Linq</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 10, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">For a lot of things, Linq is really nice. But there is one very important problem with Linq. It make it very easy to do some really stupid things, because it is so easy to intermix in memory operations with remote operations. One of the most common problems that we run into with the RavenDB API was this:     session.LuceneQuery&lt;User&gt;(&quot;Users/ByName&quot;)&#xA;            .Where(x=&gt;x.Name == username)&#xA;            .FirstOrDefault();&#xA;  &#xA;&#xA;The problem is that LuceneQuery is not the Linq endpoint to RavenDB. It is the lower level API that we use to query RavenDB, and the Linq API is built on top of that. The problem is that it is very easy to write code like that, and it works, for small amounts of data. What this code actually does is load the first page of information from the database and do the filtering in memory. &#xA;&#xA;Obviously, this is not ideal, but this is a pretty common mistake. We are currently thinking of ways to drastically simplify the API, but in the meantime, something had to be done about this.&#xA;&#xA;LuceneQuery returns an instance of IDocumentQuery:&#xA;&#xA;&#xA;  public interface IDocumentQuery&lt;T&gt; : IEnumerable&lt;T&gt;&#xA;  &#xA;&#xA;That was good, because that meant that we had a hook to place stop the user from making this mistake. The way Linq works, it first looks for an instance method and only afterward it will look for extension methods. That allowed me to define the following:&#xA;&#xA;&#xA;  [Obsolete(@&quot;&#xA;You cannot issue an in memory filter - such as Where(x=&gt;x.Name == &quot;&quot;Ayende&quot;&quot;) - on IDocumentQuery. &#xA;This is likely a bug, because this will execute the filter in memory, rather than in RavenDB.&#xA;Consider using session.Query&lt;T&gt;() instead of session.LuceneQuery&lt;T&gt;. The session.Query&lt;T&gt;() method fully supports Linq queries, while session.LuceneQuery&lt;T&gt;() is intended for lower level API access.&#xA;If you really want to do in memory filtering on the data returned from the query, you can use: session.LuceneQuery&lt;T&gt;().ToList().Where(x=&gt;x.Name == &quot;&quot;Ayende&quot;&quot;)&#xA;&quot;, true)]&#xA;IEnumerable&lt;T&gt; Where(Func&lt;T, bool&gt; predicate);&#xA;  &#xA;&#xA;Now, the code above it going to generate a very descriptive compilation error, and the entire class of bugs just went out the window.</p>
        </article>
        <article id="article-5294">
            <a href="https://ayende.com/blog/4654/where-is-the-bug" target="_blank">
                <h2 class="title mb-6" id="article-5294">Where is the bug?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 09, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I thought that I was adding an innocent little feature, here:     public class CreateFolderIcon : IStartupTask&#xA;{&#xA;    public void Execute(DocumentDatabase database)&#xA;    {&#xA;        var dataDirectory = Path.GetFullPath(database.Configuration.DataDirectory);&#xA;            &#xA;        var desktopIni = Path.Combine(dataDirectory, &quot;desktop.ini&quot;);&#xA;        var icon = Path.Combine(dataDirectory, &quot;raven-data.ico&quot;);&#xA;&#xA;        if (File.Exists(desktopIni) &amp;&amp; File.Exists(icon))&#xA;            return;&#xA;&#xA;        using (var iconFile = typeof(CreateFolderIcon).Assembly.GetManifestResourceStream(&quot;Raven.Database.Server.WebUI.raven-data.ico&quot;))&#xA;        {&#xA;            File.WriteAllBytes(icon, iconFile.ReadData());&#xA;        }&#xA;&#xA;        File.WriteAllText(desktopIni, string.Format(@&quot;&#xA;[.ShellClassInfo]&#xA;IconResource={0},0&#xA;[ViewState]&#xA;Mode=&#xA;Vid=&#xA;FolderType=Generic&#xA;&quot;,&#xA;                                icon));&#xA;&#xA;&#xA;        File.SetAttributes(desktopIni, FileAttributes.Hidden | FileAttributes.System | FileAttributes.Archive);&#xA;        File.SetAttributes(dataDirectory, FileAttributes.ReadOnly);&#xA;&#xA;    }&#xA;}&#xA;  &#xA;&#xA;But this resulted in every single test failing.&#xA;&#xA;Can you figure out why?</p>
        </article>
        <article id="article-5295">
            <a href="https://ayende.com/blog/4653/directory-icons" target="_blank">
                <h2 class="title mb-6" id="article-5295">Directory icons</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 08, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Since people got into RavenDb&#x2019;s data directory and started messing around with things, I decided that I might as well try to stop them. Now, I can&#x2019;t really stop anyone, but I can make it clear that the Data directory is off limit.  I decided to do it by giving the RavenDB directory its own icon. That led me toward a journey to understand exactly how the desktop.ini works. Eventually, I got this:     public class CreateFolderIcon : IStartupTask&#xA;{&#xA;    public void Execute(DocumentDatabase database)&#xA;    {&#xA;        var dataDirectory = Path.GetFullPath(database.Configuration.DataDirectory);&#xA;            &#xA;        var desktopIni = Path.Combine(dataDirectory, &quot;desktop.ini&quot;);&#xA;        var icon = Path.Combine(dataDirectory, &quot;raven-data.ico&quot;);&#xA;&#xA;        if (File.Exists(desktopIni) &amp;&amp; File.Exists(icon))&#xA;            return;&#xA;&#xA;        using (var iconFile = typeof(CreateFolderIcon).Assembly.GetManifestResourceStream(&quot;Raven.Database.Server.WebUI.raven-data.ico&quot;))&#xA;        {&#xA;            File.WriteAllBytes(icon, iconFile.ReadData());&#xA;        }&#xA;&#xA;        File.WriteAllText(desktopIni, string.Format(@&quot;&#xA;[.ShellClassInfo]&#xA;IconResource={0},0&#xA;[ViewState]&#xA;Mode=&#xA;Vid=&#xA;FolderType=Generic&#xA;&quot;,&#xA;                                icon));&#xA;&#xA;&#xA;        File.SetAttributes(desktopIni, FileAttributes.Hidden | FileAttributes.System | FileAttributes.Archive);&#xA;        File.SetAttributes(dataDirectory, FileAttributes.ReadOnly);&#xA;&#xA;    }&#xA;}&#xA;  &#xA;&#xA;And now the RavenDB data directory looks like:&#xA;&#xA;&#xA0; &#xA;&#xA;&#xA;&#xA;A few things to note:&#xA;&#xA;&#xA;  This isn&#x2019;t exactly what I envisioned as the usage scenario for startup tasks.&#xA;&#xA;  You have to use set the attributes on the desktop.ini to hidden, system &amp; archive for it to work.&#xA;&#xA;  You have to set the attributes on the directory to read only. The documentation says that you need to call PathMakeSystemFolder, but you can just use File.SetAttributes (remember, a directory is a file, when all is said and done).&#xA;&#xA;&#xA;I think that this is cool, a bit useless, but cool. A bit of polish for the way RavenDB behaves.</p>
        </article>
        <article id="article-5296">
            <a href="https://ayende.com/blog/4652/the-benefits-of-a-plugins-based-system-ravendb" target="_blank">
                <h2 class="title mb-6" id="article-5296">The benefits of a plugins based system: RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 07, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I just fixed an interesting bug with RavenDB. Basically, a user was complaining that if they went ahead and (effectively randomly) deleted files from the RavenDB directory, RavenDB would break. The bug is that it used to work previously and now it doesn&#x2019;t work anymore. The actual bug is a bit more complex than that, but I think that the description I just gave is a good indication of how I think of this bug.  Nevertheless, this actually demonstrate a problem with RavenDB. RavenDB stores index information in 3 different locations:     Index statistics are tracked inside the storage (the RavenDB data file)    Index definition are stored in the /IndexDefinitions directory, as plain JSON files.    The index data itself is tracked inside the /Indexes directory   Granted, the only way that those locations can go out of sync is if the user is actively trying to corrupt RavenDB by messing with the internal stuff directly, but still&#x2026;  I decided that I wanted to add explicit support for detecting and recovering from this scenario, so I wrote the following:     namespace Raven.Database.Plugins.Builtins&#xA;{&#xA;    public class DeleteRemovedIndexes : IStartupTask&#xA;    {&#xA;        public void Execute(DocumentDatabase database)&#xA;        {&#xA;            database.TransactionalStorage.Batch(actions =&gt;&#xA;            {&#xA;                var indexNames = actions.Indexing.GetIndexesStats().Select(x =&gt; x.Name).ToList();&#xA;                foreach (var indexName in indexNames)&#xA;                {&#xA;                    if(database.IndexDefinitionStorage.Contains(indexName) )&#xA;                        continue;&#xA;&#xA;                    // index is not found on disk, better kill for good&#xA;                    // Even though technically we are running into a situation that is considered to be corrupt data&#xA;                    // we can safely recover from it by removing the other parts of the index.&#xA;                    database.IndexStorage.DeleteIndex(indexName);&#xA;                    actions.Indexing.DeleteIndex(indexName);&#xA;                }&#xA;            });&#xA;        }&#xA;    }&#xA;}&#xA;  &#xA;&#xA;IStartupTask is marked with InheritableExport, and the rest just plugs into RavenDB using MEF. Just by the action of creating this class, I have added new behavior to Raven. Moreover, this is now clearly executed in the proper place and in its own class, making it very easy to understand what is going on.&#xA;&#xA;A lot of the stuff in RavenDB is wired in this fashion, and it makes adding things to it a snap.</p>
        </article>
        <article id="article-5297">
            <a href="https://ayende.com/blog/4651/jaoo-the-go-programming-language" target="_blank">
                <h2 class="title mb-6" id="article-5297">JAOO</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 06, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Currently sitting in the Go language keynote in JAOO.   Go was created to handle Google needs:     Compilation speed    Efficient    Fit for the current set of challenges we face   Go is meant to be Simple, Orthogonal, Succinct. Use C syntax, but leave a lot of complexity behind.   This make sense, because C/C&#x2B;&#x2B; is horrible for a lot of reasons, because of complexity added to it over the years. Actually, the major problem is that C/C&#x2B;&#x2B; mindset are literally designed for a different era. Take into account how long it can take to build a C&#x2B;&#x2B; application (I have seen no too big apps that had half an hour build times!), and you can figure out why Google wanted to have a better model.  Nice quotes:     Programming shouldn&#x2019;t be a game of Simon&#x2019;s Says    Difference between seat belts &amp; training wheels &#x2013; I am going to use that a lot.   I find Go&#x2019;s types annoying:     [variable name] [variable type] vs. [variable type] [variable name]    And []int vs. int[]   I like the fact that is uses garage collection in native code, especially since if you reference a variable (including local) it will live as long as it has a reference to. Which is a common mistake in C.  It also have the notion of deferring code. This is similar to how you can use RAII in C&#x2B;&#x2B;, but much more explicit, which is good, because RAII is always tricky. It very cleanly deals with the need to dispose things.  All methods looks like extension methods. Data is held in structures, not in classes. There is support for embedding structures inside one another, but Go isn&#x2019;t an OO language.   Interfaces work for all types, and interfaces are satisfied implicitly! Much easier to work, think about this like super dynamic interfaces, but strong typed. Implies that we can retrofit things afterward.  Error handling is important, and one of the major reasons that I moved from C&#x2B;&#x2B; to .NET. Go have two modes, the first is error codes, which they use for most errors. This is especially nice since Go have multiple return values, so it is very simple to use. But it also have the notion of panics, which are similar to exceptions. Let us take a look at the following test code:     package main&#xA;&#xA;func test() {&#xA;  panic(&quot;ayende&quot;)&#xA;}&#xA;&#xA;func main() {&#xA;    test()&#xA;}&#xA;  &#xA;&#xA;Which generate the following panic:&#xA;&#xA;&#xA;  panic: ayende&#xA;&#xA;panic PC=0x2ab34dd47040&#xA;runtime.panic&#x2B;0xb2 /sandbox/go/src/pkg/runtime/proc.c:1020&#xA;    runtime.panic(0x2ab300000000, 0x2ab34dd470a0)&#xA;main.test&#x2B;0x47 /tmp/gosandbox-a9aaff6c_68e6b411_26fb5255_aa397bb1_6299a954/prog.go:5&#xA;    main.test()&#xA;main.main&#x2B;0x18 /tmp/gosandbox-a9aaff6c_68e6b411_26fb5255_aa397bb1_6299a954/prog.go:8&#xA;    main.main()&#xA;mainstart&#x2B;0xf /sandbox/go/src/pkg/runtime/amd64/asm.s:78&#xA;    mainstart()&#xA;goexit /sandbox/go/src/pkg/runtime/proc.c:145&#xA;    goexit()&#xA;  &#xA;&#xA;I got my stack trace, so everything is good. Error handling is more tricky. There isn&#x2019;t a notion of try/catch, because panics aren&#x2019;t really exceptions, but you can recover from panics:&#xA;&#xA;&#xA;  package main&#xA;import ( &#xA;   &quot;fmt&quot;&#xA;)&#xA;func badCall() {&#xA;  panic(&quot;ayende&quot;)&#xA;}&#xA;&#xA;func test() {&#xA;   defer func() { &#xA;    if e := recover(); e != nil {&#xA;       fmt.Printf(&quot;Panicing %s\r\n&quot;, e);&#xA;    }&#xA;   &#xA;    }()&#xA;    badCall()&#xA;   fmt.Printf(&quot;After bad call\r\n&quot;);&#xA;}&#xA;&#xA;func main() {&#xA;   fmt.Printf(&quot;Calling test\r\n&quot;);&#xA;   test()&#xA;   fmt.Printf(&quot;Test completed\r\n&quot;);&#xA; &#xA; &#xA;}&#xA;  &#xA;&#xA;Which will result in the following output:&#xA;&#xA;&#xA;  Calling test&#xA;Panicing ayende&#xA;Test completed&#xA;&#xA;&#xA;All in all, if I need to write native code, I&#x2019;ll probably go with Go instead of C now. Especially since the ideas that it have about multi threading are so compelling. I just wish that the windows port would be completed soon.</p>
        </article>
        <article id="article-5298">
            <a href="https://ardalis.com/linq-range-variable-problem/" target="_blank">
                <h2 class="title mb-6" id="article-5298">LINQ Range Variable Problem</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Ran into this issue last night and just figured it out. I have this code for a demo: Now, in Visual Studio, it looks like this: image&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-5299">
            <a href="https://ayende.com/blog/4650/nosql-without-web-scale" target="_blank">
                <h2 class="title mb-6" id="article-5299">NoSQL without web-scale</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The application data is one of the most precious assets that we have. And for a long time, there wasn&#x27;t any question about where we are going to put this data. The RDBMS was the only game in town. The initial drive away    from the RDBMS was indeed driven by the need to scale. But that was just the original impetuous to start developing the NoSQL solutions. Once those solutions came into being and matured, it isn&#x27;t just the &quot;we need web-scale&quot; players    that benefited.   Proven &amp; Mature NoSQL solutions aren&#x27;t applicable just at high end of scaling. NoSQL solutions provide a lot of benefits even for applications that will never need to scale higher than a single machine. Document databases drastically   simplify things like user defined fields, or working with Aggregates. The performance of a NoSQL solution can often exceed a comparable RDBMS solution, because the NoSQL solution will usually focus on a very small subset of the     featureset that RDMBS has.</p>
        </article>
        <article id="article-5300">
            <a href="https://ayende.com/blog/4649/linq-queries-with-ravendb" target="_blank">
                <h2 class="title mb-6" id="article-5300">Linq queries with RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">People seems to be puzzled by my post about ad-hoc queries with RavenDB, that is mostly because I posted code from the very early experiments.   Basically, the main problem with supporting arbitrary Linq queries with RavenDB is outline in this post, since I have to compile a Linq query to an assembly, and since assemblies can&#x2019;t be unloaded (we aren&#x2019;t talking about dynamic assemblies, which can) except by unloading the whole app domain. That meant that supporting arbitrary Linq queries is essentially opening up a memory leak, which is why we didn&#x2019;t implement it for a long time.  But the feature was so&#x2026; shiny that I really couldn&#x2019;t let it go. I tried testing it with serializing the data from storage over app domain boundary, but that turned out to be prohibitive from a performance perspective. Then it occurred to me that if Mohammad can&#x27;t go to the mountain, let the mountain come to Mohammad.  RavenDB uses Esent under the covers to handle storage. That means that the storage itself doesn&#x2019;t really care for app domains, since it isn&#x27;t managed code. Once I had that idea, it was very simple to write the rest of the code that setup querying in a separate app domain and would tear it down once memory usage became too high.     Note that the purpose of this feature is mainly for testing / exporting / migrating data.    The code in the previous post was the very first attempt to prove that this can be done. This is how it looks like in practice:     [Fact]&#xA;public void CanPerformQueryToSelectSingleItem()&#xA;{&#xA;    db.Put(&quot;ayende&quot;, null, JObject.FromObject(new {Name = &quot;Ayende&quot;}), new JObject(), null);&#xA;    &#xA;    var result = db.ExecuteQueryUsingLinearSearch(new LinearQuery&#xA;    {&#xA;        Query = &quot;from doc in docs select new { doc.Name }&quot;&#xA;    });&#xA;&#xA;    Assert.Empty(result.Errors);&#xA;    Assert.Equal(@&quot;{&quot;&quot;Name&quot;&quot;:&quot;&quot;Ayende&quot;&quot;,&quot;&quot;__document_id&quot;&quot;:&quot;&quot;ayende&quot;&quot;}&quot;, result.Results[0].ToString(Formatting.None));&#xA;}&#xA;  &#xA;&#xA;We also integrated that into the HTTP API and WebUI, including all the usual taxes such as error handling, paging, etc.&#xA;&#xA;What about the name? ExecuteQueryUsingLinearSearch is a pretty hefty method name. That is quite intentional. While most queries in RavenDB are done using indexes, this performs a linear search across all documents. The performance in O(N), so this isn&#x2019;t really something that you want to run in production (in the same sense that you don&#x2019;t want table scans in production RDBMS).</p>
        </article>
        <div class="button flex justify-between">
            <a href="529.html"><span class="back arrow"></span></a>

            <a href="531.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
