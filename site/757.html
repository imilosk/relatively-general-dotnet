
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 757 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-7561">
            <a href="https://ayende.com/blog/2782/line-count-complexity" target="_blank">
                <h2 class="title mb-6" id="article-7561">Line count &amp; complexity</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Dave Laribee&#xA0;is talking about measuring line counts and code quality. He mentions that in the Ruby&#x27;s community is is considered a value to express yourself in fewer lines of code. Recently I had to do some statistics over my project, and I was astonished to discover that it was closing rapidly to the 150,000 lines of code. That made me wonder what another project line count was, I was pretty sure that it would be closer to half a million lines of code, but I was floored when I discovered that it barely reached the 30,000 lines of code. There is no comparison between the ease of working with both projects. The bigger one is a pleasure to work with, and the smaller is just plain hard. I was the main developer of the small project, and I have learn a lot from it (what not to do :-) ). I don&#x27;t think that a lower line count is really meaningful, unless you also have the context of how it is used. Here is another example, Rhino Mocks is at about ~25,000 lines of code, most of those are tests, the core library is about 10,000 lines, but only 4,801 lines of code (vs. xml comments, etc). To compare to that, I just check the most complex use case in my application, which is composed out of the following:  Controller: 400  Controller Finders: 531  Code Behind: 479  ASPX: 1,261 (roughly 500 of those are javascript) So a bit over 2,600 lines of code (not including infrastructure), for a single use case.&#xA0;  It is also the Murphy Zone in the application, the one we would rather not touch (it is about five times as large as any of the other use cases), because it touches so many other things. (And naturally, we had to fix a bug there yesterday :-), not liking to touch and afraid to of touching are two different things). So, I don&#x27;t want to agree with lower LOC is a good thing, and I do want to be more expressive when I write the code. I am not sure where it puts me. But I do know that the end result is that we want to be able to get simple code at all costs. (Not stupid code, simple code.) This means that reducing line count should be accompanied with increase in the code clarity. At any rate, just a bit of my own experience in this debate.</p>
        </article>
        <article id="article-7562">
            <a href="https://ayende.com/blog/2781/per-application-database" target="_blank">
                <h2 class="title mb-6" id="article-7562">Per Application Database</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Scott Bellware&#xA0;is talking about application embedded databases, an application that is the sole domain of the application that is using it. I don&#x27;t like the term, because embedded databases have another meaning, but I fully support the idea that the database should be an implementation detail of the applications. I had a project where we needed to use an existing database, and I want to cry when I think about the length and breath of of effort that we had to go through to get it to really work. In the last project, I have had at one time to change the DB password daily, to keep [Some Other Party] from trying to integrate with the application through the database. (In the end, we create a separate database, just for them, and they integrate through it). The problems with per application databases are silos and getting the data out to other applications. This bring us back to the data outlives the application, etc. I have a longer post in the pipeline that is going to talk about that.</p>
        </article>
        <article id="article-7563">
            <a href="https://ayende.com/blog/2780/generated-code-quality" target="_blank">
                <h2 class="title mb-6" id="article-7563">Generated Code Quality</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Jeremy Miller&#xA0;made the mistake of opening the DataSet.Designer.cs file&#xA0;and got:  You know the orange bars that ReSharper puts into the vertical scroll bar to denote warnings in the code?&#xA0; In the DataSet code it looked like a solid bar of orange sherbert.&#xA0; The discussion in the comments is about the quality of generated code, and it is fairly interesting. As someone who does quite a bit with code generation, I wanted to note two things:  The quality of the generated code is the result of the generator, with the qualification that the generated code may be used to off load nasty parts of the code base. The code generated by NHQG is doing some really crazy stuff with generics and operator overloading, and it is something that can get very hairy very fast. The other issue is that the use of CodeDOM means that you are often specifying redundant things. In this case, this this.myName and the fully qualified namespaces could go away, and this is something that ReSharper detects and warns against. public virtual Query_Post&lt;T1&gt; With() {&#xA;&#x9;Query_Post&lt;T1&gt; query = new Query_Post&lt;T1&gt;(this, this.myName, this.associationPath);&#xA;&#x9;query.joinType = NHibernate.SqlCommand.JoinType.InnerJoin;&#xA;&#x9;query.fetchMode = NHibernate.FetchMode.Default;&#xA;&#x9;return query;&#xA;}&#xA;It is not code generation in general that is problematic, in my view, it is the use of code generation to cover problems with the underlying platform that is usually what is causing the pain.</p>
        </article>
        <article id="article-7564">
            <a href="https://ayende.com/blog/2779/a-most-applicable-approach-to-the-fertilizer-pattern" target="_blank">
                <h2 class="title mb-6" id="article-7564">A most applicable approach to the Fertilizer pattern</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I recently had a chance to go through several legacy applications, bug spotting in one and evaluating the possibilities of code reuse in another. Stuff like &quot;a most applicable approach to the Fertilizer pattern&quot; began to run on my head as I read it, and at one point I had to go away to be able to curse in private (there were ladies present). Some of the things that I run into (across all the applications):  Goto inside a grid implementation, after a little fact finding, it was discovered that they lost the original source, and just copy / pasted the result of Reflector&#x27;s de-compilation and moved on. SQL Injection problems in stored procedures that were found by reading the documentation. Naming convention like bo_showinui, id_file, nm_folder, tx_folderpath We fixed the bug (which made me learn some stuff about double hop windows authentication and citrix, of all the things in the world, and we will not be reusing the code. In retrospect, I should have known, everyone else went to the far side of the room when I started reading the code...</p>
        </article>
        <article id="article-7565">
            <a href="https://ayende.com/blog/2778/refactoring-monorail-views" target="_blank">
                <h2 class="title mb-6" id="article-7565">Refactoring MonoRail Views</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 20, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">As I mentioned, I build a very quick &amp; dirty solution to display a collection of scheduled task descriptions. The end result looked like this:  This works, and it should start producing value as of next week, but I didn&#x27;t really like the way I built it. Here is the original view code: &lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;&#xA;&#x9;&lt;thead&gt;&#xA;&#x9;&#x9;&lt;tr&gt;&#xA;&#x9;&#x9;&#x9;&lt;th&gt;&#xA;&#x9;&#x9;&#x9;&#x9;Name:&lt;/th&gt;&#xA;&#x9;&#x9;&#x9;&lt;th&gt;&#xA;&#x9;&#x9;&#x9;&#x9;Occurances&lt;/th&gt;&#xA;&#x9;&#x9;&#x9;&lt;th&gt;&#xA;&#x9;&#x9;&#x9;&#x9;&amp;nbsp;&lt;/th&gt;&#xA;&#x9;&#x9;&lt;/tr&gt;&#xA;&#x9;&lt;/thead&gt;&#xA;&#x9;&lt;tbody&gt;&#xA;&#x9;&#x9;&lt;% for task in tasks: %&gt;&#xA;&#x9;&#x9;&lt;tr&gt;&#xA;&#x9;&#x9;&#x9;&lt;td&gt;&#xA;&#x9;&#x9;&#x9;${Text.PascalCaseToWord(task.Name)}&#xA;&#x9;&#x9;&#x9;&lt;/td&gt;&#xA;&#x9;&#x9;&#x9;&lt;td&gt;&#xA;&#x9;&#x9;&#x9;Every ${task.OccuranceEvery}&#xA;&#x9;&#x9;&#x9;&lt;/td&gt;&#xA;&#x9;&#x9;&#x9;&lt;td&gt;&#xA;&#x9;&#x9;&#x9;${Html.LinkTo(&quot;Execute&quot;, &quot;ScheduledTasks&quot;, &quot;Execute&quot;, task.FullName)}&#xA;&#x9;&#x9;&#x9;&lt;/td&gt;&#xA;&#x9;&#x9;&lt;/tr&gt;&#xA;&#x9;&#x9;&lt;% end %&gt;&#xA;&#x9;&lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;This work, it is simple and easy to understand, but it still bothered me. So I replaced it with this:&#xA;&lt;% component SmartGrid, {@source: tasks}  %&gt;&#xA;&#xA;Well, that was much shorter, but the result was this...&#xA; &#xA;I am cropping things, because it is a fairly long picture, but it should be clear that this is not a really nice UI to use.&#xA;This was my second attempt;&#xA;&lt;% component SmartGrid, {@source: tasks, @columns: [@Name, @OccuranceEvery] }  %&gt;&#xA;&#xA;And it produced this:&#xA; &#xA;Better, but not really that much, let us try to have nicer names there, shall we?&#xA;&lt;% &#xA;component SmartGrid, {@source: tasks, @columns: [@Name, @OccuranceEvery] }:  &#xA;&#x9;section Name:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;td&gt;${Text.PascalCaseToWord(value)}&lt;/td&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;end&#xA;%&gt;&#xA;And this produced:&#xA; &#xA;That is much better on the name side, but we still have the &quot;Occurance Every&quot; column to fix...&#xA;&lt;% &#xA;component SmartGrid, {@source: tasks, @columns: [@Name, @OccuranceEvery] }:  &#xA;&#x9;section OccuranceEveryHeader:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;th&gt;Occurances&lt;/th&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;&#x9;section Name:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;td&gt;${Text.PascalCaseToWord(value)}&lt;/td&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;&#x9;section OccuranceEvery:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;td&gt;Every ${value}&lt;/td&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;end&#xA;%&gt;&#xA;With the result being:&#xA; &#xA;One last thing that we have left is the additional column at the end, we can manage it like this:&#xA;&lt;% &#xA;component SmartGrid, {@source: tasks, @columns: [@Name, @OccuranceEvery] }:  &#xA;&#x9;section OccuranceEveryHeader:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;th&gt;Occurances&lt;/th&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;&#x9;section MoreHeader:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;th&gt;&lt;/th&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;&#x9;section Name:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;td&gt;${Text.PascalCaseToWord(value)}&lt;/td&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;&#x9;section OccuranceEvery:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;td&gt;Every ${value}&lt;/td&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;&#x9;section More:&#xA;&#x9;%&gt;&#xA;&#x9;&lt;td&gt;${Html.LinkTo(&quot;Execute&quot;, &quot;ScheduledTasks&quot;, &quot;Execute&quot;, item.FullName)}&lt;/td&gt;&#xA;&#x9;&lt;%&#xA;&#x9;end&#xA;end&#xA;%&gt;&#xA;&#xA;So here is the final result:&#xA; &#xA;Now that I did that, I am looking at both pieces of code and wondering:&#xA;&#xA;What is the fuss about, anyway?&#xA;Which of those versions is more readable?&#xA;Granted, this is a fairly specialized case, but in terms of LoC, the second approach is actually longer, and the &quot;major&quot; benefit here is that I&#xA0;get less HTML in the view, but that is not a really major consideration.&#xA;The SmartGrid would produce a pager if needed, but that about it with regards to the differences in their abilities.</p>
        </article>
        <article id="article-7566">
            <a href="https://ayende.com/blog/2777/convention-over-configuration-structured-approach" target="_blank">
                <h2 class="title mb-6" id="article-7566">Convention over configuration: Structured approach</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 20, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Hammett has a post that made me think. He is talking about configuring Spring for Java and has this to comment:  I can&#x2019;t understand this uncontrolled passion that java programmers carry for xml. I can certainly agree with him about that, but I got to the same point a long time ago with Windsor. I had an application which was rife with components. I am talking about many dozens of generic (as in MyComponent&lt;T&gt;) components, all of which required registration in the config file, which got to be fairly annoying very fast. I solved that by creating Binsor, a Boo DSL for configuring an IoC container. Initially, it was very similar to the Batch Registration Facility, but I pushed it much further, until today I do all my Windsor configuration using Windsor.boo, and its existence is a core part of my application architecture. Why? Because I can do things like this: controllersAssemblies = (Assembly.Load(&quot;MyApp.Web&quot;), Assembly.Load(&quot;Castle.MonoRail.ViewComponents&quot;) )&#xA;for asm in controllersAssemblies:&#xA;&#x9;for type in asm.GetTypes():&#xA;&#x9;&#x9;continue if type.Name == &quot;ScheduledTasksController&quot;&#xA;&#x9;&#x9;if typeof(Controller).IsAssignableFrom(type):&#xA;&#x9;&#x9;&#x9;IoC.Container.AddComponent(type.FullName, type)&#xA;&#x9;&#x9;if not typeof(ViewComponent).IsAssignableFrom(type):&#xA;&#x9;&#x9;&#x9;IoC.Container.AddComponent(type.Name, type)&#xA;The immediate result of this type of behavior is that I don&#x27;t have any weight of the IoC, I just develop as I would normally would, and it catches up with everything that it needs to handle.&#xA;I recently had the chance to maintain a MonoRail application that used XML for configuring Windsor, and by the third time that I added a controller, I was pretty annoyed. Each and every time, I had an additional step to perform before I could run the code. Compared to the approach that I was using, it was hardly zero friction.&#xA;&#xA;Of course, my approach is not flawless in any mean, there is a bug in the configuration above, can you spot it?&#xA;The point of this post, which I have been trying to get to for a while, while random electrical pulses moved my fingers in interesting ways, is that I have began not only to use this to a great extent (all projects in the last year or so are based on this idea), but I have started to actually design with this in mind.&#xA;The end result right now is that I am relying a lot more on commands patterns and attributes for selections. This means that I often do things like:&#xA;[SelectionCriteria(Selection.FirstOption, Selection.SecondOption)]&#xA;public void SomeSpecficCommand : Command&lt;ObjectActingUpon&gt;&#xA;{&#xA;&#x9;public override void Execute()&#xA;&#x9;{&#xA;&#x9;}&#xA;}&#xA;&#xA;You can see a more real world sample here, but the idea is to declaratively express the intent, have the configuration figure out what I want, and make it happen. The nice thing, most of the time, It Just Works. And the nice thing about utilizing Binsor is that I can adapt the convention very easily. So I can have many nice conventions, each for a particular situation.</p>
        </article>
        <article id="article-7567">
            <a href="https://ayende.com/blog/2776/development-platforms-again" target="_blank">
                <h2 class="title mb-6" id="article-7567">Development Platforms, again</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 20, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Jeffery Pallermo&#xA0;commented about the applicability of SharePoint as a development platform, the conversation in the comments is fantastic. Sahil Malik&#xA0;replied to that in a post that says that SharePoint is a terrific development platform. I want to go through Sahil&#x27;s points for a moment:  I haven&#x27;t ever walked into a shop with a home grown ASP.NET app that was any easier to install than sharepoint is. Here are the steps to install (on a bare bone server) my current project:  Prerequisites:  IIS .Net&#xA0;2.0 &#x2B; 3.0 SQL Server DB&#xA0;&#xA0; Steps:  Open cmd.exe \\storage\tools\subversion\svn&#xA0;co svn://subversion/MyProject/trunk MyProject msbuild default.build /p:ConnectionString=&quot;database connection string&quot; /p:RebuildDatabase=True The whole thing takes about ten minutes, and that is from scratch. From a built environment, we can push an update by just executing the last command, and waiting for about 2 minutes. At last count I had four different environments that I had bumping around. Then there is the great fallacy of configuration by the UI:  You can configure the entire thing through a browser based UI. What else do ya want? Well, source control would be a nice thing to have, as well as a way to do search / replace on the configuration, as well as a way to quickly scan through everything that was done in the last three days and see what happened there. One thing that I really don&#x27;t agree with Jeffery is the XP/Vista limitations. I am running Win2003 on all my machines, from the production servers to the workstations to the laptop, and it has been more than pleasurable enough. There really isn&#x27;t any difference as far as I care. You might want to check my criteria for evaluating a development platform. A lot of the people on Jeffery&#x27;s comments thread repeated the ability to do anything in Share Point. The problem I have with that statement is the relative cost of doing it in and outside of the platform. And the platform fails as a development platform if it is significantly harder to do it under the platform than outside it.</p>
        </article>
        <article id="article-7568">
            <a href="https://ayende.com/blog/2775/scheduled-tasks-in-monorail-the-quick-dirty-solution" target="_blank">
                <h2 class="title mb-6" id="article-7568">Scheduled Tasks in MonoRail: The Quick &amp; Dirty solution</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 20, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I need to develop a set of tasks that would run in internals. Now, we need to do several dozens of those, and at that point, it is not important how we actually schedule them, we can defer that decision. But we really need to be able to start develop them soon. So,&#xA0;I came up with this idea. The basic structure is this:  [OccuresEvery(Occurances.Day)]&#xA;public class SendBirthdayEmails : ScheduledTask&#xA;{&#xA;&#x9;public override void Execute()&#xA;&#x9;{&#xA;&#x9;&#x9;foreach(Employee emp in Repository&lt;Employee&gt;.FindAll(Where.Employee.Birthday == DateTime.Today)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Email&#xA;&#x9;&#x9;&#x9;&#x9;.From(Settings.Default.HumanResourcesEmail)&#xA;&#x9;&#x9;&#x9;&#x9;.To(emp.Email)&#xA;&#x9;&#x9;&#x9;&#x9;.Template(Templates.Email)&#xA;&#x9;&#x9;&#x9;&#x9;.Parameter(&quot;employee&quot;, emp)&#xA;&#x9;&#x9;&#x9;.Send();&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;&#xA;This is not really interesting, but the rest is. Remember that I don&#x27;t want to deal with deciding how to actually schedule them, but we need to be able to run them right now for test / debug&#xA0;/ demo purposes.&#xA;In my windsor.boo:&#xA;//Controllers&#xA;controllersAssembly = Assembly.Load(&quot;MyApp.Web&quot;)&#xA;for type in controllersAssembly.GetTypes():&#xA;&#x9;continue if type.Name == &quot;ScheduledTasksController&quot;&#xA;&#x9;continue if not typeof(Controller).IsAssignableFrom(type)&#xA;&#x9;IoC.Container.AddComponent(type.FullName, type)&#xA;&#xA;//register scheduled tasks&#xA;scheduledTasksAssembly = Assembly.Load(&quot;MyApp.ScheduledTasks&quot;)&#xA;scheduledTasks = []&#xA;for type in scheduledTasksAssembly.GetTypes():&#xA;&#x9;continue if not typeof(ScheduledTask).IsAssignableFrom(type)&#xA;&#x9;IoC.Container.AddComponent(type.FullName, type)&#xA;&#x9;scheduledTasks.Add(type)&#xA;//register scheduled tasks controller independently, since it requires special configuration &#xA;Component(&quot;ScheduledTasksController&quot;, ScheduledTasksController,&#xA;&#x9;scheduledTasks: scheduledTasks.ToArray(Type) )&#xA;So it will automatically scan the scheduled tasks assembly, and the only thing that I have left is to write the ScheduledTasksController. This is a very simple one:&#xA; &#xA;It has just two methods, one to list all the tasks, and the second to execute them. This is strictly a dev only part of the application, so I took most of the available shortcuts that I could. So the UI looks like this:&#xA; &#xA;And the view code is:&#xA;&#xA;&lt;% for task in tasks: %&gt;&#xA;&lt;tr&gt;&#xA;&#x9;&lt;td&gt;&#xA;&#x9;${Text.PascalCaseToWord(task.Name)}&#xA;&#x9;&lt;/td&gt;&#xA;&#x9;&lt;td&gt;&#xA;&#x9;Every ${task.OccuranceEvery}&#xA;&#x9;&lt;/td&gt;&#xA;&#x9;&lt;td&gt;&#xA;&#x9;${Html.LinkTo(&quot;Execute&quot;, &quot;ScheduledTasks&quot;, &quot;Execute&quot;, task.FullName)}&#xA;&#x9;&lt;/td&gt;&#xA;&lt;/tr&gt;&#xA;&lt;% end %&gt;&#xA;&#xA;I really like the PascalCaseToWord helper, really nice.&#xA;On the controller&#x27;s side of things, I have this:&#xA;public ScheduledTasksController(Type[] scheduledTasks)&#xA;{&#xA;&#x9;scheduledTaskDescriptions = new ScheduledTaskDescription[scheduledTasks.Length];&#xA;&#x9;for (int i = 0; i &lt; scheduledTasks.Length; i&#x2B;&#x2B;)&#xA;&#x9;{&#xA;&#x9;&#x9;scheduledTaskDescriptions[i] = new ScheduledTaskDescription(scheduledTasks[i]);&#xA;&#x9;}&#xA;}&#xA;&#xA;public void Index()&#xA;{&#xA;&#x9;PropertyBag[&quot;tasks&quot;] = scheduledTaskDescriptions;&#xA;}&#xA;&#xA;Not a best practice code, but I did knock the whole thing very quickly. ScheduledTaskDescription just takes a type and unpack it in terms of attributes, name, etc.&#xA;The end result is that the other developers on my team can add a new scheduled task by simply adding a class that inherits from ScheduledTask, go to the browser, hit F5 and start executing it.&#xA;Now that is RAD.</p>
        </article>
        <article id="article-7569">
            <a href="https://ayende.com/blog/2774/employee-communication-dsl" target="_blank">
                <h2 class="title mb-6" id="article-7569">Employee Communication DSL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 20, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We have a client that is a Pro Microsoft big time. We are constantly running into SSIS issues at their end, and it has gotten to the point where I am willing to rewrite the entire ETL process from scratch, and I am quite certain that it will take me far less than it would on any other way. Here is my boss&#x27; reply to the suggestion to use Rhino ETL:  If boo in configuration &#xA0;&#xA0; Explain to {John, Jane} onEach(day: is(Monday) ) If ETL in DataLoader &#xA0; While(true) &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Explain() You meant going back to using SQL jobs &#x2B; stored procedures, right? In this case, SP and plain old SQL would do the trick, so that is indeed the direction we are going to take, but I was literally floored by the DSL. * BTW, I feel mean because it bothers me that the If and the While are capitalized.</p>
        </article>
        <article id="article-7570">
            <a href="https://ayende.com/blog/2773/microsoft-connect-redefining-bugs-as-features-as-a-standard-operation-procedure" target="_blank">
                <h2 class="title mb-6" id="article-7570">Microsoft Connect</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: September 18, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This&#xA0;and this&#xA0;bugs are really pissing me off. Both those bugs are related to the same source, and one of them was originally a Rhino Mocks issue. They both&#xA0; stems from the CLR runtime bugs.&#xA0; Basically, trying to inherit from a generic interface with generic method parameters that has constraints causes the runtime to puke with a TypeLoadException.  I am not one to cry that select() is broken, but in this case, it most certainly is. It is verified using both the C# compiler and Reflection.Emit, so it is definitely a runtime bug. The really annoying parts that they were acknowledged and verified as bugs by Microsoft, and then closed By Design.&#xA0; No communication whatsoever about the reasoning for that, just the customary &quot;By Design&quot; response that I have seen all too often in the past. I personally have had to track down the root cause when it was first submitted to me as a Rhino Mocks bug. If this is a By Design bug, then either the design is broken, or we deserve a lot more information about this, because no way your turn this, it should be legal to do this. As you can probably tell, I am very angry about this, not the least because I spent many hours with it before admitting that it was a runtime bug that I had no way around. I am pretty sure that some of the bugs in connect are resolved to their reporters satisfactions, I just have to meet such a thing.</p>
        </article>
        <div class="button flex justify-between">
            <a href="756.html"><span class="back arrow"></span></a>

            <a href="758.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
