
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 191 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-1901">
            <a href="https://ayende.com/blog/186369-C/workflow-design-what-you-shouldnt-be-looking-for" target="_blank">
                <h2 class="title mb-6" id="article-1901">Workflow design</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 27, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the most common themes I run into when talking to customers, users and sundry people in tech is the repeated desire to fire developers.Actually, that is probably too loaded a statement. It actually come in two parts:Developers usually want to focus on the interesting bits, and the business logic portions aren&#x2019;t that much fun.The business analysts usually want to get things done and having to get developers to do that is considered inefficient.If only there was a tool, or a pattern, or a framework, or something that would allow the business analysts to directly specify the behavior of the system&#x2026; Why, we could cut the developers from the process entirely! And speaking as a developer, that would be a huge relief. I think the original name for that was CASE tools, and that flopped. In fact, literally every single one of the attempts to replace developers by a tool has flopped. They got such a bad rap that people keep trying to implement them using different names. Some stuff can be done fairly easily, though. WYSIWYG for GUI is well established and Wordpress and WIX, to name the two examples that come to mind immediately, show that you can have a non techie build a proper website. In fact, you can even plug in some pretty sophisticated functionality without burdening the user with too much. But all that takes you to a point. And past that point, the drop off is harsh. Let&#x2019;s take another common tool that is used to reduce the dependency on developers, SharePoint. SharePoint hourly rate: $ 48.3C# hourly rate: $28.6You pay close to double for actual developer time on SharePoint, mostly because it is so painful to work with it.In a recent conference, I got into a conversation about business workflows and how to best implement them. You can look at the image on the right to get a good idea about what kind of process they were talking about.To make things real, I want to take a &#x201C;simple&#x201D; example, of accepting a life insurance policy. Here is what the (extremely simplified) workflow looks like for issuing a life insurance policy:This looks good, and it certainly should make sense to a business analyst. However, even after I pretty much reduced the process to its bare bones and even those has been filed away, this is still pretty complex. The process of actually getting a policy is actually a lot more complex. Some questions don&#x2019;t require doctor evaluation (for example, smoking) and some require supplemental documentation (oh, you were hospitalized? Gimme all these records). The doctor may recommend different rates, rejecting entirely, some exceptions in the policy, etc. All of which need to be in the workflow. Actuarial tables needs to be consulted for each of those cases, etc, etc, etc.But something like the diagram above isn&#x2019;t going to be able to handle this level of complexity. You are going to get lost very quickly if you try to put so many boxes on the screen.So you need encapsulation.And you&#x2019;ll probably want to have a way to develop these business workflows, which means that they aren&#x2019;t static. So you need source control.And if you have a complex business process, you likely have different people working on it.So you need to be able to review changes, and merge them. Note that this is explicitly distinct from being able to store the data in source control. Being able to actually diff in a meaningful fashion two versions of such a process is anything but trivial. Usually you are left with diffing the raw XML / JSON that store the structure. Good luck with that.If the workflow is complex, you need to be able to understand what is going on under various conditions.So you need a debugger.In fact, pretty soon you&#x2019;ll realize that you&#x2019;ll need quite a lot of the things that developers do. Except that your tool of choice doesn&#x2019;t do that, or if they do, they do it poorly.Another issue that even if you somehow managed to bypass all of those details, you are going to be facing the same drop that you see elsewhere with tools that attempt to get rid of developers. At some point, the complexity grows too large, and you&#x2019;ll call your development team and hand of the system to them. At which point they will be stack with a very clucky tool that attempt to be quite clever and easy to use. It is also horribly limiting for a developer. Mostly because all of the &#x201C;complexity&#x201D; involved is in the business process itself, not in the actual complexity of what is going on.There are better ways of handling that, and the easier among them is to just use code. That can be&#x2026; surprisingly versatile.</p>
        </article>
        <article id="article-1902">
            <a href="https://www.stevejgordon.co.uk/early-look-at-grpc-using-aspnet-core-3" target="_blank">
                <h2 class="title mb-6" id="article-1902">An Early Look at gRPC and ASP.NET Core 3.0</h2>
            </a>
            <p class="mb-2">by Steve Gordon</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 26, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post, I want to introduce my very early experience (after a few hours of experimentation) of gRPC and ASP.NET Core 3.0. I&#x2019;ve conducted some experiments as part of our quarterly Madgex hack day. This will be an introductory post so I don&#x2019;t expect to show everything in fine detail. This is intended to [&#x2026;]</p>
        </article>
        <article id="article-1903">
            <a href="https://ayende.com/blog/186337-C/bug-of-the-day" target="_blank">
                <h2 class="title mb-6" id="article-1903">Bug of the day</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 26, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This one was in an experimental feature, as part of the extra testing process of making this into a stable feature, we run into a bug.Here is the bug fix:The code is meant to detect changes in a distributed environment and we checked the wrong location, meaning that we never actually did the check. In 99.999% of the time, this already happened, but it exposed us to some nasty race conditions.This particular piece of code has been the subject to multiple code reviews, all of which never noticed the issue.</p>
        </article>
        <article id="article-1904">
            <a href="https://andrewlock.net/creating-my-first-github-app-with-probot-part-2-creating-the-auto-assign-issues-bot/" target="_blank">
                <h2 class="title mb-6" id="article-1904">Creating the auto-assign-issues bot</h2>
            </a>
            <p class="mb-2">by Andrew Lock</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 26, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Creating my first GitHub app with Probot - Part 2</p>
        </article>
        <article id="article-1905">
            <a href="https://www.stevejgordon.co.uk/an-introduction-to-optimising-code-using-span-t" target="_blank">
                <h2 class="title mb-6" id="article-1905">An Introduction to Optimising Code Using Span&lt;T&gt;</h2>
            </a>
            <p class="mb-2">by Steve Gordon</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 25, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post continues my series about writing high-performance C# code. In this post, we&#x2019;ll continue from the last two posts by introducing the Span&lt;T&gt; type and refactor some existing code by converting it to a Span-based version. We&#x2019;ll use Benchmark.NET to compare the methods and validate whether our changes have improved the code. If you [&#x2026;]</p>
        </article>
        <article id="article-1906">
            <a href="https://ayende.com/blog/186309-C/ravendb-customers-portal" target="_blank">
                <h2 class="title mb-6" id="article-1906">RavenDB Customers Portal</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 25, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I wanted to point out the RavenDB Customers Portal website, because it has a very important function that may not seem obvious.As part of the process of setting up RavenDB, we provide our users with a domain name so they can run their clusters securely. This is pretty easy and has been used by thousands of our users. However, advanced scenarios, such as adding a node to a cluster or changing a node IP required you to re-run the setup and weren&#x2019;t convenient. We have now made it even simpler, you can use the customers portal to edit your cluster DNS configuration.Here is how this looks like:This is available to customers who purchased a commercial license as well as users running on the community edition. As usual, we would love to get your feedback.</p>
        </article>
        <article id="article-1907">
            <a href="https://ayende.com/blog/186308-C/data-modeling-with-indexes-event-sourcing-part-iii-time-sensitive-data" target="_blank">
                <h2 class="title mb-6" id="article-1907">Data modeling with indexes</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 22, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I got a great comment on my previous post about using Map/Reduce indexes in RavenDB for event sourcing. The question was how to handle time sensitive events or ordered events in this manner. The simple answer is that you can&#x2019;t, RavenDB intentionally don&#x2019;t expose anything about the ordering of the documents to the index. In fact, given the distributed nature of RavenDB, even the notion of ordering documents by time become really hard. But before we close the question as &#x201C;cannot do that by design&quot;, let&#x2019;s see why we want to do something like that. Sometimes, this really is just the developer wanting to do things in the way they are used to and there is no need for actually enforcing the ordering of documents. But in other cases, you want to do this because there is a business meaning behind these events. In those cases, however, you need to handle several things that are a lot more complex than they appear. Because you may be informed of an event long after that actually happened, and you need to handle that. Our example for this post is going to be mortgage payments. This is a good example of a system where time matters. If you don&#x2019;t pay your payments on time, that matters. So let&#x2019;s see how we can model this as an event based system, shall we?A mortgage goes through several stages, but the only two that are of interest for us right now are:Approval &#x2013; when the terms of the loan are set (how much money, what is the collateral, the APR, etc).Withdrawal &#x2013; when money is actually withdrawn, which may happen in installments. Depending on the terms of the mortgage, we need to compute how much money should be paid on a monthly basis. This depend on a lot of factors, for example, if the principle is tied to some base line, changes to the base line will change the amount of the principle. If only some of the amount was withdrawn, if there are late fees, balloon payment, etc. Because of that, on a monthly basis, we are going to run a computation for the expected amount due for the next month. And, obviously, we have the actual payments that are being made. Here is what the (highly simplified) structure looks like:This includes all the details about the mortgage, how much was approved, the APR, etc.The following is what the expected amount to be paid looks like:And here we have the actual payment:All pretty much bare bones, but sufficient to explain what is going on here.With that in place, let&#x2019;s see how we can actually make use of it, shall we?Here are the expected payments:Here are the mortgage payments:The first thing we want to do is to aggregate the relevant operations on a monthly basis, since this is how mortgages usually work. I&#x2019;m going to use a map reduce index to do so, and as usual in this series of post, we&#x2019;ll use JavaScript indexes to do the deed.&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          map(&quot;PaymentExpected&quot;, event =&gt; {&#xA;        &#xA;        &#xA;          &#xA;             return {&#xA;        &#xA;        &#xA;          &#xA;                 Mortgage: event.Mortgage,&#xA;        &#xA;        &#xA;          &#xA;                 DueBy: event.DueBy.substring(0,7),&#xA;        &#xA;        &#xA;          &#xA;                 InterestDue: event.Interest,&#xA;        &#xA;        &#xA;          &#xA;                 PrincipleDue: event.Principle&#xA;        &#xA;        &#xA;          &#xA;             } &#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          map(&quot;MortgagePayment&quot;, event =&gt; {&#xA;        &#xA;        &#xA;          &#xA;             return {&#xA;        &#xA;        &#xA;          &#xA;                 Mortgage: event.Mortgage,&#xA;        &#xA;        &#xA;          &#xA;                 AmountPaid: event.Amount,&#xA;        &#xA;        &#xA;          &#xA;                 DueBy: event.DueBy.substring(0,7)&#xA;        &#xA;        &#xA;          &#xA;             } &#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          function normalize(r){&#xA;        &#xA;        &#xA;          &#xA;              return parseFloat(r.toFixed(3));&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          function sum(g, fetch){&#xA;        &#xA;        &#xA;          &#xA;              var r =  g.values.filter(x=&gt;fetch(x) != null)&#xA;        &#xA;        &#xA;          &#xA;                  .reduce((acc, val) =&gt; acc &#x2B; fetch(val, 2), 0);&#xA;        &#xA;        &#xA;          &#xA;              return normalize(r);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          groupBy(x=&gt;({Mortgage: x.Mortgage, DueBy: x.DueBy }))&#xA;        &#xA;        &#xA;          &#xA;              .aggregate(g=&gt;{&#xA;        &#xA;        &#xA;          &#xA;                 var interest = sum(g, x=&gt;x.InterestDue);&#xA;        &#xA;        &#xA;          &#xA;                 var principle = sum(g, x=&gt;x.PrincipleDue);&#xA;        &#xA;        &#xA;          &#xA;                 var amountPaid = sum(g, x =&gt; x.AmountPaid);&#xA;        &#xA;        &#xA;          &#xA;                 var interestRemaining = 0, principleRemaining = 0;&#xA;        &#xA;        &#xA;          &#xA;                 if (amountPaid &lt; interest) {&#xA;        &#xA;        &#xA;          &#xA;                      interestRemaining = normalize(interest - amountPaid);&#xA;        &#xA;        &#xA;          &#xA;                      principleRemaining = normalize(principle);&#xA;        &#xA;        &#xA;          &#xA;                 }&#xA;        &#xA;        &#xA;          &#xA;                 else {&#xA;        &#xA;        &#xA;          &#xA;                     principleRemaining =  normalize(principle - (amountPaid - interest));&#xA;        &#xA;        &#xA;          &#xA;                 }&#xA;        &#xA;        &#xA;          &#xA;                 &#xA;        &#xA;        &#xA;          &#xA;                 &#xA;        &#xA;        &#xA;          &#xA;                 return {&#xA;        &#xA;        &#xA;          &#xA;                     Mortgage: g.key.Mortgage,&#xA;        &#xA;        &#xA;          &#xA;                     DueBy: g.key.DueBy,&#xA;        &#xA;        &#xA;          &#xA;                     PrincipleDue: principle,&#xA;        &#xA;        &#xA;          &#xA;                     InterestDue: interest,&#xA;        &#xA;        &#xA;          &#xA;                     PrincipleRemaining: principleRemaining,&#xA;        &#xA;        &#xA;          &#xA;                     InterestRemaining: interestRemaining,&#xA;        &#xA;        &#xA;          &#xA;                     AmountPaid: amountPaid&#xA;        &#xA;        &#xA;          &#xA;                 } &#xA;        &#xA;        &#xA;          &#xA;              });&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          index.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;Unlike previous examples, now we have real business logic in the index. Most specifically, funds allocations for partial payments. If the amount of money paid is less than the expected amount, we first apply it to the interest, and only then to the principle.Here are the results of this index:You can clearly see that mistake that were made in the payments. On March, the amount due for the loan increased (took another installment from the mortgage) but the payments were made on the old amount. We aren&#x2019;t done yet, though. So far we have the status of the mortgage on a monthly basis, but we want to have a global view of the mortgage. In order to do that, we need to take a few steps. First, we need to define an Output Collection for the index, that will allow us to further process the results on this index.In order to compute the current status of the mortgage, we aggregate both the mortgage status over time and the amount paid by the bank for the mortgage, so we have the following index:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          map(&quot;MortgageMonthlyStatuses&quot;, status =&gt; {&#xA;        &#xA;        &#xA;          &#xA;             return {&#xA;        &#xA;        &#xA;          &#xA;                Mortgage: status.Mortgage,&#xA;        &#xA;        &#xA;          &#xA;                PrincipleRemaining: status.PrincipleRemaining,&#xA;        &#xA;        &#xA;          &#xA;                InterestRemaining: status.InterestRemaining,&#xA;        &#xA;        &#xA;          &#xA;                AmountPaid: status.AmountPaid,&#xA;        &#xA;        &#xA;          &#xA;                PastDue:  (status.PrincipleRemaining &#x2B; status.InterestRemaining) &gt; 0 ? 1 : 0&#xA;        &#xA;        &#xA;          &#xA;             };&#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          map(&quot;AmountPaid&quot;, amount =&gt; {&#xA;        &#xA;        &#xA;          &#xA;              return {&#xA;        &#xA;        &#xA;          &#xA;                 Amount: amount.Amount,&#xA;        &#xA;        &#xA;          &#xA;                 Mortgage: amount.Mortgage&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          groupBy(x=&gt;x.Mortgage)&#xA;        &#xA;        &#xA;          &#xA;              .aggregate(g =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                  return {&#xA;        &#xA;        &#xA;          &#xA;                    Mortgage: g.key,&#xA;        &#xA;        &#xA;          &#xA;                    PastDue: Math.max(0, sum(g, x=&gt;x.PastDue) - 1),&#xA;        &#xA;        &#xA;          &#xA;                    Amount: sum(g, x=&gt;x.Amount),&#xA;        &#xA;        &#xA;          &#xA;                    PrincipleRemaining: sum(g, x=&gt;x.PrincipleRemaining),&#xA;        &#xA;        &#xA;          &#xA;                    InterestRemaining: sum(g, x=&gt;x.InterestRemaining)&#xA;        &#xA;        &#xA;          &#xA;                  };&#xA;        &#xA;        &#xA;          &#xA;              });&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          index2.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;Which gives us the following output:As you can see, we have a PastDue marker on the loan. At this point, we can make another payment on the mortgage, to close the missing amount, like so:This will update the monthly mortgage status and then the overall status. Of course, in a real system (I mentioned this is highly simplified, right?) we&#x2019;ll need to take into account payments made in one time but applied to different times (which we can handle by an AppliedTo property) and a lot of the actual core logic isn&#x2019;t in indexes. Please don&#x2019;t do mortgage logic in RavenDB indexes, that stuff deserve its own handling, in your own code. And most certainly don&#x2019;t do that in JavaScript. The idea behind this post is to explore how we can handle non trivial event projection using RavenDB. The example was chosen because I assume most people will be familiar with it and it wasn&#x2019;t immediately obvious how to go about actually solving it.If you want to play with this, you can import the following file (Settings &gt; Import Data) to get the documents and index definitions.</p>
        </article>
        <article id="article-1908">
            <a href="https://www.stevejgordon.co.uk/httpclient-creation-and-disposal-internals-should-i-dispose-of-httpclient" target="_blank">
                <h2 class="title mb-6" id="article-1908">HttpClient Creation and Disposal Internals: Should I Dispose of HttpClient?</h2>
            </a>
            <p class="mb-2">by Steve Gordon</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 21, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A common question that I get asked quite often and a point of reasonable confusion for developers is&#xA0;&#x201C;Should I dispose of HttpClient or not?&#x201D; There isn&#x2019;t one yes or no answer to this. It really does depend on a few key factors. In this post, I&#x2019;ll try to answer this question with enough code snippets [&#x2026;]</p>
        </article>
        <article id="article-1909">
            <a href="https://ayende.com/blog/186307-C/the-first-database-i-ever-built-20-years-ago" target="_blank">
                <h2 class="title mb-6" id="article-1909">The first database I ever built (20 years ago)</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 21, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I was reminiscing about some old code that I wrote a long while ago, in the heyday of ASP and when the dotcom bubble was just starting to inflate. At the time, I was either still at high school or just graduated and I was fascinated by the ability to write web applications. I wrote quite a few of them, as I recall. Thankfully, none of them ever made it to this day and age. I remember one project in particular that I was quite proud of. I wrote a bunch of BBS / forum systems. One version used an Access file as the database. IIRC, that is literally how I learned SQL for the first time. The other BBS system is what I&#x2019;m here to talk about today. You couldn&#x2019;t always get Access, and having it installed on the server was PITA. Especially given that I was pretty much limited to hosts that offered free hosting only. So I decided to write a BBS system that had no dependencies whatsoever and can be deployed on any host that could handle ASP. Note that this is ASP classic, .NET is still 2 years away from alpha status at this time and Java is for applets. I decided that I would write everything through file I/O, but that was quite complex. I needed something that would help me out. Then I realized that I could use ASP itself to help me. Instead of having to pull data at runtime from a file, parse it, process it and so on, I could lean on ASP itself for that.Trigger warning: This code is newly written, but I still remember the shape of it quite well. This may cause you seizures. For the full beauty of this piece of code, you need to consider that this is a very small piece of a much larger codebase (all in a single file, of course) but it is a very much a reprehensive representative example. &#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          Select Case Request.QueryString(&quot;op&quot;)&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          Case Nothing&#xA;        &#xA;        &#xA;          &#xA;              &#x27; Nothing to do, render directly&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          Case &quot;Post&quot;&#xA;        &#xA;        &#xA;          &#xA;              &#x27; handle adding a post&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              &#x27; 1000s of lines here and several dozen cases&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          Case &quot;comment&quot;&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              Dim fs, f, data&#xA;        &#xA;        &#xA;          &#xA;              Set fs = Server.CreateObject(&quot;Scripting.FileSystemObject&quot;)&#xA;        &#xA;        &#xA;          &#xA;              Set f = fs.OpenTextFile(Server.MapPath(&quot;forum.asp&quot;), 1)&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              data = f.ReadAll&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              data = Replace(data, _&#xA;        &#xA;        &#xA;          &#xA;                  &quot;&lt;!-- post-&quot; &amp; Request.QueryString(&quot;post&quot;) &amp; &quot;-comment --&gt;&quot;, _&#xA;        &#xA;        &#xA;          &#xA;                  &quot;&lt;tr&gt;&lt;td&gt;&quot; &amp; Request.QueryString(&quot;user_id&quot;) &amp; &quot;&lt;/td&gt;&lt;td&gt;&quot; &amp; Server.HTMLEncode(Request.QueryString(&quot;comment&quot;)) &amp; _&#xA;        &#xA;        &#xA;          &#xA;                          &quot;&lt;/td&gt;&lt;/tr&gt;&quot; &amp; &quot;&lt;!-- post-&quot; &amp; Request.QueryString(&quot;post&quot;) &amp; &quot;-comment --&gt;&quot;, _&#xA;        &#xA;        &#xA;          &#xA;                  0, 1, vbTextCompare)&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;              f.Close&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              Set f = fs.OpenTextFile(Server.MapPath(&quot;forum.asp&quot;), 2)&#xA;        &#xA;        &#xA;          &#xA;              f.Write data&#xA;        &#xA;        &#xA;          &#xA;              f.Close&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              Set f = Nothing&#xA;        &#xA;        &#xA;          &#xA;              Set fs = Nothing&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              Response.Redirect &quot;forum.asp&quot;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          End Select&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          form.vbs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;I&#x2019;ll give you a moment to study the code. It deserve that much of your attention.What you see here is a beautiful example of using code as data and data as code, self modifying code and some really impressive (even if I say so myself) capabilities of my past self to dig himself way into the hole.Bonus points if you can point out all the myriad of issue that this code has. You can safely leave aside maintainability, I never had to maintain it, but over twenty year have passed, and I still remember the complexity involved in keeping all the states in my head.And that was the first time that I actually wrote my own dedicated database.</p>
        </article>
        <article id="article-1910">
            <a href="https://enterprisecraftsmanship.com/posts/validate-commands-cqrs/" target="_blank">
                <h2 class="title mb-6" id="article-1910">When to validate commands in CQRS?</h2>
            </a>
            <p class="mb-2">by Vladimir Khorikov</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 20, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">There&#x2019;s a question that I didn&#x2019;t cover in the course and that was raised at least twice since then: when to validate commands in CQRS?</p>
        </article>
        <div class="button flex justify-between">
            <a href="190.html"><span class="back arrow"></span></a>

            <a href="192.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>