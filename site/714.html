
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 714 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-7131">
            <a href="https://ayende.com/blog/3108/sqlite-vs-sql-ce" target="_blank">
                <h2 class="title mb-6" id="article-7131">SQLite vs. SQL CE</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 22, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Those two seems to be the most common embedded databases in the .NET world. This is important to me, since I want to do testing against embedded database. SQL CE can be used with SQL Management Studio, which is nice, but it has three major issues for me so far:  It doesn&#x27;t support memory only operations. SQLite does, and it means a difference of 12 seconds vs. 40 seconds in running ~100 tests that hit the DB. This is important, especially kicking up everything seems to take about 10 seconds anyway (using Test Driven.Net) It doesn&#x27;t support paging (WTF!) It doesn&#x27;t support comparing to a sub query, so this is not legal:select * from account where 1 = (select allow from permissions) Right now I am experimenting with just how much I can twist around to get everything to break. I am on the third NH bug this week, and counting :-)</p>
        </article>
        <article id="article-7132">
            <a href="https://ayende.com/blog/3107/dealing-with-hierarchical-structures-in-databases" target="_blank">
                <h2 class="title mb-6" id="article-7132">Dealing with hierarchical structures in databases</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 22, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have a very simple requirement, I need to create a hierarchy of users&#x27; groups. So you can do something like:  Administrators  DBA  SQLite DBA If you are a member of SQLite DBA group, you are implicitly a member of the Administrators group. In the database, it is trivial to model this:   Except that then we run into the problem of dealing with the hierarchy. We can&#x27;t really ask questions that involve more than one level of the hierarchy easily.&#xA0; Some databases has support for hierarchical operators, but that is different from one database to the next. That is a problem, since I need it to work across databases, and without doing too much fancy stuff. We can work around the problem by introducing a new table:   Now we move the burden of the hierarchy from the query phase to the data entry phase.  From the point of view of the entity, we have this:  Please ignore the death star shape and concentrate on the details :-)  Here is how we are getting all the data in the tree: public virtual UsersGroup[] GetAssociatedUsersGroupFor(IUser user)&#xA;{&#xA;    DetachedCriteria directGroupsCriteria = DetachedCriteria.For&lt;UsersGroup&gt;()&#xA;        .CreateAlias(&quot;Users&quot;, &quot;user&quot;)&#xA;        .Add(Expression.Eq(&quot;user.id&quot;, user.SecurityInfo.Identifier))&#xA;        .SetProjection(Projections.Id());&#xA;&#xA;    DetachedCriteria allGroupsCriteria = DetachedCriteria.For&lt;UsersGroup&gt;()&#xA;        .CreateAlias(&quot;Users&quot;, &quot;user&quot;, JoinType.LeftOuterJoin)&#xA;        .CreateAlias(&quot;AllChildren&quot;, &quot;child&quot;, JoinType.LeftOuterJoin)&#xA;        .Add(&#xA;            Subqueries.PropertyIn(&quot;child.id&quot;, directGroupsCriteria) ||&#xA;            Expression.Eq(&quot;user.id&quot;, user.SecurityInfo.Identifier));&#xA;&#xA;    ICollection&lt;UsersGroup&gt; usersGroups = &#xA;        usersGroupRepository.FindAll(allGroupsCriteria, Order.Asc(&quot;Name&quot;));&#xA;    return Collection.ToArray&lt;UsersGroup&gt;(usersGroups);&#xA;}&#xA;&#xA;Note that here we don&#x27;t care whatever we are associated with a group directly or indirectly. This is an important consideration in some scenarios (mostly when you want to display information to the user), so we need some way to chart the hierarchy, right?&#xA;Here is how we are doing this:&#xA;public virtual UsersGroup[] GetAncestryAssociation(IUser user, string usersGroupName)&#xA;{&#xA;    UsersGroup desiredGroup = GetUsersGroupByName(usersGroupName);&#xA;    ICollection&lt;UsersGroup&gt; directGroups =&#xA;        usersGroupRepository.FindAll(GetDirectUserGroupsCriteria(user));&#xA;    if (directGroups.Contains(desiredGroup))&#xA;    {&#xA;        return new UsersGroup[] { desiredGroup };&#xA;    }&#xA;    // as a nice benefit, this does an eager load of all the groups in the hierarchy&#xA;    // in an efficient way, so we don&#x27;t have SELECT N &#x2B; 1 here, nor do we need&#xA;    // to load the Users collection (which may be very large) to check if we are associated&#xA;    // directly or not&#xA;    UsersGroup[] associatedGroups = GetAssociatedUsersGroupFor(user);&#xA;    if (Array.IndexOf(associatedGroups, desiredGroup) == -1)&#xA;    {&#xA;        return new UsersGroup[0];&#xA;    }&#xA;    // now we need to find out the path to it&#xA;    List&lt;UsersGroup&gt; shortest = new List&lt;UsersGroup&gt;();&#xA;    foreach (UsersGroup usersGroup in associatedGroups)&#xA;    {&#xA;        List&lt;UsersGroup&gt; path = new List&lt;UsersGroup&gt;();&#xA;        UsersGroup current = usersGroup;&#xA;        while (current.Parent != null &amp;&amp; current != desiredGroup)&#xA;        {&#xA;            path.Add(current);&#xA;            current = current.Parent;&#xA;        }&#xA;        if (current != null)&#xA;            path.Add(current);&#xA;        // Valid paths are those that are contains the desired group&#xA;        // and start in one of the groups that are directly associated&#xA;        // with the user&#xA;        if (path.Contains(desiredGroup) &amp;&amp; directGroups.Contains(path[0]))&#xA;        {&#xA;            shortest = Min(shortest, path);&#xA;        }&#xA;    }&#xA;    return shortest.ToArray();&#xA;}&#xA;As an aside, this is about as complex a method as I can tolerate, and even that just barely.&#xA;I mentioned that the burden was when creating it, right? Here is what I meant:&#xA;public UsersGroup CreateChildUserGroupOf(string parentGroupName, string usersGroupName)&#xA;{&#xA;    UsersGroup parent = GetUsersGroupByName(parentGroupName);&#xA;    Guard.Against&lt;ArgumentException&gt;(parent == null,&#xA;                                     &quot;Parent users group &#x27;&quot; &#x2B; parentGroupName &#x2B; &quot;&#x27; does not exists&quot;);&#xA;&#xA;    UsersGroup group = CreateUsersGroup(usersGroupName);&#xA;    group.Parent = parent;&#xA;    group.AllParents.AddAll(parent.AllParents);&#xA;    group.AllParents.Add(parent);&#xA;    parent.Directchildren.Add(group);&#xA;    parent.AllChildren.Add(group);&#xA;    return group;&#xA;}&#xA;We could hide it all inside the Parent&#x27;s property setter, but we still need to deal with it.&#xA;And that is all you need to do in order to get it cross database hierarchical structures working.</p>
        </article>
        <article id="article-7133">
            <a href="https://ayende.com/blog/3106/performance-threading-and-double-checked-locks" target="_blank">
                <h2 class="title mb-6" id="article-7133">Performance, threading and double checked locks</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 21, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A very common pattern for lazy initialization of expensive things is this: GetDescriptionsHelper.Delegate getDescription;&#xA;if (GetDescriptionsHelper.Cache.TryGetValue(entityType, out getDescription) == false)&#xA;{&#xA;&#x9;MethodInfo getDescriptionInternalGeneric = getDescriptionInternalMethodInfo.MakeGenericMethod(entityType);&#xA;&#x9;getDescription = (GetDescriptionsHelper.Delegate)Delegate.CreateDelegate(&#xA;&#x9;&#x9;typeof(GetDescriptionsHelper.Delegate),&#xA;&#x9;&#x9;getDescriptionInternalGeneric);&#xA;&#xA;&#x9;GetDescriptionsHelper.Cache.Add(entityType, getDescription);&#xA;}&#xA;This tends to break down when we are talking about code that can run in multiply threads. So we start writing this:&#xA;lock(GetDescriptionsHelper.Cache)&#xA;{&#xA;&#x9;GetDescriptionsHelper.Delegate getDescription;&#xA;&#x9;if (GetDescriptionsHelper.Cache.TryGetValue(entityType, out getDescription) == false)&#xA;&#x9;{&#xA;&#x9;&#x9;MethodInfo getDescriptionInternalGeneric = getDescriptionInternalMethodInfo.MakeGenericMethod(entityType);&#xA;&#x9;&#x9;getDescription = (GetDescriptionsHelper.Delegate)Delegate.CreateDelegate(&#xA;&#x9;&#x9;&#x9;typeof(GetDescriptionsHelper.Delegate),&#xA;&#x9;&#x9;&#x9;getDescriptionInternalGeneric);&#xA;&#x9;&#xA;&#x9;&#x9;GetDescriptionsHelper.Cache.Add(entityType, getDescription);&#xA;&#x9;}&#xA;}&#xA;Except, this is really bad for performance, because we always lock when we try to get the value out. So we start playing with it and get this:&#xA;GetDescriptionsHelper.Delegate getDescription;&#xA;if (GetDescriptionsHelper.Cache.TryGetValue(entityType, out getDescription) == false)&#xA;{&#xA;&#x9;lock(GetDescriptionsHelper.Cache)&#xA;&#x9;{&#x9;&#xA;&#x9;&#x9;MethodInfo getDescriptionInternalGeneric = getDescriptionInternalMethodInfo.MakeGenericMethod(entityType);&#xA;&#x9;&#x9;getDescription = (GetDescriptionsHelper.Delegate)Delegate.CreateDelegate(&#xA;&#x9;&#x9;&#x9;typeof(GetDescriptionsHelper.Delegate),&#xA;&#x9;&#x9;&#x9;getDescriptionInternalGeneric);&#xA;&#x9;&#xA;&#x9;&#x9;GetDescriptionsHelper.Cache.Add(entityType, getDescription);&#xA;&#x9;}&#xA;}&#xA;This code has a serious error in it, in the right conditions, two threads will evaluate the if at the same time, and then try to enter the lock at the same time. The end result is an exception as the second of them will try to add the entity type again.&#xA;So we come out with the doubly checked lock, like this:&#xA;GetDescriptionsHelper.Delegate getDescription;&#xA;if (GetDescriptionsHelper.Cache.TryGetValue(entityType, out getDescription) == false)&#xA;{&#xA;&#x9;lock(GetDescriptionsHelper.Cache)&#xA;&#x9;{&#x9;&#xA;&#x9;&#x9;if (GetDescriptionsHelper.Cache.TryGetValue(entityType, out getDescription) )&#xA;&#x9;&#x9;&#x9;return;&#xA;&#xA;&#x9;&#x9;MethodInfo getDescriptionInternalGeneric = getDescriptionInternalMethodInfo.MakeGenericMethod(entityType);&#xA;&#x9;&#x9;getDescription = (GetDescriptionsHelper.Delegate)Delegate.CreateDelegate(&#xA;&#x9;&#x9;&#x9;typeof(GetDescriptionsHelper.Delegate),&#xA;&#x9;&#x9;&#x9;getDescriptionInternalGeneric);&#xA;&#x9;&#xA;&#x9;&#x9;GetDescriptionsHelper.Cache.Add(entityType, getDescription);&#xA;&#x9;}&#xA;}&#xA;Now we are handling this condition as well. But my preference of late has been to use this code in multi threaded environments.&#xA;Update: I should be wrong more often, I got some very good replies to this post. The code below happened to work by chance and luck alone, apparently. The solution above is the more correct one.&#xA;Actually, it is more complex than that. It is still possible to have readers attempt to read the Cache variable (which is of type Dictionary&lt;Type, Delegate&gt;) while it is being written to inside the lock. There is a potential for serious&#xA0; bit of mayhem in that case.&#xA;The safe thing to do in this case would be to lock it always before access, but for things that are going to be used frequently (hot spots) this can be a problem. Reader/Writer lock is much worse in terms or performance than the usual lock statement, and ReaderWriterLockSlim is for .NET 3.5 only.&#xA;An interesting dilemma, and I apologize for misleading you earlier.&#xA;GetDescriptionsHelper.Delegate getDescription;&#xA;if (GetDescriptionsHelper.Cache.TryGetValue(entityType, out getDescription) == false)&#xA;{&#xA;&#x9;MethodInfo getDescriptionInternalGeneric = getDescriptionInternalMethodInfo.MakeGenericMethod(entityType);&#xA;&#x9;getDescription = (GetDescriptionsHelper.Delegate)Delegate.CreateDelegate(&#xA;&#x9;&#x9;typeof(GetDescriptionsHelper.Delegate),&#xA;&#x9;&#x9;getDescriptionInternalGeneric);&#xA;&#xA;&#x9;GetDescriptionsHelper.Cache[entityType] = getDescription;&#xA;}&#xA;can you spot the main difference? We are not using locks, and we are using the indexer instead of the Add() method.&#xA;Empirical evidence suggest that using the indexer in a multi threaded environment is safe, in that it doesn&#x27;t corrupt the dictionary and one of the values will remain there.&#xA;This means that assuming that the cost of creating the value isn&#x27;t very high, it is just fine to have it created twice on those rare cases, the end result is after the initial flurry, we have the value cached, even if it was calculated more than once. In the long run, it doesn&#x27;t matter.</p>
        </article>
        <article id="article-7134">
            <a href="https://ayende.com/blog/3105/challenge-strongly-typing-weakly-typed-code" target="_blank">
                <h2 class="title mb-6" id="article-7134">Challenge</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 21, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">How would you make the following code work? public static class Security&#xA;{&#xA;&#x9;public static string GetDescription(Type entityType, Guid securityKey)&#xA;&#x9;{&#xA;&#x9;&#x9;Guard.Against&lt;ArgumentException&gt;(securityKey == Guid.Empty, &quot;Security Key cannot be empty&quot;);&#xA;&#x9;&#x9;IEntityInformationExtractor&lt;TEntity&gt; extractor = IoC.Resolve&lt;IEntityInformationExtractor&lt;TEntity&gt;&gt;();&#xA;&#x9;&#x9;return extractor.GetDescription(securityKey);&#xA;&#x9;}&#xA;}&#xA;You can&#x27;t change the entity type parameter to a generic parameter, because you only know about it at runtime. This is usually called with:&#xA;Security.GetDescription(Type.GetType(permission.EntityTypeName), permission.EntitySecurityKey.Value);</p>
        </article>
        <article id="article-7135">
            <a href="https://ayende.com/blog/3104/donjon-hammetts-teasing" target="_blank">
                <h2 class="title mb-6" id="article-7135">Donjon - Hammett&#x27;s Teasing</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 20, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Hammett has just posted teaser image on his blog. Go check it out. I have some idea about how long ago it started, and to get to this point is amazing (and no, I don&#x27;t have any extra knowledge about what it does otherwise, except maybe free us from OutOfMemoryError s and manual restarts).</p>
        </article>
        <article id="article-7136">
            <a href="https://ayende.com/blog/3103/serialazble-isolation-level-on-rows-that-does-not-exists" target="_blank">
                <h2 class="title mb-6" id="article-7136">Serialazble isolation level on rows that does not exists</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 18, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Recently I was asked how to solve this problem. An external service makes a call to the application, to create / update an entity. This call can arrive in one of few endpoints. The catch is that sometimes the external service send the call to create a new entity to all the end points at the same time. This obviously caused issue when trying to insert the same row twice. I suggested using serializable isolation level to handle this scenario, but I wasn&#x27;t sure what kind of guarantees is makes for rows that do not exists. I decided to write this simple test case (warning: test code / quick hack, don&#x27;t write real code like this!). private static void InsertToDatabase(object state)&#xA;{&#xA;    int value = 0;&#xA;&#xA;    while (true)&#xA;    {&#xA;        value &#x2B;= 1;&#xA;        try&#xA;        {&#xA;            using (SqlConnection connection =&#xA;                    new SqlConnection(&quot;data source=localhost;integrated security=sspi;initial catalog=test&quot;))&#xA;            {&#xA;                connection.Open();&#xA;                using (SqlTransaction transaction =&#xA;                        connection.BeginTransaction(IsolationLevel.Serializable))&#xA;                using (SqlCommand command = connection.CreateCommand())&#xA;                {&#xA;                    command.CommandText = &quot;SELECT Id FROM Items WHERE Id = @id&quot;;&#xA;                    command.Parameters.AddWithValue(&quot;id&quot;, value);&#xA;                    command.Transaction = transaction;&#xA;                    if (command.ExecuteScalar() != null)&#xA;                        continue;&#xA;                    command.CommandText = &quot;INSERT INTO Items (Id) VALUES(@id)&quot;;&#xA;                    command.ExecuteNonQuery();&#xA;                    Console.WriteLine(&quot;{1}: Wrote {0}&quot;, value, Thread.CurrentThread.ManagedThreadId);&#xA;&#xA;                    transaction.Commit();&#xA;                }&#xA;            }&#xA;        }&#xA;        catch (SqlException e)&#xA;        {&#xA;            if (e.Number == 1205) //transaction deadlock&#xA;            {&#xA;                Console.WriteLine(&quot;{0}: Deadlock recovery&quot;, Thread.CurrentThread.ManagedThreadId);&#xA;                continue;&#xA;            }&#xA;            Console.WriteLine(e);&#xA;        }&#xA;    }&#xA;}&#xA;As a note, performance for this really sucks if you have contention, and I got a lot of transaction deadlocks when running it with multiply threads.&#xA;What I have observed was that it indeed inserted only a single id. All other isolation levels (including snapshot) will produce duplicate rows in this scenario.&#xA;Assumption proven, now I only need to find what kind of a lock it takes on a row that doesn&#x27;t exists.</p>
        </article>
        <article id="article-7137">
            <a href="https://ardalis.com/silverlight-hyperlink/" target="_blank">
                <h2 class="title mb-6" id="article-7137">Silverlight Hyperlink</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 17, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Playing with Silverlight and needed a simple way to redirect the page. This isn&#x27;t built-in yet but probably will be. For now, you can call&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-7138">
            <a href="https://ardalis.com/tfs-tips/" target="_blank">
                <h2 class="title mb-6" id="article-7138">TFS Tips</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 16, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;m just wrapping up a long article on Team System 2008 and its new capabilities, especially its continuous integration support and build&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-7139">
            <a href="https://ayende.com/blog/3102/rhino-etl-2-0" target="_blank">
                <h2 class="title mb-6" id="article-7139">Rhino ETL 2.0</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 16, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Rhino ETL was born out of a need. I need to do a lot of ETL type operations. Those include anything from moving data from legacy databases to my database, importing files, importing data over web services, etc. For a while, I have used SSIS for those needs. It has proven... inadequate. Mostly in terms of ease of development, deployment, error handling, etc. This is my third attempt at building an ETL tool. The third time is much shorter and clearer than both previous attempts.  The goals for the project were:  Developer friendly:  Errors Development Deployment Performant - I need to move large amounts of data around, and I need to do it fast. Easy - The hard part should be handling the required transforms, dealing with the logic for in/out, etc. Unlimited - You should not be limited to what the tool gives you, and you should be able to integrate easily with other tools Language agnostic - You should be able to develop solutions for this using C#/VB/Boo DSL - Provide a DSL to make it even easier to work with The overall concept is based around these two classes, and the idea of a pipeline:    Here is a simple operation, which just generate all the even numbers to a million: public class EvenNumberToMillion : AbstractOperation&#xA;{&#xA;&#x9;public override IEnumerable&lt;Row&gt; Execute(IEnumerable&lt;Row&gt; rows)&#xA;&#x9;{&#xA;&#x9;&#x9;for(int i = 2; i&lt; 1000000; i &#x2B;= 2)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;Row row = new Row();&#xA;&#x9;&#x9;&#x9;row[&quot;number&quot;] = i;&#xA;&#x9;&#x9;&#x9;yield return row;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;This is an input operation, it ignores its rows parameter, and yields rows generated by some other way. As you can see, we use the yield rows for each iteration. &#xA;We combine operations into a pipeline using the process. If we wanted to print the numbers, we would have build the following pipeline process:&#xA;public class PrintNumbersProcess : EtlProcess&#xA;{&#xA;&#x9;public override void Initialize()&#xA;&#x9;{&#xA;&#x9;&#x9;Register(new EvenNumberToMillion());&#xA;&#x9;&#x9;Register(new PrintNumbers());&#xA;&#x9;}&#xA;}&#xA;All the output of the first operation goes into the second operation, and so on and so forth. Using the DSL it will look like:&#xA;operation EvenNumbersToMillion:&#xA;&#x9;for i in range(1000000,2):&#xA;&#x9;&#x9;yield Row(Number: i)&#xA;&#xA;operation PrintNumbers:&#xA;&#x9;for row in rows:&#xA;&#x9;&#x9;print row.Number&#xA;&#xA;process PrintNumbersProcess:&#xA;&#x9;EvenNumbersToMillion()&#xA;&#x9;PrintNumbers()&#xA;This is just to demonstrate the concept of the pipeline. Now we can get into the interesting operations. As you already surmised, AbstractOperation is the common base class, and you can inherit it to produce rows from any source. &#xA;Inputs&#xA;Rhino ETL offers special support for getting data from a database. It means that you can define it simple as:&#xA;public class ReadUsers : ConventionInputCommandOperation&#xA;{&#xA;    public ReadUsers() : base(&quot;test&quot;)&#xA;    {&#xA;        Command = &quot;SELECT Id, Name,Email FROM Users&quot;;&#xA;    }&#xA;}&#xA;&#xA;Or, using DSL:&#xA;input &quot;test&quot;, Command = &quot;SELECT id, name, email  FROM Users&quot;&#xA;Note the &quot;test&quot; here, it is the name of the connection string in the app.config.&#xA;Outputs&#xA;On the output side, we have more interesting options. We can use any custom option that we want, of course, but for working with databases, we have the following options:&#xA;Standard DB commands:&#xA;public class FibonacciOutput : ConventionOutputCommandOperation&#xA;{&#xA;    public FibonacciOutput() : base(&quot;test&quot;)&#xA;    {&#xA;        Command = &quot;INSERT INTO Fibonacci (Id) VALUES(@Id)&quot;;&#xA;    }&#xA;}&#xA;You&#x27;ll note that I am not specifying the parameters, those are taken implicitly from the current row.&#xA;Using DSL:&#xA;output &quot;test&quot;, Command = &quot;INSERT INTO Fibonacci (Id) VALUES(@Id)&quot;&#xA;&#xA;SQL Batch operations:&#xA;public class FibonacciOutput : ConventionSqlBatchOpeartion&#xA;{&#xA;    public FibonacciOutput() : base(&quot;test&quot;)&#xA;    {&#xA;        Command = &quot;INSERT INTO Fibonacci (Id) VALUES(@Id)&quot;;&#xA;    }&#xA;}&#xA;Using DSL: Haven&#x27;t written that yet :-(&#xA;Sql Bulk Insert:&#xA; public class FibonacciBulkInsert : SqlBulkInsertOperation&#xA;    {&#xA;        public FibonacciBulkInsert() : base(&quot;test&quot;, &quot;Fibonacci&quot;)&#xA;        {&#xA;        }&#xA;&#xA;        protected override void PrepareSchema()&#xA;        {&#xA;            Schema[&quot;id&quot;] = typeof (int);&#xA;        }&#xA;    }&#xA;Using DSL: Haven&#x27;t written that yet :-(&#xA;Files&#xA;For working with files, we have the support of the excellent FileHelpers library, which makes working with files really easy. &#xA;Reading from a file is simply:&#xA;public class UserRecord&#xA;{&#xA;    public string email;&#xA;    public int id;&#xA;    public string name;&#xA;}&#xA;&#xA;public class ReadUsersFromFile : AbstractOperation&#xA;{&#xA;    public override IEnumerable&lt;Row&gt; Execute(IEnumerable&lt;Row&gt; rows)&#xA;    {&#xA;        using(FileEngine file = FluentFile.For&lt;UserRecord&gt;().From(&quot;users.txt&quot;))&#xA;        {&#xA;            foreach (object obj in file)&#xA;            {&#xA;                yield return Row.FromObject(obj);&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;There is 1:1 translation to Boo here, so I&#x27;ll spare you that. &#xA;Writing is very similar:&#xA;public class WriteUsersToFile : AbstractOperation&#xA;{&#xA;    public override IEnumerable&lt;Row&gt; Execute(IEnumerable&lt;Row&gt; rows)&#xA;    {&#xA;        FluentFile engine = FluentFile.For&lt;UserRecord&gt;();&#xA;        engine.HeaderText = &quot;Id\tName\tEmail&quot;;&#xA;        using(FileEngine file = engine.To(&quot;users.txt&quot;))&#xA;        {&#xA;            foreach (Row row in rows)&#xA;            {&#xA;                UserRecord record = new UserRecord();&#xA;                &#xA;                record.Id = (int)row[&quot;id&quot;];&#xA;                record.Name = (string)row[&quot;name&quot;];&#xA;                record.Email = (string)row[&quot;email&quot;];&#xA;&#xA;                file.Write(record);&#xA;            }&#xA;        }&#xA;        yield break;&#xA;    }&#xA;}&#xA;Joins&#xA;Joins are an interesting concept, and I play with them quite extensively recently. Joins in Rhino ETL are implemented as sub processes. Hash joins are very simple:&#xA;public class JoinUsersAndIds : JoinOperation&#xA;{&#xA;&#x9;protected override Row MergeRows(Row leftRow, Row rightRow)&#xA;&#x9;{&#xA;&#x9;&#x9;Row row = leftRow.Clone();&#xA;&#x9;&#x9;row[&quot;user_id&quot;] = rightRow[&quot;new_id&quot;];&#xA;&#x9;&#x9;return row;&#xA;&#x9;}&#xA;&#xA;&#x9;protected override void SetupJoinConditions()&#xA;&#x9;{&#xA;&#x9;&#x9;InnerJoin&#xA;&#x9;&#x9;&#x9;.Left(&quot;id&quot;)&#xA;&#x9;&#x9;&#x9;.Right(&quot;old_id&quot;);&#xA;&#x9;}&#xA;}&#xA;This is just the operation, you hook it up in the process using:&#xA;Register(new JoinUsersAndIds()&#xA;         &#x9;.Left(new GenerateUsers(25000))&#xA;         &#x9;.Right(new GenerateRandomIds(15000)));&#xA;Each side is capable of accepting a full blown sub process on its own.&#xA;Nested loops joins are appropriate for the more complex cases:&#xA;public class FullJoinUsersToPeopleByEmail : NestedLoopsJoinOperation&#xA;{&#xA;    protected override bool MatchJoinCondition(Row leftRow, Row rightRow)&#xA;    {&#xA;        return LeftJoin(leftRow[&quot;email&quot;], rightRow[&quot;email&quot;]);&#xA;    }&#xA;&#xA;&#x9;protected override Row MergeRows(Row leftRow, Row rightRow)&#xA;    {&#xA;        Row row = new Row();&#xA;        row.Copy(leftRow);&#xA;        row[&quot;person_id&quot;] = rightRow[&quot;id&quot;];&#xA;        return row;&#xA;    }&#xA;}&#xA;Using DSL it looks like this:&#xA;join get_user_roles:&#xA;&#x9;left:&#xA;&#x9;&#x9;input &quot;test&quot;, Command = &quot;SELECT id, name, email  FROM Users&quot;&#xA;&#x9;&#x9;&#xA;&#x9;right:&#xA;&#x9;&#x9;nput &quot;test&quot;, Command = &quot;SELECT userid, roleid FROM UsersToRoles&quot;&#xA;&#x9;&#x9;&#x9;&#xA;&#x9;on left.id ==  right.userid:&#xA;&#x9;&#x9;row.Name = left.Name&#xA;&#x9;&#x9;row.Role = right.RoleId&#xA;(A note about this syntax, this currently generate a nested loop join, I intend to make it generate an optimize version soon).&#xA;Branching&#xA;That was quite a challenge to implement, I kept missing a key point, and that tripped me for a while. Here is how send a row to several sources:&#xA;BranchingOperation split = new BranchingOperation()&#xA;&#x9;.Add(Partial&#xA;&#x9;&#x9;.Register(new MultiplyByThreeOperation())&#xA;&#x9;&#x9;.Register(new Fibonacci.Bulk.FibonacciBulkInsert()))&#xA;&#x9;.Add(Partial&#xA;&#x9;&#x9;.Register(new Fibonacci.Bulk.FibonacciBulkInsert()));&#xA;Register(split);&#xA;(Note, the implementation is not as optimized as it could be.)&#xA;Aggregates&#xA;Well, you got to have those, don&#x27;t you? Here is a simple Row Count aggregate:&#xA;public class RowCount : AbstractAggregationOperation&#xA;{&#xA;    &#x9;protected override void Accumulate(Row row, Row aggregate)&#xA;      {&#xA;            if (aggregate[&quot;count&quot;] == null)&#xA;                aggregate[&quot;count&quot;] = 0;&#xA;&#xA;            int count = (int)aggregate[&quot;count&quot;];&#xA;            aggregate[&quot;count&quot;] = count &#x2B; 1;&#xA;      }&#xA;}&#xA;We are called once per row, and can accumulate all the values that we want. We can use grouping to create more interesting results:&#xA;public class CostPerProductAggregation : AbstractAggregationOperation&#xA;{&#xA;    protected override void Accumulate(Row row, Row aggregate)&#xA;    {&#xA;        aggregate[&quot;name&quot;] = row[&quot;name&quot;];&#xA;        if(aggregate[&quot;cost&quot;]==null)&#xA;            aggregate[&quot;cost&quot;] = 0;&#xA;        aggregate[&quot;cost&quot;] = ((int) aggregate[&quot;cost&quot;]) &#x2B; ((int) row[&quot;price&quot;]);&#xA;    }&#xA;&#xA;    protected override string[] GetColumnsToGroupBy()&#xA;    {&#xA;        return new string[] {&quot;name&quot;};&#xA;    }&#xA;}&#xA;We can also override the FinishAggregation(Row) method to complete any calculations when all the rows are completed. Rhino ETL guarantees that we will get the same aggregate row for all the rows that match the same columns, so that is taken care of.&#xA;Using DSL for that is simply:&#xA;aggregate join_product_names:&#xA;&#x9;accumulate:&#xA;&#x9;&#x9;aggregate.names = [] if aggregate.names is null&#xA;&#x9;&#x9;aggregate.names.Add(row.name)&#xA;&#x9;&#xA;&#x9;terminate:&#xA;&#x9;&#x9;aggregate.result = string.Join(&quot;, &quot;, aggregate.names.ToArray(string))&#xA;That is about it for now, I think. You can get the source for Rhino ETL here:&#xA;https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/trunk/rhino-etl&#xA;I plan to have a binary release one I am confident that all the notes in this post are no longer relevant.</p>
        </article>
        <article id="article-7140">
            <a href="https://ayende.com/blog/3101/ssis-vs-csv" target="_blank">
                <h2 class="title mb-6" id="article-7140">SSIS vs. CSV</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 15, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Another team have run into this bug, what this basically means is that SSIS is not capable of importing CSV files. The &quot;spec&quot; for CSV files is about three lines long, including the special cases ( of which there are two ) and it hasn&#x27;t changed in a decade.  It boggles the mind that not only isn&#x27;t SSIS capable of doing this, but they are not going to fix it for SSIS 2008. Looks like you would need to wait to SSIS 201x for a version that can handle CSV files.</p>
        </article>
        <div class="button flex justify-between">
            <a href="713.html"><span class="back arrow"></span></a>

            <a href="715.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>