
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 493 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4921">
            <a href="https://ayende.com/blog/64513/the-horror-of-having-to-enforce-slas" target="_blank">
                <h2 class="title mb-6" id="article-4921">The horror of having to enforce SLAs</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 22, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am doing the NHibernate Course right now, and we go to the stage where everyone is tired and need some comic relief, at which point I decided to show them the true meaning of an SLA.  If you commit this without telling anyone, you get to have so much fun when the computer suddenly start screaming at those horribly inefficient pages.</p>
        </article>
        <article id="article-4922">
            <a href="https://www.meziantou.net/access-private-members-of-a-class-using-reflection.htm" target="_blank">
                <h2 class="title mb-6" id="article-4922">Access private members of a class using reflection</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 21, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Accessing private members of a class is generally not a good thing. However, sometimes this is required. Here are some methods to facilitate access to private members:C#copypublic static T GetPrivateField&lt;T&gt;(this object obj, string name)&#xA;{&#xA;    BindingFlags flags = BindingFlags.Instance | Bind</p>
        </article>
        <article id="article-4923">
            <a href="https://ayende.com/blog/63491/ravendb-lazy-requests" target="_blank">
                <h2 class="title mb-6" id="article-4923">RavenDB Lazy Requests</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 19, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In my previous post, I discussed the server side implementation of lazy requests / Multi GET. The ability to submit several requests to the server in a single round trip. RavenDB has always supported the ability to perform multiple write operations in a single batch, but now we have the reverse functionality the ability to make several reads at one. (The natural progression, the ability to make several read/write operations in a single batch will not be supported). As it turned out, it was actually pretty hard to do, and require us to do some pretty deep refactoring to the way we were executing our requests, but in the end it is here and it is working. Here are a few examples of how it looks line from the client API point of view: var lazyUser = session.Advanced.Lazily.Load&lt;User&gt;(&quot;users/ayende&quot;);&#xA;var lazyPosts = session.Query&lt;Posts&gt;().Take(30).Lazily();&#xA;&#xA;&#xA;&#xA;And up until now, there is actually nothing being sent to the server. The result of those two calls are Lazy&lt;User&gt; and Lazy&lt;IEnumerable&lt;Post&gt;&gt;, respectively.&#xA;The reason that we are using Lazy&lt;T&gt; in this manner is that we want to make it very explicit when you are actually evaluating the lazy request. All the lazy requests will be sent to the server in a single roundtrip the first time that any of the lazy instances are evaluated, or you can force this to happen by calling:&#xA;session.Advanced.Eagerly.ExecuteAllPendingLazyOperations();&#xA;&#xA;&#xA;In order to increase the speed even more, on the server side, we are actually going to process all of those queries in parallel. So you get several factors that would speed up your application:&#xA;&#xA;Only a single remote call is made.&#xA;All of the queries are actually handled in parallel on the server side.&#xA;And the best part, you usually don&#x2019;t really have to think about it. If you use the Lazy API, it just works .</p>
        </article>
        <article id="article-4924">
            <a href="https://benfoster.io/blog/jquery-loadnicely/" target="_blank">
                <h2 class="title mb-6" id="article-4924">jQuery loadNicely - load your images...nicely</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 19, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">loadNicely is a little jQuery plugin used to load your images nicely.</p>
        </article>
        <article id="article-4925">
            <a href="https://ayende.com/blog/63489/ravendb-multi-get-support" target="_blank">
                <h2 class="title mb-6" id="article-4925">RavenDB Multi GET support</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 18, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the annoyances of HTTP is that it is not really possible to make complex queries easily. To be rather more exact, you can make a complex query fairly easily, but at some point you&#x2019;ll reach the URI limit, and worse, there is no easy way to make multiple queries in a single round trip. I have been thinking about this a lot lately, because it is a stumbling block for a feature that is near and dear to my heart, the Future Queries feature that is so useful when using NHibernate. The problem was that I couldn&#x2019;t think of a good way of doing this. Well, I could think of how to do this quite easily, to be truthful. I just couldn&#x2019;t think of a good way to make this work nicely with the other features of RavenDB. In particular, it was hard to figure out how to deal with caching. One of the really nice things about RavenDB&#x2019;s RESTful nature is that caching is about as easy as it can be. But since we need to tunnel requests through another medium for it to work, I couldn&#x2019;t figure out how to make this work in a nice fashion. And then I remembered that REST didn&#x2019;t actually have anything to do with HTTP itself, you can do REST on top of any transport protocol. Let us look at how requests are handled in RavenDB over the wire: GET http://localhost:8080/docs/bobs_address&#xA;&#xA;HTTP/1.1 200 OK&#xA;&#xA;{&#xA;  &quot;FirstName&quot;: &quot;Bob&quot;,&#xA;  &quot;LastName&quot;: &quot;Smith&quot;,&#xA;  &quot;Address&quot;: &quot;5 Elm St.&quot;&#xA;}&#xA;&#xA;GET http://localhost:8080/docs/users/ayende&#xA;&#xA;HTTP/1.1 404 Not Found&#xA;&#xA;&#xA;&#xA;As you can see, we have 2 request / reply calls.&#xA;What we did in order to make RavenDB support multiple requests in a single round trip is to build on top of this exact nature using:&#xA;POST http://localhost:8080/multi_get&#xA;&#xA;[&#xA;   { &quot;Url&quot;: &quot;http://localhsot:8080/docs/bobs_address&quot;, &quot;Headers&quot;: {} },&#xA;   { &quot;Url&quot;: &quot;http://localhsot:8080/docs/users/ayende&quot;, &quot;Headers&quot;: {} },&#xA;]&#xA;&#xA;HTTP/1.1 200 OK&#xA;&#xA;[&#xA;  { &quot;Status&quot;: 200, &quot;Result&quot;: { &quot;FirstName&quot;: &quot;Bob&quot;, &quot;LastName&quot;: &quot;Smith&quot;, &quot;Address&quot;: &quot;5 Elm St.&quot; }},&#xA;  { &quot;Status&quot;: 404 &quot;Result&quot;: null },&#xA;]&#xA;&#xA;&#xA;Using this approach, we can handle multiple requests in a single round trip. &#xA;You might not be surprised to learn that it was actually very easy to do, we just needed to add an endpoint and have a way of executing the request pipeline internally. All very easy.&#xA;The really hard part was with the client, but I&#x2019;ll touch on that in my next post.</p>
        </article>
        <article id="article-4926">
            <a href="https://ayende.com/blog/57345/macto-looking-at-warrants" target="_blank">
                <h2 class="title mb-6" id="article-4926">Macto</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 17, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After spending so much time talking about how important Warrants are, it is actually surprising to see the UI for a warrant:   It is pretty simple, because from a data entry perspective, there isn&#x2019;t really much to it. It is the effects of the Warrants that make it such an interesting concept. One thing to note here is that the date that we care about for the Warrant isn&#x2019;t the date it was issued, but when the guy was actually arrested, that is where the clock starts ticking. Adding a Warrant is also not that complex from a data entry perspective:    As you can see, thus far, it is pretty simple. But when you click the Finish button the complexity starts. We need to check that the Warrant is valid (issued by someone with the authority to do so), and then calculate the new duration for the Inmate. And that is enough for today, I just wrote ~10 posts on Macto in the last 24 hours, it is time to do something else.</p>
        </article>
        <article id="article-4927">
            <a href="https://ayende.com/blog/63490/answer-modifying-execution-approaches" target="_blank">
                <h2 class="title mb-6" id="article-4927">Answer</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 16, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In RavenDB, we had this piece of code:         internal T[] LoadInternal&lt;T&gt;(string[] ids, string[] includes)&#xA;        {&#xA;            if(ids.Length == 0)&#xA;                return new T[0];&#xA;&#xA;            IncrementRequestCount();&#xA;            Debug.WriteLine(string.Format(&quot;Bulk loading ids [{0}] from {1}&quot;, string.Join(&quot;, &quot;, ids), StoreIdentifier));&#xA;            MultiLoadResult multiLoadResult;&#xA;            JsonDocument[] includeResults;&#xA;            JsonDocument[] results;&#xA;#if !SILVERLIGHT&#xA;            var sp = Stopwatch.StartNew();&#xA;#else&#xA;            var startTime = DateTime.Now;&#xA;#endif&#xA;            bool firstRequest = true;&#xA;            do&#xA;            {&#xA;                IDisposable disposable = null;&#xA;                if (firstRequest == false) // if this is a repeated request, we mustn&#x27;t use the cached result, but have to re-query the server&#xA;                    disposable = DatabaseCommands.DisableAllCaching();&#xA;                using (disposable)&#xA;                    multiLoadResult = DatabaseCommands.Get(ids, includes);&#xA;&#xA;                firstRequest = false;&#xA;                includeResults = SerializationHelper.RavenJObjectsToJsonDocuments(multiLoadResult.Includes).ToArray();&#xA;                results = SerializationHelper.RavenJObjectsToJsonDocuments(multiLoadResult.Results).ToArray();&#xA;            } while (&#xA;                AllowNonAuthoritiveInformation == false &amp;&amp;&#xA;                results.Any(x =&gt; x.NonAuthoritiveInformation ?? false) &amp;&amp;&#xA;#if !SILVERLIGHT&#xA;                sp.Elapsed &lt; NonAuthoritiveInformationTimeout&#xA;#else &#xA;                (DateTime.Now - startTime) &lt; NonAuthoritiveInformationTimeout&#xA;#endif&#xA;                );&#xA;&#xA;            foreach (var include in includeResults)&#xA;            {&#xA;                TrackEntity&lt;object&gt;(include);&#xA;            }&#xA;&#xA;            return results&#xA;                .Select(TrackEntity&lt;T&gt;)&#xA;                .ToArray();&#xA;        }&#xA;&#xA;&#xA;And we needed to take this same piece of code and execute it in:&#xA;&#xA;Async fashion &#xA;As part of a batch of queries (sending multiple requests to RavenDB in a single HTTP call).&#xA;Everything else is the same, but in each case the marked line is completely different.&#xA;I chose to address this by doing a Method Object refactoring. I create a new class, and moved all the local variables to fields, and moved each part of the method to its own method. I also explicitly gave up control on executing, deferring that to whoever it calling us. We ended up with this:&#xA;    public class MultiLoadOperation&#xA;    {&#xA;        private static readonly Logger log = LogManager.GetCurrentClassLogger();&#xA;&#xA;        private readonly InMemoryDocumentSessionOperations sessionOperations;&#xA;        private readonly Func&lt;IDisposable&gt; disableAllCaching;&#xA;        private string[] ids;&#xA;        private string[] includes;&#xA;        bool firstRequest = true;&#xA;        IDisposable disposable = null;&#xA;        JsonDocument[] results;&#xA;        JsonDocument[] includeResults;&#xA;                &#xA;#if !SILVERLIGHT&#xA;        private Stopwatch sp;&#xA;#else&#xA;        private    DateTime startTime;&#xA;#endif&#xA;&#xA;        public MultiLoadOperation(InMemoryDocumentSessionOperations sessionOperations, &#xA;            Func&lt;IDisposable&gt; disableAllCaching,&#xA;            string[] ids, string[] includes)&#xA;        {&#xA;            this.sessionOperations = sessionOperations;&#xA;            this.disableAllCaching = disableAllCaching;&#xA;            this.ids = ids;&#xA;            this.includes = includes;&#xA;        &#xA;            sessionOperations.IncrementRequestCount();&#xA;            log.Debug(&quot;Bulk loading ids [{0}] from {1}&quot;, string.Join(&quot;, &quot;, ids), sessionOperations.StoreIdentifier);&#xA;&#xA;#if !SILVERLIGHT&#xA;            sp = Stopwatch.StartNew();&#xA;#else&#xA;            startTime = DateTime.Now;&#xA;#endif&#xA;        }&#xA;&#xA;        public IDisposable EnterMultiLoadContext()&#xA;        {&#xA;            if (firstRequest == false) // if this is a repeated request, we mustn&#x27;t use the cached result, but have to re-query the server&#xA;                disposable = disableAllCaching();&#xA;            return disposable;&#xA;        }&#xA;&#xA;        public bool SetResult(MultiLoadResult multiLoadResult)&#xA;        {&#xA;            firstRequest = false;&#xA;            includeResults = SerializationHelper.RavenJObjectsToJsonDocuments(multiLoadResult.Includes).ToArray();&#xA;            results = SerializationHelper.RavenJObjectsToJsonDocuments(multiLoadResult.Results).ToArray();&#xA;&#xA;            return    sessionOperations.AllowNonAuthoritiveInformation == false &amp;&amp;&#xA;                    results.Any(x =&gt; x.NonAuthoritiveInformation ?? false) &amp;&amp;&#xA;#if !SILVERLIGHT&#xA;                    sp.Elapsed &lt; sessionOperations.NonAuthoritiveInformationTimeout&#xA;#else &#xA;                    (DateTime.Now - startTime) &lt; sessionOperations.NonAuthoritiveInformationTimeout&#xA;#endif&#xA;                ;&#xA;        }&#xA;&#xA;        public T[] Complete&lt;T&gt;()&#xA;        {&#xA;            foreach (var include in includeResults)&#xA;            {&#xA;                sessionOperations.TrackEntity&lt;object&gt;(include);&#xA;            }&#xA;&#xA;            return results&#xA;                .Select(sessionOperations.TrackEntity&lt;T&gt;)&#xA;                .ToArray();&#xA;        }&#xA;    }&#xA;&#xA;&#xA;&#xA;&#xA;Note that this class doesn&#x2019;t contain two very important things:&#xA;&#xA;The actual call to the database, we gave up control on that. &#xA;The execution order for the methods, we don&#x2019;t control that either.&#xA;That was ugly, and I decided that since I have to write another implementation as well, I might as well do the right thing and have a shared implementation. The key was to extract everything away except for the call to get the actual value. So I did just that, and we got a new class, that does all of the functionality above, except control where the actual call to the server is made and how.&#xA;Now, for the sync version, we have this code:&#xA;internal T[] LoadInternal&lt;T&gt;(string[] ids, string[] includes)&#xA;{&#xA;    if(ids.Length == 0)&#xA;        return new T[0];&#xA;&#xA;    var multiLoadOperation = new MultiLoadOperation(this, DatabaseCommands.DisableAllCaching, ids, includes);&#xA;    MultiLoadResult multiLoadResult;&#xA;    do&#xA;    {&#xA;        using(multiLoadOperation.EnterMultiLoadContext())&#xA;        {&#xA;            multiLoadResult = DatabaseCommands.Get(ids, includes);&#xA;        }&#xA;    } while (multiLoadOperation.SetResult(multiLoadResult));&#xA;&#xA;    return multiLoadOperation.Complete&lt;T&gt;();&#xA;}&#xA;&#xA;&#xA;&#xA;&#xA;This isn&#x2019;t the most trivial of methods, I&#x2019;ll admit, but it is ever so much better than the alternative, especially since now the async version looks like:&#xA;/// &lt;summary&gt;&#xA;/// Begins the async multi load operation&#xA;/// &lt;/summary&gt;&#xA;public Task&lt;T[]&gt; LoadAsyncInternal&lt;T&gt;(string[] ids, string[] includes)&#xA;{&#xA;    var multiLoadOperation = new MultiLoadOperation(this,AsyncDatabaseCommands.DisableAllCaching, ids, includes);&#xA;    return LoadAsyncInternal&lt;T&gt;(ids, includes, multiLoadOperation);&#xA;}&#xA;&#xA;private Task&lt;T[]&gt; LoadAsyncInternal&lt;T&gt;(string[] ids, string[] includes, MultiLoadOperation multiLoadOperation)&#xA;{&#xA;    using (multiLoadOperation.EnterMultiLoadContext())&#xA;    {&#xA;        return AsyncDatabaseCommands.MultiGetAsync(ids, includes)&#xA;            .ContinueWith(t =&gt;&#xA;            {&#xA;                if (multiLoadOperation.SetResult(t.Result) == false)&#xA;                    return Task.Factory.StartNew(() =&gt; multiLoadOperation.Complete&lt;T&gt;());&#xA;                return LoadAsyncInternal&lt;T&gt;(ids, includes, multiLoadOperation);&#xA;            })&#xA;            .Unwrap();&#xA;    }&#xA;}&#xA;&#xA;&#xA;Again, it isn&#x2019;t trivial, but at least the core stuff, the actual logic that isn&#x2019;t related to how we execute the code is shared.</p>
        </article>
        <article id="article-4928">
            <a href="https://ayende.com/blog/56321/macto-talking-to-nasty-people" target="_blank">
                <h2 class="title mb-6" id="article-4928">Macto</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 15, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Well, so far we have looked at the main screen and the Counting screen, it is time we introduce ourselves to the Inmate screen as well:  As you can see, there isn&#x2019;t a lot going on here. We have the Inmate&#x2019;s Id, name and location (including noting where he is located, if he is known to be outside the prison). We don&#x2019;t usually care for things like detailed information in the normal course of things (the Inamte&#x2019;s national id, for example). That information is important, but usually not relevant, we relegate it to a separate screen. The dates for incarceration and scheduled release are also important, but they aren&#x2019;t available for editing, they are there only for information purposes. The note is there to make sure that highly important information (such as whatever the Inmate is suicidal / flight risk) would be clearly available. The same is true for the Cliff Notes version of the Record. It is there not for casual use, but to ensure that pertinent information is available. Most importantly, note the last line there. Which means that if this Inmate is about to be released, we have to notify someone and get their approval for that. Well, approval is a strong word, we notify them that they need to give us a new Warrant for the Inmate, but we can delay releasing him (say, until midnight the day he is to be released) waiting for that Warrant. Warrants are important, and you can see the ones that this guy have listed here. The last Warrant is the important one, the others are shown for completion sake and to ensure that we have continuous Warrants. There are also several actions that we can do to an Inmate. We can Transfer him to another prison, Release him or Add a Warrant. Each of those is a complex process of its own, and I&#x2019;ll discuss them later on.</p>
        </article>
        <article id="article-4929">
            <a href="https://benfoster.io/blog/structuremap-resourcefactory-wcf-webapi/" target="_blank">
                <h2 class="title mb-6" id="article-4929">Creating a StructureMap Resource Factory for WCF Web API</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 15, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I demonstrate how to register a custom IResourceFactory in WCF Web Api that uses StructureMap to create our resources.</p>
        </article>
        <article id="article-4930">
            <a href="https://benfoster.io/blog/new-fabrik-theme-system-preview/" target="_blank">
                <h2 class="title mb-6" id="article-4930">A look at the new fabrik theme system</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 14, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I give you a preview of the new fabrik theme system and discuss some of the technical challenges I faced in creating it.</p>
        </article>
        <div class="button flex justify-between">
            <a href="492.html"><span class="back arrow"></span></a>

            <a href="494.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
