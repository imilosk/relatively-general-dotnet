
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 887 • Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-8861">
            <a href="https://ayende.com/blog/1454/nhibernate-caching-and-tests-oh-my" target="_blank">
                <h2 class="title mb-6" id="article-8861">NHibernate, Caching  and tests, Oh My!</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 11, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I just spent several hours trying to figure out why enabling NHibernate second level caching caused a lot of my tests to fail, seemingly randomly.&#xA;The initial problem was obvious, I was trying to be efficient, and I used a stored procedure (yes, I do use them  ) to delete all the database and restore it to a known state. With caching, this meant that the cache and the database were in an inconsistent state. I need to restore my database to a consistent state because I need my tests to be repeatable.&#xA;Yes, I am familiar with all the argument against unit tests hitting the database, and yes I do feel the pain. I&#x2019;m going to do something about it soon, but for now, I need to work with what I have got. My problem was compounded by the fact that large parts of the database are read only, so I wanted to keep them in the cache for the tests.&#xA;I quickly wrote this function, which was called before each test was run:&#xA;private&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;void ClearCache()&#xA;{&#xA;    ISessionFactory factory = Context. SessionFactory;&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ICollection types = factory.GetAllClassMetadata().Keys;&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;foreach (Type type in types)&#xA;    {&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if (typeof(NotChanging) == type)&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;continue;&#xA;            factory.Evict(type);&#xA; &#xA;&#xA0;   }&#xA;}&#xA;&#xA0;And I thought I was through with it, but apparently not. I still got seemingly random tests failures, I couldn&#x2019;t reproduce them most of the time, and when I did, they made me question whatever the test itself had a bug. Eventually I realized that I was being stupid.&#xA;The reason for that is that NHibernate doesn&#x2019;t really have a single second level cache. It actually has three. Well, not really three, but it is logically segmented to three caches.&#xA;The first cache, which I cleared effectively, was the object cache. This holds the values of the cached entities. &#xA;The second cache, which I forgot about, is the collections cache.  This holds the association between the entities. &#xA;The third cache, which I am not using, is the query cache. It holds the results of HQL queries.&#xA;There are also cache regions, but I won&#x2019;t get into that now. What I need to do was simply add this to my ClearCache() method, and everything turned out just fine:&#xA;foreach (string  role in factory.GetAllCollectionMetadata().Keys)&#xA;{&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(!role.Contains(&quot;NotChangin&quot;))&#xA;   factory.EvictCollection(role);&#xA;}&#xA;&#xA;&#xA0;I need the caching support to hold the major read only data in memory for the tests, since it considerably shorten their runtime.&#xA;I am also going to see what I can do to mock all the data access code that doesn&#x2019;t actually test that talking to the database works. It should be simple enough, but I got quite a bit of tests to refactor.</p>
        </article>
        <article id="article-8862">
            <a href="https://ayende.com/blog/1453/riddle-me-this" target="_blank">
                <h2 class="title mb-6" id="article-8862">Riddle me this...</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 11, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">What is the result of the following code:            public class Foo                        {                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; public static void Recursive()                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Recursive();                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;                                 &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; public static void Main(string[]args)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; try                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Recursive();                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; catch(StackOverflowException&#xA0; e)                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; {                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Console.WriteLine(&quot;Bummer&quot;);                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }                        &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; }                        }                        In .Net 1.0/1.1 ?    In .Net 2.0 ?</p>
        </article>
        <article id="article-8863">
            <a href="https://ayende.com/blog/1452/jonathan-coulton" target="_blank">
                <h2 class="title mb-6" id="article-8863">Jonathan Coulton</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 11, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Jonathan Coulton is the one who performed the Code Monkey song. He has a lot of free music on his site. I downloaded all of it and liked what I heard, so I bought the entire collection. &#xA;Highly recommended.</p>
        </article>
        <article id="article-8864">
            <a href="https://ayende.com/blog/1451/the-adventures-of-a-developer-seeking-good-performance" target="_blank">
                <h2 class="title mb-6" id="article-8864">The adventures of a developer seeking good performance&#x2026;</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 11, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am beginning to really appreciate a lot of enterprise-y stuff. Mostly because my poor laptop is no longer a real development machine, but just barely adequate for the job. In local development mode, my machine needs to carry SQL Server, ASP.Net, My application (not light weight, I am afraid), VS.Net, SQL Management Studio, Outlook, etc. This is not conductive to a proper working conditions, or my continued sanity.&#xA;I understand that the problem is paging, so I did a search about paging performance, and apparently the answer to that is to use Ajax to reduce the load. I tried to convince Windows to do paging using Ajax, but it stubbornly refused to cooperate.&#xA;I mean, everyone knows that Java script is built into Windows, I don&#x2019;t see why I can&#x2019;t use it to customize the way Windows work. I mean, it is pretty straightforward, it you think of it. I saw Scott Guthrie&#x2019;s video, and it only took him a few minutes to do it.&#xA;Then I realized that it was because he used Atlas, and not plain Ajax. I was elated, and immediately set to use Atlas to reduce the paging on my machine. It didn&#x2019;t work, although I am not sure why. Okay, I understand that Atlas is in beta, and won&#x2019;t be release in a million years or so, but still. Paging seems to be pretty basic requirement from an Ajax toolkit.&#xA;I&#x2019;m beginning to fear that Ajax is not the answer to everything, no doubt because it doesn&#x2019;t have 42 in its name. I heard that Microsoft has a Project 42 somewhere, I bet that they are working on this at this moment.  It seems elementary to use Ajax experience to speed up Windows. &#xA;Never mind, after seeing that Ajax is not the solution,  I found a password to one of the useless servers and took over it. It had all sort of crappy stuff that I don&#x2019;t know like BizTalk and Back Office. I don&#x2019;t like back offices and no one serious would call their product BizTalk, so I kicked them out,  put the development database on it, and started to work against it. &#xA;Someone also put a lot of data in SQL Server there. And it was really busy serving some really stupid queries. I mean, it was all stored procedure calls, and I didn&#x2019;t like the naming convention: &#x201C;hr_PaySalaries&#x201D;, &#x201C;hr_EndOfMonthProcessing&#x201D;. It was keeping the server too busy, so I dropped the database, and everything worked just fine after that.&#xA;Even with network latencies, just turning SQL Server off brought some performance improvements. If remote debugging wasn&#x2019;t such a pain, I would have moved  the web server itself to another machine. It is really hard to work right now, because there is a lot of screaming and shouting outside the door. I do my best to ignore it, but it is pretty hard. It sound like the sys admin is pretty pissed. And he should be, if he was doing his job I would have to  work so hard to get a proper server.&#xA;I also spent some time adding caching to the application, which should help, but several tests broke.  I fixed that pretty quickly. Apparently the old &#x201C;we can do it the easy way or I can bring out the 5 Kg hammer&#x201D; work on this machine.  I&#x2019;m seriously considering adding distributed caching to the application, just so the cache wouldn&#x2019;t get lost every time that I restart the application (and, of course, so the cache wouldn&#x2019;t take memory on my machine).&#xA;I just need a few machines with a lot of RAM available. The problem is that I had only one server password, and the way the sys-admin is shouting outside, I don&#x2019;t think it is a good time to ask him for another one. I am thinking about writing a script and sending it to all my contact list, it will install the distributed cache and then I will finally have enough RAM to work.&#xA;I think I got to go now, I just got a very angry email saying I need to go to the servers room, and I&#x2019;m not sure why. I am working very hard just to be able to work.  Maybe they finally realized that I need a stronger machine and they will let me choose my next machine&#x2026;&#xA;Note: this post was written while waiting for VS.Net to start responding&#x2026;</p>
        </article>
        <article id="article-8865">
            <a href="https://ayende.com/blog/1450/net-versions-2-years-from-now" target="_blank">
                <h2 class="title mb-6" id="article-8865">.Net Versions, 2 Years From Now</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After reading this post, a scenario came to mind:We are going to build this application on the CLR 3.2 in .Net 4.1 SP3 using C# 3.0 and WCF 3.8 with WPF 3.1 as smart client deployed using ClickTwicePointThree.    Yes, it is absurd, but I can sense the confustion this is going to cause.</p>
        </article>
        <article id="article-8866">
            <a href="https://ayende.com/blog/1449/list-t-is-broken" target="_blank">
                <h2 class="title mb-6" id="article-8866">List&lt;T&gt; is broken</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">It is broken because it is a basic framework class that&#xA0;doesn&#x27;t have a single virtual method. I want to have a list where a delegate is called when an item is added or removed, but I can&#x27;t do that, since this means that I need to override the Add()/Remove() methods. I need to create a completely new class, implement the entire IList&lt;T&gt; functionality, to get such a basic behavior.    Yes, I know about Collection&lt;T&gt;, but this isn&#x27;t acceptable. Why have two seperate classes? If I want a custom&#xA0;collection with ForEach() method on it, I need to do it myself. This is no way to write an extensible framework.&#xA0;They might as well have sealed the class.</p>
        </article>
        <article id="article-8867">
            <a href="https://ayende.com/blog/1448/on-system-transaction" target="_blank">
                <h2 class="title mb-6" id="article-8867">On System.Transaction</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is an excellent post about System.Transactions, which include a very concise example of how to build your own resource manager for integrating with System.Transactions.    Highly recommended.</p>
        </article>
        <article id="article-8868">
            <a href="https://ayende.com/blog/1447/on-memcached" target="_blank">
                <h2 class="title mb-6" id="article-8868">On Memcached</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">For some reason, I have not heard much about Memcached in the .Net circles, which is a shame. Memcached is a distributed memory caching system, which makes it very interesting for ASP.Net applications in web farms scenarios (but not just), since the ASP.Net cache is local cache, and can go out of sync with the other caches on the     The basic idea is that a Memcached server is listening on a port, and you set and get data from it. So far, it is not very exciting, but the nice part is that there everything is in memory, and that you can use multiply Memcached server to increase the cache size indefinitely very cheaply. Because everything is done in memory, and the server is carefully designed to hold no locks, the performance is really impressive.    An interesting scenario is to take couple hundreds of megabytes from each computer in the organization, and use that to fuel the cache size for the servers. Memcached has automatic failover support, so you can just ignore Memcached server going offline for a period of time, and it is very low on CPU usage.    I intended to write&#xA0;a bit more about it, but I found this article, that explains how it works, and it even have some pretty pictures, so it is pretty useless for me to try. :-)    A couple of interesting points Memcached:            It runs out of process, so it is not affected by IIS Reset, restarting the application, etc. This is very important if you rely on&#xA0;a cache for good performance, and especially if you application startup loads big amounts of data. This is very important in development, since we can safely skip this initialization step when we are developing.            Memcached can cache any byte stream, which means that in .Net, it can hold any serialized object            It is one of the options for NHibernate&#x27;s caching, and the recommended one for use in web farms. This make it very attractive to me, since I can flip a switch and start using it, without touching my code.            Make sure that you set it up in a way that makes maping highly unlikely (in other words, if you put it on a 1Gb machine, don&#x27;t tell it to cache 2Gb), there is no point in paging in a caching server.            Using Memcached can significantly reduce your database load, turning it into a mostly write store.            Many people seem to be using Memcached as a fast storage engine for interesting data that shouldn&#x27;t be persisted. Caching calculation, behavioral patterns, etc.    I&#x27;ll just add that Memcached servers exists for unix&#xA0;and windows, and there are client APIs for just about anything, including .Net.</p>
        </article>
        <article id="article-8869">
            <a href="https://ayende.com/blog/1446/hungry-outlook" target="_blank">
                <h2 class="title mb-6" id="article-8869">Hungry Outlook</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I noticed that I have sudden CPU spikes for no good reason.&#xA;After tracking it a bit, I found that the culprit is Outlook 12.&#xA;&#xA;Take a look at the CPU time numbers:&#xA;&#xA;&#xA;&#xA;Just to give an idea about the implications, SQL Server used&#xA;only two minutes of CPU, and I hit it quite a bit recently.&#xA;&#xA;Here is the CPU Graph, I&#x2019;m showing just one CPU, due&#xA;to space constraints, but the second is just as busy (HT machine).</p>
        </article>
        <article id="article-8870">
            <a href="https://ayende.com/blog/1445/active-record-and-asp-net-2-0" target="_blank">
                <h2 class="title mb-6" id="article-8870">Active Record and ASP.Net 2.0</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: June 10, 2006
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post is prompt by Scott Guthrie&#x2019;s post about ASP.Net&#xA;&#x2B; DLinq and Frans Bouma&#x2019;s post about LLBLGen&#xA;Pro v2.0 with ASP.NET 2.0. For completion sake, I think that I should pipe&#xA;in with how you would do this with Active Record. I&#xA;strongly urge you to read both posts, since I&#x2019;m going to go short on text&#xA;and heavy on code.&#xA;&#xA;&#xA0;&#xA;&#xA;One thing to note before we begin, both DLinq &amp; LLBLGen Pro&#xA;posts used the code generation utilities for the demo. While Active Record has&#xA;a tool that can generate code from existing databases, it is targeted to version&#xA;1.1, and is not actively maintained at the moment. So, we will write the code&#xA;from scratch, and we will enjoy doing it J.&#xA;&#xA0;As you will see, there isn&#x2019;t much code to write.&#xA;&#xA;&#xA0;&#xA;&#xA;I wrote extensively about Active Record in 2.0 in a previous&#xA;set&#xA;of posts.&#xA;&#xA;&#xA0;&#xA;&#xA;Step 1 : Setting up the project&#xA;&#xA;Create a Web Site or a Web Application project and add a&#xA;reference to Castle.ActiveRecord.dll &#xA;&#xA;&#xA0;&#xA;&#xA;Step 2: Create The Customer Class&#xA;&#xA;This is a very simple process, I&#x2019;m showing only some&#xA;of the code here, but you can see that it is a matter of simply having a&#xA;property marked with [Property] per each column in the table.&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA; &#xA;  &#xA;  [ActiveRecord(&quot;Customers&quot;)]&#xA;  public class Customer : ActiveRecordBase&lt;Customer&gt;&#xA;  {&#xA;  &#xA0;&#xA;  &#xA0;&#xA0;&#xA0; [PrimaryKey(PrimaryKeyType.Assigned)]&#xA;  &#xA0;&#xA0;&#xA0; public&#xA;  string CustomerID&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; get { return&#xA;   customerID; }&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; set {  customerID = value;&#xA;  }&#xA;  &#xA0;&#xA0;&#xA0; }&#xA;  &#xA0;&#xA;  &#xA0;&#xA0;&#xA0; [Property]&#xA;  &#xA0;&#xA0;&#xA0; public&#xA;  string City&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; get { return  city;&#xA;  }&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; set {  city = value;&#xA;  }&#xA;  &#xA0;&#xA0;&#xA0; }&#xA;  &#xA0;&#xA;  &#xA0;&#xA0;&#xA0; [Property]&#xA;  &#xA0;&#xA0;&#xA0; public&#xA;  string Region&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; get { return&#xA;   region; }&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; set {  region = value;&#xA;  }&#xA;  &#xA0;&#xA0;&#xA0; }&#xA;  &#xA0;&#xA;  &#xA0;&#xA0;&#xA0; [Property]&#xA;  &#xA0;&#xA0;&#xA0; public&#xA;  string CompanyName&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; get { return&#xA;   companyName; }&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; set {  companyName = value;&#xA;  }&#xA;  &#xA0;&#xA0;&#xA0;&#xA;  }&#xA;  }&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Step 3: Setup configuration&#xA;&#xA;&#xA0;&#xA;&#xA;Create the following web.config file:&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA; &#xA;  &#xA;  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&#xA;  &lt;configuration&gt;&#xA;  &#xA0; &lt;configSections&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;section name=&quot;activerecord&quot;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;type=&quot;Castle.ActiveRecord.Framework.Config.ActiveRecordSectionHandler,&#xA;  Castle.ActiveRecord&quot; /&gt;&#xA;  &#xA0; &lt;/configSections&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA;  &#xA0; &lt;connectionStrings&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;add name=&quot;NorthWind&quot; connectionString=&quot;Data&#xA;  Source=localhost;Initial Catalog=Northwind;Integrated Security=True;&quot;/&gt;&#xA;  &#xA0; &lt;/connectionStrings&gt;&#xA;  &#xA0;&#xA;  &#xA0; &lt;activerecord isWeb=&quot;true&quot;&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;config&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;add key=&quot;hibernate.connection.driver class&quot; value=&quot;NHibernate.Driver.SqlClientDriver&quot; /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;add key=&quot;hibernate.dialect&quot;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  value=&quot;NHibernate.Dialect.MsSql2000Dialect&quot; /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;add key=&quot;hibernate.connection.provider&quot;&#xA0;&#xA0;&#xA0;&#xA0; value=&quot;NHibernate.Connection.DriverConnectionProvider&quot; /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;add key=&quot;hibernate.connection.connection string&quot; value=&quot;ConnectionString =&#xA;  ${NorthWind}&quot; /&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;/config&gt;&#xA;  &#xA0; &lt;/activerecord&gt;&#xA;  &#xA0;&#xA;  &lt;/configuration&gt;&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Create a global.asax file and add the following to the&#xA;Application Start event handler, which will initialize Active Record:&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA; &#xA;  &#xA;  void Application Start(object&#xA;  sender, EventArgs e) &#xA;  {&#xA;  &#xA0;&#xA0;&#xA0; Castle.ActiveRecord.Framework.IConfigurationSource source =&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  System.Configuration.ConfigurationManager.GetSection(&quot;activerecord&quot;) as Castle.ActiveRecord.Framework.IConfigurationSource;&#xA;  &#xA0;&#xA0;&#xA0; Castle.ActiveRecord.ActiveRecordStarter.Initialize(typeof(Customer).Assembly, source);&#xA;  }&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Step 4: Write a page that uses Active Record&#xA;&#xA;&#xA0;&#xA;&#xA;Now we can write the page, like this:&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA; &#xA;  &#xA;  &lt;%@ Page&#xA;  Language=&quot;C#&quot;&#xA;  AutoEventWireup=&quot;true&quot;&#xA;  CodeFile=&quot;Default.aspx.cs&quot;&#xA;  Inherits=&quot; Default&quot;&#xA;  %&gt;&#xA;  &#xA0;&#xA;  &lt;html&gt;&#xA;  &lt;body&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;form id=&quot;form2&quot; runat=&quot;server&quot;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;h1&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  Northwind Customers&lt;/h1&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;asp:GridView ID=&quot;GridView1&quot;&#xA;  AutoGenerateColumns=&quot;false&quot;&#xA;  runat=&quot;server&quot;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;Columns&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;asp:BoundField HeaderText=&quot;Customer&#xA;  ID&quot; DataField=&quot;CustomerID&quot; /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;asp:BoundField HeaderText=&quot;Name&quot;&#xA;  DataField=&quot;CompanyName&quot;&#xA;  /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;asp:BoundField HeaderText=&quot;City&quot;&#xA;  DataField=&quot;City&quot;&#xA;  /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;asp:BoundField HeaderText=&quot;State&quot;&#xA;  DataField=&quot;Region&quot;&#xA;  /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;/Columns&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/asp:GridView&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;/form&gt;&#xA;  &lt;/body&gt;&#xA;  &lt;/html&gt;&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;And the code behind is simply:&#xA;&#xA;&#xA; &#xA;  &#xA;  protected void Page Load(object sender, EventArgs&#xA;  e)&#xA;  {&#xA;  &#xA0;&#xA0;&#xA0; GridView1.DataSource = Customer. FindAllByProperty(&quot;Country&quot;,&quot;USA&quot;);&#xA;  &#xA0;&#xA0;&#xA0; GridView1.DataBind();&#xA;  }&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;The result is&#x2026; &#xA;&#xA;&#xA;&#xA;Step 5: Data Shaping and Projections&#xA;&#xA;Here Scott took advantage of anonymous types in C# 3.0,&#xA;which we can&#x2019;t take advantage of in C# 2.0. Because of this, we need a&#xA;real type that we will use for projection. It is a very simple one:&#xA;&#xA;&#xA;&#xA;We need to add those two columns to the grid:&#xA;&#xA;&#xA; &#xA;  &#xA;  &lt;asp:BoundField HeaderText=&quot;Num Orders&quot; DataField=&quot;NumberOfOrders&quot; /&gt;&#xA;  &lt;asp:BoundField HeaderText=&quot;Last&#xA;  Order&quot; DataField=&quot;LastOrderDate&quot; &#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; DataFormatString=&quot;{0:d}&quot;&#xA;  HtmlEncode=&quot;false&quot;&#xA;  /&gt;&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Then, we use a projection query to get the results from the&#xA;database. What we end up with is this:&#xA;&#xA;&#xA; &#xA;  &#xA;  protected void Page Load(object sender, EventArgs&#xA;  e)&#xA;  {&#xA;  &#xA0;&#xA0;&#xA0; IActiveRecordQuery&#xA;  query = new HqlBasedQuery(typeof (Customer),&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; @&quot;select new CustomerProjection(c.CustomerID,&#xA;  c.CompanyName, c.City, &#xA;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; c.Region,&#xA;  count(o), max(o.OrderDate) )&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  from Customer c join c.Orders o where c.Country = &#x27;USA&#x27;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  group by c.CustomerID, c.CompanyName, c.City, c.Region&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &quot;);&#xA;  &#xA0;&#xA0;&#xA0; GridView1.DataSource = ActiveRecordMediator.ExecuteQuery(query);&#xA;  &#xA0;&#xA0;&#xA0; GridView1.DataBind();&#xA;  }&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Running this code will result in this page:&#xA;&#xA;&#xA;&#xA;By the way, a note to all the efficiency freaks out there,&#xA;the above query result in a&#xA0; single query sent to the server.&#xA;&#xA;&#xA0;&#xA;&#xA;Step 6: Hierarchical Binding&#xA;&#xA;Now that we have projections, let us see how we can use&#xA;Active Record for hierarchical data. Scott&#x2019;s example used anonymous types&#xA;and Linq to do some very nice things with hierarchical binding. Mixing aggregation&#xA;and hierarchies is more of a problem in C# 2.0 and NHibernate. (Solvable, but&#xA;not within the constraints of demo code) &#xA;&#xA;What is very easy, though, is to work with&#xA;hierarchies:&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA; &#xA;  &#xA;  GridView1.DataSource&#xA;  = Customer.FindAllByProperty(&quot;Country&quot;, &quot;USA&quot;);&#xA;  GridView1.DataBind();&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;The gird looks like this:&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA; &#xA;  &#xA;  &lt;asp:GridView ID=&quot;GridView1&quot; AutoGenerateColumns=&quot;false&quot; runat=&quot;server&quot;&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;Columns&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;asp:BoundField HeaderText=&quot;Customer&#xA;  ID&quot; DataField=&quot;CustomerID&quot; /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;asp:BoundField HeaderText=&quot;Name&quot;&#xA;  DataField=&quot;CompanyName&quot;&#xA;  /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;asp:BoundField HeaderText=&quot;City&quot;&#xA;  DataField=&quot;City&quot;&#xA;  /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;asp:BoundField HeaderText=&quot;State&quot;&#xA;  DataField=&quot;Region&quot;&#xA;  /&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;asp:TemplateField HeaderText=&quot;Recent&#xA;  Orders&quot;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;ItemTemplate&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;ul&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;asp:Repeater ID=&quot;Repeater1&quot;&#xA;  DataSource=&#x27;&lt;%#&#xA;  Eval(&quot;Orders&quot;) %&gt;&#x27; &#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; runat=&quot;server&quot;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;ItemTemplate&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;li&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;%# Eval(&quot;OrderID&quot;)&#xA;  %&gt; - &#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  (&lt;%# Eval(&quot;OrderDate&quot;,&#xA;  &quot;{0:d}&quot;)%&gt;) &lt;/li&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;/ItemTemplate&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;/asp:Repeater&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;/ul&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  &lt;/ItemTemplate&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/asp:TemplateField&gt;&#xA;  &#xA0;&#xA0;&#xA0; &lt;/Columns&gt;&#xA;  &lt;/asp:GridView&gt;&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;And the result is:&#xA;&#xA;&#xA0;&#xA;&#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Step 7: Paging&#xA;&#xA;&#xA0;&#xA;&#xA;I enabled paging for the grid, set the page size to 3 and that&#xA;was about it. &#xA;&#xA;I need to handle the OnPageIndexChanging event, of course,&#xA;but this is trivial.&#xA;&#xA;This is the end result:&#xA;&#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;For completion sake, here is the full code behind:&#xA;&#xA;&#xA; &#xA;  &#xA;  public partial class  Default :&#xA;  System.Web.UI.Page &#xA;  {&#xA;  &#xA0;&#xA0;&#xA0; protected&#xA;  void Page Load(object&#xA;  sender, EventArgs e)&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; if(!IsPostBack)&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  BindData();&#xA;  &#xA0;&#xA0;&#xA0; }&#xA;  &#xA0;&#xA;  &#xA0;&#xA0;&#xA0; private&#xA;  void BindData()&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  GridView1.DataSource = Customer.FindAllByProperty(&quot;Country&quot;, &quot;USA&quot;);&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  GridView1.DataBind();&#xA;  &#xA0;&#xA0;&#xA0; }&#xA;  &#xA0;&#xA;  &#xA0;&#xA0;&#xA0; protected&#xA;  void GridView1 PageIndexChanging(object sender, GridViewPageEventArgs&#xA;  e)&#xA;  &#xA0;&#xA0;&#xA0; {&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;  GridView1.PageIndex = e.NewPageIndex;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; BindData();&#xA;  &#xA0;&#xA0;&#xA0; }&#xA;  }&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;Summary:&#xA;&#xA;Well, you have seen how we can do some fairly complex stuff&#xA;with a minimum of fuss. Enabling complete data binding approach is extremely&#xA;easy as well, using Active Record inherited static methods and Object Data&#xA;Source. I may try to put together a web cast showing how it can be done.</p>
        </article>
        <div class="button flex justify-between">
            <a href="886.html"><span class="back arrow"></span></a>

            <a href="888.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>