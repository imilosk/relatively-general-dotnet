
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 41 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-401">
            <a href="https://devblogs.microsoft.com/dotnet/binaryformatter-removed-from-dotnet-9/" target="_blank">
                <h2 class="title mb-6" id="article-401">BinaryFormatter removed from .NET 9</h2>
            </a>
            <p class="mb-2">by Immo Landwerth</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 28, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Starting with .NET 9, we no longer include an implementation of BinaryFormatter in the runtime. This post covers what options you have to move forward.</p>
        </article>
        <article id="article-402">
            <a href="https://devblogs.microsoft.com/dotnet/announcing-the-dotnet-community-toolkit-830/" target="_blank">
                <h2 class="title mb-6" id="article-402">.NET Community Toolkit 8.3 is here! NativeAOT, .NET 8 enhancements, and more!</h2>
            </a>
            <p class="mb-2">by Sergio Pedri</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 27, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We&#x27;re happy to announce the official launch of the .NET Community Toolkit 8.3 release, featuring .NET 8 and NativeAOT support, performance improvements, several bug fixes and enhancements, and more!</p>
        </article>
        <article id="article-403">
            <a href="https://devblogs.microsoft.com/dotnet/whats-new-in-csharp-dev-kit-august-2024/" target="_blank">
                <h2 class="title mb-6" id="article-403">C# Dev Kit update brings enhanced Razor IntelliSense, Project Status, and New Config Options</h2>
            </a>
            <p class="mb-2">by Wendy Breiding (SHE/HER)</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 27, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Boost your dev workflow with the C# Dev Kit August 2024 release, which brings enhanced Razor IntelliSense, updated Project Status Bar, and new Project Configuration Options!</p>
        </article>
        <article id="article-404">
            <a href="https://devblogs.microsoft.com/dotnet/introducing-pinecone-dotnet-sdk/" target="_blank">
                <h2 class="title mb-6" id="article-404">Introducing the Pinecone .NET SDK</h2>
            </a>
            <p class="mb-2">by Luis Quintanilla</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 27, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Get started building AI applications in .NET using the Pinecone Vector DB and the Pinecone .NET SDK.</p>
        </article>
        <article id="article-405">
            <a href="https://andrewlock.net/using-azure-storage-queues-with-azure-functions-and-queuetrigger/" target="_blank">
                <h2 class="title mb-6" id="article-405">Using Azure Storage Queue messages with Azure Functions and [QueueTrigger]</h2>
            </a>
            <p class="mb-2">by Andrew Lock</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 27, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I discuss using Azure Storage Queue as a message queue and how you can process Storage Queue messages using an Azure Functions app&#x2026;</p>
        </article>
        <article id="article-406">
            <a href="https://ardalis.com/you-should-blog/" target="_blank">
                <h2 class="title mb-6" id="article-406">You Should Blog</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 26, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">As a software developer, you might spend most of your time immersed in code, solving problems, and building innovative solutions. But have&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-407">
            <a href="https://www.meziantou.net/automated-tests.htm" target="_blank">
                <h2 class="title mb-6" id="article-407">Automated tests</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 26, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Automated tests are important to ensure the quality of your application. In the literature, you&#x27;ll find many kinds of automated tests such as unit tests, integration tests, functional tests, smoke tests, and so on. I don&#x27;t like this naming because some tests don&#x27;t fit in a category and people give</p>
        </article>
        <article id="article-408">
            <a href="https://devblogs.microsoft.com/dotnet/supercharge-your-testing-experience-with-ms-test-analyzers/" target="_blank">
                <h2 class="title mb-6" id="article-408">Supercharge your testing experience with MSTest.Analyzers</h2>
            </a>
            <p class="mb-2">by Jakub Jare&#x161;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 21, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">MSTest ships with extensive suite of code analyzers to help you write well-formed, performant and error free tests.</p>
        </article>
        <article id="article-409">
            <a href="https://andrewlock.net/avoiding-cdn-supply-chain-attacks-with-subresource-integrity/" target="_blank">
                <h2 class="title mb-6" id="article-409">Avoiding CDN supply-chain attacks with Subresource Integrity (SRI)</h2>
            </a>
            <p class="mb-2">by Andrew Lock</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 20, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I discus the recent pollyfill.io supply-chain attack and describe how to protect against similar attacks using Subresource Integrity (SRI)&#x2026;</p>
        </article>
        <article id="article-410">
            <a href="https://ayende.com/blog/201602-A/caching-documents-in-ravendb-the-good-the-bad-and-the-ugly" target="_blank">
                <h2 class="title mb-6" id="article-410">Caching documents in RavenDB: The good, the bad and the ugly</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 19, 2024
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">RavenDB has a hidden feature, enabled by default and not something that you usually need to be aware of. It has built-in support for caching. Consider the following code:async Task&lt;Dictionary&lt;string, int&gt;&gt; HowMuchWorkToDo(string userId)&#xD;&#xA;{&#xD;&#xA;    using var session = _documentStore.OpenAsyncSession();&#xD;&#xA;    var results = await session.Query&lt;Item&gt;()&#xD;&#xA;        .GroupBy(x =&gt;new { x.Status, x.AssignedTo })&#xD;&#xA;        .Where(g =&gt; g.Key.AssignedTo == userId &amp;&amp; g.Key.Status != &quot;Closed&quot;)&#xD;&#xA;        .Select(g =&gt; new &#xD;&#xA;        {&#xD;&#xA;            Status = g.Key.Status,&#xD;&#xA;            Count = g.Count()&#xD;&#xA;        })&#xD;&#xA;        .ToListAsync();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    return results.ToDictionary(x =&gt; x.Status, x =&gt; x.Count);&#xD;&#xA;}What happens if I call it twice with the same user? The first time, RavenDB will send the query to the server, where it will be evaluated and executed. The server will also send an ETag&#xA0;header with the response. The client will remember the response and its ETag in its own memory.The next&#xA0;time this is called on the same user, the client will again send a request to the server. This time, however, it will also inform the server that it has a previous response to this query, with the specified ETag. The server, when realizing the client has a cached response, will do a (very cheap) check to see if the cached response matches the current state of the server. If so, it can inform the client (using 304 Not Modified) that it can use its cache.In this way, we benefit twice:First, on the server side, we avoid the need to compute the actual query.Second, on the network side, we aren&#x2019;t sending a full response back, just a very small notification to use the cached version.You&#x2019;ll note, however, that there is still an issue. We have to go to the server to check. That means that we still pay the network costs. So far, this feature is completely transparent to the user. It works behind the scenes to optimize server query costs and network bandwidth costs.We have a full-blown article on caching in RavenDB if you care to know more details&#xA0;instead of just &#x201C;it makes things work faster for me&#x201D;.Aggressive Caching in RavenDBThe next stage is to involve the user. Enter the AggressiveCache()&#xA0;feature (see the full documentation&#xA0;here), which allows the user to specify an additional aspect. Now, when the client has the value in the cache, it will skip&#xA0;going to the server entirely and serve the request directly from the cache. What about cache invalidation? Instead of having the client check on each request if things have changed, we invert the process. The client asks the server to notify it when things change, and until it gets notice from the server, it can serve responses completely from the local cache.I really love this feature, that was the Good part, now let&#x2019;s talk about the other pieces:There are only two hard things in Computer Science: cache invalidation and naming things.-- Phil KarltonThe bad part of caching is that this introduces more complexity to the system. Consider a system with two clients that are using the same database. An update from one of them may show up at different times in each. Cache invalidation will not happen instantly, and it is possible to get into situations where the server fails to notify the client about the update, meaning that we didn&#x2019;t clear the cache.We have a good set of solutions around all of those, I think. But it is important to understand that the problem space itself is a problem. In particular, let&#x2019;s talk about dealing with the following query:var emps = session.Query&lt;Employee&gt;()&#xD;&#xA;    .Include(x =&gt; x.Department)&#xD;&#xA;    .Where(x =&gt; x.Location.City == &quot;London&quot;)&#xD;&#xA;    .ToListAsync();When an employee is changed on the server, it will send a notice to the client, which can evict the item from the cache, right? But what about when a department&#xA0;is changed? For that matter, what happens if a new&#xA0;employee is added to London? How do we detect that we need to refresh this query?There are&#xA0;solutions to those problems, but they are super&#xA0;complicated and have various failure modes that often require more computing power than actually running the query. For that reason, RavenDB uses a much simpler model. If the server notifies us about any&#xA0;change, we&#x2019;ll mark the entire&#xA0;cache as suspect. The next request will have to go to the server (again with an ETag, etc) to verify that the response hasn&#x2019;t changed. Note that if the specific query&#xA0;results haven&#x2019;t changed, we&#x2019;ll get OK (304 Not Modified) from the server, and the client will use the cached response.Conservatively aggressive approachIn other words, even when using aggressive caching, RavenDB still has to go to the server sometimes. What is the impact of this approach when you have a system under load?We&#x2019;ll still use aggressive caching, but you&#x2019;ll see brief periods where we aren&#x2019;t checking with the server (usually be able to cache for about a second or so), followed by queries to the server to check for any changes.In most cases, this is what you want. We still benefit from the cache while reducing the number of remote calls by about 50%, and we don&#x2019;t have to worry about missing updates. The downside is that, as application developers, we know&#xA0;that this particular document and query are independent, so we want to cache them until we get notice about that&#xA0;particular document being changed.The default aggressive caching in RavenDB will not be of major help here, I&#x2019;m afraid. But there are a few things you can do.You can use Aggressive Caching in the NoTracking mode. In that mode, the client will not ask the server for notifications on changes, and will cache the responses in memory until they expire (clock expiration or size expiration only).There is also a feature suggestion that calls for updating the aggressive cache in a background manner, I would love to hear more feedback on this proposal. Another option is to take this feature higher than RavenDB directly, but still use its capabilities. Since we have a scenario where we know that we want to cache a specific set of documents and refresh the cache only&#xA0;when those documents are updated, let&#x2019;s write it.Here is the code:public class RecordCache&lt;T&gt;&#xD;&#xA;{&#xD;&#xA;    private ConcurrentLru&lt;string, T&gt; _items = &#xD;&#xA;        new(256, StringComparer.OrdinalIgnoreCase);&#xD;&#xA;    private readonly IDocumentStore _documentStore;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    public RecordCache(IDocumentStore documentStore)&#xD;&#xA;    {&#xD;&#xA;        const BindingFlags Flags = BindingFlags.Instance | &#xD;&#xA;            BindingFlags.NonPublic | BindingFlags.Public;&#xD;&#xA;        var violation = typeof(T).GetFields(Flags)&#xD;&#xA;            .FirstOrDefault(f =&gt; f.IsInitOnly is false);&#xD;&#xA;        if (violation != null)&#xD;&#xA;        {&#xD;&#xA;            throw new InvalidOperationException(&#xD;&#xA;                &quot;You should cache *only* immutable records, but got: &quot; &#x2B; &#xD;&#xA;                typeof(T).FullName &#x2B; &quot; with &quot; &#x2B; violation.Name &#x2B; &#xD;&#xA;                &quot; which is not read only!&quot;);&#xD;&#xA;        }&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;        var changes = documentStore.Changes();&#xD;&#xA;        changes.ConnectionStatusChanged &#x2B;= (_, args) =&gt;&#xD;&#xA;        {&#xD;&#xA;            _items = new(256, StringComparer.OrdinalIgnoreCase);&#xD;&#xA;        };&#xD;&#xA;        changes.ForDocumentsInCollection&lt;T&gt;()&#xD;&#xA;            .Subscribe(e =&gt;&#xD;&#xA;            {&#xD;&#xA;                _items.TryRemove(e.Id, out _);&#xD;&#xA;            })&#xD;&#xA;            ;&#xD;&#xA;        _documentStore = documentStore;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    public ValueTask&lt;T&gt; Get(string id)&#xD;&#xA;    {&#xD;&#xA;        if (_items.TryGetValue(id, out var result))&#xD;&#xA;        {&#xD;&#xA;            return ValueTask.FromResult(result);&#xD;&#xA;        }&#xD;&#xA;        return new ValueTask&lt;T&gt;(GetFromServer(id));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    private async Task&lt;T&gt; GetFromServer(string id)&#xD;&#xA;    {&#xD;&#xA;        using var session = _documentStore.OpenAsyncSession();&#xD;&#xA;        var item = await session.LoadAsync&lt;T&gt;(id);&#xD;&#xA;        _items.Set(id, item);&#xD;&#xA;        return item;&#xD;&#xA;    }&#xD;&#xA;}There are a few things to note about this code. We are holding live instances, so we ensure that the values we keep are immutable records. Otherwise, we may hand the same instance to two threads which can be&#x2026; fun. Note that document IDs in RavenDB are case insensitive, so we pass the right string comparer.Finally, &#xA0;the magic happens in the constructor. We register for two important events. Whenever the connection status of the Changes()&#xA0;connection is modified, we clear the cache. This handles any lost updates scenarios that occurred while we were disconnected.In practice, the subscription to events on that particular collection is where we ensure that after the server notification, we can evict the document from the cache so that the next request will load a fresh version.Caching &#x2B; Distributed Systems = &#x1F92F;&#x1F92F;&#x1F92F;I&#x2019;m afraid this isn&#x2019;t an easy topic once you dive into the specifics and constraints we operate under. As I mentioned, I would love your feedback on the background cache refresh feature,&#xA0;or maybe you have better insight into other ways to address the topic.</p>
        </article>
        <div class="button flex justify-between">
            <a href="40.html"><span class="back arrow"></span></a>

            <a href="42.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
