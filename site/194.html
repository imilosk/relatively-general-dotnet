
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 194 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-1931">
            <a href="https://ayende.com/blog/185859-A/comparing-c-and-rust-network-protocol-exercises" target="_blank">
                <h2 class="title mb-6" id="article-1931">Comparing C and Rust network protocol exercises</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 05, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Almost by accident, it turned out that I implemented a pretty simple, but non trivial task in both C and Rust and blogged about them.Implementing with CImplementing with RustNow that I&#x2019;m done with both of them, I thought it would be interesting to talk about the differences in the experiences.The Rust version clocks at exactly 400 lines of code and uses 12 external crates.The C version has 911 lines of C code and another 140 lines in headers and depends on libuv and openssl.Both took about two weeks of evenings of me playing around. If I was working full time on that, I could probably do that in a couple of days (but probably more, to be honest).The C version was very straightforward. The C language is pretty much not there, and on the one hand, it didn&#x2019;t get in my way at all. On the other hand, you are left pretty much on your own. I had to write my own error handling code to be sure that I got good errors, for example. I had to copy some string processing routines that aren&#x2019;t available in the standard library, and I had to always be sure that I&#x2019;m releasing resources properly. Adding dependencies is something that you do carefully, because it is so painful. The Rust version, on the other hand, uses the default error handling that Rust has (and much improved since the last time I tried it). I&#x2019;m pretty sure that I&#x2019;m getting worse error messages than the C version I used, but that is good enough to get by, so that is fine. I had to do no resource handling. All of that is already handled for me, and that was something that I didn&#x2019;t even consider until I started doing this comparison. When writing the C version, I spent a lot of time thinking about the structure of the code, debugging through it (to understand what is going on, since I also learned how OpenSSL work) and seeing if things worked. Writing the code and compiling it were both things that I spent very little time on.In comparison, the Rust version (although benefiting from the fact that I did it second, so I already knew what I needed to do) made me spend a lot more time on just writing code and getting it to compile.&#xA0; In both cases, I decided that I wanted this to be a production worthy code, which meant handling all errors, producing good errors, etc. In C, that was simply a tax that needed to be dealt with. With Rust, that was a lot of extra work. The syntax and language really make it obvious that you want to do that, but in most of the Rust code that I reviewed, there are a lot of unwrap() calls, because trying to handle all errors is too much of a burden. When you aren&#x2019;t doing that, your code size balloons, but the complexity of the code didn&#x2019;t, which was a great thing to see.What was really annoying is that in C, if I got a compiler error, I knew exactly what the problem was, and errors were very localized. In Rust, a compiler error could stymie me for hours, just trying to figure out what I need to do to move forward. Note that the situation is much better than it used to be, because I eventually managed to get there, but it took a lot of time and effort, and I don&#x2019;t think that I was trying to explore any dark corners of the language. What really sucked is that Rust, by its nature, does a lot of type inferencing for you. This is great, but this type inferencing goes both backward and forward. So if you have a function and you create a variable using: HashMap::new(), the actual type of the variable depends on the parameters that you pass to the first usage of this instance. That sounds great, and for the first few times, it looked amazing. The problem is that when you have errors, they compound. A mistake in one location means that Rust has no information about other parts of your code, so it generates errors about that. It was pretty common to make a change, run cargo check and see three of four screen&#x2019;s worth of errors pass by, and then go into a &#x201C;let&#x2019;s fix the next compiler error&#x201D; for a while. The type inferencing bit also come into play when you write the code, because you don&#x2019;t have the types in front of you (and because Rust love composing types) it can be really hard to understand what a particular method will return.C&#x2019;s lack of async/await meant that when I wanted to do async operations, I had to decompose that to event loop mode. In Rust, I ended up using tokio, but I think that was a mistake. I should have used the event loop model there as well. It isn&#x2019;t as nice, in terms of the code readability, but the fact that Rust doesn&#x2019;t have proper async/await meant that I had a lot more additional complexity to deal with, and that nearly caused me to give up on the whole thing.I do want to mention that for C, I had run Valgrind a few times to get memory leaks and invalid memory accesses (it found a few, even when I was extra careful). In Rust, the compiler was very strict and several times complained about stuff that if allowed, would have caused problems. I did liked that, but most of the time, it felt like fighting the compiler.Speaking of which, the compilation times for Rust felt really high. Even with 400 lines of code, it can take a couple of seconds to compile (with cargo check, mind, not full build). I do wonder what it will do with a project of significant size. I gotta say, though, compiling the C code meant that I would have to test the code. Compiling the Rust code meant that I could run things and they usually worked. That was nice, but at the same time, getting the thing to compile at all was a major chore many times. Even with the C code not working properly, the feedback loop was much shorter with C than with Rust. And some part of that was that I already had a working implementation for most of what I needed, so I had a lot less need to explore when I wrote the Rust code. I don&#x2019;t have any hard conclusions from the experience, I like the simplicity of C, and if I had something like Go&#x2019;s defer to ensure resource disposal, that would probably be enough (I&#x2019;m aware of libdefer and friends). I find the Rust code elegant (except the async stuff) and the standard library is great. The fact that the crates system is there means that I have very rich access to additional libraries and that this is easy to do. However, Rust is full of ceremony that sometimes seems really annoying. You have to use cargo.toml and extern crate for example. There is a lot more to be done to make the compiler happy. And while it does catch you sometimes doing something your shouldn&#x2019;t, I found that it usually felt like busy work more than anything else. In some ways, it feels like Rust is trying to do too much. I would have like to see something less ambitious. Just focusing on one or two concepts, instead of trying to be high and low level language, type inference set to the make, borrow checker and memory safety, etc. It feels like this is a very high bar to cross, and I haven&#x2019;t seen that the benefits are clearly on the plus side here.</p>
        </article>
        <article id="article-1932">
            <a href="https://andrewlock.net/reducing-latency-by-pre-building-singletons-in-asp-net-core/" target="_blank">
                <h2 class="title mb-6" id="article-1932">Reducing initial request latency by pre-building services in a startup task in ASP.NET Core</h2>
            </a>
            <p class="mb-2">by Andrew Lock</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 05, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I show a startup task that pre-builds all the services registered in the DI container to reduce the duration of the first request to the app.&#x2026;</p>
        </article>
        <article id="article-1933">
            <a href="https://ayende.com/blog/186241-C/the-security-implications-of-self-updating-credentials" target="_blank">
                <h2 class="title mb-6" id="article-1933">The security implications of self updating credentials</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 04, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">RavenDB uses X509 certificates for many purposes. One of them is to enable authentication by using clients certificates. This create a highly secured authentication method with quite a lot to recommend it. But it does create a problem. Certificates, by their very nature, expire. Furthermore, certificates usually have relatively short expiration times. For example, Let&#x2019;s Encrypt certificates expire in 3 months. We don&#x2019;t have to use the same cert we use for server authentication for client authentication as well, but it does create a nice symmetry and simplify the job of the admin.Except that every cert replacement ( 3 months, remember? ) the admin will now need to go to any of the systems that we talk to and update the list of allowed certificates whenever we update the Let&#x2019;s Encrypt certificate. One of the reasons behind this 3 months deadline is to ensure that you&#x2019;ll automate the process of cert replacement, so it is obvious that we need a way to automate the process of updating third parties about cert replacements.Our current design goes like this:This design applies only to the nodes for which we authenticate using our own server certificate (thus excluding Pull Replication, for example).Keep track of all the 3rd parties RavenDB instances that we talk to.Whenever we have an updated certificate, contact each of those instances and let them know about the cert change. This is done using a request that authenticate using the old certificate and providing the new one.The actual certificate replacement is delayed until all of those endpoints have been reached or until the expiration of the current certificate is near.Things to consider:Certificate updates are written to the audit log. And you can always track the chain of updates backward. Obviously, a certificate can only register a replacement as long as it is active.The updated certificate will have the exact same permissions as the current certificate.A certificate can only ever replace itself with one other certificate. We allow to do that multiple times, but the newly updated cert will replace the previous updated cert.A certificate cannot replace a certificate that it updated if that certificate has updated certificate as well. In other words, consider certificate A that is registered in a RavenDB instance:Cert A can ask the RavenDB instance to register updated certificate B, at which point users can connect to the RavenDB instance using either A or B. Until certificate A expires. This is to ensure that during the update process, we won&#x2019;t see some nodes that we need to talk to using cert A and some nodes that we need to talk to using cert B. Cert A can ask the RavenDB instance to register updated certificate C, at which point, certificate B is removed and is no longer valid. This is done in case we failed to update the certificate and need to update with a different certificate. Cert C can then ask the RavenDB instance to register updated certificate D. At this point, certificate A become invalid and can no longer be used. Only certs C and D are now active.More things to consider:Certain certificates, such as the ones exposing Pull Replication, are likely going to be used by many clients. I&#x2019;m not sure if we should allow certificate replacement there. Given that we usually won&#x2019;t use the server cert for authentication in Pull Replication, I don&#x2019;t see that as a problem.The certificate update process will be running on only a single node in the cluster, to avoid concurrency issues.We&#x2019;ll provide a way to the admin to purge all expired certificates (although, with one update every 3 months, I don&#x2019;t expect there to be many).We are considering limiting this to non admin certificates only. So you will not be able to update a certificate if it has admin privileges in an automated manner. I&#x2019;m not sure if this is a security feature or a feel good feature.We&#x2019;ll likely provide administrator notification that this update has happened on the destination node, and that might be enough to allow updating of admin certificates.Any feedback you have would be greatly appreciated.</p>
        </article>
        <article id="article-1934">
            <a href="https://www.meziantou.net/working-with-types-in-a-roslyn-analyzer.htm" target="_blank">
                <h2 class="title mb-6" id="article-1934">Working with types in a Roslyn analyzer</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 04, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post is part of the series &#x27;Roslyn Analyzers&#x27;. Be sure to check out the rest of the blog posts of the series!Writing a Roslyn analyzerWriting language-agnostic Roslyn Analyzers using IOperationWorking with types in a Roslyn analyzer (this post)Referencing an analyzer from a projectPackaging a</p>
        </article>
        <article id="article-1935">
            <a href="https://ardalis.com/how-to-hide-the-connection-bar-in-remote-desktop-connection-rdp/" target="_blank">
                <h2 class="title mb-6" id="article-1935">How to Hide the Connection Bar in Remote Desktop Connection (RDP)</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 03, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Sometimes, like when you&#x27;re trying to record a full screen video from a (virtual) machine you&#x27;ve connected to using remote desktop, you&#x27;d&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-1936">
            <a href="https://ayende.com/blog/186148-A/next-week-in-new-york" target="_blank">
                <h2 class="title mb-6" id="article-1936">Next week in New York</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 01, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;ll be in New York for all of next week, and I got a busy schedule.I&#x2019;m going to be in the O&#x2019;Reilly Architecture Conference on the RavenDB booth, showing off our new features and how RavenDB can figure into your next application&#x2019;s architecture.Feb 4 &#x2013; Feb 6 &#x2013; I&#x2019;ll be at the RavenDB booth in the conference.On Feb 6, I&#x2019;m going to be talking about SQL and NoSQL databases and where to use each.On Feb 7, I&#x2019;m going to be talking about Autonomous Database Self Management. On Feb 10, I&#x2019;m going to be talking about Data flow architecture for Micro Services Systems.If you are around, I would be delighted to meet you in any of these events.</p>
        </article>
        <article id="article-1937">
            <a href="https://enterprisecraftsmanship.com/posts/cqrs-commands-part-domain-model/" target="_blank">
                <h2 class="title mb-6" id="article-1937">Are CQRS commands part of the domain model?</h2>
            </a>
            <p class="mb-2">by Vladimir Khorikov</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 31, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I published an online course about CQRS&#xA0;a couple months ago, and since then I realized that there are some topics I didn&#x2019;t put enough emphasize on in that course, or didn&#x2019;t cover at all. In the next several blog posts, I&#x2019;m going to fill this gap.</p>
        </article>
        <article id="article-1938">
            <a href="https://ayende.com/blog/185858-A/using-tls-in-rust-handling-messages-out-of-band" target="_blank">
                <h2 class="title mb-6" id="article-1938">Using TLS in Rust</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 31, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;m pretty much done with my Rust protocol impl. The last thing that I wanted to try was to see how it would look like when I allow for messages to be handled out of band. Right now, my code consuming the protocol library looks like this:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          // handler def&#xA;        &#xA;        &#xA;          &#xA;          type Handler = fn(self::cmd::Cmd) -&gt; Result&lt;String, ConnectionError&gt;;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          // handler impl&#xA;        &#xA;        &#xA;          &#xA;          fn echo(cmd: server::cmd::Cmd) -&gt; std::result::Result&lt;String, ConnectionError&gt; {&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              Ok(cmd.args[1].clone())&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          // registeration&#xA;        &#xA;        &#xA;          &#xA;          {&#xA;        &#xA;        &#xA;          &#xA;              Arc::get_mut(&amp;mut server).unwrap()&#xA;        &#xA;        &#xA;          &#xA;                  .handle(&quot;echo&quot;.to_string(), echo);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          confumer1.rs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;This is pretty simple, but note that the function definition forces us to return a value immediately, and that we don&#x2019;t have a way to handle a command asynchronously. What I wanted to do is to change things around so I could do that. I decided to implemented the command:remind 15 NapWhich should help me remember to nap. In order to handle this scenario, I need to provide a way to do async work and to keep sending messages to the client. Here was the first change I made:Instead of returning a value from the function, we are going to give it the sender (which will render the value to the client) and can return an error if the command is invalid in some form.That said, it means that the echo implementation is a bit more complex. &#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          fn echo(cmd: server::cmd::Cmd, sender : Sender&lt;String&gt;) -&gt; std::result::Result&lt;(), ConnectionError&gt; {&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              tokio::spawn(sender.send(cmd.args[1].clone()).map_err(|_|()).map(|_|()));&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              Ok(())&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          echo2.rs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;There is&#x2026; a lot of ceremony here, even for something so small. Let&#x2019;s see what happens when we do something bigger, shall we? Here is the implementation of the reminder handler:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          fn remind(cmd: server::cmd::Cmd, sender : Sender&lt;String&gt;) -&gt; std::result::Result&lt;(), ConnectionError&gt; {&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              static COUNTER : std::sync::atomic::AtomicUsize = std::sync::atomic::ATOMIC_USIZE_INIT;&#xA;        &#xA;        &#xA;          &#xA;              // remdind &lt;sec&gt; msg&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              #[async]&#xA;        &#xA;        &#xA;          &#xA;              fn delayed_send(delay: u64, msg: String, sender : Sender&lt;String&gt;) -&gt; std::result::Result&lt;(), ConnectionError&gt; {&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;                  await!(Delay::new(Instant::now() &#x2B;Duration::from_secs(delay)))?;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;                  await!(sender.send(msg))?;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;                  Ok(())&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              let secs : u64  = match cmd.args.get(1){&#xA;        &#xA;        &#xA;          &#xA;                  None =&gt; return Err(ConnectionError::BadDataArgs{&#xA;        &#xA;        &#xA;          &#xA;                      msg: &quot;&#x27;remind&#x27; requires a &lt;secs&gt; argument&quot;.to_string()&#xA;        &#xA;        &#xA;          &#xA;                  }),&#xA;        &#xA;        &#xA;          &#xA;                  Some(str) =&gt; match str.parse::&lt;u64&gt;(){&#xA;        &#xA;        &#xA;          &#xA;                      Err(e) =&gt; return Err(ConnectionError::BadDataArgs{&#xA;        &#xA;        &#xA;          &#xA;                          msg: &quot;&#x27;remind&#x27; requires a &lt;secs&gt; argument to be a u64: &quot;.to_string() &#x2B; &amp;e.to_string()&#xA;        &#xA;        &#xA;          &#xA;                      }),&#xA;        &#xA;        &#xA;          &#xA;                      Ok(v) =&gt; v&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;              let msg = match cmd.args.get(2){&#xA;        &#xA;        &#xA;          &#xA;                  None =&gt; &quot;Reminder&quot;,&#xA;        &#xA;        &#xA;          &#xA;                  Some(v) =&gt; v&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              let id = (COUNTER.fetch_add(1, std::sync::atomic::Ordering::SeqCst) &#x2B; 1).to_string();&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              tokio::spawn(delayed_send(secs, msg.to_string() &#x2B; &quot;\r\nSequence: &quot; &#x2B; &amp;id, sender.clone()).map_err(|_|()));&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              tokio::spawn(sender.send(&quot;OK\r\nSequence: &quot;.to_string() &#x2B; &amp;id).map_err(|_|()).map(|_|()));&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              Ok(())&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          remind.rs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;Admittedly, a lot of that is error handling, but there is a lot of code here to do something that simple.&#xA0; Compare that to something like C#, where the same thing could be written as:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          public async Task Remind(Cmd cmd, TextWriter writer)&#xA;        &#xA;        &#xA;          &#xA;          {&#xA;        &#xA;        &#xA;          &#xA;              if(cmd.Arguments.Count &lt; 3)&#xA;        &#xA;        &#xA;          &#xA;                return await writer.WriteAsync(&quot;ERR command requires 3 parameters\r\n\r\n&quot;);&#xA;        &#xA;        &#xA;          &#xA;                &#xA;        &#xA;        &#xA;          &#xA;               if(int.TryParse(cmd.Arguments[1], out var wait) == false))&#xA;        &#xA;        &#xA;          &#xA;                return await writer.WriteAsync(&quot;ERR cannot parse &lt;wait&gt; argument for command: &quot; &#x2B; cmd.Arguments[1] &#x2B; &quot;\r\n\r\n&quot;);&#xA;        &#xA;        &#xA;          &#xA;               &#xA;        &#xA;        &#xA;          &#xA;               await writer.WriteAsync(&quot;OK\r\n\r\n&quot;);&#xA;        &#xA;        &#xA;          &#xA;               async Task.Delay(wait);&#xA;        &#xA;        &#xA;          &#xA;               await writer.WriteAsync(string.Join(cmd.Arguments.Skip(2)) &#x2B; &quot;\r\n\r\n&quot;);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          reminder.cs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;I&#x2019;m not sure that the amount of complexity that is brought about by the tokio model, even with the async/await macros is worth it at this point. I believe that it needs at least a few more iterations before it is going to be usable for the general public. There is way too much ceremony and work to be done, and a single miss and you are faced with a very pissed off compiler.</p>
        </article>
        <article id="article-1939">
            <a href="https://ayende.com/blog/186081-A/data-modeling-with-indexes-event-sourcing-part-i" target="_blank">
                <h2 class="title mb-6" id="article-1939">Data modeling with indexes</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 30, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post, I want to take the notion of doing computation inside RavenDB&#x2019;s indexes to the next stage. So far, we talked only about indexes that work on a single document at a time, but that is just the tip of the iceberg of what you can do with indexes inside RavenDB. What I want to talk about today is the ability to do computations over multiple documents and aggregate them. The obvious example is in the following RQL query:That is easy to understand, it is simple aggregation of data. But it can get a lot more interesting. To start with, you can add your own aggregation logic in here, which open up some interesting ideas. Event Sourcing, for example, is basically a set of events on a subject that are aggregated into the final model. Probably the classiest example of event sourcing is the shopping cart example. In such a model, we have the following events:AddItemToCartRemoveItemFromCartPayForCartHere what these look like, in document form:We add a couple of items to the cart, remove excess quantity and pay for the whole thing. Pretty simple model, right? But how does this relate to indexing in RavenDB? Well, the problem here is that we don&#x2019;t have a complete view of the shopping cart. We know what the actions were, but not what its current state is. This is where our index come into play, let&#x2019;s see how it works.The final result of the cart should be something like this:Let&#x2019;s see how we get there, shall we? We&#x2019;ll start by processing the add to cart events, like so:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          map(&quot;AddItemToCart&quot;, event =&gt; {&#xA;        &#xA;        &#xA;          &#xA;              var products = {};&#xA;        &#xA;        &#xA;          &#xA;              products[event.Product] = {&#xA;        &#xA;        &#xA;          &#xA;                  Quantity: event.Quantity,&#xA;        &#xA;        &#xA;          &#xA;                  Price: event.Price&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;              return {&#xA;        &#xA;        &#xA;          &#xA;                  Cart: event.Cart,&#xA;        &#xA;        &#xA;          &#xA;                  Products: products&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          add-to-car.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;As you can see, the map phase here build the relevant parts of the end model directly. But we still need to complete the work by doing the aggregation. This is done on the reduce phase, like so:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          groupBy(x=&gt;x.Cart)&#xA;        &#xA;        &#xA;          &#xA;              .aggregate(g =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                  var products = g.values.reduce((agg, item) =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                      for (var key in item.Products) {&#xA;        &#xA;        &#xA;          &#xA;                          var p = item.Products[key];&#xA;        &#xA;        &#xA;          &#xA;                          var existing = agg[key];&#xA;        &#xA;        &#xA;          &#xA;                          if (!existing) {&#xA;        &#xA;        &#xA;          &#xA;                              agg[key] = { Quantity: p.Quantity, Price: p.Price };&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                          else {&#xA;        &#xA;        &#xA;          &#xA;                              existing.Quantity &#x2B;= p.Quantity;&#xA;        &#xA;        &#xA;          &#xA;                              existing.Price = Math.min(p.Price, existing.Price);&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                      return agg;&#xA;        &#xA;        &#xA;          &#xA;                  }, {});&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  return {&#xA;        &#xA;        &#xA;          &#xA;                      Cart: g.key,&#xA;        &#xA;        &#xA;          &#xA;                      Products: products&#xA;        &#xA;        &#xA;          &#xA;                  };&#xA;        &#xA;        &#xA;          &#xA;              })&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          reduce1.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;Most of the code here is to deal with merging of products from multiple add actions, but even that should be pretty simple. You can see that there is a business rule here. The customer will be paying the minimum price they encountered throughout the process of building their shopping cart.Next, let&#x2019;s handle the removal of items from the cart, which is done in two steps. First, we map the remove events:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          map(&quot;RemoveItemFromCart&quot;, event =&gt; {&#xA;        &#xA;        &#xA;          &#xA;              var products = {};&#xA;        &#xA;        &#xA;          &#xA;              products[event.Product] = {&#xA;        &#xA;        &#xA;          &#xA;                  Quantity: -event.Quantity,&#xA;        &#xA;        &#xA;          &#xA;                  Price: 0&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;              return {&#xA;        &#xA;        &#xA;          &#xA;                  Cart: event.Cart,&#xA;        &#xA;        &#xA;          &#xA;                  Products: products&#xA;        &#xA;        &#xA;          &#xA;              };&#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          removefromcart.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;There are a few things to note here, the quantity is negative, and the price is zeroed, that necessitate changes in the reduce as well. Here they are:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          groupBy(x=&gt;x.Cart)&#xA;        &#xA;        &#xA;          &#xA;              .aggregate(g =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                  var products = g.values.reduce((agg, item) =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                      for (var key in item.Products) {&#xA;        &#xA;        &#xA;          &#xA;                          var p = item.Products[key];&#xA;        &#xA;        &#xA;          &#xA;                          var existing = agg[key];&#xA;        &#xA;        &#xA;          &#xA;                          if (!existing) {&#xA;        &#xA;        &#xA;          &#xA;                              agg[key] = { Quantity: p.Quantity, Price: p.Price };&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                          else {&#xA;        &#xA;        &#xA;          &#xA;                              existing.Quantity &#x2B;= p.Quantity;&#xA;        &#xA;        &#xA;          &#xA;                              if(p.Price &gt; 0)&#xA;        &#xA;        &#xA;          &#xA;                                  existing.Price = Math.min(p.Price, existing.Price);&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                      return agg;&#xA;        &#xA;        &#xA;          &#xA;                  }, {});&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;                  for (var key in products) {&#xA;        &#xA;        &#xA;          &#xA;                      if(products[key].Quantity == 0)&#xA;        &#xA;        &#xA;          &#xA;                          delete products[key];&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  return {&#xA;        &#xA;        &#xA;          &#xA;                      Cart: g.key,&#xA;        &#xA;        &#xA;          &#xA;                      Products: products&#xA;        &#xA;        &#xA;          &#xA;                  };&#xA;        &#xA;        &#xA;          &#xA;              })&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          reduce2.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;As you can see, we now only get the cheapest price, above zero, and we&#x2019;ll remove empty items from the cart. The final step we have to take is handle the payment events. We&#x2019;ll start with the map first, obviously.&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          map(&quot;PayForCart&quot;, event =&gt; {&#xA;        &#xA;        &#xA;          &#xA;              var paid = {};&#xA;        &#xA;        &#xA;          &#xA;              paid[event.Method] = event.Paid;&#xA;        &#xA;        &#xA;          &#xA;              return {&#xA;        &#xA;        &#xA;          &#xA;                  Cart: event.Cart,&#xA;        &#xA;        &#xA;          &#xA;                  Products: [],&#xA;        &#xA;        &#xA;          &#xA;                  Paid: paid&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          });&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          payforcart.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;Note that we added a new field to the output. Just like we set the Products fields in the pay for cart map to empty array, we need to update the rest of the maps to include a Paid: {} to match the structure. This is because all the maps (and the reduce) in an index must output the same shape out.And now we can update the reduce accordingly. Here is the third version: &#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          groupBy(x=&gt;x.Cart)&#xA;        &#xA;        &#xA;          &#xA;              .aggregate(g =&gt; {&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;                  var products = g.values.reduce((agg, item) =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                      for (var key in item.Products) {&#xA;        &#xA;        &#xA;          &#xA;                          var p = item.Products[key];&#xA;        &#xA;        &#xA;          &#xA;                          var existing = agg[key];&#xA;        &#xA;        &#xA;          &#xA;                          if (!existing) {&#xA;        &#xA;        &#xA;          &#xA;                              agg[key] = { Quantity: p.Quantity, Price: p.Price };&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                          else {&#xA;        &#xA;        &#xA;          &#xA;                              existing.Quantity &#x2B;= p.Quantity;&#xA;        &#xA;        &#xA;          &#xA;                              if(p.Price &gt; 0)&#xA;        &#xA;        &#xA;          &#xA;                                  existing.Price = Math.min(p.Price, existing.Price);&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                      return agg;&#xA;        &#xA;        &#xA;          &#xA;                  }, {});&#xA;        &#xA;        &#xA;          &#xA;                  for (var key in products) {&#xA;        &#xA;        &#xA;          &#xA;                      if(products[key].Quantity == 0)&#xA;        &#xA;        &#xA;          &#xA;                          delete products[key];&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  var paid = g.values.reduce((agg, item) =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                      for (var key in item.Paid){&#xA;        &#xA;        &#xA;          &#xA;                          agg[key] = item.Paid[key] &#x2B; (agg[key] || 0);&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                      return agg;&#xA;        &#xA;        &#xA;          &#xA;                  }, {});&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  return {&#xA;        &#xA;        &#xA;          &#xA;                      Cart: g.key,&#xA;        &#xA;        &#xA;          &#xA;                      Products: products,&#xA;        &#xA;        &#xA;          &#xA;                      Paid: paid&#xA;        &#xA;        &#xA;          &#xA;                  };&#xA;        &#xA;        &#xA;          &#xA;              })&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          reduce3.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;This is almost there, but we still need to do a bit more work to get the final output right. To make things interesting, I changed things up a bit and here is how we are paying for this cart:And here is the final version of the reduce:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          groupBy(x=&gt;x.Cart)&#xA;        &#xA;        &#xA;          &#xA;              .aggregate(g =&gt; {&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;                  var products = g.values.reduce((agg, item) =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                      for (var key in item.Products) {&#xA;        &#xA;        &#xA;          &#xA;                          var p = item.Products[key];&#xA;        &#xA;        &#xA;          &#xA;                          var existing = agg[key];&#xA;        &#xA;        &#xA;          &#xA;                          if (!existing) {&#xA;        &#xA;        &#xA;          &#xA;                              agg[key] = { Quantity: p.Quantity, Price: p.Price };&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                          else {&#xA;        &#xA;        &#xA;          &#xA;                              existing.Quantity &#x2B;= p.Quantity;&#xA;        &#xA;        &#xA;          &#xA;                              if(p.Price &gt; 0)&#xA;        &#xA;        &#xA;          &#xA;                                  existing.Price = Math.min(p.Price, existing.Price);&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                      return agg;&#xA;        &#xA;        &#xA;          &#xA;                  }, {});&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  var totalDue = 0;&#xA;        &#xA;        &#xA;          &#xA;                  for (var key in products) {&#xA;        &#xA;        &#xA;          &#xA;                      if(products[key].Quantity == 0)&#xA;        &#xA;        &#xA;          &#xA;                          delete products[key];&#xA;        &#xA;        &#xA;          &#xA;                      else&#xA;        &#xA;        &#xA;          &#xA;                          totalDue &#x2B;= products[key].Quantity * products[key].Price;&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  var paid = g.values.reduce((agg, item) =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                      for (var key in item.Paid){&#xA;        &#xA;        &#xA;          &#xA;                          agg[key] = item.Paid[key] &#x2B; (agg[key] || 0);&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                      return agg;&#xA;        &#xA;        &#xA;          &#xA;                  }, {});&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  var totalPaid = 0;&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  for (var key in paid) {&#xA;        &#xA;        &#xA;          &#xA;                      totalPaid &#x2B;= paid[key];&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  &#xA;        &#xA;        &#xA;          &#xA;                  return {&#xA;        &#xA;        &#xA;          &#xA;                      Cart: g.key,&#xA;        &#xA;        &#xA;          &#xA;                      Products: products,&#xA;        &#xA;        &#xA;          &#xA;                      Paid: paid,&#xA;        &#xA;        &#xA;          &#xA;                      TotalDue: totalDue,&#xA;        &#xA;        &#xA;          &#xA;                      TotalPaid: totalPaid,&#xA;        &#xA;        &#xA;          &#xA;                      Status: totalDue == totalPaid ? &quot;Paid&quot; : &quot;Pending&quot;&#xA;        &#xA;        &#xA;          &#xA;                  };&#xA;        &#xA;        &#xA;          &#xA;              })&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          reduce4.js&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;And the output of this for is:You can see that this is a bit different from what I originally envisioned it. This is mostly because I&#x2019;m bad at JavaScript and likely took many shortcuts along the way to make things easy for myself. Basically, I was easier to do the internal grouping using an object than using arrays.Some final thoughts:A shopping cart is usually going to be fairly small with a few dozens of events in the common case. This method works great for this, but it will also scale nicely if you need to aggregate over tens of thousands of events. A key concept here is that the reduce portion is called recursively on all the items, incrementally building the data until we can&#x2019;t reduce it any further. That means that the output we have get should also serve as the input to the reduce. This take some getting used to, but it is a very powerful technique.The output of the index is a complete model, which you can use inside your system. I the next post, I&#x2019;ll discuss how we can more fully flesh this out.If you want to play with this, you can get the dump of the database that you can import into your own copy of RavenDB (or our live demo instance).</p>
        </article>
        <article id="article-1940">
            <a href="https://ayende.com/blog/185857-A/using-tls-in-rust-the-complexity-of-async-macros-and-madness" target="_blank">
                <h2 class="title mb-6" id="article-1940">Using TLS in Rust</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 29, 2019
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After a lot of trouble, I&#x2019;m really happy that I was able to build an async I/O implementation of my protocol. However, for real code, I think that I would probably recommend using with the sync API instead, since at least that is straightforward and doesn&#x2019;t incur so much overhead at development time. The async stuff is still very much a &#x201C;use at your own risk&#x201D; kind of deal from my perspective. And I can&#x2019;t imagine trying to use it in a large project and no suffering from the complexity.As a good example, take a look at the following bit of code:It doesn&#x2019;t seem to be doing much, right? And it is clear what the intent of the code is. However, if you try to compile this code you&#x2019;ll get:Now, it took me a long while to figure out what is going on.&#xA0; The issue is that the code I&#x2019;m seeing isn&#x2019;t the actual code, because of macro expansions. So let&#x2019;s resolve this and see what the expanded code looks like:&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          fn send_results(&#xA;        &#xA;        &#xA;          &#xA;              receiver: Receiver&lt;String&gt;,&#xA;        &#xA;        &#xA;          &#xA;          ) -&gt; impl ::futures::__rt::MyFuture&lt;std::result::Result&lt;(), io::Error&gt;&gt; &#x2B; &#x27;static {&#xA;        &#xA;        &#xA;          &#xA;              ::futures::__rt::gen(move || -&gt; std::result::Result&lt;(), io::Error&gt; {&#xA;        &#xA;        &#xA;          &#xA;                  let __e: std::result::Result&lt;(), io::Error&gt; = {&#xA;        &#xA;        &#xA;          &#xA;                      {&#xA;        &#xA;        &#xA;          &#xA;                          {&#xA;        &#xA;        &#xA;          &#xA;                              let mut __stream = receiver;&#xA;        &#xA;        &#xA;          &#xA;                              loop {&#xA;        &#xA;        &#xA;          &#xA;                                  let msg = {&#xA;        &#xA;        &#xA;          &#xA;                                      extern crate futures_await;&#xA;        &#xA;        &#xA;          &#xA;                                      let r = futures_await::Stream::poll(&amp;mut __stream)?;&#xA;        &#xA;        &#xA;          &#xA;                                      match r {&#xA;        &#xA;        &#xA;          &#xA;                                          futures_await::Async::Ready(e) =&gt; match e {&#xA;        &#xA;        &#xA;          &#xA;                                              futures_await::__rt::std::option::Option::Some(e) =&gt; e,&#xA;        &#xA;        &#xA;          &#xA;                                              futures_await::__rt::std::option::Option::None =&gt; break,&#xA;        &#xA;        &#xA;          &#xA;                                          },&#xA;        &#xA;        &#xA;          &#xA;                                          futures_await::Async::NotReady =&gt; {&#xA;        &#xA;        &#xA;          &#xA;                                              yield futures_await::Async::NotReady;&#xA;        &#xA;        &#xA;          &#xA;                                              continue;&#xA;        &#xA;        &#xA;          &#xA;                                          }&#xA;        &#xA;        &#xA;          &#xA;                                      }&#xA;        &#xA;        &#xA;          &#xA;                                  };&#xA;        &#xA;        &#xA;          &#xA;                                  {&#xA;        &#xA;        &#xA;          &#xA;                                      {&#xA;        &#xA;        &#xA;          &#xA;                                          $crate::io::_print($crate::fmt::Arguments::new_v1_formatted(&#xA;        &#xA;        &#xA;          &#xA;                                              &amp;[&quot;&quot;, &quot;\n&quot;],&#xA;        &#xA;        &#xA;          &#xA;                                              &amp;match (&amp;msg,) {&#xA;        &#xA;        &#xA;          &#xA;                                                  (arg0,) =&gt; [$crate::fmt::ArgumentV1::new(&#xA;        &#xA;        &#xA;          &#xA;                                                      arg0,&#xA;        &#xA;        &#xA;          &#xA;                                                      $crate::fmt::Display::fmt,&#xA;        &#xA;        &#xA;          &#xA;                                                  )],&#xA;        &#xA;        &#xA;          &#xA;                                              },&#xA;        &#xA;        &#xA;          &#xA;                                              &amp;[$crate::fmt::rt::v1::Argument {&#xA;        &#xA;        &#xA;          &#xA;                                                  position: $crate::fmt::rt::v1::Position::At(0usize),&#xA;        &#xA;        &#xA;          &#xA;                                                  format: $crate::fmt::rt::v1::FormatSpec {&#xA;        &#xA;        &#xA;          &#xA;                                                      fill: &#x27; &#x27;,&#xA;        &#xA;        &#xA;          &#xA;                                                      align: $crate::fmt::rt::v1::Alignment::Unknown,&#xA;        &#xA;        &#xA;          &#xA;                                                      flags: 0u32,&#xA;        &#xA;        &#xA;          &#xA;                                                      precision: $crate::fmt::rt::v1::Count::Implied,&#xA;        &#xA;        &#xA;          &#xA;                                                      width: $crate::fmt::rt::v1::Count::Implied,&#xA;        &#xA;        &#xA;          &#xA;                                                  },&#xA;        &#xA;        &#xA;          &#xA;                                              }],&#xA;        &#xA;        &#xA;          &#xA;                                          ));&#xA;        &#xA;        &#xA;          &#xA;                                      };&#xA;        &#xA;        &#xA;          &#xA;                                  }&#xA;        &#xA;        &#xA;          &#xA;                              }&#xA;        &#xA;        &#xA;          &#xA;                          }&#xA;        &#xA;        &#xA;          &#xA;                          Ok(())&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                  };&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;                  #[allow(unreachable_code)]&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      return __e;&#xA;        &#xA;        &#xA;          &#xA;                      loop {&#xA;        &#xA;        &#xA;          &#xA;                          yield ::futures::Async::NotReady&#xA;        &#xA;        &#xA;          &#xA;                      }&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;              })&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          expanded.rs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;This is after formatting, of course, but it certainly looks scary. Glancing at this code doesn&#x2019;t tell me what the problem was, so I tried replacing the method with the expanded result, and I got the same error, but this time I got it on a line that helped me figure it out. Here is the issue:We use the ? to return early from the poll method, and the Receiver I&#x2019;m using in this case is defined to have a Result&lt;String, ()&gt;, so this is the cause of the problem.I returned my own error type as a result, giving me the ability to convert from (), but that was a really hard thing to resolve. It might be better to have Rust also offer to show the error on the expanded code by default, because it was somewhat of a chore to actually get to this.What made this oh so confusing is that I had the exact same code, but using a Stream&lt;String, io:Error&gt; that worked, obviously. But it was decidedly non obvious to see what was the difference between two identical pieces of code.</p>
        </article>
        <div class="button flex justify-between">
            <a href="193.html"><span class="back arrow"></span></a>

            <a href="195.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>