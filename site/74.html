
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 74 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-731">
            <a href="https://www.meziantou.net/executing-code-before-main-in-dotnet.htm" target="_blank">
                <h2 class="title mb-6" id="article-731">Executing code before Main in .NET</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 07, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The Main method is the entry point of a C# application. When the application started, the Main method is the first method that is invoked.-- DocumentationIn fact, the Main method may not be the first method of the assembly to be executed when the application starts. There are different methods that</p>
        </article>
        <article id="article-732">
            <a href="https://www.meziantou.net/restore-old-right-click-context-menu-in-windows-11-explorer.htm" target="_blank">
                <h2 class="title mb-6" id="article-732">Restore old right-click context menu in Windows 11 Explorer</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 03, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The new context menu in Windows 11 explorer is nice, but lots of applications are not yet integrated into it. Currently, I have to use the &quot;Show more options&quot; item too often (7-zip, Notepad&#x2B;&#x2B;, Visual Studio Code, etc.). You can restore the old context menu by editing the registry. Open a command pr</p>
        </article>
        <article id="article-733">
            <a href="https://ayende.com/blog/196577-B/recording-ravendb-a-really-boring-database" target="_blank">
                <h2 class="title mb-6" id="article-733">Recording</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 02, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Dejan is talking about RavenDB here:</p>
        </article>
        <article id="article-734">
            <a href="https://ayende.com/blog/196545-B/using-the-net-jit-to-reduce-abstraction-overhead" target="_blank">
                <h2 class="title mb-6" id="article-734">Using the .NET JIT to reduce abstraction overhead</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: March 01, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I ran into this recently and I thought that this technique would make a great post. We are using that extensively inside of RavenDB to reduce the overhead of abstractions while not limiting our capabilities. It is probably best that I&#x2019;ll start with an example. We have a need to perform some action, which needs to be specialized by the caller.&#xA;For example, let&#x2019;s imagine that we want to aggregate the result of calling multiple services for a certain task. Consider the following code:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          using System.Buffers;&#xA;        &#xA;        &#xA;          &#xA;          using System.Threading.Tasks;&#xA;        &#xA;        &#xA;          &#xA;          using System.Net.Http;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          public class Orchestrator&#xA;        &#xA;        &#xA;          &#xA;          {&#xA;        &#xA;        &#xA;          &#xA;              string[] urls;&#xA;        &#xA;        &#xA;          &#xA;              HttpClient client = new();&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              public Orchestrator(string[] urls)&#xA;        &#xA;        &#xA;          &#xA;              {&#xA;        &#xA;        &#xA;          &#xA;                  this.urls = urls;&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              private static readonly Task&lt;string&gt; CompletedTask = Task.FromResult(string.Empty);&#xA;        &#xA;        &#xA;          &#xA;              public async Task&lt;T&gt; Execute&lt;T&gt;(Func&lt;string, HttpRequestMessage&gt; factory, Func&lt;Memory&lt;string&gt;, T&gt; combine)&#xA;        &#xA;        &#xA;          &#xA;              {&#xA;        &#xA;        &#xA;          &#xA;                  var tasks = ArrayPool&lt;Task&lt;string&gt;&gt;.Shared.Rent(urls.Length);&#xA;        &#xA;        &#xA;          &#xA;                  for (int i = 0; i &lt; urls.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      tasks[i] = client.SendAsync(factory(urls[i]))&#xA;        &#xA;        &#xA;          &#xA;                          .ContinueWith(t=&gt; t.Result.Content.ReadAsStringAsync())&#xA;        &#xA;        &#xA;          &#xA;                          .Unwrap();&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  for (int i = urls.Length; i &lt; tasks.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      tasks[i] = CompletedTask;&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  await Task.WhenAll(tasks);&#xA;        &#xA;        &#xA;          &#xA;                  var results = ArrayPool&lt;string&gt;.Shared.Rent(urls.Length);&#xA;        &#xA;        &#xA;          &#xA;                  for (int i = 0; i &lt; urls.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      results[i] = tasks[i].Result;&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  ArrayPool&lt;Task&lt;string&gt;&gt;.Shared.Return(tasks);&#xA;        &#xA;        &#xA;          &#xA;                  var result = combine(new Memory&lt;string&gt;(results, 0, urls.Length));&#xA;        &#xA;        &#xA;          &#xA;                  ArrayPool&lt;string&gt;.Shared.Return(results);&#xA;        &#xA;        &#xA;          &#xA;                  return result;&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          OrchestratorV1.cs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;As you can see, the code above sends a single request to multiple locations and aggregates the results. The point is that we can separate the creation of the request (and all that this entails) from the actual logic for aggregating the results.&#xA;Here is a typical usage for this sort of code:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;           var urls = new[] { &quot;https://google.com&quot;, &quot;https://bing.com&quot; };&#xA;        &#xA;        &#xA;          &#xA;           var orch = new Orchestrator(urls);&#xA;        &#xA;        &#xA;          &#xA;           var term = &quot;fun&quot;;&#xA;        &#xA;        &#xA;          &#xA;           var t = await orch.Execute&lt;string&gt;(&#xA;        &#xA;        &#xA;          &#xA;               url =&gt; new HttpRequestMessage(HttpMethod.Get,url &#x2B; &quot;/?q=&quot; &#x2B; term),&#xA;        &#xA;        &#xA;          &#xA;               results =&gt;&#xA;        &#xA;        &#xA;          &#xA;               {&#xA;        &#xA;        &#xA;          &#xA;                   var sb = new StringBuilder();&#xA;        &#xA;        &#xA;          &#xA;                   var span = results.Span;&#xA;        &#xA;        &#xA;          &#xA;                   for(var i =0;i&lt; span.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                   {&#xA;        &#xA;        &#xA;          &#xA;                       sb.AppendLine(span[i]);&#xA;        &#xA;        &#xA;          &#xA;                   }&#xA;        &#xA;        &#xA;          &#xA;                   return sb.ToString();&#xA;        &#xA;        &#xA;          &#xA;               });&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          Usage.cs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;You can notice that the code is fairly simple, and uses lambdas for injecting the specialized behavior into the process.&#xA;That leads to a bunch of problems:&#xA;&#xA;Delegate / lambda invocation is more expensive.&#xA;Lambdas need to be allocated.&#xA;They capture state (and may capture more and for a lot longer than you would expect).&#xA;&#xA;In short, when I look at this, I see performance issues down the road. But it turns out that I can write very similar code, without any of those issues, like this:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          using System.Buffers;&#xA;        &#xA;        &#xA;          &#xA;          using System.Threading.Tasks;&#xA;        &#xA;        &#xA;          &#xA;          using System.Net.Http;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          public interface IMergedOperation&lt;T&gt;&#xA;        &#xA;        &#xA;          &#xA;          {&#xA;        &#xA;        &#xA;          &#xA;              T Combine(Memory&lt;string&gt; results);&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              HttpRequestMessage Create(string url);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          public class Orchestrator&#xA;        &#xA;        &#xA;          &#xA;          {&#xA;        &#xA;        &#xA;          &#xA;              string[] urls;&#xA;        &#xA;        &#xA;          &#xA;              HttpClient client = new();&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              public Orchestrator(string[] urls)&#xA;        &#xA;        &#xA;          &#xA;              {&#xA;        &#xA;        &#xA;          &#xA;                  this.urls = urls;&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              private static readonly Task&lt;string&gt; CompletedTask = Task.FromResult(string.Empty);&#xA;        &#xA;        &#xA;          &#xA;              public async Task&lt;TResult&gt; Execute&lt;TMerger, TResult&gt;(TMerger merger)&#xA;        &#xA;        &#xA;          &#xA;                 where TMerger : struct, IMergedOperation&lt;TResult&gt;&#xA;        &#xA;        &#xA;          &#xA;              {&#xA;        &#xA;        &#xA;          &#xA;                  var tasks = ArrayPool&lt;Task&lt;string&gt;&gt;.Shared.Rent(urls.Length);&#xA;        &#xA;        &#xA;          &#xA;                  for (int i = 0; i &lt; urls.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      tasks[i] = client.SendAsync(merger.Create(urls[i]))&#xA;        &#xA;        &#xA;          &#xA;                          .ContinueWith(t=&gt; t.Result.Content.ReadAsStringAsync())&#xA;        &#xA;        &#xA;          &#xA;                          .Unwrap();&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  for (int i = urls.Length; i &lt; tasks.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      tasks[i] = CompletedTask;&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  await Task.WhenAll(tasks);&#xA;        &#xA;        &#xA;          &#xA;                  var results = ArrayPool&lt;string&gt;.Shared.Rent(urls.Length);&#xA;        &#xA;        &#xA;          &#xA;                  for (int i = 0; i &lt; urls.Length; i&#x2B;&#x2B;)&#xA;        &#xA;        &#xA;          &#xA;                  {&#xA;        &#xA;        &#xA;          &#xA;                      results[i] = tasks[i].Result;&#xA;        &#xA;        &#xA;          &#xA;                  }&#xA;        &#xA;        &#xA;          &#xA;                  ArrayPool&lt;Task&lt;string&gt;&gt;.Shared.Return(tasks);&#xA;        &#xA;        &#xA;          &#xA;                  var result = merger.Combine(new Memory&lt;string&gt;(results, 0, urls.Length));&#xA;        &#xA;        &#xA;          &#xA;                  ArrayPool&lt;string&gt;.Shared.Return(results);&#xA;        &#xA;        &#xA;          &#xA;                  return result;&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          OrchestratorV2.cs&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;Here, instead of passing lambdas, we pass an interface. That has the same exact cost as lambda, in fact. However, in this case we also specify that this interface must be implemented by a struct (value type). That leads to really interesting behavior, since at JIT time, the system knows that there is no abstraction here, it can do optimizations such as inlining or calling the method directly (with no abstraction overhead). It also means that any state that we capture is done so explicitly (and we won&#x2019;t be tainted by other lambdas in the method).&#xA;We still have good a separation between the process we run and the way we specialize that, but without any runtime overhead on this. The code itself is a bit more verbose, but not too onerous.</p>
        </article>
        <article id="article-735">
            <a href="https://ayende.com/blog/196514-B/performance-optimizations-in-production" target="_blank">
                <h2 class="title mb-6" id="article-735">Performance optimizations in production</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 28, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Date range queries can be quite expensive for RavenDB. Consider the following query:&#xA;&#xA;from index &#x27;Users/Search&#x27; where search(DisplayName, &quot;Oren&quot;) and CreationDate between &quot;2008-10-13T07:18:01.623&quot; and &quot;2018-10-13T07:18:01.623&quot; include timings()&#xA;&#xA;The root issue is that we have a compound query here, we use full text search on the left but then need to match it on the right. The way Lucene works, we have to compute the set of all the documents that match the date range. If we have a lot of documents in that range, we have to scan through a lot of values here.&#xA;We spent a lot of time and effort optimizing date queries in RavenDB. Such issues also impacted heavily the design of our next-gen indexing capabilities (but more on that when it matures enough to discuss).&#xA;One of the primary design principles of RavenDB is that it learns from previous usage, and we realized that date ranges in queries are likely to repeat often. So we take advantage of that. The details are a bit complex and require that you&#x2019;ll understand how Lucene stores its data in immutable segments. We are able to analyze queries on repeating date ranges and remember them, so next time we use the same type of date range, we&#x2019;ll already have the set of matching documents ready.&#xA;That feature was deployed to address a specific customer scenario, where they do a lot of wide date range queries and it had a big impact on that.&#xA;Last week we ran into some funny metrics for a completely different customer, with a very different scenario. You can probably tell at what point they moved to the updated version of RavenDB and were able to take advantage of this feature:&#xA;&#xA;The really nice thing about this, from my perspective, is that none of us even considered the impact that feature would have for this scenario. They upgraded to the latest version to get access to the new features, and this is just sitting in the background, pushing their CPU utilization to near zero.&#xA;That&#x2019;s the kind of news that I love to get.</p>
        </article>
        <article id="article-736">
            <a href="https://www.meziantou.net/executing-github-actions-jobs-or-steps-only-when-specific-files-change.htm" target="_blank">
                <h2 class="title mb-6" id="article-736">Executing GitHub Actions jobs or steps only when specific files change</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 28, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Sometimes you want to execute a step or a job only when some files are modified. For instance, you may want to lint and deploy the documentation only when a file under docs is modified. This scenario is not directly supported by GitHub Actions. However, you can do it manually by using git, PowerShe</p>
        </article>
        <article id="article-737">
            <a href="https://ayende.com/blog/196513-B/ravendb-domain-modeling-and-data-persistency" target="_blank">
                <h2 class="title mb-6" id="article-737">RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 25, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Dejan Mili&#x10D;i&#x107; is talking with Andr&#xE9; Baltieri about data modeling and data persistency.</p>
        </article>
        <article id="article-738">
            <a href="https://ayende.com/blog/196486-A/badly-implementing-encryption-part-x-additional-data" target="_blank">
                <h2 class="title mb-6" id="article-738">Badly implementing encryption</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 24, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This series has been going on quite a bit longer than I intended it to be. Barring any new developments or questions, I think that this will be the last post I&#x2019;ll write on the topic.&#xA;In a previous post, I implemented authenticated encryption, ensuring that we&#x2019;ll be able to clearly detect if the ciphertext we got has been modified along the way. That is relevant because we have to think about malicious actors but we also have to consider things like bit flips, random hardware errors, etc.&#xA;In most crypto systems, we have to pass some metadata about the encrypted messages that we pass. Right now, this is strictly outside our scope, but it turns out that there is a compelling reason to consider that plain text data as well. For example, let&#x2019;s say that I&#x2019;m sending a number of messages. I have to include the message length and its position in the set of messages I sent in the clear. Otherwise, the receiver might not be able to make sense of that. When we need to decrypt the message, we want to include that additional information (which wasn&#x2019;t encrypted) as well.&#xA;The reason for that is simple, we want to ensure that the other data hasn&#x2019;t been modified using the same cryptographic tools we already have. It turns out that this is quite simple, check out the code:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          pub fn encryptSivWithNonce(key: [32]u8, nonceKey: []u8, additionalData: []u8, plainText: []const u8, cipherText: []u8) void {&#xA;        &#xA;        &#xA;          &#xA;              var nonce: [HmacMd5.mac_length]u8 = undefined;&#xA;        &#xA;        &#xA;          &#xA;              HmacMd5.create(&amp;nonce, plainText, nonceKey);&#xA;        &#xA;        &#xA;          &#xA;              var mca = MyCryptoAlgo.initWithNonce(key, nonce);&#xA;        &#xA;        &#xA;          &#xA;              mca.encryptBlock(plainText, cipherText);&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              // additional data hashing&#xA;        &#xA;        &#xA;          &#xA;              mca.macGen.update(additionalData);&#xA;        &#xA;        &#xA;          &#xA;              &#xA;        &#xA;        &#xA;          &#xA;              mca.finalize(cipherText[plainText.len..]);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          pub fn decrypt(key: [32]u8, additionalData: []u8, cipherText: []u8, plainText: []u8) !void {&#xA;        &#xA;        &#xA;          &#xA;              if (cipherText.len &lt; ExtraLen)&#xA;        &#xA;        &#xA;          &#xA;                  return error.CihpherTextBufferTooSmall;&#xA;        &#xA;        &#xA;          &#xA;              if (cipherText.len - ExtraLen &gt; plainText.len)&#xA;        &#xA;        &#xA;          &#xA;                  return error.PlainTextBufferTooSmall;&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              var nonce: [HmacMd5.mac_length]u8 = undefined;&#xA;        &#xA;        &#xA;          &#xA;              std.mem.copy(u8, &amp;nonce, cipherText[cipherText.len - ExtraLen .. cipherText.len - NonceLen]);&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              var dec = MyCryptoAlgo.initWithNonce(key, nonce);&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              var msgText = cipherText[0 .. cipherText.len - ExtraLen];&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              var expectedMac: [16]u8 = undefined;&#xA;        &#xA;        &#xA;          &#xA;              std.mem.copy(u8, &amp;expectedMac, cipherText[cipherText.len - NonceLen .. cipherText.len]);&#xA;        &#xA;        &#xA;          &#xA;              var myMac: [16]u8 = undefined;&#xA;        &#xA;        &#xA;          &#xA;              dec.macGen.update(msgText);&#xA;        &#xA;        &#xA;          &#xA;              dec.macGen.update(additionalData);&#xA;        &#xA;        &#xA;          &#xA;              dec.macGen.final(&amp;myMac);&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              if (std.crypto.utils.timingSafeEql([16]u8, expectedMac, myMac) == false) {&#xA;        &#xA;        &#xA;          &#xA;                  return error.InvalidMac;&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;              dec.xorWithKeyStream(msgText, plainText);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          aead.zig&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;We added a parameter for the encryptSivWithNonce() and decrypt() functions that has the buffer of all the associated data for this message. And all we need to do is add that to the MAC computation as well. On the decrypt(), we do the exact same. We compute the hash from the encrypted text and the additional data and abort if they aren&#x2019;t an exact match.&#xA;And with this in place, we implemented a (probably very bad) encryption system from a single primitive (MD5) and brought it to roughly modern standards of AEAD encryption (Authenticated Encryption, Additional Data).&#xA;I want to emphasize that this entire series is meant primarily to go over the details of how you build and use an encryption system, not to actually build a real one. I didn&#x2019;t do any analysis on how secure such a system would be, and I wouldn&#x2019;t want to trust this with anything beyond toying around.&#xA;If you have any references on similar systems, I would be very happy to learn about that, I doubt that I&#x2019;m the first person who tried to build stream cipher from MD5, after all.</p>
        </article>
        <article id="article-739">
            <a href="https://ayende.com/blog/196485-A/badly-implementing-encryption-part-ix-siv" target="_blank">
                <h2 class="title mb-6" id="article-739">Badly implementing encryption</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 23, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I mentioned in a previous post that nonce reuse is a serious problem. It is enough to reuse a nonce even once and you can have catastrophic results at your hands. The problem occurs, interestingly enough, when we are able to capture two separate messages generated with the same key &amp; nonce. If we capture the same message twice, that is not an issue (we can XOR the values, they will be all zeroes).&#xA;The question is whether there is something that can be done about this. The answer to that is yes, we can create a construction that would be safe from nonce reuse. This is called SIV mode (Syntactic IV).&#xA;The way to do that is to make the nonce itself depend on the value that we are encrypting. Take a look at the following code:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          pub fn encryptSiv(key: [32]u8, plainText: []const u8, cipherText: []u8) void {&#xA;        &#xA;        &#xA;          &#xA;              var nonceKey: [HmacMd5.mac_length]u8 = undefined;&#xA;        &#xA;        &#xA;          &#xA;              std.crypto.random.bytes(&amp;nonceKey);&#xA;        &#xA;        &#xA;          &#xA;              encryptSivWithNonce(key, &amp;nonceKey, plainText, cipherText);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          pub fn encryptSivWithNonce(key: [32]u8, nonceKey: []u8, plainText: []const u8, cipherText: []u8) void {&#xA;        &#xA;        &#xA;          &#xA;              var nonce: [HmacMd5.mac_length]u8 = undefined;&#xA;        &#xA;        &#xA;          &#xA;              HmacMd5.create(&amp;nonce, plainText, nonceKey);&#xA;        &#xA;        &#xA;          &#xA;              var mca = MyCryptoAlgo.initWithNonce(key, nonce);&#xA;        &#xA;        &#xA;          &#xA;              mca.encryptBlock(plainText, cipherText);&#xA;        &#xA;        &#xA;          &#xA;              mca.finalize(cipherText[plainText.len..]);&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          encryptSiv.zig&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;The idea is that we get a nonce, as usual, but instead of relying on the nonce, we&#x2019;ll compute a hash of the plain text using the nonce as a key. Aside from that, the rest of the system behaves as usual. In particular, there are no changes to the decryption.&#xA;Let&#x2019;s see what the results are, shall we?&#xA;With a separate nonce per use:&#xA;&#xA;&#xA;&#xA;&#xA;attack at dawn!&#xA;838E1CE1A64D97E114237DE161A544DA5030FC5ECAB1C20D34AF838634D1C591AE208FC0AEE706690669E9F56F45C1&#xA;&#xA;&#xA;attack at dusk!&#xA;EEA7DE8A51A06FE6CA9374CDDEC1053249F8B1F0BF1995A0EEEE7D6EBF68868ECAE7CBEFD6EE23017480ACD494D634&#xA;&#xA;&#xA;&#xA;&#xA;Now, what happens when we use the same nonce?&#xA;&#xA;&#xA;&#xA;&#xA;attack at dusk!&#xA;0442EFA977919327C92B47C7F6A0CD617AE4FD3138DF07D45994EBC2C4B709ACDE1130422924B7206354D03569FDAA&#xA;&#xA;&#xA;attack at dawn!&#xA;324A996C22F7FFDE62596C0E9EE37D7EE1F89569A10A1188BA4A03EE7B8C47DF347A20D1B73EB4523D3511F2F46FF2&#xA;&#xA;&#xA;&#xA;&#xA;As you can see, the values are completely different, even though we used the same key and nonce and the plain text is mostly the same.&#xA;Because we are generating the actual nonce we use from the hash of the input, reusing the nonce with different data will result in a wildly different nonce being actually used. We are safe from the catastrophe that is nonce reuse.&#xA;With SIV mode, we are paying with an additional hashing pass over the plain text data. In return, we have the following guarantees:&#xA;&#xA;If the nonce isn&#x2019;t reused, we have nothing to worry about.&#xA;If the nonce is reused, an attacker will not be able to learn anything about the content of the message.&#xA;However, an attacker may be able to detect that the same message is being sent, if the nonce is reused.&#xA;&#xA;Given the cost of nonce reuse without SIV, it is gratifying to see that the worst case scenario for SIV with nonce reuse is that an adversary can detect duplicate messages.&#xA;I&#x2019;m not sure how up to date this is, but this report shows that SIV adds about 1.5 &#x2013; 2.2 cycles to the overall cost of encryption. Note that this is for actual viable implementations, instead of what I&#x2019;m doing, which is by design, not a good idea.</p>
        </article>
        <article id="article-740">
            <a href="https://ayende.com/blog/196484-A/badly-implementing-encryption-part-viii-timings-attacks-and-side-channels" target="_blank">
                <h2 class="title mb-6" id="article-740">Badly implementing encryption</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 22, 2022
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In the previous post, I showed some code that compared two MAC values (binary buffers) and I mentioned that the manner in which I did that was bad.&#xA;Here is the code in question:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          // bad code&#xA;        &#xA;        &#xA;          &#xA;          if (std.mem.eql(u8, mac, &amp;myMac) == false) {&#xA;        &#xA;        &#xA;          &#xA;              return error.InvalidMac;&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          // good code&#xA;        &#xA;        &#xA;          &#xA;          if (std.crypto.utils.timingSafeEql(u8, mac, &amp;myMac) == false) {&#xA;        &#xA;        &#xA;          &#xA;              return error.InvalidMac;&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          options.zig&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;When you are looking at code that is used in a cryptographic context, you should be aware that any call that compares buffers (or strings) cannot short circuit. What do I mean by that? Let&#x2019;s look at the implementation of those two functions:&#xA;&#xA;&#xA;    &#xA;      &#xA;        &#xA;  &#xA;    &#xA;    &#xA;&#xA;        &#xA;&#xA;&#xA;  &#xA;  &#xA;  &#xA;    &#xA;&#xA;    &#xA;      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.&#xA;      Learn more about bidirectional Unicode characters&#xA;    &#xA;&#xA;&#xA;              Show hidden characters&#xA;&#xA;&#xA;&#xA;&#xA;  &#xA;    &#xA;    &#xA;&#xA;&#xA;&#xA;  &#xA;        &#xA;          &#xA;          pub fn timingSafeEql(a: []u8, b: []u8) bool {&#xA;        &#xA;        &#xA;          &#xA;              var acc :u8=0;&#xA;        &#xA;        &#xA;          &#xA;              for (a) |x, i| {&#xA;        &#xA;        &#xA;          &#xA;                  acc |= x ^ b[i];&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;              return acc ==0;&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;        &#xA;          &#xA;          &#xA;&#xA;        &#xA;        &#xA;          &#xA;          pub fn eql(a: []const u8, b: []const u8) bool {&#xA;        &#xA;        &#xA;          &#xA;              if (a.len != b.len) return false;&#xA;        &#xA;        &#xA;          &#xA;              if (a.ptr == b.ptr) return true;&#xA;        &#xA;        &#xA;          &#xA;              for (a) |item, index| {&#xA;        &#xA;        &#xA;          &#xA;                  if (b[index] != item) return false;&#xA;        &#xA;        &#xA;          &#xA;              }&#xA;        &#xA;        &#xA;          &#xA;              return true;&#xA;        &#xA;        &#xA;          &#xA;          }&#xA;        &#xA;  &#xA;&#xA;&#xA;&#xA;    &#xA;&#xA;  &#xA;&#xA;&#xA;      &#xA;      &#xA;        view raw&#xA;        &#xA;          impl.zig&#xA;        &#xA;        hosted with &#x2764; by GitHub&#xA;      &#xA;    &#xA;&#xA;&#xA;&#xA;Those two functions are doing the same thing, but in a very different manner. The issue with eql() is that it will stop at the first mismatch byte, while timingSafeEql() will always scan through the two buffers first and then return the result.&#xA;Why do we need that?&#xA;Well, the issue is that if I can time (and you can, even over the network) the duration of a call like that, I&#x2019;ll be able to test various values until I match whatever secret value the code is comparing against. In this case, I don&#x2019;t believe that the use of eql() is an actual problem. We tested that on the output of HMAC operation vs. the expected value. The caller has no way to control the HMAC computation and already knows what we are comparing against. I can&#x2019;t think of any reason where that would be a problem. However, I&#x2019;m not a cryptographer and any call to buffer comparison in crypto related code should use a constant time method.&#xA;For that matter, side channels are a huge worry in cryptography. AES, for example, is nearly impossible to implement in software at this point, because it is vulnerable to timings side channels and requires the hardware to help here. Other side channels include watching caches, power signatures and more. I don&#x2019;t actually have much to say about this, except that when working with cryptography, even something as simple as multiplication is suspect, because it may not complete in constant time. As a good example of the problem, see this page.</p>
        </article>
        <div class="button flex justify-between">
            <a href="73.html"><span class="back arrow"></span></a>

            <a href="75.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2024<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>