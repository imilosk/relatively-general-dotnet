
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 438 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4371">
            <a href="https://www.meziantou.net/how-to-prevent-csrf-attacks.htm" target="_blank">
                <h2 class="title mb-6" id="article-4371">How to prevent CSRF attacks</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 12, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post is part of the series &#x27;Vulnerabilities&#x27;. Be sure to check out the rest of the blog posts of the series!Impersonation and securitySQL injectionsHow to prevent CSRF attacks (this post)ASP MVC and XSRFCross-site scripting (XSS)ASP MVC: Mass AssignmentRegex - Deny of Service (ReDoS)Deserializ</p>
        </article>
        <article id="article-4372">
            <a href="https://ayende.com/blog/159105/introducing-rhino-events" target="_blank">
                <h2 class="title mb-6" id="article-4372">Introducing Rhino.Events</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 11, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After talking so often about how much I consider OSS work to be indicative of passion, I got bummed when I realized that I didn&#x2019;t actually did any OSS work for a while, if you exclude RavenDB. I was recently at lunch at a client, when something he said triggered a bunch of ideas in my head. I am afraid that I made for poor lunch conversation, because all I could see in my head was code and IO blocks moving around in interesting ways. At any rate, I sat down at the end of the day and wrote a few spikes, then I decided to write the actual thing in a way that would actually be useful. What is Rhino Events?  It is a small .NET library that gives you embeddable event store. Also, it is freakishly fast. How fast is that?   Well, this code writes a fairly non trivial events 10,000,000 (that is ten million times) to disk. It does this at a rate of about 60,000 events per second. And that include the full life cycle (serializing the data, flushing to disk, etc). Rhino.Events has the following external API:   As you can see, we have several ways of writing events to disk, always associating to a stream, or just writing the latest snapshot. Note that the write methods actually return a Task. You can ignore that Task, if you wish, but this is part of how Rhino Events gets to be so fast. When you call EnqueueEventAsync, we register the value in a queue and have a background process write all of the pending events to disk. This means that we actually have only one thread that is actually doing writes, which means that we can batch all of those writes to get really nice performance from being able to handle all of that. We can also reduce on the number of times that we have to actually Flush to disk (fsync), so we only do that when we run out of things to write or at a predefined times (usually after a full 200 ms of non stop writes. Only after the information was fully flushed to disk will we set the task status to completed. This is actually a really interesting approach from my point of view, and it makes the entire thing transactional, in the sense that you can wait to be sure that the event has been persisted to disk (and yes, Rhino Events is fully ACID) or you can fire &amp; forget it, and move on with your life. A few words before I let you go off and play with the bits.  This is a Rhino project, which means that it is a fully OSS one. You can take the code and do pretty much whatever you want with it. But I , or Hibernating Rhinos, will not be providing support for that. You can get the bits here: https://github.com/ayende/Rhino.Events</p>
        </article>
        <article id="article-4373">
            <a href="https://www.meziantou.net/sql-injections.htm" target="_blank">
                <h2 class="title mb-6" id="article-4373">SQL injections</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 11, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post is part of the series &#x27;Vulnerabilities&#x27;. Be sure to check out the rest of the blog posts of the series!Impersonation and securitySQL injections (this post)How to prevent CSRF attacksASP MVC and XSRFCross-site scripting (XSS)ASP MVC: Mass AssignmentRegex - Deny of Service (ReDoS)Deserializ</p>
        </article>
        <article id="article-4374">
            <a href="https://ardalis.com/a-review-of-the-clean-coder/" target="_blank">
                <h2 class="title mb-6" id="article-4374">A Review of The Clean Coder</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 10, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;m generally a fan of Robert C. &#x201C;Uncle Bob&#x201D; Martin&#x2019;s books, so realize I&#x2019;m going into this book with something of a positive bias. While is&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4375">
            <a href="https://ayende.com/blog/159042/handling-entities-validations-in-ravendb" target="_blank">
                <h2 class="title mb-6" id="article-4375">Handling entities validations in RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 10, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post came out of a stack overflow question. The user had the following code:      1: public void StoreUser(User user)   2: {   3:     //Some validation logic   4:     if(string.IsNullOrWhiteSpace(user.Name))   5:         throw new Exception(&quot;User name can not be empty&quot;);   6:&#xA0;    7:     Session.Store(user);   8: }&#xA;But he noted that this will not work for other approaches, such as this:&#xA;&#xA;&#xA;   1: var u1 = Sesion.Load&lt;User&gt;(1);   2: u1.Name = null; //change is tracked and will persist on the next save changes   3: Session.SaveChanges();&#xA;This is because RavenDB tracks the entity and will persist it if there has been any changes when SaveChanges is called.&#xA;The question was:&#xA;&#xA;Is there someway to get RavenDB to store only a snapshot of the item that was stored and not track further changes?&#xA;The answer is, as is often the case if you run into hardship with RavenDB, you are doing something wrong. In this particular case, that wrongness is the fact that you are trying to do validation manually. This means that you always have to remember to call it, and that you can&#x2019;t use a lot of the good stuff that RavenDB gives you, like change tracking. Instead, RavenDB contains the hooks to do it once, and do it well.&#xA;&#xA;&#xA;   1: public class ValidationListener : IDocumentStoreListener   2: {   3:     readonly Dictionary&lt;Type, List&lt;Action&lt;object&gt;&gt;&gt; validations = new Dictionary&lt;Type, List&lt;Action&lt;object&gt;&gt;&gt;();   4:&#xA0;    5:     public void Register&lt;T&gt;(Action&lt;T&gt; validate)   6:     {   7:         List&lt;Action&lt;object&gt;&gt; list;   8:         if(validations.TryGetValue(typeof(T),out list) == false)   9:             validations[typeof (T)] = list = new List&lt;Action&lt;object&gt;&gt;();  10:&#xA0;   11:         list.Add(o =&gt; validate((T) o));  12:     }  13:&#xA0;   14:     public bool BeforeStore(string key, object entityInstance, RavenJObject metadata, RavenJObject original)  15:     {  16:         List&lt;Action&lt;object&gt;&gt; list;  17:         if (validations.TryGetValue(entityInstance.GetType(), out list))  18:         {  19:             foreach (var validation in list)  20:             {  21:                 validation(entityInstance);  22:             }  23:         }  24:         return false;  25:     }  26:&#xA0;   27:     public void AfterStore(string key, object entityInstance, RavenJObject metadata)  28:     {  29:     }  30: }&#xA;This will be called by RavenDB whenever we save to the database. We can now write the validation / registration code like this:&#xA;&#xA;&#xA;   1: var validationListener = new ValidationListener();   2: validationListener.Register&lt;User&gt;(user=&gt;   3:     {   4:         if (string.IsNullOrWhiteSpace(user.Name))   5:             throw new Exception(&quot;User name can not be empty&quot;);   6:     });   7: store.RegisterListener(validationListener);&#xA;And that is all that she wrote.</p>
        </article>
        <article id="article-4376">
            <a href="https://ayende.com/blog/159041/listofparams-and-other-horrible-things-that-you-shouldnt-bring-to-ravendb" target="_blank">
                <h2 class="title mb-6" id="article-4376">ListOfParams and other horrible things that you shouldn&#x2019;t bring to RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 09, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In the mailing list, we got asked about an issue with code that looked like this:      1: public abstract class Parameter   2: {   3:     public String Name { get; set; }   4: }   5:&#xA0;    6: public class IntArrayParameter : Parameter   7: {   8:     public Int32[,] Value { get; set; }   9: }&#xA;I fixed the bug, but that was a strange thing to do, I thought. Happily, the person asking that question was actually taking part of a RavenDB course and I could sit with him and understand the whole question.&#xA;It appears that in their system, they have a lot of things like that:&#xA;&#xA;IntParameter&#xA;StringParameter&#xA;BoolParameter&#xA;LongParameter&#xA;And along with that, they also have a coordinating class:&#xA;&#xA;&#xA;   1: public class ListOfParams   2: {   3:    public List&lt;Param&gt; Values {get;set;}   4: }&#xA;The question was, could they keep using the same approach using RavenDB? They were quite anxious about this, since they had a need for the capabilities of this in their software.&#xA;This is why I hate Hello World questions. I could answer just the question that was asked, and that was it. But the problem is quite different.&#xA;You might have recognized it by now, what they have here is Entity Attribute Value system. A well known anti pattern for the relational database world and one of the few ways to actually get a dynamic schema in that world.&#xA;In RavenDB, you don&#x2019;t need all of those things. You can just get things done. Here is the code that we wrote to replace the above monstrosity:&#xA;&#xA;&#xA;   1: public class Item : DynamicObject   2: {   3:     private Dictionary&lt;string, object&gt;  vals = new Dictionary&lt;string, object&gt;();   4:&#xA0;    5:     public string StaticlyDefinedProp { get; set; }   6:&#xA0;    7:     public override bool TryGetMember(GetMemberBinder binder, out object result)   8:     {   9:         return vals.TryGetValue(binder.Name, out result);  10:     }  11:&#xA0;   12:     public override bool TrySetMember(SetMemberBinder binder, object value)  13:     {  14:         if(binder.Name == &quot;Id&quot;)  15:             return false;  16:         vals[binder.Name] = value;  17:         return true;  18:     }  19:&#xA0;   20:     public override bool TrySetIndex(SetIndexBinder binder, object[] indexes, object value)  21:     {  22:         var key = (string) indexes[0];  23:         if(key == &quot;Id&quot;)  24:             return false;  25:         vals[key] = value;  26:         return true;  27:     }  28:&#xA0;   29:     public override bool TryGetIndex(GetIndexBinder binder, object[] indexes, out object result)  30:     {  31:         return vals.TryGetValue((string) indexes[0], out result);  32:     }  33:&#xA0;   34:     public override IEnumerable&lt;string&gt; GetDynamicMemberNames()  35:     {  36:         return GetType().GetProperties().Select(x =&gt; x.Name).Concat(vals.Keys);  37:     }  38: }&#xA;Not only will this class handle the dynamics quite well, it also serializes&#xA0; to idiomatic JSON, which means that querying that is about as easy as you can ask.&#xA;The EAV schema was created because RDBMS aren&#x2019;t suitable for dynamic work, and like many other things from the RDMBS world, this problem just doesn&#x2019;t exists for us in RavenDB.</p>
        </article>
        <article id="article-4377">
            <a href="https://ayende.com/blog/159009/get-thou-out-of-my-head-damn-idea" target="_blank">
                <h2 class="title mb-6" id="article-4377">Get thou out of my head, damn idea</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 08, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Sometimes I get ideas, and they just won&#x2019;t leave my head no matter what I do. In this case, I decided that I wanted to see what it would take to implement an event store in terms of writing a fully managed version. I am not really interested in the actual event store, I care a lot more about the actual implementation idea that I had (I/O queues in append only mode, if you care to know). After giving it some though, I managed to create a version that allow me to write the following code:      1: var diskData = new OnDiskData(new FileStreamSource(), &quot;Data&quot;);   2:&#xA0;    3: var data = JObject.Parse(&quot;{&#x27;Type&#x27;: &#x27;ItemCreated&#x27;, &#x27;ItemId&#x27;: &#x27;1324&#x27;}&quot;);   4: var sp = Stopwatch.StartNew();   5: Parallel.For(0, 1000*10, i =&gt;   6:     {   7:         var tasks = new Task[1000];   8:         for (int j = 0; j &lt; 1000; j&#x2B;&#x2B;)   9:         {  10:             tasks[j] = diskData.Enqueue(&quot;users/&quot; &#x2B; i, data);  11:         }  12:         Task.WaitAll(tasks);  13:     });  14:&#xA0;   15: Console.WriteLine(sp.ElapsedMilliseconds);&#xA;Admittedly, it isn&#x2019;t a really interesting client code, but it is plenty good enough for what I need, and it allowed me to check something really interesting, just how hard would I have to go to actually get really good performance. As it turned out, not that far.&#xA;This code writes 10 million events, and it does so in under 1 minutes (on my laptop, SSD drive). Just to give you some idea, that is &gt; 600 Mb of events, and about 230 events per milliseconds or about 230 thousands events per second. Yes, that is 230,000 events / sec.&#xA;The limiting factor seems to be the disk, and I have some ideas on how to implement that. I still got roughly 12MB/s, so there is certainly room for improvement.&#xA0; &#xA;How does this work? Here is the implementation of the Enqueue method:&#xA;&#xA;&#xA;   1: public Task Enqueue(string id, JObject data)   2: {   3:     var item = new WriteState   4:         {   5:             Data = data,   6:             Id = id   7:         };   8:&#xA0;    9:     writer.Enqueue(item);  10:     hasItems.Set();  11:     return item.TaskCompletionSource.Task;  12: }&#xA;In other words, this is a classic producer/consumer problem.&#xA;The other side is&#xA0; reading the events from the queue and writing them to disk. There is just one thread that is doing that, and it is always appending to the end of the file. Moreover, because of the way it works, we are actually gaining the ability to batch a lot of them together into a stream of really nice IO calls that optimize the actual disk access. When we finished with a batch of items and flushed them to disk, only then are we going to complete the task, so the fun part is that for all intents and purposes, we are doing that while preserving transactionability of the system. Once the Enqueue task returned, we can be sure that the data is fully saved on disk.&#xA;That was an interesting spike, and I wonder where else I would be able to make use of something like this in the future.&#xA;Yes, those are pretty small events, and yes, that is a fake test, but the approach seems to be very solid.&#xA;And just for fun, with absolutely no optimizations what so ever, no caching, no nothing, I am able to load 1,000 events per stream in less than 10 ms.</p>
        </article>
        <article id="article-4378">
            <a href="https://ardalis.com/devreach-2012-sessions/" target="_blank">
                <h2 class="title mb-6" id="article-4378">DevReach 2012 Sessions</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 06, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Thanks to everybody who attended my DevReach sessions. I had two talks and two panels, and both of the talks were standing room only (in the&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4379">
            <a href="https://benfoster.io/blog/per-request-dependencies-in-aspnet-web-api-using-structuremap/" target="_blank">
                <h2 class="title mb-6" id="article-4379">Per-Request dependencies in ASP.NET Web API using StructureMap</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 06, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I discuss how to scope dependencies per-request in ASP.NET Web API using StructureMap.</p>
        </article>
        <article id="article-4380">
            <a href="https://ayende.com/blog/158977/awesome-indexing-with-ravendb" target="_blank">
                <h2 class="title mb-6" id="article-4380">Awesome indexing with RavenDB</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am currently teaching a course in RavenDB, and as usual during a course, we keep doing a lot of work that pushes what we do with RavenDB. Usually because we try to come up with new scenarios on the fly and adapting to the questions from the students. In this case, we were going over the map/reduce stack and we kept coming more and more complex example and how to handle them, and then we got to this scenario. Given the following class structure:      1: public class Animal   2: {   3:     public string Name { get; set; }   4:     public string Species { get; set; }   5:     public string Breed { get; set; }   6: }&#xA;Give me the count of all the species and all the breeds.&#xA0; That is pretty easy to do, right?&#xA0; In SQL, you would write it like this:&#xA;&#xA;&#xA;   1: SELECT Species, Breed, Count(*) FROM Animals   2: GROUP BY Species, Breed&#xA;And that is nice, but it still means that you have to do some work on the client side to merge things up to get the final result, since we want something like this:&#xA;&#xA;Dogs: 6 &#xA;&#xA;German Shepherd: 3 &#xA;Labrador: 1 &#xA;Mixed: 2&#xA;Cats: 3 &#xA;&#xA;Street: 2 &#xA;Long Haired: 1&#xA;In RavenDB, we can express the whole thing in a simple succinct index:&#xA;&#xA;&#xA;   1: public class Animals_Stats : AbstractIndexCreationTask&lt;Animal, Animals_Stats.ReduceResult&gt;   2: {   3:     public class ReduceResult   4:     {   5:         public string Species { get; set; }   6:         public int Count { get; set; }   7:         public BreedStats[] Breeds { get; set; }   8:&#xA0;    9:         public class BreedStats  10:         {  11:             public string Breed { get; set; }  12:             public int Count { get; set; }  13:         }  14:     }  15:&#xA0;   16:     public Animals_Stats()  17:     {  18:         Map = animals =&gt;  19:                 from animal in animals  20:                 select new  21:                     {  22:                         animal.Species,  23:                         Count = 1,  24:                         Breeds = new [] {new {animal.Breed, Count = 1}}  25:                     };  26:         Reduce = animals =&gt;  27:                     from r in animals  28:                     group r by r.Species  29:                     into g  30:                     select new  31:                         {  32:                             Species = g.Key,  33:                             Count = g.Sum(x =&gt; x.Count),  34:                             Breeds = from breed in g.SelectMany(x =&gt; x.Breeds)  35:                                     group breed by breed.Breed  36:                                     into gb  37:                                     select new {Breed = gb.Key, Count = gb.Sum(x =&gt; x.Count)}  38:                         };  39:&#xA0;   40:     }  41: }&#xA;And the result of this beauty?&#xA;&#xA;And that is quite pretty, even if I say so myself.</p>
        </article>
        <div class="button flex justify-between">
            <a href="437.html"><span class="back arrow"></span></a>

            <a href="439.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>