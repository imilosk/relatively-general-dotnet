
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 575 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-5741">
            <a href="https://ayende.com/blog/4233/using-a-service-bus-for-queries" target="_blank">
                <h2 class="title mb-6" id="article-5741">Using a service bus for queries</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 07, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Yep, another forum question. Unfortunately, in this case all I have is the title. Even more unfortunately, I already used the stripper metaphor before.&#xA;There are some questions that I am really not sure how to answer, because there are several underlying premises that are flat out wrong in the mere asking of the question.&#xA;&#x201C;Can you design a square wheel carriage?&#x201D; is a good example of that, and using a service bus for queries is another.&#xA;The short answer is that you don&#x2019;t do that.&#xA;The longer answer is that you still don&#x2019;t do that, but also explains why the question itself is wrong. One of the things that goes along with a service bus is the concept of services.&#xA; Services are autonomous.&#xA;Does this ring a bell?&#xA;You don&#x2019;t query a service for its state, because that would violate the autonomy tenant.&#xA;But I need the users data from the Personalization service to show the home page, I can hear you say. Well, sure, but you don&#x2019;t perform queries across a service boundary.&#xA;&#xA0;&#xA;Notice the terminology here. You don&#x2019;t perform queries across a service boundary.&#xA;But you can perform queries inside a service boundary. The image on the right shows one such example of that.&#xA;We have several services in a single application, they communicate between services using a service bus.&#xA;But a service isn&#x2019;t just something that is running in a server somewhere. The personalization service also have user interface, business logic that needs to run on the UI, etc.&#xA;That isn&#x2019;t just some other part of the application that is accessing the personalization service operations. It is a part of the personalization service.&#xA;And inside a service boundary, there are no limitation to how you get the data you need to perform some operation.&#xA;You can perform a query using whatever method you like (a synchronous web service call, hitting the service database, using local state).&#xA;Personally, I would either access the data store directly (which usually means querying the service database) or use local state. I spoke about building a system where all queries are handled using local state here.</p>
        </article>
        <article id="article-5742">
            <a href="https://ayende.com/blog/4232/texo-my-power-shell-continuous-integration-server" target="_blank">
                <h2 class="title mb-6" id="article-5742">Texo &#x2013; My Power Shell Continuous Integration Server</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 06, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Yes, I wrote my own CI server. I even did it in Power Shell, because that looks cool. You can find the source here. It is currently running in production and is responsible for pushing NH Prof builds out.  Now, what was I thinking when I built my own CI server? Put simply, I had the following goals:     Test WPF apps &#x2013; CC.Net doesn&#x2019;t allow it, since it is running as a service and that affects the way WPF tests behave. Texo shell out a different process, so it doesn&#x2019;t have this limitation. Most other CI servers do the same.    Don&#x2019;t expose passwords &#x2013; the thing that really killed me with CC.Net was looking at the build log and seeing my password right there in plain text (happens if there is connectivity error to the repository). Yes, I am also surprised this is a feature.    Handle Git pushes &#x2013; Git allows you to push several changes to the repository in a single shot. When I tried to use CC.Net to build NH Prof from git, it only showed the last commit. Texo understand the notion of a push (it takes it from the git hub API) and can pass that information to the build script.    Reactive &#x2013; Texo doesn&#x2019;t check the repository, in fact, most of the time it is completely passive (and is likely to be shut down). Whenever a push is made to the repository, github will call the Texo&#x2019;s url, providing the information about the current push. Texo will take that information and create the builder process, which will update / clone the new repository, and then execute the build command.    Small configuration footprint &#x2013; there are only two types of configuration, the SMTP settings and the project information. Here is the full configuration file:              &lt;settings&gt;&#xA;  &lt;email&gt;&#xA;    &lt;smtpServer&gt;smtp.gmail.com&lt;/smtpServer&gt;&#xA;    &lt;username&gt;*****@gmail.com&lt;/username&gt;&#xA;    &lt;password&gt;****&lt;/password&gt;&#xA;    &lt;useSSL&gt;true&lt;/useSSL&gt;&#xA;    &lt;port&gt;587&lt;/port&gt;&#xA;    &lt;from&gt;*****@gmail.com&lt;/from&gt;&#xA;  &lt;/email&gt;&#xA;  &lt;project&#xA;    url=&quot;https://github.com/ayende/Texo&quot;&#xA;    name=&quot;Texo&quot;&#xA;    git=&quot;C:\Work\Texo&quot;&#xA;    ref=&quot;refs/heads/master&quot;&#xA;    cmd=&quot;powershell .\psake.ps1 default.ps1 upload&quot;&#xA;    build=&quot;3&quot;&#xA;    workingDir=&quot;C:\Builds\Texo&quot;&#xA;    email=&quot;ayende@ayende.com&quot; /&gt;&#xA;&lt;/settings&gt;&#xA;  &#xA;&#xA;&#xA;What it doesn&#x2019;t do:&#xA;&#xA;&#xA;  UI, reports, tracking, whatever. Texo has one purpose in life, listen to changes and build the software, nothing else. The UI is a very simple email notification process, nothing more. &#xA;&#xA;  Hung build recovery.&#xA;&#xA;  Anything but git &#x2B; github.&#xA;&#xA;&#xA;Texo is compromised of two parts, a web endpoint, written in C#, that plugs into IIS. I assume that the IIS website user is going to be the same one that the tests will run under (makes things much simpler). Once a notification arrives, the endpoint will invoke the Builder Power Shell script to perform the actual CI process.&#xA;&#xA;At some point I really have to make up a list of all the projects that I was involved at, I know how I am going to title it: &#x201C;NIH R US&#x201D;.&#xA;&#xA;Oh, and can you figure out the naming?</p>
        </article>
        <article id="article-5743">
            <a href="https://ayende.com/blog/4231/licensing-a-commercial-product" target="_blank">
                <h2 class="title mb-6" id="article-5743">Licensing a commercial product</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 06, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is another forum question, this time from Brendan Rice:     A lot of developers are unsure of how best to go about making money from a product, how do you go about implementing licensing, what pay system do you use, how do you accept payment, are there any legal issues...   Well, talk about an open ended question. There are several aspects for the answer, legal, licensing and payment processing. There are somewhat related, though.  From the legal side, you need to understand basic concepts in the legal side of software engineering. You need to understand copyright, the idea of licensing software, what rights you care about and what you shouldn&#x2019;t. I got a lot of my knowledge from simply researching the topic.  You might want to have a lawyer draft your EULA, but there are two major things that you want to remember about the EULA. Some people actually read the bloody things. If you put things there that are too nefarious people will get pissed at you. There is such a thing as bad publicity. You want to avoid that.   The second important thing about EULA is that if you take someone to court over it, you have already lost. I like to think about EULA as just setting the grounds for what is expected from either side. By all means, get that through your lawyer, but be sure that you know what is in there. And be sure that it is an agreement that you would be willing to sign.  From the licensing perspective, I had a disastrous experience using one licensing component, after which I decided that I might as well write my own. It is a pretty simple system, based on signed XML files, I have the secret private key and the application ship with the public key. It allows to pass data around in a very simple form while protecting the license files from tampering. The code is available, and it is pretty simple, so I won&#x2019;t get deeper into it.  The last part, payment processing, is probably the most interesting bit. I use a payment provider, because trying to manage something like that yourself is a nightmare. My payment provider handles all sort of payment options, including things that require someone to answer the phone or manually clear mailed checks, etc.  They also provide nice admin site, where I can do things like generate coupons, like this one: NHP-45K2D46S27 (yes, it is a valid one, at least until someone will use it), refund people, taxation, view interesting reports and in general administer all aspects of the accepting payments.   They take a commission that isn&#x2019;t significantly larger than most credit cards and in general they solve so much headache that I am happy to pay them.  The result of a successful order in the payment provider is an email generated that is sent to a mailbox monitored by a service. That email is read, parsed, and the corresponding license file is then sent to the user.  Nothing really earth shattering in all the process, yes, I know. But it is probably important to outline that clearly for people who haven&#x2019;t done it yet. It isn&#x2019;t complex or hard by any measure.</p>
        </article>
        <article id="article-5744">
            <a href="https://ayende.com/blog/4230/linq-to-sql-profiler-spike-results" target="_blank">
                <h2 class="title mb-6" id="article-5744">Linq to Sql Profiler: Spike results</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Well, so far, so good.   I started by defining a simple Linq to SQL model, there are zero things that you need to do here to make things work:     And now to the actual code using this model:     static void Main()&#xA;{&#xA;    LinqToSqlProfiler.Initialize();&#xA;    using (var db = new BlogModelDataContext())&#xA;    {&#xA;        var q = from blog in db.Blogs&#xA;                where blog.Title == &quot;The Lazy Blog&quot;&#xA;                select blog;&#xA;&#xA;        foreach (var blog in q)&#xA;        {&#xA;            Console.WriteLine(blog.Title);&#xA;&#xA;            foreach (var post in blog.Posts)&#xA;            {&#xA;                Console.WriteLine(post.Title);&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;&#xA;I think that we can agree that this is pretty routine usage of Linq to SQL. The only thing extra that we need is to initialize the profiler endpoint.&#xA;&#xA;The end result is:&#xA;&#xA;&#xA0;&#xA;&#xA;We can detect data contexts opening and closing, we can detect queries and their parameters, format them to display properly and show their results. We can even detect queries generated from lazy loading and the stack trace that caused each query (a hugely valuable feature). &#xA;&#xA;Now, before you get too excited, this is a spike. A lot of the code is going to end up in the final bits, but there is a lot more to do yet.&#xA;&#xA;Things that I am not going to be able to do:&#xA;&#xA;&#xA;  Track local transactions (I&#x2019;ll probably be able to track distributed transactions, however)&#xA;&#xA;  Show query row count&#xA;&#xA;  Track query duration&#xA;&#xA;  Show entities load by session&#xA;&#xA;&#xA;I am going to be able to show at least some statistics, however, which is pretty nice, all told.&#xA;&#xA;Thoughts?</p>
        </article>
        <article id="article-5745">
            <a href="https://ayende.com/blog/4229/jaoo-evolving-the-key-value-programming-model-to-a-higher-level" target="_blank">
                <h2 class="title mb-6" id="article-5745">JAOO</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Billy Newport is talking about Redis, showing some of the special APIs that Redis offers.     Redis gives us first class List/Set operation, simplify many tasks involving collections. It is easy to get into big problems afterward.     Can do 100,000 operations per second.     Redis encourage a column oriented view, you use things like:              R.set(&quot;user:123@firstname&quot;, &quot;billy&quot;)&#xA;R.set(&quot;user:123@surname&quot;, &quot;newport&quot;)&#xA;R.set(&quot;uid:bewport&quot;, 123)&#xA;  &#xA;&#xA;&#xA;&#xA;  Ayende&#x2019;s comment: I really don&#x2019;t like that. No transactions or consistency, and this requires lots of remote calls.&#xA0; &#xA;&#xA;&#xA;&#xA;  Bugs in your code can corrupt the entire data store. Causing severe issues in development. &#xA;&#xA;  There is a sample Twitter like implementation, and the code is pretty interesting, it is a work-on-write implementation. &#xA;&#xA;  List/set operations are problems. What happen when you have a big set? Case in point, Ashton has 4 million followers, work-on-write doesn&#x2019;t work in this case. &#xA;&#xA;  100,000 operations per second doesn&#x2019;t mean much when a routine scenario result in millions of operations. &#xA;&#xA;  This is basically the usual SELECT N&#x2B;1 issue. &#xA;&#xA;  Async approach is required, processing large operations in chunks. &#xA;&#xA;  Changing the way we work, instead of getting the data and working on it, send the code to the data store and execute it there (execute near the data). &#xA;    &#xA;      Ayende&#x2019;s note: That is still dangerous, what happen if you send a piece of code&#xA0; to the data store and it hungs? &#xA;    &#xA;  &#xA;&#xA;  Usual problems with column oriented issues, no reports, need export tools. &#xA;&#xA;  Maybe use closures as a way to send the code to the server? &#xA;&#xA;&#xA;Ayende&#x2019;s thoughts:&#xA;&#xA;I need to think about this a bit more, I have some ideas based on this presentation that I would really like to explore more.</p>
        </article>
        <article id="article-5746">
            <a href="https://ayende.com/blog/4228/jaoo-working-effectively-with-legacy-code-2-michael-feathers" target="_blank">
                <h2 class="title mb-6" id="article-5746">JAOO</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have a tremendous amount of respect to Michael Feathers, so it is a no brainer to see his presentation.   Michael is talking about why Global Variables are not evil. We already have global state in the application, removing it is bad/impossible. Avoiding global variables leads to very deep argument passing chains, where something needs an object and it passed through dozens of objects that just pass it down. We already have the notions on how to test systems using globals (Singletons). He also talks about Repository Hubs &amp; Factory Hubs &#x2013; which provide the scope for the usage of a global variable.     Refactor toward explicit seams, do not rely on accidental seams, make them explicit.     Test Setup == Coupling, excessive setup == excessive coupling.     Slow tests indicate insufficient granularity of coupling &lt;- I am not sure that I agree with, see my previous posts about testing for why.     It is often easier to mock outward interfaces than inward interfaces (try to avoid mocking stuff that return data)     One of the hardest things in legacy code is making a change and not knowing what it is affecting. Functional programming makes it easier, because of immutability.     Seams in a functional languages are harder. You parameterize functions in order to get those seams.     TUF &#x2013; Test Unfriendly Feature &#x2013; IO, database, long computation     TUC &#x2013; Test Unfriendly Construct &#x2013; static method, ctor, singleton     Never Hide a TUF within a TUC     No Lie principal &#x2013; Code should never lie to you. Ways that code can lie:             Dynamically replacing code in the source         Addition isn&#x2019;t a problem         System behavior should be &#x201C;what I see in the code &#x2B; something else&#x201D;, never &#x201C;what I see minus something else&#x201D;         Weaving &amp; aspects         Impact on inheritance             The Fallacy of Restricted Languages     You want to rewrite if the architecture itself is bad, if you have issues in making changes rapidly, it is time for refactor the rough edges out.</p>
        </article>
        <article id="article-5747">
            <a href="https://ayende.com/blog/4227/xprofiler-a-generic-or-m-profiler" target="_blank">
                <h2 class="title mb-6" id="article-5747">xProfiler &#x2013; A generic OR/M Profiler</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 05, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">With the release of NH Prof v1.0, I started to look if I can extend what I am doing for NHibernate for other OR/M in the .NET space. My initial spiking makes me optimistic, this is certainly possible. I&#x2019;ll probably talk at length about the actual architectural implementation, but for now I want to concentrate on the actual high level requirements. I want to be able to support the following:     Linq to SQL    SubSonic    LLBLGen    Plug your own DAL   While none of them are going to provide me with the detailed information that I can get from NHibernate, it turns out that I can get a pretty good mileage from just pushing the basics along. The first spikes with Linq to SQL are promising (more about that will show up starting next week or the one after that), and I intend to allow you to:     Show DataContext     Show SQL Statements         Show you the actual formatted SQL, including parameters      Show you the stack trace of where that SQL was generated       Generate alerts for bad practices such as SELECT N&#x2B;1 or issuing too many queries   There are things that I can do with NHibernate that are simply not possible with other OR/Ms (something like tracking loaded entities per session, for example, or showing cached queries), but since most of those are actually capabilities that NHibernate has and the others do not, I think it is still great.  Currently the plan is to have a separate product for each OR/M, that means that buying NH Prof will not get you L2S Prof, but we will most likely have some uber license that will cover all of them.   You&#x2019;ll notice that the Entity Framework isn&#x2019;t listed in my initial targets list. That is for a very simple reason, plugging into EF seems to be about nine times harder than doing it with anything else. I would need to get a strong feedback that this is something that enough people are willing to pay for.</p>
        </article>
        <article id="article-5748">
            <a href="https://ayende.com/blog/4226/message-passing-concurrency-and-shared-state" target="_blank">
                <h2 class="title mb-6" id="article-5748">Message passing concurrency and shared state</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Mike Rettig has left a somewhat snarky comment on a post detailing a deadlock issue that I run into:     Locking on shared state? I thought you were a proponent of message based concurrency.&#xA0; This post demonstrates exactly why concurrency combined with shared state is so hard.     Looking forward to your next thread race or deadlock,   The problem with message passing concurrency is that the underlying assumption here is that there isn&#x2019;t any shared state. But in my situation, that is no a valid assumption.  Let us see if I can give a good example of what I mean. Let us assume that we have a message passing the exchange the following messages:     Session Created { Session Id }    Statement Executed { Session Id, Statement Text }    Query Sessions And Statements { }   Furthermore, you are not going to be make use of something like a DB to manage the state (which would handle the sharing issue for you), you have to manage everything in memory.  I would be very interested in hearing how you can design such a system without having shared state and locking.</p>
        </article>
        <article id="article-5749">
            <a href="https://ayende.com/blog/4225/what-is-happening-with-nh-prof" target="_blank">
                <h2 class="title mb-6" id="article-5749">What is happening with NH Prof?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 04, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I was a bit quite on the NH Prof front lately, not because I didn&#x2019;t work on it, but because I was fighting a really nasty bug. The way NH Prof is making use of WPF exposed a memory leak scenario inside WPF.  Luckily, once we were able to isolate the actual problem, it was relatively easy to find a workaround. If you care, the resolution was to keep a single instance bound to the view and replace its values, instead of providing a new instance when replacement was required. The problem is that this bug took forever to isolate.   Also included are a bunch of performance optimizations that I did along the way to resolve the OOM error. Those relate to better handling of batch statements, caching the result of SQL parsing and optimized NH Prof&#x2019;s idle state (I&#x2019;ll have a separate post about that).  In addition to that, I gave some additional love to DDL statements, making sure that NH Prof treated them specially and didn&#x2019;t generate DML errors for DDL statements. Same goes for cached statements.  It is a bunch of small changes, the biggest of them was tracking down and viciously attacking the OOM error. For the next week, I am going to be busy at JAOO, but I also intend to spend some free time continuing the final polishing &amp; touch ups.  The week after that, I intend to seriously start working on the 1.1 feature set.  Should be interesting.</p>
        </article>
        <article id="article-5750">
            <a href="https://ayende.com/blog/4224/do-you-sign-the-default-contract" target="_blank">
                <h2 class="title mb-6" id="article-5750">Do you sign the default contract?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: October 03, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is just something that came up recently in a mailing list, we were talking about copyright, ownership and such. The topic of who owns the code you write on your own time (and on your own machines) came up.  The opinion of some people was that the employer may own the code even under those circumstances. It seems that it isn&#x2019;t usually part of the law (that depend on where you are at, of course), but it is part of standard employment contract templates.   When I started looking for a job, I insisted on taking the employment contract home and going over it with:     a calm mind    having another set of eyes go over it   I had one case of not properly reading what I was signing on with bad consequences, I learned since then.  There is no such thing as a standard contract, you can always negotiate.   For that matter, I rejected an offer from one place after verbal agreements that we reached didn&#x2019;t get into the contract (twice!). I decided that if they were trying to effectively cheat me when I wasn&#x2019;t even working for them, I had better things to do than to put my head into this sickbed.  Some of the things that I found in employment contracts are of the sort that would make your head curl. Non compete agreements that basically say that you are not allowed to do any work (for anyone) for 2 years after you stop working for the company. Ownership on anything you do (be in software artifacts, a book about flowers and quite possibly any children you have during your employment terms).  Some of them are unenforceable at court, but you would be at a much better position if you didn&#x2019;t have to deal with annoying section in a contract that you are signed on in the first place.  My usual approach to reading contracts is to debug them, assuming that the other side is nefarious, evil, double dealing and likes kicking puppies before breakfast. Most places will go with the &#x201C;Try and you shall succeed&#x201D; method for contracts. If you signed on to them without complaints, they are good. If you object to something, they can amend the contract to be more reasonable. It isn&#x2019;t that they are nefarious, or that they even plan to act according to the contract. But it is best if they don&#x2019;t have any leverage on you.  An interesting point that I run into is that it is often useful to be bold when negotiating a contract. I deleted the non compete clause for my employment contract when I viewed it, and required a lot of clarifications about what of my work amounts to company&#x2019;s property. I followed the same logic as they did, &#x201C;Try and you shall succeed&#x201D;, if they didn&#x2019;t care about that, I was good.   We ended up with a 1 year limitation for clients that they sent me to, and agreeing that any software work that I am making on the company&#x2019;s time or using their equipment belong to the company, which I considered reasonable.   Not reading the contract is a crime, once you did, be very careful in deciding what is acceptable and what isn&#x2019;t. And if you are already signed on a contract, make sure that you know what is in it.</p>
        </article>
        <div class="button flex justify-between">
            <a href="574.html"><span class="back arrow"></span></a>

            <a href="576.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>