
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 768 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-7671">
            <a href="https://ayende.com/blog/2649/rhino-etl-full-package-syntax" target="_blank">
                <h2 class="title mb-6" id="article-7671">Rhino.ETL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Okay, here is the full package syntax that I have now, which is enough to express&#xA0;quite a bit, I am now getting started on working on the engine itself, I am going to try the message passing architecture for now, since it is much more flexible. connection( &#xA;&#x9;&quot;NorthwindConnection&quot;,&#xA;&#x9;ConnectionType: SqlConnection,&#xA;&#x9;ConnectionString: &quot;Data Source=localhost;Initial Catalog=Northwind; Integrated Security=SSPI;&quot;&#xA;&#x9;)&#xA;&#xA;source Northwind, Connection=&quot;NorthwindConnection&quot;:&#xA;&#x9;Command: &quot;SELECT * FROM Orders WHERE RequiredDate BETWEEN @LastUpdate AND @CurrentDate&quot;&#xA;&#x9;&#xA;&#x9;Parameters:&#xA;&#x9;&#x9;@LastUpdate = date.Today.AddDays(-1)&#xA;&#x9;&#x9;@CurrentTime = ExecuteScalar(&quot;NorthwindConnection&quot;, &quot;SELECT MAX(RequiredDate) FROM Orders&quot;)&#xA;&#xA;transform ToLowerCase:&#xA;&#x9;for column in Parameters.Columns:&#xA;&#x9;&#x9;Row[column] = Row[column].ToLower() if Row[column] isa string&#xA;&#xA;destination Northwind, Connection = &quot;NorthwindConnection&quot;:&#xA;&#x9;Command: &quot;&quot;&quot;&#xA;INSERT INTO [Orders_Copy]&#xA;(&#xA;&#x9;[CustomerID], [EmployeeID], [OrderDate], [RequiredDate], [ShippedDate],[ShipVia],&#xA;&#x9;[Freight],[ShipName],[ShipAddress],[ShipCity],[ShipRegion],[ShipPostalCode],&#xA;&#x9;[ShipCountry]&#xA;)&#xA;VALUES&#xA;(&#xA;&#x9;@CustomerID,@EmployeeID,@OrderDate,@RequiredDate,@ShippedDate,@ShipVia,@Freight,&#xA;&#x9;@ShipName,@ShipAddress,@ShipCity,@ShipRegion,@ShipPostalCode,@ShipCountry&#xA;)&#xA;&quot;&quot;&quot;&#xA;&#xA;pipeline CopyOrders:&#xA;&#x9;Sources.Northwind &gt;&gt; ToLowerCase(Columns: [&#x27;ShipCity&#x27;,&#x27;ShipRegion&#x27;])&#xA;&#x9;ToLowerCase &gt;&gt; Destinations.Northwind</p>
        </article>
        <article id="article-7672">
            <a href="https://ayende.com/blog/2648/rhino-etl-turning-transformations-to-fizzbuzz-tests" target="_blank">
                <h2 class="title mb-6" id="article-7672">Rhino.ETL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Tobin Harris has asked some questions about how Rhino.ETL will handle transformations.&#xA0; As you can see, I consider this something as trivial as a FizzBuzz test, which is a Good Thing, since it really should be so simple. Tobin&#x27;s questions really show the current pain points in ETL processes.  Remove commas from numberstransform RemoveCommas:&#xA;  for column in row.Columns:&#xA;&#x9;if row[column] isa string:&#xA;&#x9;&#x9;row[column] = row[column].Replace(&quot;,&quot;,&quot;&quot;)&#xA;Trim and convert empty string to nulltransform TrimEmptyStringToNull:&#xA;&#x9;for column in row.Columns:&#xA;&#x9;&#x9;val = row[column]&#xA;&#x9;&#x9;if val isa string:&#xA;&#x9;&#x9;&#x9;row[column] = null if val.Trim().Length == 0&#xA;Reformat UK postcodes - No idea from what format, and to what format, but let us say that I have &quot;SW1A0AA&quot; and I want &quot;SW1A 0AA&quot;transform IntroduceSpace:&#xA;&#x9;row.PostalCode = row.PostalCode.Substring(0,4) &#x2B;&#x27; &#x27; &#x2B; row.PostalCode.Substring(4)&#xA;Make title case and Derive title from name and drop into column &#x27;n&#x27;:transform  MakeTitleCase:&#xA;&#x9;row.Title = row.Name.Substring(0,1).ToUpper() &#x2B; row.Name.Substring(1)&#xA;Remove blank rows - right now, you would need to check all the columns manually ( here is a sample for one column that should suffice in most cases ), if this is an important, it is easy to add the check in the row class itself, so you can ask for it directly.transform RemoveRowsWithoutId:&#xA;&#x9;RemoveRow() if not row.Id&#xA;Format dates - I think you already got the idea, but never the less, let us take &quot;Mar 04, 2007&quot; and translate it to &quot;2007-03-04&quot;, as an aside, it is probably easier to keep the date object directly.transform TranslateDate:&#xA;&#x9;row.Date = date.Parse(row.Date).ToString(&quot;yyyy-MM-dd&quot;)&#xA;Remove illegal datestransform RemoveBadDate:&#xA;&#x9;tmp as date&#xA;&#x9;row.Date = null if not date.TryParse(row.Date, tmp)&#xA;Things that I don&#x27;t have an implementation of are:&#xA;&#xA;Remove repeated column headers in data - I don&#x27;t understand the requirement.&#xA;Unpivot repeated groups onto new rows, Unpivot( startCol, colsPerGroup, numberOfGroups) - I have two problems here, I never groked pivot/unpviot fully, so this require more research, but I have a more serious issue, and that is that this is a transformation over a set of rows, and I can&#x27;t thing of a good syntax for that, or the semantics it should have.I am opened for ideas...</p>
        </article>
        <article id="article-7673">
            <a href="https://ayende.com/blog/2647/rhino-etl-providing-answers" target="_blank">
                <h2 class="title mb-6" id="article-7673">Rhino.ETL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">It would be easier to me to answer a few of the questions that has cropped up regarding Rhino.ETL. Boo vs. Ruby: Why I choose to go with Boo rather than Ruby. Very simple reasoning, my familiarity with Boo. I can make Boo do a lot of stuff already, I would have to start from scratch on Ruby. I don&#x27;t see any value in one over the other, frankly, is there a reason behind the preference? NAnt ETL Tasks: The main problem I have with such an endeavor is that it is back to XML again, if I want to build complex processes, I want them to be easy to follow, and that exclude XML. Active Warehouse: Interesting idea, but that is using the imperative approach, I want to do something a little more declarative, and I really want it to be on the .Net platform (hence, much more familiar &amp; debuggable). I also in a position where I believe that it would actually take me less time to build the tool than learn a tool in a new language. Other OSS ETL tools: There are quite a few&#xA0;OSS ETL tools that has been raised,&#xA0;they all share one problem from my perspective, they are not .Net and they are&#xA0;all visual / XML oriented.  I should also mention that&#xA0;I am building this&#xA0;project as preemptive step against the next&#xA0;project ETL&#x27;s requirements, so I have both time to build it, and I have the craziest itch to scratch after dealing with SSIS in this project. The last time I was this excited about something, Rhino Mocks came out :-)</p>
        </article>
        <article id="article-7674">
            <a href="https://ayende.com/blog/2646/framework-building-rhino-etl-status-report" target="_blank">
                <h2 class="title mb-6" id="article-7674">Framework building: Rhino.ETL Status Report</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 21, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am currently working on making this syntax possible, and letting ideas buzz at the back of my head regarding the implementation of the ETL engine itself. This probably requires some explanation. My idea about this is to separate the framework into two distinct layers. The core engine, which I&#x27;ll talk about in a second, and the DSL syntax. One of the basic design decisions was that the DSL would be declarative, and not imperative. How does this follow, when I have something like this working: source ComplexGenerator:&#xA;&#x9;CommandGenerator:&#xA;&#x9;&#x9;if Environment.GetEnvironmentVariable(&quot;production&quot;):&#xA;&#x9;&#x9;&#x9;return &quot;SELECT * FROM Production.Customers&quot;&#xA;&#x9;&#x9;else:&#xA;&#x9;&#x9;&#x9;return &quot;SELECT * FROM Test.Customers&quot;&#xA;This certainly looks like an imperative language to me... (And no, this isn&#x27;t really an example of something that I would recommend doing, it is here just make the principal).&#xA;The idea is that the DSL is used to build the object graph, then we can execute that object graph. But building it in a two stage fashion make it a lot easier to deal with such things as validation, visualization, etc.&#xA;Now, let us more to the core engine, and see what I have been thinking about. Core concepts:&#xA;&#xA;Connection - The details about how to get the IDbConnection instance, including such things as number of concurrent connection, etc... &#xA;DataSource - Contains the details about how to get the data. Command to execute, parameters, associated connection, etc. &#xA;DataDestination - Contains the details about how to write the data, command / action to execute, parameters, connection, etc. &#xA;Row - A single row. A simple key &lt;-&gt; value structure with a twist that it can also contain other rows (from a merge/join) &#xA;Transform - Transform the current row &#xA;RowSet - a set of rows, obviously, useful for aggregation, lookup, etc. Not really sure how it should come into play yet.&#xA;The architecture of the whole thing is based on the pipeline idea, obviously. Now, there are several implementation decisions that should be considered from there.&#xA;&#xA;Destination as the driver. The destination is the driver behind this architecture, it request the next row from the pipeline, which starts things rolling. Implementation can be as simple as:foreach(Row row in Pipeline.NextRow())&#xA;{&#xA;&#x9;PushToDestination(row);&#xA;} This has the side affect of making the entire pipeline single threaded per destination, it makes it much easier to implement, and would make it easier to see the flow of things. Parallelism can be managed by multiple pipelines and/or helper threads. The major benefit in parallelism is with the data read/write, and those are limited to a pipeline at any rate.It does bring up the interesting question of how to deal with something like merge join, which requires multiply inputs, you would need to manage the different inputs in the merge, but I think that this is mandatory anyway.&#xA;&#xA;Message passing architecture. In this architecture, each component (source, transform, destination) is basically an independent object with input/output channels, they all operate without reliance on each other. This is more complex because you can&#x27;t do the simplest thing of just giving each component a thread, so you need to manage yielding and concurrency to a much higher degree.A bigger issue is that it puts a higher burden on writing components.&#xA;Right now I am leaning toward going to the single threaded pipeline idea, any comments?</p>
        </article>
        <article id="article-7675">
            <a href="https://ayende.com/blog/2645/test-driving-rhino-etl" target="_blank">
                <h2 class="title mb-6" id="article-7675">Test driving Rhino.ETL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 20, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Here is the first test: [Test] &#xA;public void EvaluatingScript_WithConnection_WillAddDataSourceToContext() &#xA;{ &#xA;&#x9;EtlConfigurationContext configurationContext = EtlContextBuilder.FromFile(@&quot;Connections\connection_only.retl&quot;);&#xA;&#x9;Assert.AreEqual(3, configurationContext.Connections.Count, &quot;should have three connections&quot;);&#xA;}&#xA;There is quite a bit of information just in this test, we introduced the EtlConfigurationContext class, decided that we will create it from a factory, and that we have something that is called a connection. Another decision made was the &#x201C;retl&#x201D; extension (Rhino ETL), but that is a side benefit.&#xA;The source for this is:&#xA;Connection( &#xA;&#x9;&quot;Northwind&quot;,&#xA;&#x9;ConnectionType: SqlConnection,&#xA;&#x9;ConnectionString: &quot;Data Source=localhost;Initial Catalog=Northwind; Integrated Security=SSPI;&quot;,&#xA;&#x9;ConcurrentConnections: 5&#xA;&#x9;)&#xA;&#x9;&#xA;Connection( &#xA;&#x9;&quot;SouthSand&quot;,&#xA;&#x9;ConnectionType: OracleConnection,&#xA;&#x9;ConnectionStringName: &quot;SouthSand&quot;&#xA;&#x9;)&#xA;&#xA;Connection( &#xA;&#x9;&quot;StrangeOne&quot;,&#xA;&#x9;ConnectionType: OracleConnection,&#xA;&#x9;ConnectionStringGenerator: { System.Environment.GetEnvironmentVariable(&quot;MyEnvVar&quot;) }&#xA;&#x9;)&#xA;You may have wondered about the last one, what does this do? Well, it allows you to do runtime evaluation of something, in this case, it get the value from an env-var, but that has a lot of potential. Here it a test that demonstrate the capabilities:&#xA;[Test]&#xA;public void DataSources_ConnectionStringGenerator_CanUseEvnrionmentVariables()&#xA;{&#xA;&#x9;Environment.SetEnvironmentVariable(&quot;MyEnvVar&quot;,&quot;MyExpectedValue&quot;);&#xA;&#xA;&#x9;Assert.AreEqual(&#xA;&#x9;&#x9;&#x9;&quot;MyExpectedValue&quot;,&#xA;&#x9;&#x9;&#x9;configurationContext.Connections[&quot;StrangeOne&quot;].ConnectionString&#xA;&#x9;);&#xA;&#xA;&#x9;Environment.SetEnvironmentVariable(&quot;MyEnvVar&quot;, &quot;2&quot;);&#xA;&#xA;&#x9;Assert.AreEqual(&#xA;&#x9;&#x9;&#x9;&quot;2&quot;,&#xA;&#x9;&#x9;&#x9;configurationContext.Connections[&quot;StrangeOne&quot;].ConnectionString&#xA;&#x9;);&#xA;&#xA;}</p>
        </article>
        <article id="article-7676">
            <a href="https://ayende.com/blog/2644/what-is-bad-about-good-ideas" target="_blank">
                <h2 class="title mb-6" id="article-7676">What is bad about good ideas?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 19, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I finalized thinking about Rhino.ETL late last night, and then went to bed. I couldn&#x27;t sleep for over an hour later, kept rolling thinks in my head. When I caught myself thinking about how I would design the test strategy when I was in the shower, I knew that it is an emergency, this idea wants to get out, badly. Help! I am attached by my own muse!</p>
        </article>
        <article id="article-7677">
            <a href="https://ayende.com/blog/2643/idea-the-boo-etl-dsl" target="_blank">
                <h2 class="title mb-6" id="article-7677">Idea: The Boo ETL DSL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 19, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Note: This is just syntax idea that I have in my head right now, it has no implementation.  I have decided to do something about, and spent some time thinking about it, here is the initial design. It is a textual DSL for ETL. What you can see directly below is in a direct correlation of a lot of the stuff that I need to do with SSIS.&#xA0; The first one is basically a Data Flow task. The script goes like this:  Define two data sources, and you can see that I ma using named connection strings in one, and hard coded connection string in the other. Define the source, which is a SQL command, against Oracle database, with supports for parameters (that is not something that SSIS can do, amazing as it sounds). Note that the parameters are retrieved by executing SQL against the different databases, and then storing it in a variable. We have a simple transform, which include some logic as well as string manipulation and date formatting, all things that are disgustingly hard in SSIS. Then we have the destination, we define the command that we want to execute, and we get all the parameters from the context (note that we are using a new parameter that we created in the transform &quot;@Registered&quot;. We are also defining a BatchSize, which should increase performance if it matters.  DataSource(&#xA;&#x9;&quot;SouthSand&quot;,&#xA;&#x9;&quot;System.Data.SqlConnection&quot;,&#xA;&#x9;&quot;Data Source=localhost;Integrated Security=SSPI;Initial Catalog=SouthSand&quot;&#xA;&#x9;)&#xA;&#xA;DataSource(&#xA;&#x9;&quot;Northwind&quot;,&#xA;&#x9;&quot;Orale.Client.OracleConnection&quot;,&#xA;&#x9;System.Configuration.ConfigurationManager.ConnectionStrings[&quot;Northwind&quot;]&#xA;&#x9;)&#xA;&#xA;source Northwind:&#xA;&#x9;Sql: &quot;&quot;&quot;&#xA;&#x9;&#x9;SELECT CustomerID,&#xA;&#x9;&#x9;   CompanyName,&#xA;&#x9;&#x9;   ContactName,&#xA;&#x9;&#x9;   ContactTitle,&#xA;&#x9;&#x9;   Address,&#xA;&#x9;&#x9;   City,&#xA;&#x9;&#x9;   Region,&#xA;&#x9;&#x9;   PostalCode,&#xA;&#x9;&#x9;   Country,&#xA;&#x9;&#x9;   Phone,&#xA;&#x9;&#x9;   Fax,                   RegisteredYear,                   RegisteredMonth,&#xA;&#x9;&#x9; FROM tblCustomers&#xA;&#x9;&#x9; WHERE LastUpdateDate BETWEEN :lastUpdate AND :currentTime&#xA;&#x9;      &quot;&quot;&quot;&#xA;&#xA;&#x9;Parameters:&#xA;&#x9;&#x9;@lastUpdate = ExecuteScalar(&quot;SouthSand&quot;, &quot;GetLastRunTimeForETL&quot;)&#xA;&#x9;&#x9;@currentTime = ExecuteScalar(&quot;Northwind&quot;, &quot;SELECT sysdate from dual&quot;)&#xA;&#x9;&#x9;&#xA;transform:&#xA;&#x9;@Phone = @Fax if @Phone is null&#xA;&#x9;@CustomerId = @CustomerId.ToLower()        @Registered = date(@RegisteredYear,@RegisteredMonth, 1)&#xA;&#x9;&#xA;destination SouthSand:&#xA;&#x9;BatchSize: 500&#xA;&#x9;Command: &quot;&quot;&quot;&#xA;&#x9;&#x9;INSERT INTO  [Customers]&#xA;&#x9;&#x9;&#x9;(&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;[CustomerID] ,[CompanyName],[ContactName],[ContactTitle],&#xA;&#x9;&#x9;&#x9;&#x9;[Address],[City],[Region],[PostalCode],[Country],[Phone],&#xA;&#x9;&#x9;&#x9;&#x9;[Fax],[Registered]&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;VALUES&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;@CustomerID,@CompanyName,@ContactName,@ContactTitle,@Address,&#xA;&#x9;&#x9;&#x9;&#x9;@City,@Region,@PostalCode,@Country,@Phone,@Fax,@Registered&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&quot;&quot;&quot;&#xA;If this is a data flow, how would the overall package look like? Let us take a package like this one, which is a format that I am using right now to do a lot of things.&#xA;DataSource(&#xA;&#x9;&quot;SouthSand&quot;,&#xA;&#x9;&quot;System.Data.SqlConnection&quot;,&#xA;&#x9;&quot;Data Source=localhost;Integrated Security=SSPI;Initial Catalog=SouthSand&quot;&#xA;&#x9;)&#xA;&#xA;DataSource(&#xA;&#x9;&quot;Northwind&quot;,&#xA;&#x9;&quot;Orale.Client.OracleConnection&quot;,&#xA;&#x9;System.Configuration.ConfigurationManager.ConnectionStrings[&quot;Northwind&quot;]&#xA;&#x9;)&#xA;&#xA;Execute(&quot;SouthSand&quot;, &quot;etl.TruncateAllTables&quot;) # etl.TruncateAllTables is a stored proc&#xA;&#xA;sequence: &#xA;&#x9;DataFlow(&quot;Customers.flow&quot;)&#xA;&#x9;DataFlow(&quot;Orders.flow&quot;)&#xA;&#x9;DataFlow(&quot;Products.flow&quot;)&#xA;&#x9;DataFlow(&quot;ProductStatuses.flow&quot;)&#xA;&#x9;DataFlow(&quot;OrderStatuses.flow&quot;)&#xA;&#x9;&#xA;Execute(&quot;SouthSand&quot;, &quot;etl.CleanData&quot;) &#xA;Execute(&quot;SouthSand&quot;, &quot;etl.UpdateInsertAllTables&quot;) &#xA;This probably means that I will have a way of inheriting the Data Source definitions. It took me about an hour to think it though, but I have this running through my head for a while now.&#xA;I estimate that it should take me a day or two to build this DSL. But you know what, once I have that, writing the ETL processes themselves are down to minutes! What is much more important is that I would estimate a similar amount of time to get an SSIS package of the same complexity ready to go, under the same circumstances, and I refuse to make estimates regarding SSIS deployments.&#xA;So, about the same time to build a new framework as it would take me to build a single task. Yes, it will not have a designer, but it will be maintainable RAD!&#xA;Nitpicker corner: No, it will not do XYZ feature of SSIS (lookups come to mind, or SSIS joins), but I rarely use them, and they are fairly simple to write once I do need them.</p>
        </article>
        <article id="article-7678">
            <a href="https://ayende.com/blog/2642/on-competition-nih-and-good-software" target="_blank">
                <h2 class="title mb-6" id="article-7678">On Competition, NIH and Good Software</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 19, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Jdn doesn&#x27;t agree with me:  .NET OSS developers *can&#x27;t* have it both ways. &#xA0;They can&#x27;t complain about Microsoft &#x27;reinventing the wheel&#x27; and not make it about a competition. &#xA0;It is the same thing, when it boils down to it.What is the complaint otherwise? &#xA0;That Microsoft shouldn&#x27;t come out with something that mirrors OSS efforts unless it is 10 times better? &#xA0;10 times better according to whom? &#xA0;You? &#xA0;The OSS police?  [...snip...] Your own and Jeremy Miller&#x27;s own blogs about &#x27;building a better CAB in an hour&#x27; *reek* of &#x27;it is a competition.&#x27;I do not doubt that you do not intend it to come across that way, but it certainly does, in spades, and I don&#x27;t see how you could think otherwise. Let me start by saying that I believe that it is a poor mind that can&#x27;t argue against itself (and win). I most certainly can have it both ways. I can complain about MS reinventing the wheel when they aren&#x27;t providing as much value as existing stuff, because they are in a position where people will follow them blindly. This means that they have the responsibility to be just as good as the existing things out there. I think that you missed an important distinction here, it is not about OSS, or using something other than MS, it is about not having to deal with a half-assed product. I would rather have nothing from Microsoft than something that doesn&#x27;t do everything that I expect something in its category to do. The reasoning is very simple, if I have nothing from Microsoft, it is much easier to build / buy something else. If there is something from Microsoft, but it is not up to par with the established standards, that is bad. It is bad because &quot;you don&#x27;t get fired for buying Microsoft&quot; way of thinking. And yes, this is a big issue to me. I would much rather do actual work than have to argue politics about &quot;But we are a Microsoft shop and they have a really cool presentation&quot;. Pointing out things that I don&#x27;t like, or consider overblown is not something that I would consider a competition, I do much the same for a lot of other things, including my own.</p>
        </article>
        <article id="article-7679">
            <a href="https://ayende.com/blog/2641/why-i-hate-ssis-part-n-1" target="_blank">
                <h2 class="title mb-6" id="article-7679">Why I hate SSIS: Part N&#x2B;1</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 19, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Take a look at this (highly simplified) package. The flow is very simple, truncate shadow tables, copy to shadow tables, perform cleanup and copy to the real tables. The inside of each data flow is simple Source -&gt; Convert to Unicode -&gt; Destination. Not really complicated or ground breaking, right? The shadow tables have the same structure as the real tables, but they have no FKs.  It failed on me, in production, but only when running as a job! The error? Primary Key violation in the Products Statuses and Order Statuses tables. I have verified that:  I am truncating those tables That only one instance of the job is running at any single time That the source data is neither changing nor invalid (those are lookup tables with 6 and 2 values, respectively) 99% reproducible, it would give an error when running as a job, 50% reproducible, it would give the error when running from dtexec.  After hitting the wall with it for way too long, I &quot;fixed&quot; it by doing:   Why it would make a difference, I have no idea.  The original version is what I was using for the last four or five months, and it never gave me any problems, until three days ago, just when I wanted to load it to production. I have began thinking about how to build my own &quot;ETL engine&quot; for the next project, code is reliable, safe, debuggable and easy to understand. Something in Boo is probably the way to go... I had enough of fighting with tools!</p>
        </article>
        <article id="article-7680">
            <a href="https://ayende.com/blog/2640/quid-quid-latine-dictum-sit-altum-videtur" target="_blank">
                <h2 class="title mb-6" id="article-7680">Quid quid latine dictum sit, altum videtur *</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 18, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I don&#x27;t speak much about what goes at work, but this just got to get out, when I am LOL-ing from a serious reply that I am getting from my boss, there is something good going on. Several days ago I have sent an email to my boss, with some technical details, to which he replied with: &quot;Omnia mihi lingua graeca sunt**&quot; That has released the flood, and right now we have a discussion that involved:  Sum perdidi ***  Vis eccum erit, &#xA0;semper. ****  Luke sum ipse patrem te *****  De integro ****** Those are just the ones I can recall off-hand.  Now I just need to find a reason to use &quot;Facta, non verba&quot;. Naturally,this means that I need to put &quot;throw new FelixCulpaException()&quot; in my code somewhere. (last two phrases are left as an exercise for the reader.) * Everything in Latin sounds profound** It is all Greek to me*** I am wasted**** May the force be with you, my son***** Luke, I am your father***** Repeat again from the start</p>
        </article>
        <div class="button flex justify-between">
            <a href="767.html"><span class="back arrow"></span></a>

            <a href="769.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;🚀&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
