
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 710 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-7091">
            <a href="https://ardalis.com/some-2008-goals/" target="_blank">
                <h2 class="title mb-6" id="article-7091">Some 2008 Goals</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 03, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">With 2007 gone and 2008 already 1% complete I need to start thinking about what some of my goals are for the year. Last year I didn&#x2019;t blog&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-7092">
            <a href="https://ayende.com/blog/3079/its-the-future-now" target="_blank">
                <h2 class="title mb-6" id="article-7092">It&#x27;s the future now</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 02, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">For various reasons, I had to implement the Future pattern in two completely different settings in three different ways today.  A future is a place-holder for the undetermined result of a (concurrent) computation. Once the computation delivers a result, the associated future is eliminated by globally replacing it with the result value. That value may be a future on its own. The last implementation was the explicit one, it was simply: public class Future&lt;T&gt;&#xA;{&#xA;&#x9;private T value;&#xA;&#x9;private bool hasValue;&#xA;&#x9;private string error;&#xA;&#xA;&#x9;public void SetValue(T value)&#xA;&#x9;{&#xA;&#x9;&#x9;this.value = value;&#xA;&#x9;&#x9;hasValue = true;&#xA;&#x9;}&#xA;&#xA;&#x9;public void SetError(string error)&#xA;&#x9;{&#xA;&#x9;&#x9;this.error = error;&#xA;&#x9;}&#xA;&#xA;&#x9;public bool HasError&#xA;&#x9;{&#xA;&#x9;&#x9;get { return error != null; }&#xA;&#x9;}&#xA;&#xA;&#x9;public T Value&#xA;&#x9;{&#xA;&#x9;&#x9;get { return value; }&#xA;&#x9;}&#xA;&#xA;&#x9;public bool HasValue&#xA;&#x9;{&#xA;&#x9;&#x9;get { return hasValue; }&#xA;&#x9;}&#xA;&#xA;&#x9;public string Error&#xA;&#x9;{&#xA;&#x9;&#x9;get { return error; }&#xA;&#x9;}&#xA;}&#xA;This is the simplest approach, primitive, you would say. It requires active collaboration from the code that uses it, and it requires that the method would return a future value. It is a good approach for a very small API, but this is often something that you want to handle in a cross cutting fashion. First, we need a more robust future implementation. (This is wasteful in that it doesn&#x27;t lazily allocate the reset event).&#xA;public class Future&lt;T&gt;&#xA;{&#xA;&#x9;private ManualResetEvent resetEvent = new ManualResetEvent(false);&#xA;&#x9;private T value;&#xA;&#x9;private bool hasValue;&#xA;&#x9;private Exception error;&#xA;&#xA;&#x9;public void SetValue(T value)&#xA;&#x9;{&#xA;&#x9;&#x9;this.value = value;&#xA;&#x9;&#x9;hasValue = true;&#xA;&#x9;&#x9;resetEvent.Set();&#xA;&#x9;}&#xA;&#xA;&#x9;public void SetError(Exception error)&#xA;&#x9;{&#xA;&#x9;&#x9;this.error = error;&#xA;&#x9;&#x9;resetEvent.Set();&#xA;&#x9;}&#xA;&#xA;&#x9;public bool HasError&#xA;&#x9;{&#xA;&#x9;&#x9;get { return error != null; }&#xA;&#x9;}&#xA;&#xA;&#x9;public T Value&#xA;&#x9;{&#xA;&#x9;&#x9;get&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;resetEvent.WaitOne();&#xA;&#x9;&#x9;&#x9;resetEvent.Close();&#xA;&#x9;&#x9;&#x9;if (error != null)&#xA;&#x9;&#x9;&#x9;&#x9;throw new FutureInvocationException(error);&#xA;&#x9;&#x9;&#x9;return value;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;public bool HasValue&#xA;&#x9;{&#xA;&#x9;&#x9;get { return hasValue; }&#xA;&#x9;}&#xA;&#xA;&#x9;public Exception Error&#xA;&#x9;{&#xA;&#x9;&#x9;get&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;resetEvent.WaitOne();&#xA;&#x9;&#x9;&#x9;return error;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;Now that we have that, we still have to deal with changing the interfaces and an explicitly concurrent programming model. There is a better way, I got the idea from watching a future / active objects implementation in Python, from Ronnie Maor. The ability to subvert the return value there allows for really nice things.&#xA;We will start with the easiest version to grasp, we will define the code that we want to work with:&#xA;public class WorkFlowController&#xA;{&#xA;    public virtual int LongRunningTask()&#xA;    {&#xA;        Console.WriteLine(&quot;Starting long running&quot;);&#xA;        Thread.Sleep(5000);&#xA;        Console.WriteLine(&quot;Completed long running&quot;);&#xA;        return 42;&#xA;    }&#xA;}&#xA;Now, we want to make this into something that will return a future, and we want to do it in a way that wouldn&#x27;t be too awkward. Here is a simple usage:&#xA;WorkFlowController controller = new WorkFlowController();&#xA;Future&lt;int&gt; future = InThe.Future&lt;int&gt;(delegate { return controller.LongRunningTask(); });&#xA;Console.WriteLine(&quot;After calling long running&quot;);&#xA;Console.WriteLine(future.Value);&#xA;Executing this code produces:&#xA;&#xA;After calling long runnningStarting long runningCompleted long running42&#xA;The InThe.Future part is simply:&#xA;public class InThe&#xA;{&#xA;    public delegate T Proc&lt;T&gt;();&#xA;    public static Future&lt;T&gt; Future&lt;T&gt;(Proc&lt;T&gt; futureAction)&#xA;    {&#xA;        Future&lt;T&gt; future = new Future&lt;T&gt;();&#xA;        ThreadPool.QueueUserWorkItem(delegate&#xA;        {&#xA;            try&#xA;            {&#xA;                future.SetValue(futureAction());&#xA;            }&#xA;            catch (Exception e)&#xA;            {&#xA;                future.SetError(e);&#xA;            }&#xA;        });&#xA;        return future;&#xA;    }&#xA;}&#xA;This is pretty straightforward, but I don&#x27;t like the syntax that we have here (even with C# 3.0, it is still ugly). What I would like to get is this:&#xA;WorkFlowController controller = With.Future&lt;WorkFlowController&gt;();&#xA;Future&lt;int&gt; future = InThe.Future(controller.LongRunningTask());&#xA;Console.WriteLine(&quot;After calling long runnnig&quot;);&#xA;Console.WriteLine(future.Value);&#xA;&#xA;&#xA;Suddenly I have a saner model, and the model to support futures is explicit. The implementation is fairly trivial as well:&#xA;public class FutureInterceptor : IInterceptor&#xA;{&#xA;    public void Intercept(IInvocation invocation)&#xA;    {&#xA;        InThe.lastInvocation = invocation;&#xA;        if (invocation.Method.ReturnType.IsValueType)&#xA;            invocation.ReturnValue = Activator.CreateInstance(invocation.Method.ReturnType);&#xA;    }&#xA;}&#xA;&#xA;public static class With&#xA;{&#xA;    private readonly static ProxyGenerator generator = new ProxyGenerator();&#xA;&#xA;    public static T Future&lt;T&gt;(params object[] args)&#xA;    {&#xA;        return (T)generator.CreateClassProxy(&#xA;            typeof (T), &#xA;            new IInterceptor[] {new FutureInterceptor()}, &#xA;            args);&#xA;    }&#xA;}&#xA;&#xA;public class InThe&#xA;{&#xA;    public static IInvocation lastInvocation;&#xA;&#xA;    public static Future&lt;T&gt; Future&lt;T&gt;(T ignored)&#xA;    {&#xA;        Future&lt;T&gt; future = new Future&lt;T&gt;();&#xA;        IInvocation invocation = lastInvocation;&#xA;        lastInvocation = null;&#xA;        ThreadPool.QueueUserWorkItem(delegate&#xA;        {&#xA;            try&#xA;            {&#xA;                invocation.Proceed();&#xA;                future.SetValue((T)invocation.ReturnValue);&#xA;            }&#xA;            catch (Exception e)&#xA;            {&#xA;                future.SetError(e);&#xA;            }&#xA;        });&#xA;        return future;&#xA;    }&#xA;}&#xA;I like this best, and it is very easy to implement and work with. Return value woes has been overcome, horray!</p>
        </article>
        <article id="article-7093">
            <a href="https://ayende.com/blog/3078/microsoft-crm-woes" target="_blank">
                <h2 class="title mb-6" id="article-7093">Microsoft CRM woes</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 31, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have wasted the entire day trying to troubleshoot some idiotic issues with MS CRM. Allow me to reiterate my previous statements on Microsoft CRM. It is an application built on feet of clay, marketed as a development platform and undeserving of consideration as anything but a vanilla install.  Highlights of the CRM:  Trying to update an entity via web service call. You get a &quot;platform error&quot; message. You have no input why this is not working working. Fast forward a day, turn out a PreUpdate callout is throwing an exception, which the CRM just swallows and abort. Trying to update an entity via web service call. The call completes successfully, but the update is never made. Fast forward a day or two, turn out a PostUpdate callout is throwing an exception, which the CRM will swallow, appear to continue and discard the supposedly saved data. Changing the type of a field in the entity will ensure that you cannot do an import/export from that entity ever again. You have to do a reinstall. Yuck!</p>
        </article>
        <article id="article-7094">
            <a href="https://ayende.com/blog/3077/tricky-code" target="_blank">
                <h2 class="title mb-6" id="article-7094">Tricky Code</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 31, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Without running the code, what is the result of this masterpiece? class Program&#xA;{&#xA;&#x9;static void Main(string[] args)&#xA;&#x9;{&#xA;&#x9;&#x9;DoSomething(&quot;a&quot;,&quot;b&quot;);&#xA;&#x9;}&#xA;&#xA;&#x9;public static void DoSomething&lt;T&gt;(IList&lt;T&gt; set)&#xA;&#x9;{&#xA;&#x9;&#x9;Console.WriteLine(set.Count);&#xA;&#x9;}&#xA;&#xA;&#x9;public static void DoSomething&lt;T&gt;(params T[] items)&#xA;&#x9;{&#xA;&#x9;&#x9;List&lt;T&gt; set = new List&lt;T&gt;();&#xA;&#x9;&#x9;foreach (T t in items)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;if (t == null)&#xA;&#x9;&#x9;&#x9;&#x9;continue;&#xA;&#x9;&#x9;&#x9;set.Add(t);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;DoSomething(set);&#xA;&#x9;}&#xA;}&#xA;It surprised the hell out of me until I figured out what was going on, then I was very amused. This code works exactly as it should be, to produce a very different result than the expected one.</p>
        </article>
        <article id="article-7095">
            <a href="https://ayende.com/blog/3076/im-without-the-instant" target="_blank">
                <h2 class="title mb-6" id="article-7095">IM - Without the instant...</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 31, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20"></p>
        </article>
        <article id="article-7096">
            <a href="https://ayende.com/blog/3075/hostile-code-review" target="_blank">
                <h2 class="title mb-6" id="article-7096">Hostile Code Review</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 30, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20"></p>
        </article>
        <article id="article-7097">
            <a href="https://ayende.com/blog/3074/low-pain-tolerance" target="_blank">
                <h2 class="title mb-6" id="article-7097">Low pain tolerance</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 27, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am coming back to a project that I haven&#x27;t been a part of for about six months. It was in active development during that time, and I was happy to get back to it, since it is a really good code base, and a fun project beside. The team that handle this project is top notched, but my first reaction was something in the order: &quot;how could you let it turn so hard!&quot; Then I toned it down a bit and started Big Refactoring. About fifteen minutes later, I was done, which didn&#x27;t match at all my initial response, and took some thinking. Why did I react this way? Why did it took ~15 minutes to turn something that I found awkward to something that was really pleasant to work with? How could the other team members, all of whom are very good, have gotten into this situation? The answer is both that I over reacted and that the expectations that I had from the project where high. We have made working on this project very smooth experience, but as time passed, it started to get awkward to work with. By that time, I wasn&#x27;t around, and the developers just dealt with that. It isn&#x27;t painful or hard, it is not bad or annoying. It is just that it began to get awkward, in a project that was really smooth sailing. Those 15 minutes were spent mostly in breaking apart a few services, setting up a registration rule in Binsor and relaxing in the glow of content that Things Just Work once again. I came to the conclusion that different pain tolerance levels are responsible for my reaction. I have very high expectations from my code, and I expected that it would continue to be as easy as it was in the start. The devs in the team would have likely performed the same actions as I did, at a later date. But I found it painful now. It is especially interesting in light of the recent discussion about code size and scaling a project higher. I think that having a lower pain tolerance level is a good thing, if kept in check.</p>
        </article>
        <article id="article-7098">
            <a href="https://ayende.com/blog/3073/the-applicability-of-dsl" target="_blank">
                <h2 class="title mb-6" id="article-7098">The applicability of DSL</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 27, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When is a DSL applicable? When will using a DSL make our job easier? There are several layers to the answer, depending on the type of DSL that we want, and the context that we want to apply it. When building a technical DSL, we will generally use that as bootstrapping and configuration mechanism, to make it easier to modify and change a part of the system. In general, those DSL are focused enabling recurring types of tasks, usually of one off nature. Configuration is a common scenario, since it is probably the simplest to explain and to start, but there are many other example. Build scripts comes to mind, in fact, scripting in general is a common area for technical DSL. Combining the power of a flexible language with a DSL directed at the task at hand makes for a powerful tool. Another interesting task for DSL is mapping layers, we have the destination in mind, usually some domain object or DTO, and we get some input that we transform to that object. Here we use the DSL for ease of modification, and ease of just adding new handlers. Again, technical DSL are shortcuts to code and to avoiding pain. You can do everything you do in a technical DSL using code. The DSL should make it easier, but the main benefit is one-of-a-kind solution to a type of task. Note that this one of a kind solution doesn&#x27;t mean throw-away code. it means that you would usually have a singular need in an application. Configuring the IoC container is a need that you have once per application, for example, but it is critically important part of the application, and something that you go back. For the last year and half or so, we have used Binsor to just that, as a DSL that can configure the IoC container for us. It allowed very good flexibility in that it would allow use to define per project conventions very easily. Technical DSL are usually the glue that holds stuff together.  What about business DSL? Here, the situation is different. Business DSL are almost always about rules and the actions to be taken when those rules are met. This sounds like a very narrow space, doesn&#x27;t it? But let me state in another way, the place of a business DSL is to define policy, while the application code defined the actual operations. A simple examples will be defining the rules for order processing. Those, in turn, will affect the following domain objects:  Discounts Payment plans Shipping options Authorization Rules The application code then takes this and act upon it. Policy is usually the place where we make most changes, while the operations of the system are mostly fixed. We are also not limited to a single DSL per application, in fact, we will probably have several, both technical and business focused DSL. Each of those will handle&#xA0;a specific set of scenarios (processing orders, authorizing payments, suggesting new products, etc). What about building the entire system as a set of DSL? That may be a very interesting approach to the task. In this scenario, we inverse the usual application code to DSL metrics, and decide that the application code that we would like to build would be about mostly infrastructure concerns and the requirements of the DSL. I would typically like to use this type of approach in backend processing systems. Doing UI on top of a DSL is certainly possible, but at this point, I think that we will hit the point of diminishing returns. Mostly because UI are usually complex, and you want to be able to handle them appropriately. A complex DSL is a programming language, and at the point, you would probably want to use&#xA0;a programming language to work with rather than a DSL. There is an exception to that, assuming that your application code is in Boo. They you are working with a programming language, and then you can build a technical DSL that will work in concrete with the actual frameworks that you are using. Rails is a good example of this approach. Assuming that you write your application code in a language that is not suited for DSL, however, you would probably want to have a more strict separation of the two approaches. Using DSL to define policy and using the application code to define the framework and the operations that can be executed by the system. Building such a system turns out to be almost trivial, because all you need to do is apply the operations (usually fairly well understood) and then can play around with the policy at will. If you have done your job well, you&#x27;ll likely have the ability to sit down with the customer and define the policy and have them review it at the same time. I wonder how and why you would test those...</p>
        </article>
        <article id="article-7099">
            <a href="https://ayende.com/blog/3072/the-record-replay-verify-model" target="_blank">
                <h2 class="title mb-6" id="article-7099">The Record/Replay/Verify model</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 26, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Daniel and I are having an interesting discussion about mock frameworks, and he just posted this: What&#x27;s wrong with the Record/Reply/Verify model for mocking frameworks. Daniel also pulled this quote from the Rhino Mocks documentation:  Record &amp; Replay model - a model that allows for recording actions on a mock object and then replaying and verifying them. All mocking frameworks uses this model. Some (NMock, TypeMock.Net, NMock2) use it implicitly and some (EasyMock.Net, Rhino Mocks) use it explicitly. Daniel go on to say:  I find this record/replay/verify model somewhat unnatural. I suggest that you would read the entire post, since this is a response to that. I just want to point out that I still hold this view. Mock frameworks all use this model, because verification is a core part of mocking.  The problem that I have with what Daniel is saying is that we seem to have a fundamental difference in opinion about what mocking is. What Daniel calls mocks I would term stubs. Indeed, Daniel&#x27;s library, by design, is not a mock framework library. It is a framework for providing stubs. Going a little bit deeper than that, it seems that Daniel is mostly thinking about mocks in tests as a way to make the test pass. I am thinking of those in terms of testing the interactions of an object with its collaborators. This project&#xA0;does a good job of showing off how I think mocking should be used, and it represent the accumulation of several years of knowledge&#xA0;and experience in testing and using&#xA0;mocks. It also represent several spectacular failures in using both (hint: mocking the database when going to production may not be a good idea), from which I learned quite a bit. Mocking can be abused to cause hard to change tests, so can other methods. Deciding to throw the baby with the bath water seems to be a waste to me. There is a lot of guidance out there about correct application of mocking, including how to avoid the over specified tests. The first that comes to mind is Hibernating Rhinos #1&#xA0;web cast, which talks about Rhino Mocks and its usage. Rhino Mocks can be used in the way that Daniel is describing. I would consider this appropriate at certain times, but I think that to say that this is the way it should be is a mistake. The Rhino Mocks web cast should do a good job in&#xA0;not only showing some of the more interesting Rhino Mocks features, but also where to use them. To conclude, the record, replay, verify model stands at the core of mocking. You specify what you think that should happen, you execute the code under test and then you verify that&#xA0;the expected happened.&#xA0;Taking this to the limit would produce tests that are hard to work with, but I am in the opinion that taking a&#xA0;worst practice and starting to apply conclusions from&#xA0;that is not a good idea.</p>
        </article>
        <article id="article-7100">
            <a href="https://ayende.com/blog/3071/multi-threading-challenge-can-you-spot-a-bug" target="_blank">
                <h2 class="title mb-6" id="article-7100">Multi threading challenge: can you spot a bug?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: December 26, 2007
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">One of the problems of multi threading is that there are a lot of intricacies that you have to deal with. Recently I run into issues that dictated that I would have to write an AsyncBulkInserterAppender&#xA0; for log4net. One of the reasons that I want to do that is to avoid locking the application if the database is down or the logging table is locked.I just had a recent issue where this casued a problem.  When I implemented that, I started to worry about what would happen if the database is locked for a long duration. There is a chance that this async logging would block for a long time, and then another async batch would start, also blocking, etc. Eventually, it will fill the thread pool and halt the entire system. This is the approach I ended up with, it should ensure that there is at most, only two threads that are writing to the database at a time. Since I wrote it, I already found at least two bugs in there. It looks fine now, but I can&#x27;t think of any good way to really test that. I am afraid that multi threading can&#x27;t really be tested successfully. This is something where code review is required. Here is the code: protected override void SendBuffer(LoggingEvent[] events)&#xA;{&#xA;&#x9;// we accept some additional complexity here&#xA;&#x9;// in favor of better concurrency. We don&#x27;t want to&#xA;&#x9;// block all threads in the pool (train) if we have an issue with&#xA;&#x9;// the database. Therefor, we perform thread sync to ensure&#xA;&#x9;// that only a single thread will write to the DB at any given point&#xA;&#x9;ThreadPool.QueueUserWorkItem(delegate&#xA;&#x9;{&#xA;&#x9;&#x9;lock (syncLock)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;eventsList.AddLast(events);&#xA;&#x9;&#x9;&#x9;if (anotherThreadAlreadyHandlesLogging)&#xA;&#x9;&#x9;&#x9;&#x9;return;                        anotherThreadAlreadyHandlesLogging = true; &#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;while (true)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;LoggingEvent[] current;&#xA;&#x9;&#x9;&#x9;lock (syncLock)&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;if(eventsList.Count == 0)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;anotherThreadAlreadyHandlesLogging = false;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;current = eventsList.First.Value;&#xA;&#x9;&#x9;&#x9;&#x9;eventsList.RemoveFirst();&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;PerformWriteToDatabase(current);&#xA;&#x9;&#x9;}&#xA;&#x9;});&#xA;}</p>
        </article>
        <div class="button flex justify-between">
            <a href="709.html"><span class="back arrow"></span></a>

            <a href="711.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>