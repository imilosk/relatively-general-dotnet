
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Home â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<script>
    const lightModePref = window.matchMedia("(prefers-color-scheme: light)");

    function getUserPref() {
        const storedTheme = typeof localStorage !== "undefined" && localStorage.getItem("theme");
        return storedTheme || (lightModePref.matches ? "light" : "dark");
    }

    function setTheme(newTheme) {
        if (newTheme !== "light" && newTheme !== "dark") {
            return console.warn(
                `Invalid theme value '${newTheme}' received. Expected 'light' or 'dark'.`,
            );
        }

        const root = document.documentElement;

        // root already set to newTheme, exit early
        if (newTheme === root.getAttribute("data-theme")) {
            return;
        }

        root.setAttribute("data-theme", newTheme);

        const colorThemeMetaTag = document.querySelector("meta[name='theme-color']");
        const bgColour = getComputedStyle(document.body).getPropertyValue("--theme-bg");
        colorThemeMetaTag.setAttribute("content", `hsl(${bgColour})`);
        if (typeof localStorage !== "undefined") {
            localStorage.setItem("theme", newTheme);
        }
    }

    // initial setup
    setTheme(getUserPref());

    document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("theme-toggle").addEventListener("click", () => {
            const theme = localStorage.getItem("theme");

            if (theme === "dark") {
                setTheme("light");
            } else {
                setTheme("dark");
            }
        });

        document.getElementById("toggle-navigation-menu").addEventListener("click", (e) => {
            const button = e.target;
            const ariaExpanded = button.getAttribute("aria-expanded");
            const header = document.getElementById("main-header");

            if (ariaExpanded === "true") {
                button.setAttribute("aria-expanded", "false");
                header.classList.remove("menu-open");
            } else {
                button.setAttribute("aria-expanded", "true");
                header.classList.add("menu-open");
            }
        });
    });
</script>

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <theme-toggle class="ms-auto">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main">
    <section aria-label="Blog post list">
        <a href="https://ayende.com/blog/1427/production-code-maintainability-and-he-who-follows-after" target="_blank"><h1 class="title mb-6">Production Code, Maintainability, and He Who Follows After</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 06, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Yesterday I wrote about a piece of code that I wrote which I hoped would never reach production.  Oren Ellenbogen has posted a long comment about it in his blog. The gist of the comment, you should think about maintainability over hackish elegance.  &#xA;I tend to amuse myself writing some code that tests the limits of what the compiler can understand , and usually goes beyond what most developers (me included, most often) can grok. Those pieces of code do not generally get into production code. Usually my production code is much more&#x2026; subdue than what I would post on the blog. I don&#x2019;t think that posting about yet another login page implementation is interesting enough to write about. &#xA;I thought that I made it clear that I didn&#x2019;t like the solution that we ended up with. It was fragile, hard to explain, hard to understand, and I have no idea whatsoever why it works. It is something that is cool for a hack, but it is not something that I would want to maintain or work with for any period of time.&#xA;In this case, though, I provide technical expertise only, and I don&#x2019;t have control on the decisions. Luckily, technical problems has assisted me in taking the level of abstractions a notch or two. &#xA;I can very easily create a piece of short, concise code that will look nice, comply with all the little rules that programmers have, will work and yet put the fear of God in any developer that will try to maintain it. I even do it sometimes, but not in production or non throw-away code.&#xA;I have to maintain a legacy project, one that is ten years in production, mission critical and completely incomprehensible.  I have a very healthy respect for the guys that will come after me. This mean that I will be smart, but I will not be wise ass. &#xA;That guy that will have to maintain my code one day may very well be me.</p>
        <a href="https://ardalis.com/18402/" target="_blank"><h1 class="title mb-6">Debugging Tips and VS 2005 Code Snippets</h1></a>
        <p class="mb-2">by Ardalis</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Last week I published two new articles on ASPAlliance.com: Visual Studio Debugging Tips and Tricks &#x2013; which shows how to use some attributes&#x2026;Keep Reading &#x2192;</p>
        <a href="https://ardalis.com/18403/" target="_blank"><h1 class="title mb-6">Atlas Charting Goodness</h1></a>
        <p class="mb-2">by Ardalis</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I really love charts and statistics. Give me a decent reporting application and I can spend all kinds of time analyzing data this way and&#x2026;Keep Reading &#x2192;</p>
        <a href="https://ayende.com/blog/1426/nhibernates-any-association-is-cool" target="_blank"><h1 class="title mb-6">NHibernate&#x27;s &lt;any&gt; association is cool</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I need to preface the cool&#xA0; part with also mentioning that&#xA;&lt;any&gt; is a part of an evil plot to overtake the world, so don&#x2019;t use it if&#xA;you don&#x2019;t know what you are doing. If you do, however, it is one hell&#xA;of a feature to have. &#xA;&#xA;Currently I&#x2019;m using it for a&#xA0; set of rules, which can be&#xA;applied to&#xA0; several objects, which does not have a common ancestor. This is&#xA;usually a problem, since I have no way to map&#xA0; those objects to the database&#xA;and back.&#xA;&#xA;It turned out that NHibernate has support for &lt;any&gt;&#xA;and &lt;many-to-any&gt; tags which gives you this functionality.&#xA0; Let us&#xA;consider the following simple class diagram:&#xA;&#xA;&#xA;&#xA;In this case, we have a Rule, which can be applied to an&#xA;IValidable instance.&#xA0; How do I persist this to the database? And more&#xA;importantly, get it out again cleanly?&#xA;&#xA;Let us take a look at the database diagram:&#xA;&#xA;&#xA;&#xA;Second, we will look at the mapping:&#xA;&#xA;&#xA; &#xA;  &#xA;  &lt;class name=&#x27;NHibernate.Any.Rule,&#xA;  NHibernate.Any&#x27; table=&#x27;`Rule`&#x27;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;id name=&#x27;Id&#x27;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;generator class=&#x27;identity&#x27;/&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/id&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;any name=&#x27;AppliesTo&#x27; meta-type=&#x27;System.String&#x27; id-type=&#x27;System.Int32&#x27;&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;meta-value class=&#x27;NHibernate.Any.Account,&#xA;  NHibernate.Any&#x27; value=&#x27;ACC&#x27;/&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;meta-value class=&#x27;NHibernate.Any.Customer,&#xA;  NHibernate.Any&#x27; value=&#x27;CUST&#x27;/&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;column name=&#x27;AppliesToType&#x27;/&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;column name=&#x27;AppliesToId&#x27;/&gt;&#xA;  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/any&gt; &#xA;  &lt;/class&gt;&#xA;  &#xA; &#xA;&#xA;&#xA;&#xA0;&#xA;&#xA;A couple of points before we continue:&#xA;&#xA;&#xB7;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;The meta-type attribute is not&#xA;required in the schema, but omitting it causes some strange results. Always&#xA;specify it.&#xA;&#xA;&#xB7;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;The &lt;any&gt; tag has the last&#xA;two elements as &lt;column&gt;. There is a very specific meaning to the&#xA;ordering of those &lt;column&gt; elements (and it is nearly the only place in&#xA;NHibernate where element ordering has a meaning). The first &lt;column&gt;&#xA;element specify the column that holds the type of the association, and the&#xA;second &lt;column&gt; holds the id of the object that this association points&#xA;to.&#xA;&#xA;&#xB7;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA;Each &lt;meta-value&gt; element&#xA;maps between a class and a value (which is what NHibernate will search on the&#xA;Type column). &#xA;&#xA;In this case, both Customer and Account implements&#xA;IValidable, and a Rule can be applied to either of them (in this simple&#xA;example, it doesn&#x2019;t really makes sense, but I have a system where IValidable is&#xA;a fully fledged interface that exposed enough information to be able to use&#xA;just its info to run a significant number of rules).&#xA;&#xA;Now I can just set the AppliesTo attribute to the&#xA;appropriate type, and NHibernate will take care of everything for me. This&#xA;takes care of quite a bit of complexity, and simplifies my life quite a bit.&#xA;&#xA;Building on this behavior, it is possible to have a very&#xA;rich model, and still enjoy the benefits of NHibernate&#x2019;s capabilities.</p>
        <a href="https://ayende.com/blog/1425/a-bug-story" target="_blank"><h1 class="title mb-6">A Bug Story</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I think that it may be interesting to show how I diagnosed and fixed a bug in Rhino Mocks. Here is the story, only slightly embellished &#xA;I got an email from Royston Shufflebotham, who has recently been putting Rhino Mocks through its paces, with a failing test, saying that under a certain condition, an exception was thrown from Rhino Mocks. I can&#x2019;t overestimate the value that a failing test has when coming to fix a bug.&#xA;It lets you repeatedly reproduce the problem, which directs you to the problem, and it makes sure that you understand what the expected behavior is. &#xA;In this case, the test was trying to create a mock object from multiply types (one of them a class, and the other interfaces), a feature recently added to Rhino Mocks. The problem occurred when the base class implemented an interface non virtually, and one of the interfaces that was passed to Rhino Mocks also inherited from that interface.&#xA;I know this is unclear, but it is better with code:&#xA;public&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;interface&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;IMulti&#xA;{&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;void OriginalMethod1();&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;void OriginalMethod2();&#xA;}&#xA;public&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;class&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;MultiClass : IMulti&#xA;{&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;// NON-virtual method&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;public&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;void OriginalMethod1() { }&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;// VIRTUAL method&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;public&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;virtual&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;void OriginalMethod2() { }&#xA;}&#xA;public&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;interface&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ISpecialMulti : IMulti&#xA;{&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;void ExtraMethod();&#xA;}&#xA;&#xA0;As you can see, MutliClass implements IMulti non-virually, while ISpecialMuli inherits from IMulti. The problem occured when you attempt to create a mock object from MutliClass and ISepscialMulti , like this:&#xA;mocks.CreateMultiMock(typeof(MultiClass), typeof(ISpecialMulti))The exception that was thrown was: &#x201C;TypeLoadException: Declaration referenced in a method implementation cannot be a final method&#x201D;, which is not something that I have seen before.&#xA;This is a good point to thanks the gods of software for exceptions. I would hate to get an error code like 0xFEABAADC and try to figure out what it means. Exceptions are also googleble, which was exactly what I did.&#xA;It lead me to this forum question, which indicated that the problem was trying to override a non virtual method. Apparently the VB compiler sometimes do not make this checks, and it results in a runtime error. The C# compiler does make this check, which is probably why I have never seen this error before.&#xA;Once I knew what the problem was, it was a matter of finding out how Dynamic Proxy handles generating methods. After some investigation, I found that Dynamic Proxy always generate virtual methods. In this case, of course, it caused a type load exception.&#xA;A brief overview of the way the CLR implements method tables is in order, I think. If you come from a C&#x2B;&#x2B; background, you are familiar with the notion of method tables. In the CLR, there is a similar notion, but here it also has the idea of a non virtual override (new in C#, shadows in VB). This means that a new slot in the method table is created, even though the method signature matches the signature of a method in a base type.&#xA;I knew that I had a problem here because I was trying to override a non virtual method, this meant that I needed to create a new slot in the method table when I was generating the type. I won&#x2019;t get into the technical details (basically, changing the MethodAttributes when generating the call), but it is not complex.&#xA;The idea is to simple track all final methods per type, and generate a new slot when I needed to generate a method with the same signature. It sounds simple, and it is simple.&#xA;I had a fix in half an hour or so from the moment I realized what the problem is. Then all I had to do is to update the version number, run the build scripts a couple of time, and push the new release to the server.</p>
        <a href="https://ayende.com/blog/1424/word-2007-posting-to-weblog" target="_blank"><h1 class="title mb-6">Word 2007 &amp; Posting To Weblog</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">For the past few days I have been using Word 2007 as my blogging client almost exclusively. I am nearly impressed with it. And I say nearly because it is a great tools to write simple text, like this post, but it breaks down the moment that you need to write a more complex post.&#xA;Any post with code in it gets mangled by Word&#x2019;s formatting. There doesn&#x2019;t seem any discoverable way to set a piece of text as &lt;pre&gt;, so all the indenting is lost when I post.&#xA;Picture upload is horrible:&#xA;It really reduces picture quality, which is something that I care about. It goes from crisp and nice on my machine to blotchy and ugly on my blog. Not acceptable.&#xA;It has no concept of an upload path and a separate download path. I upload pictures to my server using FTP, but I want users to access them using http, of course. There is no way to set it up in word, which is annoying in the extreme.&#xA;Those two major points are the main reasons that I&#x2019;ll probably not use Word as a blogging client for long, even thought it is very convenient in most other regards. They are very big problems for me.</p>
        <a href="https://ayende.com/blog/1423/nhibernates-any-association-is-cool" target="_blank"><h1 class="title mb-6">NHibernate&#x2019;s &lt;any&gt; association is cool</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I need to preface the cool&#xA0; part with also mentioning that &lt;any&gt; is a part of an evil plot to overtake the world, so don&#x2019;t use it if you don&#x2019;t know what you are doing. If you do, however, it is one hell of a feature to have.  &#xA;Currently I&#x2019;m using it for a&#xA0; set of rules, which can be applied to&#xA0; several objects, which does not have a common ancestor. This is usually a problem, since I have no way to map&#xA0; those objects to the database and back. &#xA;It turned out that NHibernate has support for &lt;any&gt; and &lt;many-to-any&gt; tags which gives you this functionality.&#xA0; Let us consider the following simple class diagram: &#xA; &#x9;&#xA;In this case, we have a Rule, which can be applied to an IValidable instance.&#xA0; How do I persist this to the database? And more importantly, get it out again cleanly? &#xA;Let us take a look at the database diagram: &#xA; &#x9;&#xA;Second, we will look at the mapping: &#xA;&#xA;&#xA;    &#xA;    &#xA;        &#xA;            &#xA;            &lt;class &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;name=&#x27;NHibernate.Any.Rule, NHibernate.Any&#x27; &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;table=&#x27;`Rule`&#x27;&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;id &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;name=&#x27;Id&#x27;&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;generator &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;class=&#x27;identity&#x27;/&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/id&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;any &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;name=&#x27;AppliesTo&#x27; &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;meta-type=&#x27;System.String&#x27; &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;id-type=&#x27;System.Int32&#x27;&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;meta-value &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;class=&#x27;NHibernate.Any.Account, NHibernate.Any&#x27; &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;value=&#x27;ACC&#x27;/&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;meta-value &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;class=&#x27;NHibernate.Any.Customer, NHibernate.Any&#x27; &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;value=&#x27;CUST&#x27;/&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;column &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;name=&#x27;AppliesToType&#x27;/&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;column &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;name=&#x27;AppliesToId&#x27;/&gt; &#xA;            &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &lt;/any&gt;  &#xA;            &lt;/class&gt;&#xA;            &#xA;        &#xA;    &#xA;&#xA;&#xA;&#xA0; &#xA;&#xA;A couple of points before we continue: &#xA;&#xA;    &#xA;    The meta-type attribute is not required in the schema, but omitting it causes some strange results. Always specify it. &#xA;    &#xA;    &#xA;    The &lt;any&gt; tag has the last two elements as &lt;column&gt;. There is a very specific meaning to the ordering of those &lt;column&gt; elements (and it is nearly the only place in NHibernate where element ordering has a meaning). The first &lt;column&gt; element specify the column that holds the type of the association, and the second &lt;column&gt; holds the id of the object that this association points to. &#xA;    &#xA;    &#xA;    Each &lt;meta-value&gt; element maps between a class and a value (which is what NHibernate will search on the Type column).  &#xA;    &#xA;&#xA;In this case, both Customer and Account implements IValidable, and a Rule can be applied to either of them (in this simple example, it doesn&#x2019;t really makes sense, but I have a system where IValidable is a fully fledged interface that exposed enough information to be able to use just its info to run a significant number of rules). &#xA;Now I can just set the AppliesTo attribute to the appropriate type, and NHibernate will take care of everything for me. This takes care of quite a bit of complexity, and simplifies my life quite a bit. &#xA;Building on this behavior, it is possible to have a very rich model, and still enjoy the benefits of NHibernate&#x2019;s capabilities.</p>
        <a href="https://ayende.com/blog/1422/rhino-mocks-2-8-4-a-rough-diamond" target="_blank"><h1 class="title mb-6">Rhino Mocks 2.8.4 &#x2013; A Rough Diamond</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Well, it has been 24 hours, what did you expect?&#xA;This release fixes a bug in creating Multi Mocks. When a MultiMock was requested, and it implemented a non virtual method and one of the extended interfaces also had the same method, an exception would be thrown. This one was fun to dig into, actually.&#xA;The problem was in the CLR method table, and the way Dynamic Proxy handles generating new methods. By default, it always generated virtual methods, which caused a type load exception if the base type had that method marked as non virtual. The solution was to check for the existence of such methods, and then generate any additional methods with the same signature with new slots in the method table.&#xA;Ten points for the first commenter who will tell me what I meant with the title, and how it relates to the problem at hand.&#xA;At any rate, you can find the new release here, in both binary and source formats.</p>
        <a href="https://ayende.com/blog/1421/how-to-tell-that-this-is-not-production-code" target="_blank"><h1 class="title mb-6">How to tell that this is not production code</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Today I co-wrote some code that I am not so sure about. I don&#x2019;t think that I want it to ever reach production state.&#xA;Here are some of the symptoms encountered while writing it:&#xA;Before running the tests:&#xA;&#x201C;We are crazy to even try it&#x201D;&#xA;&#x201C;There is not way that it is going to work&#x201D;&#xA;&#x201C;Complete waste of time&#x201D;&#xA;&#x201C;I have no idea what I am doing here, or how it is going to behave&#x201D;&#xA;After running the tests:&#xA;&#x201C;I can&#x2019;t believe it is working&#x201D;&#xA;&#x201C;There is no way it should have worked&#x201D;&#xA;&#x201C;There is no way I can explain to other developers what we just did&#x201D;&#xA;&#x201C;It is not debuggable&#x201D;&#xA;Add that to mad giggles as we wrote the code and tested it. It is a fascinating piece of work, but it is fascinating in the same way as a car wreck.&#xA;Just to give you some idea about what I am talking about, the code involved:&#xA;Generic entities (as in Dispatcher&lt;T&gt;)&#xA;NHibernate Hierarchies&#xA;Dependency Injection via Object Builder&#xA;The end result is actually fairly clean, you end up with something like this:&#xA;Repository&lt; IDispatcher &lt;Order&gt;&gt;&#xA0;&#xA0;&#xA0;&#xA0;.FindOne(&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Expression.Eq(&#x201C;DestinationCountry&#x201D;,&#x201D;UK&#x201D;)).Dispatch(order);&#xA;It looks nice, until you try to explain how it works. &#xA;Each dispatcher has a different argument object, which is mapped via NHibernate to a common table, so you can pass strongly typed arguments to the dispatcher, and NHibernate will deal with all the magic. &#xA;The disturbing part is that there is runtime translation of the requested class, and then there is injection of services into the entity. I will leave aside the idea of service entities at the moment, which is not nice as it is. &#xA;Adding a new dispatcher involves inheriting from a generic base class, adding NHibernate mapping and adding Object Builder mapping, not for the faint of heart, in my humble opinion. &#xA;But, it is generic, configurable and extensible.  Recently, it seems like YAGNI has became a mantra for me, as well as the quote: &#x201C;The most configurable system is java.exe, and it is configured via javac.exe&#x201D;</p>
        <a href="https://ayende.com/blog/1420/rhino-mocks-documentation-update-needed" target="_blank"><h1 class="title mb-6">Rhino Mocks Documentation Update Needed</h1></a>
        <p class="mb-2">by Oren Eini</p>
        <p class="mb-6 flex gap-1.5">
                    <span>
                                    <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                                         xmlns="http://www.w3.org/2000/svg"><path
                                            xmlns="http://www.w3.org/2000/svg"
                                            d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
            posted on: June 05, 2006
        </p>
        <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I got a request to update Rhino Mocks documentation, which currently is at 2.5.5 while the current release is 2.8.3. I checked my blog and compiled the list of changes you can see below.&#xA;There are some significant improvements since 2.5.5, the problem is that they also require significant documentation updates.&#xA;Version 2.8:&#xA;Support for Multi Mocks&#xA;Can now call CallOriginalMethod() from LastCall as well as Expect.&#xA;Some better debug information for those of us who debug Rhino Mocks.&#xA;Better support for mocking COM interfaces&#xA;Version 2.7.2:&#xA;Fixed a bug with virtual method calls from constructors&#xA;Is.Same() constraint&#xA;Property.ValueConstraint() constraint, which allows to setup constraints on properties&#x2019; values. &#xA;Version 2.7:&#xA;Support for raising events&#xA;Fixed a bug where overriding Equals() will cause a StackOverFlow&#xA;Improved support for remoting mocks&#xA;ixed a bug with regard to interfaces with the same name on different namespaces.&#xA;Version 2.6.5:&#xA;Major performance improvement&#xA;Rhino Mocks is now CLS Complaint&#xA;Version 2. 6:&#xA;Mocking an internal class from a strongly typed assembly&#xA;Added serialization constructors to Rhino Mocks&#x2019; exception, so they will work with Remoting &#xA;Support for methods with arrays of value types.&#xA;Support for methods that starts with &#x201C;get_&#x201D; or &#x201C;set_&#x201D; that are not properties.&#xA;BackToReccord() now also works with repeatable expectations (SetupResult) and with Dynamic or Partial mocks&#xA;Added Is.TypeOf&lt;&gt;()&#xA;Sigh, I will try to get around to it in the next couple of days&#x2026;</p>
        <div class="button flex justify-between">
            <a href="883.html"><span class="back arrow"></span></a>

            <a href="885.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2024<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
</body>
</html>