
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 444 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4431">
            <a href="https://ayende.com/blog/155713/the-ravendb-release-process" target="_blank">
                <h2 class="title mb-6" id="article-4431">The RavenDB Release Process</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 23, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We got several questions about this in the mailing list, so I thought that this would be a good time to discuss this in the blog.  One of the best part about RavenDB is that we are able to deliver quickly and continuously.&#xA0; That means that we can deliver changes to the users very rapidly, often resulting in response times of less than an hour from &#x201C;I have an issue&#x201D; to &#x201C;it is already fixed and you can download it&#x201D;. That is awesome on a lot of level, but it lack something very important, stability. In other words, by pushing things so rapidly, we are living on the bleeding edge. Which is great, except that you tend to bleed. That is why we split the RavenDB release process into Unstable and Stable. Unstable builds are released on a &#x201C;several times a day&#x201D; basis, and only require that we will pass our internal test suite. This test suite is hefty, over 1,500 tests so far, but it is something that can be run in about 15 minutes or so on the developer machine to make sure that our changes didn&#x2019;t break anything. The release process for Stable version is much more involved. First, of course, we run the standard suite of tests. Then we have a separate set of tests, which are stress testing RavenDB by trying to see if there are any concurrency issues. Next, we take the current bits and push them to our own internal production systems. For example, at the time of this writing, this blog (and all of our assets) are currently running on RavenDB build 726 and have been running that way for a few days. This allows us to test several things. That there are no breaking changes, that this build can survive running in production over extended period of time and that the overall performance remains excellent. Finally, we ask users to take those builds for a spin, and they are usually far more rough on RavenDB than we are. After all of that, we move to a set of performance tests, comparing the system behavior on a wide range of operations compared to the old version.  And then&#x2026; we can do a stable release push. Phew!</p>
        </article>
        <article id="article-4432">
            <a href="https://www.meziantou.net/binding-the-visualstatemanager-to-a-property.htm" target="_blank">
                <h2 class="title mb-6" id="article-4432">Binding the VisualStateManager to a property</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 23, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Here is a little trick to bind a ViewModel property to a VisualStateManager state. For this we use the Triggers and the GoToStateAction TriggerActionXAMLcopy&lt;i:Interaction.Triggers&gt;&#xA;  &lt;ei:DataTrigger Binding=&quot;{Binding Model.Prop}&quot; Value=&quot;Value1&quot;&gt;&#xA;    &lt;ei:GoToStateAction StateName=&quot;St</p>
        </article>
        <article id="article-4433">
            <a href="https://ayende.com/blog/156289/ravenhq-goes-out-of-beta" target="_blank">
                <h2 class="title mb-6" id="article-4433">RavenHQ goes out of beta</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 22, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After several months in public beta, I am proud to announce that RavenHQ, the RavenDB as a Service&#xA0; on the cloud has dropped the beta label and is now ready for full production use.  That means that we now accept signups from the general public, you no longer need an AppHarbor account and you can use it directly. It also means that you can safely start using RavenHQ for production purposes. RavenHQ is a fully-managed cloud of RavenDB servers and scalable plans, you&#x2019;ll never have to worry about installation, updates, availability, performance, security or backups again.  We offer both standard and high availability plans, and are the perfect fit for RavenDB users who can safely outsource all the operational support of your databases in the RavenHQ&#x2019;s team capable hands.</p>
        </article>
        <article id="article-4434">
            <a href="https://ayende.com/blog/154657/if-you-put-tripwires-in-my-paths-you-wont-get-my-money" target="_blank">
                <h2 class="title mb-6" id="article-4434">If you put tripwires in my paths, you won&#x2019;t get my money</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 21, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Recently I updated several of my VS plugins, and immediately after that I noticed a changed in the way VS behaves.  This is actually quite nice, and useful. (Although I was a bit confused for a time about when it shows and when it doesn&#x2019;t, but that is beside the point). the problem is that in many cases, like the first two example, it is actually quite easy to press on those notifications. And if you do that, you get:   And that is annoying. Sure, I get that you want to encourage people to buy your products, I even agree. But this sort of a feature is something that is very easy to invoke by mistake, and it completely throws you out of your current context.  I have VSCommands installed for the simple reason that I really like the Reload All feature. But it isn&#x2019;t worth it if I have to be careful where I put my mouse in VS. This single feature is the reason that I uninstalled it.</p>
        </article>
        <article id="article-4435">
            <a href="https://benfoster.io/blog/image-resizer-fluent-extensions/" target="_blank">
                <h2 class="title mb-6" id="article-4435">ImageResizer Fluent Extensions</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 21, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Today I created a Fluent API for the popular ImageResizer image processing module for .NET.</p>
        </article>
        <article id="article-4436">
            <a href="https://ayende.com/blog/155617/a-bad-test" target="_blank">
                <h2 class="title mb-6" id="article-4436">A bad test</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 18, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is a bad test, because what it does is ensuring that something does not works. I just finished implementing the session.Advaned.Defer support, and this test got my attention by failing the build. Bad test, you should be telling me when I broke something, not when I added new functionality.</p>
        </article>
        <article id="article-4437">
            <a href="https://ayende.com/blog/155585/when-using-the-task-parallel-library-wait-is-a-bad-warning-sign" target="_blank">
                <h2 class="title mb-6" id="article-4437">When using the Task Parallel Library, Wait() is a BAD warning sign</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 17, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Take a look at the following code: public static Task ParseAsync(IPartialDataAccess source, IPartialDataAccess seed, Stream output, IEnumerable&lt;RdcNeed&gt; needList)&#xA;{&#xA;    return Task.Factory.StartNew(() =&gt;&#xA;    {&#xA;        foreach (var item in needList)&#xA;        {&#xA;            switch (item.BlockType)&#xA;            {&#xA;                case RdcNeedType.Source:&#xA;                    source.CopyToAsync(output, Convert.ToInt64(item.FileOffset), Convert.ToInt64(item.BlockLength)).Wait();&#xA;                    break;&#xA;                case RdcNeedType.Seed:&#xA;                    seed.CopyToAsync(output, Convert.ToInt64(item.FileOffset), Convert.ToInt64(item.BlockLength)).Wait();&#xA;                    break;&#xA;                default:&#xA;                    throw new NotSupportedException();&#xA;            }&#xA;        }&#xA;    });&#xA;}&#xA;&#xA;&#xA;Do you see the problem in here?&#xA;It is a result of a code review comment about improper use of async in a project. This resulted in a lot of Task showing up in the return methods, but not in any measurable improvement in the actual codebase use of asynchronicity.&#xA;The problem is that when you need to work with such things in C# 4.0, you have to do some annoying things to get the code to work properly. In particular, this method was modified to be:&#xA;public static Task ParseAsync(IPartialDataAccess source, IPartialDataAccess seed, Stream output, IList&lt;RdcNeed&gt; needList, int position = 0)&#xA;{&#xA;  if(position&gt;= needList.Count)&#xA;  {&#xA;        return new CompletedTask();&#xA;  }&#xA;  var item = needList[position];&#xA;  Task task;&#xA;            &#xA;  switch (item.BlockType)&#xA;  {&#xA;        case RdcNeedType.Source:&#xA;            task = source.CopyToAsync(output, Convert.ToInt64(item.FileOffset), Convert.ToInt64(item.BlockLength));&#xA;            break;&#xA;        case RdcNeedType.Seed:&#xA;            task = seed.CopyToAsync(output, Convert.ToInt64(item.FileOffset), Convert.ToInt64(item.BlockLength));&#xA;            break;&#xA;        default:&#xA;            throw new NotSupportedException();&#xA;  }&#xA;&#xA;  return task.ContinueWith(resultTask =&gt;&#xA;    {&#xA;        if (resultTask.Status == TaskStatus.Faulted)&#xA;            resultTask.Wait(); // throws&#xA;        return ParseAsync(source, seed, output, needList, position &#x2B; 1);&#xA;    }).Unwrap();&#xA;}&#xA;&#xA;&#xA;This code is more complex, but it is actually making proper use of the TPL. We have changed the loop into a recursive function, so we can take advantage of ContinueWith to the next iteration of the loop.&#xA;And no, I can&#x2019;t wait to get to C# 5.0 and have proper await work.</p>
        </article>
        <article id="article-4438">
            <a href="https://ardalis.com/common-design-patterns-presentations/" target="_blank">
                <h2 class="title mb-6" id="article-4438">Common Design Patterns Presentations</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 16, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This month I presented on Common Design Patterns at two regional events. I&#x2019;ve given this talk a few times before, and it continues to evolve&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4439">
            <a href="https://ayende.com/blog/155553/reviewing-ravendb-app-releasecandidatetracker" target="_blank">
                <h2 class="title mb-6" id="article-4439">Reviewing RavenDB app: ReleaseCandidateTracker</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 16, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">ReleaseCandidateTracker is a new RavenDB based application by Szymon Pobiega. I reviewed version 5f7e42e0fb1dea70e53bace63f3e18d95d2a62dd. At this point, I don&#x2019;t know anything about this application, including what exactly it means, Release Tracking. I downloaded the code and started VS, there is one project in the solution, which is already a Good Thing. I decided to randomize my review approach and go and check the Models directory first.  Here is how it looks:  This is interesting for several reasons. First, it looks like it is meant to keep a record of all deployments to multiple environments, and that you can lookup the history of each deployment both on the environment side and on the release candidate side. Note that we use rich models, which have collections in them. In fact, take a look at this method:  Which calls to this method:  You know what the really fun part about this?  It ain&#x2019;t relational model. There is no cost of actually making all of these calls! Next, we move to the Infrastructure folder, where we have a couple of action results and the RavenDB management stuff. Here it how RCT uses RavenDB: public static class Database&#xA;{&#xA;    private static IDocumentStore storeInstance;&#xA;&#xA;    public static IDocumentStore Instance&#xA;    {&#xA;        get&#xA;        {&#xA;            if (storeInstance == null)&#xA;            {&#xA;                throw new InvalidOperationException(&quot;Document store has not been initialized.&quot;);&#xA;            }&#xA;            return storeInstance;&#xA;        }&#xA;    }&#xA;&#xA;    public static void Initialize()&#xA;    {&#xA;        var embeddableDocumentStore = new EmbeddableDocumentStore {DataDirectory = @&quot;~\App_Data\Database&quot;};&#xA;        embeddableDocumentStore.Initialize();&#xA;        storeInstance = embeddableDocumentStore;&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;It is using an embedded database to do that, which makes it very easy to use the app. Just hit F5 and go. In fact, if we do, we see the fully functional website, which is quite awesome .&#xA;Let us move to seeing how we are managing the sessions:&#xA;public class BaseController : Controller&#xA;{&#xA;    public IDocumentSession DocumentSession { get; private set; }&#xA;    public CandidateService CandidateService { get; private set; }&#xA;    public ScriptService ScriptService { get; private set; }&#xA;&#xA;    protected override void OnActionExecuting(ActionExecutingContext filterContext)&#xA;    {&#xA;        if (filterContext.IsChildAction)&#xA;        {&#xA;            return;&#xA;        }&#xA;        DocumentSession = Database.Instance.OpenSession();&#xA;        CandidateService = new CandidateService(DocumentSession);&#xA;        ScriptService = new ScriptService(DocumentSession);&#xA;        base.OnActionExecuting(filterContext);&#xA;    }&#xA;    &#xA;    protected override void OnActionExecuted(ActionExecutedContext filterContext)&#xA;    {&#xA;        if (filterContext.IsChildAction)&#xA;        {&#xA;            return;&#xA;        }&#xA;        if(DocumentSession != null)&#xA;        {&#xA;            if (filterContext.Exception == null)&#xA;            {&#xA;                DocumentSession.SaveChanges();&#xA;            }&#xA;            DocumentSession.Dispose();&#xA;        }&#xA;        base.OnActionExecuted(filterContext);&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;This is all handled inside the base controller, and it is very similar to how I am doing that in my own apps.&#xA;However, ScriptService and CandidateService seems strange, let us explore them a bit.&#xA;public class ScriptService&#xA;{&#xA;    private readonly IDocumentSession documentSession;&#xA;&#xA;    public ScriptService(IDocumentSession documentSession)&#xA;    {&#xA;        this.documentSession = documentSession;&#xA;    }&#xA;&#xA;    public void AttachScript(string versionNumber, Stream fileContents)&#xA;    {&#xA;        var metadata = new RavenJObject();&#xA;        documentSession.Advanced.DatabaseCommands.PutAttachment(versionNumber, null, fileContents, metadata);&#xA;    }&#xA;&#xA;    public Stream GetScript(string versionNumber)&#xA;    {&#xA;        var attachment = documentSession.Advanced.DatabaseCommands.GetAttachment(versionNumber);&#xA;        return attachment != null &#xA;            ? attachment.Data() &#xA;            : null;&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;So this is using RavenDB attachment to store stuff, I am not quite sure what yet, so let us track it down.&#xA;This is being used like this:&#xA;[HttpGet]&#xA;public ActionResult GetScript(string versionNumber)&#xA;{&#xA;    var candidate = CandidateService.FindOneByVersionNumber(versionNumber);&#xA;    var attachment = ScriptService.GetScript(versionNumber);&#xA;    if (attachment != null)&#xA;    {&#xA;        var result = new FileStreamResult(attachment, &quot;text/plain&quot;);&#xA;        var version = candidate.VersionNumber;&#xA;        var product = candidate.ProductName;&#xA;        result.FileDownloadName = string.Format(&quot;deploy-{0}-{1}.ps1&quot;, product, version);&#xA;        return result;&#xA;    }&#xA;    return new HttpNotFoundResult(&quot;Deployment script missing.&quot;);&#xA;}&#xA;&#xA;&#xA;&#xA;So I am assuming that the scripts are deployment scripts for different versions, and that they get uploaded on every new release candidate.&#xA;But look at the CandidateService, it looks like a traditional service wrapping RavenDB, and I have spoken against it multiple times.&#xA;In particular, I dislike this bit of code:&#xA;public ReleaseCandidate FindOneByVersionNumber(string versionNumber)&#xA;{&#xA;    var result = documentSession.Query&lt;ReleaseCandidate&gt;()&#xA;        .Where(x =&gt; x.VersionNumber == versionNumber)&#xA;        .FirstOrDefault();&#xA;    if(result == null)&#xA;    {&#xA;        throw new ReleaseCandidateNotFoundException(versionNumber);&#xA;    }&#xA;    return result;&#xA;}&#xA;&#xA;public void Store(ReleaseCandidate candidate)&#xA;{&#xA;    var existing = documentSession.Query&lt;ReleaseCandidate&gt;()&#xA;        .Where(x =&gt; x.VersionNumber == candidate.VersionNumber)&#xA;        .Any();&#xA;    if (existing)&#xA;    {&#xA;        throw new ReleaseCandidateAlreadyExistsException(candidate.VersionNumber);&#xA;    }&#xA;    documentSession.Store(candidate);&#xA;}&#xA;&#xA;&#xA;From looking at the code, it looks like the version number of the release candidate is the primary way to look it up. More than that, in the entire codebase, there is never a case where we load a document by id.&#xA;When I see a VersionNumber, I think about things like &#x201C;1.0.812.0&#x201D;, but I think that in this case the version number is likely to include the product name as well, &#x201C;RavenDB-1.0.812.0&#x201D;, otherwise you couldn&#x2019;t have two products with the same version.&#xA;That said, the code above it wrong, because it doesn&#x2019;t take into account RavenDB&#x2019;s indexes BASE nature. Instead, the version number should actually be the ReleaseCandidate id. This way, because RavenDB&#x2019;s document store is fully ACID, we don&#x2019;t have to worry about index update times, and we can load things very efficiently.&#xA;Pretty much all of the rest of the code in the CandidateService is only used in a single location, and I don&#x2019;t really see a value in it being there.&#xA;For example, let us look at this one:&#xA;[HttpPost]&#xA;public ActionResult MarkAsDeployed(string versionNumber, string environment, bool success)&#xA;{&#xA;    CandidateService.MarkAsDeployed(versionNumber, environment, success);&#xA;    return new EmptyResult();&#xA;}&#xA;&#xA;&#xA;&#xA;As you can see, it is merely loading the appropriate release candidate, and calling the MarkAsDeployed method on it.&#xA;Instead of doing this needless, forwarding, and assuming that we have the VersionNumber as the id, I would write:&#xA;[HttpPost]&#xA;public ActionResult MarkAsDeployed(string versionNumber, string environment, bool success)&#xA;{&#xA;    var cadnidate = DocumentSession.Load&lt;ReleaseCandidate&gt;(versionNumber);&#xA;    if (cadnidate == null)&#xA;        throw new ReleaseCandidateNotFoundException(versionNumber);&#xA;    var env = DocumentSession.Load&lt;DeploymentEnvironment&gt;(environment);&#xA;    if (env == null)&#xA;        throw new InvalidOperationException(string.Format(&quot;Environment {0} not found&quot;, environment));&#xA;&#xA;    cadnidate.MarkAsDeployed(success, env);&#xA;    return new EmptyResult();&#xA;}&#xA;&#xA;&#xA;&#xA;Finally, a word about the error handling, this is handled via:&#xA;protected override void OnException(ExceptionContext filterContext)&#xA;{&#xA;    filterContext.Result = new ErrorResult(filterContext.Exception.Message);&#xA;    filterContext.ExceptionHandled = true;&#xA;}&#xA;&#xA;public class ErrorResult : ActionResult&#xA;{&#xA;    private readonly string message;&#xA;&#xA;    public ErrorResult(string message)&#xA;    {&#xA;        this.message = message;&#xA;    }&#xA;&#xA;    public override void ExecuteResult(ControllerContext context)&#xA;    {&#xA;        context.HttpContext.Response.Write(message);&#xA;        context.HttpContext.Response.StatusCode = 500;&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;The crazy part is that OnException is overridden only on some of the controllers, rather than in the base controller, and even worse. This sort of code leads to error details loss.&#xA;For example, let us say that I get a NullReferenceException. This code will dutifully tell me all about it, but will not tell me where it happened.&#xA;This sort of thing make debugging extremely hard.</p>
        </article>
        <article id="article-4440">
            <a href="https://ayende.com/blog/155521/non-overlapping-time-periods-because-i-like-the-pain-of-2-am-wakeup-calls" target="_blank">
                <h2 class="title mb-6" id="article-4440">Non overlapping time periods&#x2013;because I like the pain of 2 AM wakeup calls</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: May 15, 2012
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post is partly in response for this post, discussing the Azure problem with leap year. But it is actually a bit more general than that.&#xA;&#xA;&#x9;In my code, here is how I define &#x201C;one year from now&#x201D;:&#xA;&#xA;&#x9;&#xA;&#x9;&#x9;DateTime.Today.AddYears(1).AddDays(3);&#xA;&#xA;&#xA;&#x9;As it turned out, this tend to have a lot of implications on your business, most of them are actually pretty good ones.&#xA;&#xA;&#x9;For a start, you will never get hit with a leap year bug, but more importantly, you are never going to have to deal with an immediate cutoff. This is important because it gives you time. Mostly, it gives you time to screw up, but having the time to do so without having an egg all of your face is a really nice thing.&#xA;&#xA;&#x9;For example, all of our subscriptions are using a similar method of calculation, and this is why we can take the ordering system down for a few hours or even a day or two and no one will actually notice. We have a big grace period in which we can work things out.&#xA;&#xA;&#x9;Sure, a user gets 3 &#x201C;extra&#x201D; days for free out of this, but frankly, I don&#x2019;t give a damn. It is more important that I get the buffer, and most users like it much better when you don&#x2019;t slam the doors in their faces on the first chance.&#xA;&#xA;&#x9;One of the things that is important is style, and giving a grace period for those sort of things is crucial.</p>
        </article>
        <div class="button flex justify-between">
            <a href="443.html"><span class="back arrow"></span></a>

            <a href="445.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>