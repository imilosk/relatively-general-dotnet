
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 321 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-3201">
            <a href="https://ayende.com/blog/173313/trie-based-routing" target="_blank">
                <h2 class="title mb-6" id="article-3201">Trie based routing</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 18, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In my previous post, I discussed the cost of routing in MVC vs. our own implementation. The MVC routing / infrastructure consumed about 90% of the time, while the code that actually does stuff is left with less than 10%. In our implementation, the actual request handling code gets about 85% of the time, while all the infrastructure is handled in the other 15%. Of that , a large portion of that time is actually spent on routing. In our tests, we saw something like 40% of the time spent in selecting the right controller action to execute, this is when there is just one such action that can be run. Now, to be fair, this is a scenario where we don&#x2019;t actually have any meaningful logic. We are just saying &#x201C;hello world&#x201D; over and over again, so the infrastructure costs are really noticeable in this benchmark. But that is the point, we want to see what are the fixed costs of the infrastructure we use. Now, in RavenDB we have several hundreds routes (last count was something upward of 400), and we noticed that routing take a lot of time to select the right action to run. We optimized the hell out of that to the point by specializing that to our own situation and based on our own knowledge. But when we started to look at moving our code to Kestrel, we took the time to move to a system that is a better fit for us. The major reason routing is such an expensive issue in MVC is that it does quite a lot. It needs to handle route selection, capturing values, coercing data to the right types and a lot more. All of that takes time, memory and cpu cycles. But as it turn out, we don&#x2019;t really need all of that. We have relatively simple routing needs. Here are a few example of RavenDB routes:  /admin/stats /databases/{databaseName}/docs /databases/{databaseName}/indexes/{*id} So we have the fixed routes, like /admin/stats. We have routes that contain a database name in the middle, and we have routes with a suffix. We can take advantage of that to create an optimal solution. In our case, we used a trie:  In computer science, a trie, also called digital tree and sometimes radix tree or prefix tree (as they can be searched by prefixes), is an ordered tree data structure that is used to store a dynamic set or associative array where the keys are usually strings. The cost of querying a trie is O(L), where L is the length of the key that we are querying. Here is how a very small trie looks in our tests.  We start from the route, matching each character against the trie node key. Once we have consumed the full key, we check if it has any children starting with the next character in the url. Note that the Children array here is of size 127. This allows us to index directly into the array (at cost of O(1)) to find the next trie node. We didn&#x2019;t want to use a dictionary here because of its size and its cost relative to an array access.  This has some interesting implications:  The route definition is limited to ASCII characters (but the actual urls are not, mind). Regardless of the number of routes, we are ensured of reliable performance.  But that still doesn&#x2019;t let us handle routes like the ones above. In order to do that, we had to extend the syntax a bit. /admin/stats would match exactly. That is easiest. /databases/*/docs is a route that has a capture. The * symbol says &#x201C;matches anything but /&#x201D;, so we can get the database name captured without complex matching. Note that by capture, I mean just record the start position and length, we don&#x2019;t want to pull a substring out of that and pay for an extra allocation. /databases/*/indexes/$ is another route that has special meaning. The $ symbol says &#x201C;the match is done, even if the url has additional characters&#x201D;. That way we can capture embedded ids easily (again, no allocations). The end result?  Or roughly a route match in 0.9 &#x3BC;s. Pretty good, even if I say so myself.</p>
        </article>
        <article id="article-3202">
            <a href="https://ayende.com/blog/173282/the-cost-of-routing" target="_blank">
                <h2 class="title mb-6" id="article-3202">The cost of routing</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 17, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I was asked to see what is the cost of WebAPI on Kestrel, and it lines up nicely with a topic that I wanted to talk about, routing. So I thought I&#x2019;ll start with a small benchmark. Here is a small Kestrel based server, using MVC / WebAPI: public class Program&#xA;{&#xA;    public void ConfigureServices(IServiceCollection services)&#xA;    {&#xA;        services.AddMvc();&#xA;    }&#xA;&#xA;    public void Configure(IApplicationBuilder app, ILoggerFactory loggerfactory)&#xA;    {&#xA;        app.UseMvc();&#xA;    }&#xA;&#xA;    public static void Main(string[] args)&#xA;    {&#xA;        var configBuilder = new ConfigurationBuilder()&#xA;            .Add(new MemoryConfigurationProvider(new Dictionary&lt;string, string&gt;&#xA;            {&#xA;                [&quot;server.urls&quot;] = &quot;http://localhost:8080&quot;&#xA;            }));&#xA;&#xA;        IHostingEngine application = new WebHostBuilder(configBuilder.Build())&#xA;            .UseStartup&lt;Program&gt;()&#xA;            .UseServer(&quot;Microsoft.AspNet.Server.Kestrel&quot;)&#xA;            .Build();&#xA;&#xA;&#xA;        using (application.Start())&#xA;        {&#xA;            Console.WriteLine(&quot;ready&quot;);&#xA;            Console.ReadLine();&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;&#xA;And here is a simple controller:&#xA;[Route(&quot;api/[controller]&quot;)]&#xA;public class ValuesController : Controller&#xA;{&#xA;    // GET api/values&#xA;    [HttpGet()]&#xA;    public string Get()&#xA;    {&#xA;        return &quot;Hello World&quot;;&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;As you can see, this couldn&#x2019;t really be any more trivial. I have tested this with release mode, using the following gobench command:&#xA;&#xA;.\gobench.exe -c 100 -r 25000 -u http://localhost:8080/api/values&#xA;This was run after running a couple thousand requests as warm up.&#xA0; In other words, we are going to do a 2.5 million requests. I intentionally choose that value, because it force the server to do enough work to be meaningful, and the test run is long enough to see other factors creeping in. Note that this isn&#x2019;t a &#x201C;real&#x201D; benchmark, both gobench and this code are actually running on the same machine. But it is a good baseline.&#xA;Requests:                          2,500,000 hits&#xA;Successful requests:               2,500,000 hits&#xA;Network failed:                            0 hits&#xA;Bad requests failed (!2xx):                0 hits&#xA;Successful requests rate:             56,818 hits/sec&#xA;Read throughput:                   9,261,363 bytes/sec&#xA;Write throughput:                  5,454,545 bytes/sec&#xA;Test time:                                44 sec&#xA;&#xA;&#xA;Those are good numbers. Now let us see that with my code:&#xA;[RavenAction(&quot;/api/values&quot;, &quot;GET&quot;)]&#xA;public Task ValuesGet()&#xA;{&#xA;    return HttpContext.Response.WriteAsync(&quot;Hello world&quot;);&#xA;}&#xA;&#xA;&#xA;&#xA;There is no funny business here. We just route the request using my code, and then just write it to the client. The results:&#xA;Requests:                          2,500,000 hits&#xA;Successful requests:               2,500,000 hits&#xA;Network failed:                            0 hits&#xA;Bad requests failed (!2xx):                0 hits&#xA;Successful requests rate:             86,206 hits/sec&#xA;Read throughput:                  10,517,241 bytes/sec&#xA;Write throughput:                  8,275,862 bytes/sec&#xA;Test time:                                29 sec&#xA;&#xA;&#xA;That is over 25% improvement. &#xA;Now, there are a couple of things that works out better for my code. To start with, it is calling Response.WriteAsync directly, while the standard WebAPI code needs to get the result, figure out how to write it, etc.&#xA;In the profiler, this looks really interesting:&#xA;&#xA;So the time for actually executing the action is less than 10% of the request time. Everything else is some sort of setup.&#xA;In fact, let us dig deeper, the time to run our action is 0.2% of the 10% that this method runs:&#xA;&#xA;&#xA;To be fair, the method just returns a constant string. I would be shocked if it wasn&#x2019;t really fast.&#xA;Most of the time happens in the CreateActionResult, in which we select how we write. Let us look at this a bit differently:&#xA;&#xA;The InvokeExceptionFilterAsync is the part responsible for actually calling our code and getting the result.&#xA;The InvokeAllResultFiltersAsync is responsible for figuring out how to write the output to the client. And this is the part where we actually write to the network:&#xA;&#xA;And here is how we do in the same scenario:&#xA;&#xA;You can note that 85% of the time we are spending in servicing the request, with just 15% dedicated to managing the infrastructure.&#xA;I&#x2019;ll discuss the details of that in my next post, though.</p>
        </article>
        <article id="article-3203">
            <a href="https://enterprisecraftsmanship.com/posts/3-ways-of-archiving-code-correctness/" target="_blank">
                <h2 class="title mb-6" id="article-3203">3 ways of achieving code correctness</h2>
            </a>
            <p class="mb-2">by Vladimir Khorikov</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Code correctness verification is not an easy task. At the same time, it&#x2019;s one of the most important problems we have when we build software projects. In this article, I&#x2019;ll compare 3 different ways of achieving code correctness.</p>
        </article>
        <article id="article-3204">
            <a href="https://ayende.com/blog/173283/playing-with-key-generators-redux" target="_blank">
                <h2 class="title mb-6" id="article-3204">Playing with key generators, redux</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In my previous post, I have discussed how using Smaz-like compression, I can achieve a smaller (and more professional looking) license key. Here is the original license:  {&#xA;  &quot;id&quot;: &quot;cd6fff02-2aff-4fae-bc76-8abf1e673d3b&quot;,&#xA;  &quot;expiration&quot;: &quot;2017-01-17T00:00:00.0000000&quot;,&#xA;  &quot;type&quot;: &quot;Subscription&quot;,&#xA;  &quot;version&quot;: &quot;3.0&quot;,&#xA;  &quot;maxRamUtilization&quot;: &quot;12884901888&quot;,&#xA;  &quot;maxParallelism&quot;: &quot;6&quot;,&#xA;  &quot;allowWindowsClustering&quot;: &quot;false&quot;,&#xA;  &quot;OEM&quot;: &quot;false&quot;,&#xA;  &quot;numberOfDatabases&quot;: &quot;unlimited&quot;,&#xA;  &quot;fips&quot;: &quot;false&quot;,&#xA;  &quot;periodicBackup&quot;: &quot;true&quot;,&#xA;  &quot;quotas&quot;: &quot;false&quot;,&#xA;  &quot;authorization&quot;: &quot;true&quot;,&#xA;  &quot;documentExpiration&quot;: &quot;true&quot;,&#xA;  &quot;replication&quot;: &quot;true&quot;,&#xA;  &quot;versioning&quot;: &quot;true&quot;,&#xA;  &quot;maxSizeInMb&quot;: &quot;unlimited&quot;,&#xA;  &quot;ravenfs&quot;: &quot;true&quot;,&#xA;  &quot;encryption&quot;: &quot;true&quot;,&#xA;  &quot;compression&quot;: &quot;false&quot;,&#xA;  &quot;updatesExpiration&quot;: &quot;2017-Jan-17&quot;,&#xA;  &quot;name&quot;: &quot;Hibernating Rhinos&quot;&#xA;}&#xA;&#xA;And here is the resulting output:&#xA;&#xA;0172020007 93050A0B28 0D0D0D682C 24080D0D2C&#xA;260D080C2C 090A29282C 2A08090D23 0C2829250B&#xA;2509060C1F 171019081B 1016150587 2C672C7795&#xA;5422220322 2203222295 2E22222222 2222220692&#xA;058F064407 4A0537064B 0528064C8C 4D8C4E0549&#xA;065A8C4F8D 528C538D54 8D558D568D 5705490659&#xA;8D508D518C 5805872C5B 2C77069105 954810090C&#xA;1915081B10 150E962052 0F1015161A 069553100E&#xA;15081B1C19 0C05954511 740C1C984D 4B4641270B&#xA;95560F1608 209841492F 4108962B58 0B9556120C&#xA;95590C954C 2195441695 5623954C29 2695482009&#xA;1D1C97514D 2B1117974E 492B150E96 3D3D070157&#xA;A9E859DD06 1EE0EC6210 674ED4CA88 C78FC61D20&#xA;B1650BF992 978871264B 57994E0CF3 EA99BFE9G1&#xA;&#xA;It occurred to me that I was approaching it in completely the wrong direction. Instead of trying to specialize a generic solution, why not actually create a dedicated solution. &#xA;I started by defining the license terms:&#xA;&#xA;public static string[] Terms =&#xA;{&#xA;    &quot;id&quot;,&quot;expiration&quot;,&quot;type&quot;,&quot;version&quot;,&quot;maxRamUtilization&quot;,&quot;maxParallelism&quot;,&#xA;    &quot;allowWindowsClustering&quot;,&quot;OEM&quot;,&quot;numberOfDatabases&quot;,&quot;fips&quot;,&quot;periodicBackup&quot;,&#xA;    &quot;quotas&quot;,&quot;authorization&quot;,&quot;documentExpiration&quot;,&quot;replication&quot;,&quot;versioning&quot;,&#xA;    &quot;maxSizeInGb&quot;,&quot;ravenfs&quot;,&quot;encryption&quot;,&quot;compression&quot;,&quot;updatesExpiration&quot;,&#xA;};&#xA;&#xA;&#xA;Then I observed that I really only had five date types: boolean, int, date, guid and string. And that I only had (right now) 21 terms to work with. String is problematic, and we only ever use it for either the name on the license or for enum values (such as the type of the license). We can switch to using numeric values for enums, and we&#x27;ll ignore the name for now. The dates we have are just that, dates, we don&#x27;t need timing information. We also have a relatively small range of valid dates. From now to (lets be generous) 100 years from now. Finally, our integers are mostly very small. Version numbers and the like. All except the maxRamUtilization, which is in bytes. I switch that one to GB, which gives us small numbers again. We also have values that are numeric, but can have the string &quot;unlimited&quot;, we&#x27;ll use value 0 as the magic value to say unlimited.&#xA;What is the point of all of that the data we need to store is:&#xA;&#xA;Booleans&#xA;Integers&#xA;Dates&#xA;Since we want to conserve space, we&#x27;ll limit the integers to byte size (pun intentional ) and we&#x27;ll store the dates in DOS format:&#xA;&#xA;This means that we can pack a date (but not time, mind) into two bytes.&#xA;So the format is going to be pretty simple:&#xA;&#xA;[index into the terms, type of value, value]&#xA;However, since we have so few value types, we can do better and actually store them as bits.&#xA;So the first 5 bits in the token would be the terms index (which limits us to 32 terms, since we currently only have 21, I&#x27;m fine with that) and the last 3 bits are used for the type of the value. I&#x27;m using the following types:&#xA;&#xA;&#xA;Note that we have two definitions of boolean value, true &amp; false. The idea is that we can use a single byte to both index into the terms and specify what the actual value is. Since a lot of our properties are boolean, that saves quite a lot of space.&#xA;The rest of the format is pretty easy, and the whole thing can be done with the following code:&#xA;&#xA; var ms = new MemoryStream();&#xA; var bw = new BinaryWriter(ms);&#xA; foreach (var attribute in attributes)&#xA; {&#xA;     if (attribute.Value == null)&#xA;         throw new InvalidOperationException(&quot;Cannot write a null value&quot;);&#xA;&#xA;     var index = Array.IndexOf(Terms, attribute.Key);&#xA;     if (index == -1)&#xA;         throw new InvalidOperationException(&quot;Unknown term &quot; &#x2B; attribute.Key);&#xA;&#xA;&#xA;     if (attribute.Value is bool)&#xA;     {&#xA;         var type = (byte)((bool)attribute.Value ? ValueType.True : ValueType.False) &lt;&lt; TypeBitsToShift;&#xA;         bw.Write((byte)((byte)index | type));&#xA;         continue;&#xA;     }&#xA;     if (attribute.Value is DateTime)&#xA;     {&#xA;         bw.Write((byte)((byte)index | ((byte)ValueType.Date &lt;&lt; TypeBitsToShift)));&#xA;         var dt = (DateTime)(attribute.Value);&#xA;         bw.Write(ToDosDateTime(dt));&#xA;         continue;&#xA;     }&#xA;     if (attribute.Value is int || attribute.Value is long)&#xA;     {&#xA;         var val = Convert.ToByte(attribute.Value);&#xA;         bw.Write((byte)((byte)index | ((byte)ValueType.Int &lt;&lt; TypeBitsToShift)));&#xA;         bw.Write((byte)val);&#xA;         continue;&#xA;     }&#xA;&#xA;     throw new InvalidOperationException(&quot;Cannot understand type of &quot; &#x2B; attribute.Key &#x2B; &quot; because it is &quot; &#x2B; attribute.Value.GetType().FullName);&#xA; }&#xA;Nothing truly interesting, I&#x27;ll admit. But it means that I can pack this:&#xA;&#xA;{&#xA;  &quot;expiration&quot;: &quot;2017-01-17T00:00:00&quot;,&#xA;  &quot;type&quot;: 1,&#xA;  &quot;version&quot;: 3,&#xA;  &quot;maxRamUtilization&quot;: 12,&#xA;  &quot;maxParallelism&quot;: 6,&#xA;  &quot;allowWindowsClustering&quot;: false,&#xA;  &quot;OEM&quot;: false,&#xA;  &quot;numberOfDatabases&quot;: 0,&#xA;  &quot;fips&quot;: false,&#xA;  &quot;periodicBackup&quot;: true,&#xA;  &quot;quotas&quot;: false,&#xA;  &quot;authorization&quot;: true,&#xA;  &quot;documentExpiration&quot;: true,&#xA;  &quot;replication&quot;: true,&#xA;  &quot;versioning&quot;: true,&#xA;  &quot;maxSizeInGb&quot;: 0,&#xA;  &quot;ravenfs&quot;: true,&#xA;  &quot;encryption&quot;: true,&#xA;  &quot;compression&quot;: false,&#xA;  &quot;updatesExpiration&quot;: &quot;2017-01-17T00:00:00&quot;&#xA;}&#xA;&#xA;Into 30 bytes.&#xA;Those of you with sharp eyes might have noticed that we dropped two fairly important fields. The license id and the name for whom the license is issued to. Let us deal with the name first.&#xA;Instead of encoding the name inside the license, we can send it separately. The user will have two fields to enter, the name and the actual license key.&#xA0; But the 30 bytes we compacted the license attributes into aren&#x27;t really useful. Anyone can generate them, after all. What we need it to sign them, and we do that using DSA public key.&#xA;Basically, we take the license attributes that we built, concat them with the name&#x27;s bytes, and then generate a digital signature for that. Then we just add that to the license. Since DSA signature is 40 bytes in size, it means that our license has ballooned into whooping 70 bytes.&#xA;Using base 64, we get the following license key:&#xA;&#xA;Hibernating Rhinos&#xA;YTFKQgFDA0QMRQYGB0gACSoLLC0uL1AAMTITdDFKTDd2c6&#x2B;XrGQW/&#x2B;wEvo5YUE7g55xPC&#x2B;FS94s7rUmKOto8aWo/m7&#x2B;pSg==&#xA;And now that looks much more reasonable. This also explains why we dropped the license id. We don&#x27;t need it anymore. The license itself (short &amp; compact) gives us as good a way to refer to the license as the license id used to be, and it isn&#x27;t much longer.&#xA;For clarity&#x27;s sake it might be clearer to understand if we split this into separate fields:&#xA;&#xA;{&#xA;  &quot;Name&quot;: &quot;Hibernating Rhinos&quot;,&#xA;  &quot;Options&quot;: &quot;YTFKQgFDA0QMRQYGB0gACSoLLC0uL1AAMTITdDFK&quot;,&#xA;  &quot;Signature&quot;: &quot;LAfgqs3MPzfRERCY&#x2B;DWjZoso95lh&#x2B;AzmOdt2&#x2B;fC&#x2B;p2TgC16hWKDESw==&quot;&#xA;}&#xA;I&#x27;ll admit that I went a bit overboard here and started doing all sort of crazy things here. For example, here is another representation of the same license scheme:&#xA;&#xA;For mobile developers, I think that this would be an excellent way to enter the product registration .&#xA;And here is the code, if you want to go deep: https://gist.github.com/ayende/6ecb9e2f4efb95dd98a0</p>
        </article>
        <article id="article-3205">
            <a href="https://ayende.com/blog/173281/profiling-mysteries" target="_blank">
                <h2 class="title mb-6" id="article-3205">Profiling mysteries</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 15, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In our profiling, we run into an expensive mystery call to string.Join. Nothing in our code called it, and it is expensive.  Looking at the code didn&#x2019;t get us anywhere, so I profiled things again, this time using the debug configuration. The nice thing about the debug configuration is that it doesn&#x2019;t inline methods (among other things), so what gets executed is much closer to the actual code.  Here are the results:  And now it is clear what is going on. Here is the offending line:  var tryMatch = _trie.TryMatch(method, context.Request.Path); With context.Request.Path being a PathString, and TryMatch accepting a string, we are silently calling the implicit string operator, which just calls PathString.ToString(), which just calls ToUriComponent(), which looks like: public string ToUriComponent()&#xA;{&#xA;    if (HasValue)&#xA;    {&#xA;        if (RequiresEscaping(_value))&#xA;        {&#xA;            // TODO: Measure the cost of this escaping and consider optimizing.&#xA;            return String.Join(&quot;/&quot;, _value.Split(&#x27;/&#x27;).Select(EscapeDataString));&#xA;        }&#xA;        return _value;&#xA;    }&#xA;    return String.Empty;&#xA;}&#xA;&#xA;&#xA;&#xA;&#xA;Looking into the current code, it has already been optimized by removing the Linq call and its associated costs, but that is still expensive call to make.&#xA;The fix was to get the string directly:&#xA;&#xA;var tryMatch = _trie.TryMatch(method, context.Request.Path.Value);&#xA;And here are 10% reduction in costs.</p>
        </article>
        <article id="article-3206">
            <a href="https://benfoster.io/blog/aspnet-core-multi-tenancy-data-isolation-with-entity-framework/" target="_blank">
                <h2 class="title mb-6" id="article-3206">ASP.NET Core Multi-tenancy: Data Isolation with Entity Framework</h2>
            </a>
            <p class="mb-2">by Ben Foster</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 15, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The next in my series on building multi-tenant applications with ASP.NET Core, this post looks at how to achieve database isolation with Entity Framework Core, using a database-per-tenant strategy.</p>
        </article>
        <article id="article-3207">
            <a href="https://www.stevejgordon.co.uk/asp-net-core-identity-token-providers" target="_blank">
                <h2 class="title mb-6" id="article-3207">ASP.NET Core Identity Token Providers &#x2013; Under the Hood</h2>
            </a>
            <p class="mb-2">by Steve Gordon</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 12, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Next up for my series on ASP.NET Core Identity I was interested in how the Identity library provides a way to create tokens which validate actions such as when a user first registers and we need to confirm their email address. This post took a lot longer to write than I expected it to as [&#x2026;]</p>
        </article>
        <article id="article-3208">
            <a href="https://ayende.com/blog/173250/playing-with-key-generators" target="_blank">
                <h2 class="title mb-6" id="article-3208">Playing with key generators</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 12, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">For the past 6 years or so, Hibernating Rhinos is using a licensing component that I wrote after being burned by trying to use a commercial licensing component. This licensing scheme is based around signed XML files that we send to customers. It works, but it has a few issues. Sending files to customers turn out to be incredibly tricky. A lot of companies out there will flat out reject any email that has an attachment. So we ended up uploading the files to S3, and sending them a link to it. Dealing with files in this manner also means that there is a lot of relatively manual steps (take the file, rename it, place it in this dir, etc). With all the attendant issues that they entail. So we want something simpler. Here is a sample of the kind of information that I need to pass in the license:   Note that this is a pure property bag, no structure beyond that. An obvious solution for that is to throw it in JSON, and add a public key signature. This would look like this:  {&#xA;  &quot;id&quot;: &quot;cd6fff02-2aff-4fae-bc76-8abf1e673d3b&quot;,&#xA;  &quot;expiration&quot;: &quot;2017-01-17T00:00:00.0000000&quot;,&#xA;  &quot;type&quot;: &quot;Subscription&quot;,&#xA;  &quot;version&quot;: &quot;3.0&quot;,&#xA;  &quot;maxRamUtilization&quot;: &quot;12884901888&quot;,&#xA;  &quot;maxParallelism&quot;: &quot;6&quot;,&#xA;  &quot;allowWindowsClustering&quot;: &quot;false&quot;,&#xA;  &quot;OEM&quot;: &quot;false&quot;,&#xA;  &quot;numberOfDatabases&quot;: &quot;unlimited&quot;,&#xA;  &quot;fips&quot;: &quot;false&quot;,&#xA;  &quot;periodicBackup&quot;: &quot;true&quot;,&#xA;  &quot;quotas&quot;: &quot;false&quot;,&#xA;  &quot;authorization&quot;: &quot;true&quot;,&#xA;  &quot;documentExpiration&quot;: &quot;true&quot;,&#xA;  &quot;replication&quot;: &quot;true&quot;,&#xA;  &quot;versioning&quot;: &quot;true&quot;,&#xA;  &quot;maxSizeInMb&quot;: &quot;unlimited&quot;,&#xA;  &quot;ravenfs&quot;: &quot;true&quot;,&#xA;  &quot;encryption&quot;: &quot;true&quot;,&#xA;  &quot;compression&quot;: &quot;false&quot;,&#xA;  &quot;updatesExpiration&quot;: &quot;2017-Jan-17&quot;,&#xA;  &quot;name&quot;: &quot;Hibernating Rhinos&quot;,&#xA;  &quot;Signature&quot;: &quot;XorRcQEekjOOARwJwjK5Oi7QedKmXKdQWmO&#x2B;&#x2B;DvrqBSEUMPqVX4Ahg==&quot;&#xA;}&#xA;&#xA;This has the advantage of being simple, text friendly, easy to work send over email, paste, etc. It is also human readable (which means that it is easy for a customer to look at the license and see what is specified.&#xA;But it also means that a customer might try to change it (you&#x27;ll be surprised how often that happens), and be surprised when this fails. Other common issues include only pasting the &quot;relevant&quot; parts of the license, or pasting invalid JSON definition because of email client issues. And that doesn&#x27;t include the journey some licenses go through. (They get pasted into Word, which adds smart quotes, into various systems, get sent around on various chat programs, etc). If you have a customer name that include Unicode, it is easy to lose that information, which will result in invalid license (won&#x27;t match the signature).&#xA;There is also another issue, of professionalism. Not so much how you act, but how you appear to act. And something like the license above doesn&#x27;t feel right to certain people. It is a deviation from the common practice in the industry, and can send a message about not caring too much about this. Which lead to wondering whatever you care about the rest of the application&#x2026;&#xA;Anyway, I&#x27;m not sure that I like it, for all of those reasons. A simple way to avoid this is to just BASE64 the whole string. &#xA;What I want to have is something like this:&#xA;&#xA;eyJpZCI6ImNkNmZmZjAyLTJhZmYtNGZhZS1iYzc2LThhYmYxZ&#xA;TY3M2QzYiIsImV4cGlyYXRpb24iOiIyMDE3LTAxLTE3VDAwOj&#xA;AwOjAwLjAwMDAwMDAiLCJ0eXBlIjoiU3Vic2NyaXB0aW9uIiw&#xA;idmVyc2lvbiI6IjMuMCIsIm1heFJhbVV0aWxpemF0aW9uIjoi&#xA;MTI4ODQ5MDE4ODgiLCJtYXhQYXJhbGxlbGlzbSI6IjYiLCJhb&#xA;Gxvd1dpbmRvd3NDbHVzdGVyaW5nIjoiZmFsc2UiLCJPRU0iOi&#xA;JmYWxzZSIsIm51bWJlck9mRGF0YWJhc2VzIjoidW5saW1pdGV&#xA;kIiwiZmlwcyI6ImZhbHNlIiwicGVyaW9kaWNCYWNrdXAiOiJ0&#xA;cnVlIiwicXVvdGFzIjoiZmFsc2UiLCJhdXRob3JpemF0aW9uI&#xA;joidHJ1ZSIsImRvY3VtZW50RXhwaXJhdGlvbiI6InRydWUiLC&#xA;JyZXBsaWNhdGlvbiI6InRydWUiLCJ2ZXJzaW9uaW5nIjoidHJ&#xA;1ZSIsIm1heFNpemVJbk1iIjoidW5saW1pdGVkIiwicmF2ZW5m&#xA;cyI6InRydWUiLCJlbmNyeXB0aW9uIjoidHJ1ZSIsImNvbXByZ&#xA;XNzaW9uIjoiZmFsc2UiLCJ1cGRhdGVzRXhwaXJhdGlvbiI6Ij&#xA;IwMTctSmFuLTE3IiwibmFtZSI6IkhpYmVybmF0aW5nIFJoaW5&#xA;vcyIsIlNpZ25hdHVyZSI6IlhvclJjUUVla2pPT0FSd0p3aks1&#xA;T2k3UWVkS21YS2RRV21PKytEdnJxQlNFVU1QcVZYNEFoZz09I&#xA;n0=&#xA;&#xA;Note that this is just the same thing as above, with Base64 encoding. This is a bit big, and it gives me a chance to play with the Smaz library I made. The nice thing about the refactoring I made there is that we can provide our own custom term table.&#xA;In this case, the term table looks like this:&#xA;&#xA;&#xA;And with that, still using Base64, we get:&#xA;&#xA;AXICAAeTBQoLKA0NDWgsJAgNDSwmDQgMLAkKKSgsKggJDSMMK&#xA;CklCyUJBgwfFxAZCBsQFhUFhyxnLHeVVCIiAyIiAyIilS4iIi&#xA;IiIiIiBpIFjwZEB0oFNwZLBSgGTIxNjE4FSQZajE&#x2B;NUoxTjVS&#xA;NVY1WjVcFSQZZjVCNUYxYBYcsWyx3BpEFlUgQCQwZFQgbEBUO&#xA;liBSDxAVFhoGlVMQDhUIGxwZDAULFyYLlSsYJyUYC5VZJBUOl&#xA;U8hmFBRUkEXlVcrJxSVUSIQEZZDRRQplUEWECIhllBYEiEgIp&#xA;ZWTyUhlkpUGJZBRh6WPT0HAWzteBm/nZAfi4aI9mkbVowBmGV&#xA;PC0S0fXaHv1MUodMQdsS6TuuvmlU=&#xA;&#xA;This is much smaller (about 30%). And it has the property that it won&#x27;t be easily decoded by just throwing it into a Base64 decoder.&#xA;I decided to use plain hex encoding, and pretty format it, which gave me:&#xA;&#xA;0172020007 93050A0B28 0D0D0D682C 24080D0D2C&#xA;260D080C2C 090A29282C 2A08090D23 0C2829250B&#xA;2509060C1F 171019081B 1016150587 2C672C7795&#xA;5422220322 2203222295 2E22222222 2222220692&#xA;058F064407 4A0537064B 0528064C8C 4D8C4E0549&#xA;065A8C4F8D 528C538D54 8D558D568D 5705490659&#xA;8D508D518C 5805872C5B 2C77069105 954810090C&#xA;1915081B10 150E962052 0F1015161A 069553100E&#xA;15081B1C19 0C05954511 740C1C984D 4B4641270B&#xA;95560F1608 209841492F 4108962B58 0B9556120C&#xA;95590C954C 2195441695 5623954C29 2695482009&#xA;1D1C97514D 2B1117974E 492B150E96 3D3D070157&#xA;A9E859DD06 1EE0EC6210 674ED4CA88 C78FC61D20&#xA;B1650BF992 978871264B 57994E0CF3 EA99BFE9G1&#xA;&#xA;This make it look much better, I think. Even if it almost double the amount of space we take (we are still smaller than the original JSON, though). Mostly this is me playing around on Friday&#x27;s evening, to be honest. I needed something small to play with that had immediate feedback, so I started playing with this.&#xA;What do you think?</p>
        </article>
        <article id="article-3209">
            <a href="https://ayende.com/blog/173249/readability-matters" target="_blank">
                <h2 class="title mb-6" id="article-3209">Readability matters</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 11, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In one of my recent posts about performance, a suggestion was raised:  Just spotted a small thing, you could optimise the call to: _buffer[pos&#x2B;&#x2B;] = (byte)&#x27;\&#x27;; with a constant as it&#x27;s always the same. There are two problems with this suggestion. Let us start with the obvious one first. Here is the disassembly of the code:  &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; b[0] = (byte) &#x27;/&#x27;;  00007FFC9DC84548&#xA0; mov&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; rcx,qword ptr [rbp&#x2B;8]&#xA0;&#xA0; 00007FFC9DC8454C&#xA0; mov&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; byte ptr [rcx],2Fh&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; b[0] = 47;  00007FFC9DC8454F&#xA0; mov&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; rcx,qword ptr [rbp&#x2B;8]&#xA0;&#xA0; 00007FFC9DC84553&#xA0; mov&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; byte ptr [rcx],2Fh&#xA0;&#xA0; As you can see, in both cases, the exact same instructions are carried out.  That is because we are no longer using compilers that had 4KB of memory to work with and required hand holding and intimate familiarity with how the specific compiler version we wrote the code for behaved.  The other problem is closely related. I&#x27;ve been working with code for the past 20 years. And while I remember the ASCII codes for some characters, when reading b[0] = 47, I would have to go and look it up. That puts a really high burden on the reader of a parser, where this is pretty much all that happens.  I recently saw it when I looked at the Smaz library. I ported that to C# and along the way I made sure that it was much more understandable (at least in my opinion). This resulted in a totally unexpected pull request that ported my C# port to Java. Making the code more readable made it accessible and possible to work with. Whereas before it was a impenetrable black box. Consider what this means for larger projects, where there are large sections that are marked with &quot;there be dragons and gnarly bugs&quot;&#x2026; This really kills systems and teams productivity. In the cas of the Smaz library port, because the code was easier to work with, Peter was able to not just port it to Java, but was able to repurpose it into a useful util for compressing mime types very efficiently.</p>
        </article>
        <article id="article-3210">
            <a href="https://ayende.com/blog/173217/ravendb-at-zap-group" target="_blank">
                <h2 class="title mb-6" id="article-3210">RavenDB at ZAP Group</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 10, 2016
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">We took this video a few weeks ago, tell us what you think.</p>
        </article>
        <div class="button flex justify-between">
            <a href="320.html"><span class="back arrow"></span></a>

            <a href="322.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2024<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>