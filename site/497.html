
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 497 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-4961">
            <a href="https://ayende.com/blog/4762/the-best-bug-reports-are-pull-requests" target="_blank">
                <h2 class="title mb-6" id="article-4961">The best bug reports are pull requests</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 27, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I just got the following bug report, I&#x2019;ll just let you read it, and I have additional commentary below:    The great fun with getting a pull request with a failing test is that the whole process of working with this is pretty seamless.   For the one above, GitHub told me that I need to run the following command:     git pull https://github.com/benjamingram/ravendb.git DynamicFieldsBug   I did, and got the failing test, from there it was just a matter of fixing the actual bug, which was rather simple, and nothing that even smelled like ceremony.</p>
        </article>
        <article id="article-4962">
            <a href="https://ayende.com/blog/4761/no-alanis-this-is-ironic" target="_blank">
                <h2 class="title mb-6" id="article-4962">No, Alanis, THIS is ironic</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 26, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This is what I got when I was trying to figure out an OutOfMemoryException in RavenDB</p>
        </article>
        <article id="article-4963">
            <a href="https://ayende.com/blog/4760/performance-optimizations-rinse-repeat-repeat-repeat" target="_blank">
                <h2 class="title mb-6" id="article-4963">Performance optimizations</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 23, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Originally posted at 1/18/2011We got some reports that there was an O(N) issue with loading large number of documents from Raven.  I wrote the following test code:     var db = new DocumentDatabase(new RavenConfiguration&#xA;{&#xA;    DataDirectory = &quot;Data&quot;&#xA;});&#xA;Console.WriteLine(&quot;Ready&quot;);&#xA;Console.ReadLine();&#xA;while (true)&#xA;{&#xA;    var sp = Stopwatch.StartNew();&#xA;&#xA;    db.Query(&quot;Raven/DocumentsByEntityName&quot;, new IndexQuery&#xA;    {&#xA;        Query = &quot;Tag:Item&quot;,&#xA;        PageSize = 1024&#xA;    });&#xA;&#xA;    Console.WriteLine(sp.ElapsedMilliseconds);&#xA;}&#xA;  &#xA;&#xA;With 1,024 documents in the database, I could clearly see that most requests took in the order of 300 ms. Not content with that speed, I decided to dig deeper, and pulled out my trusty profiler (dotTrace, and no, I am not getting paid for this) and got this:&#xA;&#xA;&#xA;&#xA;As should be clear, it seems like de-serializing the data from byte[] to a JObject instance is taking a lot of time (relatively speaking).&#xA;&#xA;To be more precise, it takes 0.4 ms, to do two deserialization operations (for the following document):&#xA;&#xA;&#xA;  {&#xA;    &quot;cartId&quot;: 666,&#xA;    &quot;otherStuff&quot;: &quot;moohahaha&quot;,&#xA;    &quot;itemList&quot;: [{&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    },&#xA;    {&#xA;        &quot;productId&quot;: 42,&#xA;        &quot;name&quot;: &quot;brimstone&quot;,&#xA;        &quot;price&quot;: 6.66,&#xA;        &quot;quantity&quot;: 2000&#xA;    }]&#xA;}&#xA;  &#xA;&#xA;I found it quite surprising, to tell you the truth. I wrote the following test case to prove this:&#xA;&#xA;&#xA;  static void Main()&#xA;{&#xA;    &#xA;    var st =&#xA;        &quot;IQAAAAJSYXZlbi1FbnRpdHktTmFtZQAFAAAASXRlbQAAvgIAABJjYXJ0SWQAmgIAAAAAAAACb3RoZXJTdHVm&quot;&#x2B;&#xA;        &quot;ZgAKAAAAbW9vaGFoYWhhAARpdGVtTGlzdACFAgAAAzAATQAAABJwcm9kdWN0SWQAKgAAAAAAAAACbmFtZQAKA&quot;&#x2B;&#xA;        &quot;AAAYnJpbXN0b25lAAFwcmljZQCkcD0K16MaQBJxdWFudGl0eQDQBwAAAAAAAAADMQBNAAAAEnByb2R1Y3RJZAA&quot;&#x2B;&#xA;        &quot;qAAAAAAAAAAJuYW1lAAoAAABicmltc3RvbmUAAXByaWNlAKRwPQrXoxpAEnF1YW50aXR5ANAHAAAAAAAAAAMy&quot;&#x2B;&#xA;        &quot;AE0AAAAScHJvZHVjdElkACoAAAAAAAAAAm5hbWUACgAAAGJyaW1zdG9uZQABcHJpY2UApHA9CtejGkAScXVhbn&quot;&#x2B;&#xA;        &quot;RpdHkA0AcAAAAAAAAAAzMATQAAABJwcm9kdWN0SWQAKgAAAAAAAAACbmFtZQAKAAAAYnJpbXN0b25lAAFwcmljZ&quot;&#x2B;&#xA;        &quot;QCkcD0K16MaQBJxdWFudGl0eQDQBwAAAAAAAAADNABNAAAAEnByb2R1Y3RJZAAqAAAAAAAAAAJuYW1lAAoAAABi&quot;&#x2B;&#xA;        &quot;cmltc3RvbmUAAXByaWNlAKRwPQrXoxpAEnF1YW50aXR5ANAHAAAAAAAAAAM1AE0AAAAScHJvZHVjdElkACoAAAAAA&quot;&#x2B;&#xA;        &quot;AAAAm5hbWUACgAAAGJyaW1zdG9uZQABcHJpY2UApHA9CtejGkAScXVhbnRpdHkA0AcAAAAAAAAAAzYATQAAABJwcm9&quot;&#x2B;&#xA;        &quot;kdWN0SWQAKgAAAAAAAAACbmFtZQAKAAAAYnJpbXN0b25lAAFwcmljZQCkcD0K16MaQBJxdWFudGl0eQDQBwAAAAAAAA&quot;&#x2B;&#xA;        &quot;ADNwBNAAAAEnByb2R1Y3RJZAAqAAAAAAAAAAJuYW1lAAoAAABicmltc3RvbmUAAXByaWNlAKRwPQrXoxpAEnF1YW50a&quot;&#x2B;&#xA;        &quot;XR5ANAHAAAAAAAAAAAA&quot;;&#xA;    var buffer = Convert.FromBase64String(st);&#xA;&#xA;    while (true)&#xA;    {&#xA;        var sp = Stopwatch.StartNew();&#xA;        for (int i = 0; i &lt; 1024; i&#x2B;&#x2B;)&#xA;        {&#xA;            DoWork(buffer);&#xA;        }&#xA;        Console.WriteLine(sp.ElapsedMilliseconds);&#xA;    }&#xA;}&#xA;&#xA;private static void DoWork(byte[] buffer)&#xA;{&#xA;    var ms = new MemoryStream(buffer);&#xA;    JObject.Load(new BsonReader(ms));&#xA;    JObject.Load(new BsonReader(ms));&#xA;}&#xA;  &#xA;&#xA;On my machine, this run at around 70ms for each 1,204 run. In other words, it takes significantly less I would have thought. Roughly 0.06 ms.&#xA;&#xA;&#xA;  Note: The first number (0.4 ms) is under the profiler while the second number (0.06ms) is outside the profiler. You can routinely see order of magnitude differences between running inside and outside the profiler!&#xA;&#xA;&#xA;So far, so good, but we can literally see that this is adding almost a 100 ms to the request processing. That is good, because it is fairly simple to fix.&#xA;&#xA;What I did was introduce a cache inside the serialization pipeline that made the entire cost go away. Indeed, running the same code above showed much better performance, an average of 200 ms.&#xA;&#xA;The next step is to figure out where is the next cost factor&#x2026; For that, we use the profiler.&#xA;&#xA;&#xA;&#xA;And&#x2026; we can see the the cost of de-serializing went drastically down. Now the actual cost is just doing a search for the document by the key.&#xA;&#xA;You might have noticed that those results are for Munin. I have run the same test results with Esent, with remarkable similarity in the overall performance.</p>
        </article>
        <article id="article-4964">
            <a href="https://ayende.com/blog/4759/code-review-tools" target="_blank">
                <h2 class="title mb-6" id="article-4964">Code Review tools</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 22, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Originally posted at 1/17/2011Occasionally I get asked what code review tools I use.  The truth is, I tend to use TortoiseGit&#x2019;s Log Viewer and just read the history, but I am not leaning toward this baby:    This is really nice!</p>
        </article>
        <article id="article-4965">
            <a href="https://ardalis.com/398/" target="_blank">
                <h2 class="title mb-6" id="article-4965">Sharp XV-Z9000U Projector Wont Power Up - Solution</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 21, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have a fairly old projector that recently required a new bulb.&#xA0; It&#x2019;s a Sharp XV-Z9000U model, which has bulbs that last for something like&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4966">
            <a href="https://ayende.com/blog/4758/ravenmq-update" target="_blank">
                <h2 class="title mb-6" id="article-4966">RavenMQ update</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 21, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">It wasn&#x2019;t planned so much as it happened, but RavenMQ just slipped into private beta stage. The API is still in a the somewhat clumsy state, but it it is working quite nicely   You can see an example of the client API below:     using(var connection = RavenMQConnection.Connect(&quot;http://reduction:8181&quot;))&#xA;{&#xA;    connection.Subscribe(&quot;/queues/abc&quot;, (context, message) =&gt; &#xA;        Console.WriteLine(Encoding.UTF8.GetString(message.Data)));&#xA;&#xA;    connection.PublishAsync(new IncomingMessage&#xA;    {&#xA;        Queue = &quot;/queues/abc&quot;,&#xA;        Data = Encoding.UTF8.GetBytes(&quot;Hello Ravens&quot;)&#xA;    });&#xA;&#xA;    Console.ReadLine();&#xA;}&#xA;  &#xA;&#xA;Please note that this is likely to be subject to many changes.&#xA;&#xA;This is written about 10 minutes after I posted the code above:&#xA;&#xA;&#xA;  using(var connection = RavenMQConnection.Connect(&quot;http://localhost:8181&quot;))&#xA;{&#xA;    connection.&#xA;        Subscribe&lt;User&gt;(&quot;/queues/abc&quot;, (context, message) =&gt; Console.WriteLine(message.Name));&#xA;&#xA;    connection&#xA;        .StartPublishing&#xA;        .Add(&quot;/queues/abc&quot;, new User {Name = &quot;Ayende&quot;})&#xA;        .PublishAsync();&#xA;&#xA;    Console.ReadLine();&#xA;}&#xA;  &#xA;&#xA;I told you it would change&#x2026;</p>
        </article>
        <article id="article-4967">
            <a href="https://ayende.com/blog/4757/recording-of-my-ravendb-talk-for-e-van" target="_blank">
                <h2 class="title mb-6" id="article-4967">Recording of my RavenDB talk for E-VAN</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 20, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Originally posted at 1/13/2011You can find the recording here:  http://vimeo.com/18708232</p>
        </article>
        <article id="article-4968">
            <a href="https://ayende.com/blog/4756/it-is-the-little-things-that-trips-you-reducing-ravendbs-map-reduce-cost" target="_blank">
                <h2 class="title mb-6" id="article-4968">It is the little things that trips you: Reducing RavenDB&#x2019;s Map/Reduce cost</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 19, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">After finally managing to get to Inbox Zero, I had the chance to tackle some problems that were on the back burner. One of the more acute ones was RavenDB performance for map/reduce indexes.  Standard indexes are actually very fast, especially since I just gave them an additional boost, but map/reduce indexes had two problems:     The reduce operation is currently single threaded (for all indexes).    The reduce operation blocks standard indexing.   In order to avoid that, we split the work so reduce would run in a separate thread from standard indexing operations. That done, I started to take a look at the actual cost of map/reduce operations.  It quickly became apparent that while the map part was pretty fast, it was the reduce operation that was killing us.  After some narrowing down, I was able to figure out that this is the code at fault:  public override void Execute(WorkContext context)&#xA;{&#xA;        if (ReduceKeys.Length == 0)&#xA;            return;&#xA;&#xA;  var viewGenerator = context.IndexDefinitionStorage.GetViewGenerator(Index);&#xA;  if (viewGenerator == null)&#xA;    return; // deleted view?&#xA;&#xA;  context.TransactionaStorage.Batch(actions =&gt;&#xA;  {&#xA;    IEnumerable&lt;object&gt; mappedResults = null;&#xA;    foreach (var reduceKey in ReduceKeys)&#xA;    {&#xA;      IEnumerable&lt;object&gt; enumerable = actions.MappedResults.GetMappedResults(Index, reduceKey, MapReduceIndex.ComputeHash(Index, reduceKey))&#xA;        .Select(JsonToExpando.Convert);&#xA;&#xA;      if (mappedResults == null)&#xA;        mappedResults = enumerable;&#xA;      else&#xA;        mappedResults = mappedResults.Concat(enumerable);&#xA;    }&#xA;&#xA;    context.IndexStorage.Reduce(Index, viewGenerator, mappedResults, context, actions, ReduceKeys);&#xA;  });&#xA;}&#xA;&#xA;Can you see the problem?&#xA;&#xA;My first thought was that we had a problem with the code inside the foreach, since it effectively generate something like:&#xA;&#xA;&#xA;  select * from MappedResulsts where Index = &quot;MapReduceTestIndex&quot; and ReduceKey = &quot;Oren&quot;&#xA;select * from MappedResulsts where Index = &quot;MapReduceTestIndex&quot; and ReduceKey = &quot;Ayende&quot;&#xA;select * from MappedResulsts where Index = &quot;MapReduceTestIndex&quot; and ReduceKey = &quot;Arava&quot;&#xA;  &#xA;&#xA;And usually you&#x2019;ll have about 2,500 of those. &#xA;&#xA;Indeed, I modified the code to look like this:&#xA;&#xA;&#xA;  public override void Execute(WorkContext context)&#xA;{&#xA;        if (ReduceKeys.Length == 0)&#xA;            return;&#xA;&#xA;  var viewGenerator = context.IndexDefinitionStorage.GetViewGenerator(Index);&#xA;  if (viewGenerator == null)&#xA;    return; // deleted view?&#xA;  &#xA;  context.TransactionaStorage.Batch(actions =&gt;&#xA;  {&#xA;    IEnumerable&lt;object&gt; mappedResults = new object[0];&#xA;    foreach (var reduceKey in ReduceKeys)&#xA;    {&#xA;      IEnumerable&lt;object&gt; enumerable = actions.MappedResults.GetMappedResults(Index, reduceKey, MapReduceIndex.ComputeHash(Index, reduceKey))&#xA;        .Select(JsonToExpando.Convert);&#xA;&#xA;      mappedResults = mappedResults.Concat(enumerable);&#xA;    }&#xA;    var sp = Stopwatch.StartNew();&#xA;    Console.WriteLine(&quot;Starting to read {0} reduce keys&quot;, ReduceKeys.Length);&#xA;&#xA;    var results = mappedResults.ToArray();&#xA;&#xA;    Console.WriteLine(&quot;Read {0} reduce keys in {1} with {2} results&quot;, ReduceKeys.Length, sp.Elapsed, results.Length);&#xA;&#xA;    context.IndexStorage.Reduce(Index, viewGenerator, results, context, actions, ReduceKeys);&#xA;  });&#xA;}&#xA;  &#xA;&#xA;And got the following:&#xA;&#xA;&#xA;  &#xA;&#xA;  Starting to read 2470 reduce keys&#xA;    Read 2470 reduce keys in 00:57:57.5292856 with 2499 results&#xA;&#xA;&#xA;Yes, for 2,470 results, that took almost an hour!!&#xA;&#xA;I started planning how to fix this by moving to what is effectively an &#x201C;IN&#x201D; approach, when I realized that I skipped a very important step, I didn&#x2019;t run this through the profiler. And as we know, if it haven&#x2019;t run through the profiler, it isn&#x2019;t real, when we are talking about performance testing.&#xA;&#xA;And the profiler led me to this method:&#xA;&#xA;&#xA;  public IEnumerable&lt;JObject&gt; GetMappedResults(string view, string reduceKey, byte[] viewAndReduceKeyHashed)&#xA;{&#xA;    Api.JetSetCurrentIndex(session, MappedResults, &quot;by_reduce_key_and_view_hashed&quot;);&#xA;    Api.MakeKey(session, MappedResults, viewAndReduceKeyHashed, MakeKeyGrbit.NewKey);&#xA;    if (Api.TrySeek(session, MappedResults, SeekGrbit.SeekEQ) == false)&#xA;        yield break;&#xA;&#xA;&#xA;    Api.MakeKey(session, MappedResults, viewAndReduceKeyHashed, MakeKeyGrbit.NewKey);&#xA;    Api.JetSetIndexRange(session, MappedResults, SetIndexRangeGrbit.RangeUpperLimit | SetIndexRangeGrbit.RangeInclusive);&#xA;    if (Api.TryMoveFirst(session, MappedResults) == false)&#xA;        yield break;&#xA;    do&#xA;    {&#xA;        // we need to check that we don&#x27;t have hash collisions&#xA;        var currentReduceKey = Api.RetrieveColumnAsString(session, MappedResults, tableColumnsCache.MappedResultsColumns[&quot;reduce_key&quot;]);&#xA;        if (currentReduceKey != reduceKey)&#xA;            continue;&#xA;        var currentView = Api.RetrieveColumnAsString(session, MappedResults, tableColumnsCache.MappedResultsColumns[&quot;view&quot;]);&#xA;        if (currentView != view)&#xA;            continue;&#xA;        yield return Api.RetrieveColumn(session, MappedResults, tableColumnsCache.MappedResultsColumns[&quot;data&quot;]).ToJObject();&#xA;    } while (Api.TryMoveNext(session, MappedResults));&#xA;}&#xA;  &#xA;&#xA;You might have noticed the part that stand out , yes, we actually had a O(n) algorithm here (effectively a table scan) that was absolutely meaningless and didn&#x2019;t need to be there. I am pretty sure that it was test code that I wrote (yes, I run git blame on that and ordered some crow for tomorrow&#x2019;s lunch).&#xA;&#xA;Once I removed that, things changed for the better . To give you an idea how much, take a look at the new results:&#xA;&#xA;&#xA;  Starting to read 2470 reduce keys&#xA;    Read 2470 reduce keys in 00:00:00.4907501 with 2499 results&#xA;&#xA;&#xA;And just for fun, I had tested how long it takes to reduce each batch of results:&#xA;&#xA;&#xA;  Indexed 2470 reduce keys in 00:00:01.0533390 with 2499 results&#xA;&#xA;&#xA;And that is without doing any actual optimizations, that is just removing the brain-dead code that had no business being there.</p>
        </article>
        <article id="article-4969">
            <a href="https://ardalis.com/lessons-learned-performing-harry-potter-book-kata/" target="_blank">
                <h2 class="title mb-6" id="article-4969">Lessons Learned Performing Harry Potter Book Kata</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 18, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Last week at CodeMash I went through the Harry Potter Book Kata with Steve (@underwhelmed). This is an interesting kata because it pretty&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-4970">
            <a href="https://ardalis.com/how-do-i-change-where-msmq-messages-are-stored-or-persisted/" target="_blank">
                <h2 class="title mb-6" id="article-4970">How do I Change Where MSMQ Messages are Stored or Persisted?</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: January 18, 2011
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">If you are using MSMQ, either directly or with the help of a package like NServiceBus, you may encounter errors if your server becomes&#x2026;Keep Reading &#x2192;</p>
        </article>
        <div class="button flex justify-between">
            <a href="496.html"><span class="back arrow"></span></a>

            <a href="498.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>
</body>
</html>