
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 24 &#x2022; Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">
<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline underline"
               href="index.html"> Home </a><a
                aria-current="" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline " href="about.html">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>


<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-231">
            <a href="https://devblogs.microsoft.com/dotnet/csharp-on-visual-studio-code-just-got-better-with-enhancements-to-csharp-dev-kit/" target="_blank">
                <h2 class="title mb-6" id="article-231">C# Dev Kit Updates: .NET Aspire, Hot Reload, and More!</h2>
            </a>
            <p class="mb-2">by Wendy Breiding (SHE/HER)</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 11, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Exploring the latest features and enhancements in the C# Dev Kit for VS Code including .NET Aspire orchestration support, new hot reload features, enhanced debugging capabilities, and more!</p>
        </article>
        <article id="article-232">
            <a href="https://andrewlock.net/preventing-client-side-cross-site-scripting-vulnerabilities-with-trusted-types/" target="_blank">
                <h2 class="title mb-6" id="article-232">Preventing client-side cross-site-scripting vulnerabilities with Trusted Types</h2>
            </a>
            <p class="mb-2">by Andrew Lock</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 11, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">In this post I describe how the Trusted Types Content-Security-Policy feature can protect you against cross-site-scripting attacks.&#x2026;</p>
        </article>
        <article id="article-233">
            <a href="https://ayende.com/blog/201955-A/ravendb-7-1-next-gen-pagers" target="_blank">
                <h2 class="title mb-6" id="article-233">RavenDB 7.1</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 10, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Even though RavenDB 7.0 isn&#x2019;t quite out of the gate yet (expect the release very&#xA0;soon), I want to start talking about the RavenDB 7.1 release. This release is going to represent the biggest change in RavenDB in about 7 years, and at the same time, it is expected to be a complete non-event for most people.We care enough about performance that we have both a dedicated team to verify it&#xA0;as well as really talented people whose sole job is to run benchmarks and optimize RavenDB. This year, the goal was to test RavenDB&#x2019;s performance when running on large&#xA0;machines (many hundreds of GBs or RAM, dozens of cores, etc). The idea was to find bottlenecks and remove them, and we quickly found a few. Performance optimization is often a very repetitive process. Find a problem, figure out the root cause, and move on. It is a process full of small changes and 0.1% improvements. The key is that if you practice this routinely, you end up with real measurable results over time, since your changes compound. Most of the time, these are the changes you celebrate:Here you can see a 6.6% increase in the number of operations per millisecond. That is a pretty big change, especially since it affects reading documents from storage. We were roughly two months into this process when we ran into the end of the line. The scenario in question was 95% reads / 5% writes, with the idea of seeing how quickly the system responds under load, but without stressing it to the limits. Take a look at our findings:What you can see here is that creating a transaction is&#xA0;costly, andover 50% of that cost is due to contention over a lock. We didn&#x2019;t notice that until we had a lot&#xA0;of cores to go around, since there wasn&#x2019;t a sufficient number of threads actively contending for this lock. Once we started looking for it, the problem was very apparent and visible on smaller machines as well. RavenDB creates a single transaction per request, so that means we are spending a lot of time doing essentially nothing useful. What is worse, this is actively&#xA0;spinning. So the more cores we have, the more CPU we&#x2019;ll use and the less useful work we&#x2019;ll do. Yuck!When we looked at the root cause, the problem became pretty apparent. Take a look at the following snippet:_txCreation.EnterReadLock(); // creating read transaction&#xD;&#xA;try&#xD;&#xA;{&#xD;&#xA;    _cancellationTokenSource.Token.ThrowIfCancellationRequested();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    tx = new LowLevelTransaction(previous.LowLevelTransaction, transactionPersistentContext, context);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    ActiveTransactions.Add(tx);&#xD;&#xA;}&#xD;&#xA;finally&#xD;&#xA;{&#xD;&#xA;    _txCreation.ExitReadLock();&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;using (PreventNewTransactions()) // during commit of write transaction&#xD;&#xA;{&#xD;&#xA;    if (tx.Committed &amp;&amp; tx.FlushedToJournal)&#xD;&#xA;        Interlocked.Exchange(ref _transactionsCounter, tx.Id);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    State = tx.State;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    Journal.Applicator.OnTransactionCommitted(tx);&#xD;&#xA;    ScratchBufferPool.UpdateCacheForPagerStatesOfAllScratches();&#xD;&#xA;    Journal.UpdateCacheForJournalSnapshots();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    tx.OnAfterCommitWhenNewTransactionsPrevented();&#xD;&#xA;}What happens is that during the commit of a write transaction we need to make updates to a bunch of places. We also need all new read transactions to see all our changes at once. So during commit, we take a short lock to update a couple of locations. And when we create a write transaction, we hold a read lock to be able to properly read all those values safely.This particular code (and the approach in general) dates back to the very early days of Voron:On one hand, I look at this code and cringe internally. On the other&#xA0;hand, it has served us really well for a long time. Of course, on the gripping hand, that code has been around for long enough to have grown some barnacles. Notice the OnAfterCommitWhenNewTransactionsPrevented() call we have there? It is meant to allow other operations&#xA0;that need to run while no read transactions are allowed, in order to maintain in-memory consistency. Fixing this issue was both straightforward and quite complex at the same time. Instead of storing all the data in various places, I introduced the following record:record EnvironmentStateRecord(&#xD;&#xA;    Pager.State DataPagerState, &#xD;&#xA;    long TransactionId,&#xD;&#xA;    ImmutableDictionary&lt;long, PageFromScratchBuffer&gt; ScratchPagesTable,&#xD;&#xA;    TreeRootHeader Root,&#xD;&#xA;    long NextPageNumber,&#xD;&#xA;    (long Number, long Last4KWritePosition) Journal,&#xD;&#xA;    object ClientState);The actual details of what it does aren&#x2019;t really that interesting. What is important is that we have an immutable record that is being generated by the write transaction. That record contains all the database state that we carry over between transactions. When we want to publish this state, we can just make a single atomic write to a pointer, no need for a lock.Of course, it can&#x2019;t&#xA0;be that simple. We needed to essentially convert large portions of the code to take their state from the environment record and provide a way for higher-level code to add their own state to the record on write. That took about two months of hard&#xA0;work, I think. Not complicated work, just grinding through all of those places, figuring out the best way to represent that, and making all the necessary changes. Unfortunately, that wasn&#x2019;t the only lock convoy we found. Files inside RavenDB are held by a class called Pager (since it serves pages&#xA0;of data). A file (Pager) may hold multiple States, which is a fancy way of referring to a memory-mapped range we use. The Pager may hold multiple such&#xA0;mapping concurrently. For example, if we increase the file size, we need to map the memory again&#xA0;- so for a certain period of time, we have two such mappings.A transaction may create a reference to such a state (and thus may access the mapping) for its lifetime. At the end of the transaction, we can release the state, and if it is the last reference, we&#x2019;ll close the mapping. This is implemented using the following code:This runs for multiple&#xA0;Pagers for each transaction, mind you. The actual AddRef()&#xA0;call is very cheap, but the lock&#x2026;public void AddRef() =&gt; Interlocked.Increment(ref _refs);As you can see from the image, this is also pretty old code. The problem was how to deal with the issue. I have&#xA0;to be able to keep track of the mapped memory if a transaction is using it, but at the same time, I want to dispose of it quickly if it isn&#x2019;t being used. The answer to this question was to lean on the GC. Instead of implementing AddRef()&#xA0;/ Release(), I hold the Pager.State&#xA0;object and handle disposal in the finalizer. If there is a reference to it, the finalizer isn&#x2019;t called, so this gives me the exact behavior I want, for free. However&#x2026; I also need to be able to dispose of this explicitly when closing the pager. A common scenario is that I&#x2019;m closing the Pager and deleting the directory. If I have an outstanding reference to the file, that will fail. Here is how I&#x2019;m dealing with the issue. The Pager holds a Weak-Reference to the State and may explicitly dispose of it:public void Dispose()&#xD;&#xA;{&#xD;&#xA;    foreach (WeakReference&lt;State&gt; state in _states)&#xD;&#xA;    {&#xD;&#xA;        if (state.TryGetTarget(out var v))&#xD;&#xA;        {&#xD;&#xA;            v.Dispose();&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;}That also allowed me to refactor the way we deal with files in general inside Voron. The first version of Voron did everything in managed code (including significant P/Invoke and cross-platform work). At some point, we introduced a native DLL (PAL - Platform Abstraction Layer - written in C) that allowed us to have a more consistent API.The issue was that there was no clean division of labor between the native C code and the managed code, and some responsibilities were split between them in a way that wasn&#x2019;t very clean. RavenDB is using ZigTo be rather more exact, I&#x2019;m using Zig as a build system to make cross-compilation a lot&#xA0;easier. I initially moved everything to use Zig, but it turns out that Zig isn&#x2019;t able to produce DLLs that would run properly on older versions of Windows. At least, nothing that I did convinced Zig to give me something that wouldn&#x2019;t fail to load. So we are still using MSVC to compile for Windows and then Zig to both Linux &amp; Mac (x64 &amp; ARM). If you have good ideas on how to solve that, I would really appreciate it.As a final thought, this work took several months, and when I got to the end, we got a pull request with some interesting numbers (&#x2B;11.3K LOC, -11.2K LOC). I have to admit that I feel a bit bad about that for the reviewers &#x1F642;. I was really hoping that I would get a net negative result in the number of lines changed, but that couldn&#x2019;t be helped. The end result is that all of our state is now far simpler, but we didn&#x2019;t actually change&#xA0;anything in the way we behave. We removed two frequently hit lock convoys and allowed RavenDB to be far more efficient. How efficient? Well&#x2026; that is a bit complex to answer, because we didn&#x2019;t stop here. There are more things that happened in RavenDB 7.1 that I need to talk to you about. We&#x2019;ll cover them in my next post.</p>
        </article>
        <article id="article-234">
            <a href="https://devblogs.microsoft.com/dotnet/mtp-adoption-frameworks/" target="_blank">
                <h2 class="title mb-6" id="article-234">Microsoft.Testing.Platform: Now Supported by All Major .NET Test Frameworks</h2>
            </a>
            <p class="mb-2">by Amaury Lev&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 10, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">All major .NET testing frameworks are now supporting Microsoft.Testing.Platform. Whether you are using Expecto, MSTest, NUnit, TUnit, or xUnit.net, you can now leverage the new testing platform to run your tests.</p>
        </article>
        <article id="article-235">
            <a href="https://www.meziantou.net/using-snapshot-testing-to-validate-ef-core-schema.htm" target="_blank">
                <h2 class="title mb-6" id="article-235">Using Snapshot Testing to validate EF Core schema</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 10, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">When using Entity Framework Core, I prefer to view the generated schema as SQL. This allows me to easily validate what EF is doing behind the scenes and ensures that no attributes are missed, such as accidentally using nvarchar(max).My main objectives are:Be notified when the schema changesReview t</p>
        </article>
        <article id="article-236">
            <a href="https://devblogs.microsoft.com/dotnet/dotnet-9-networking-improvements/" target="_blank">
                <h2 class="title mb-6" id="article-236">.NET 9 Networking Improvements</h2>
            </a>
            <p class="mb-2">by M&#xE1;&#x148;a,Natalia,Anton</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 06, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Introducing new networking features in .NET 9 including HTTP space, HttpClientFactory, security and more!</p>
        </article>
        <article id="article-237">
            <a href="https://devblogs.microsoft.com/dotnet/servicing-release-advisory-aspnetcore-23/" target="_blank">
                <h2 class="title mb-6" id="article-237">ASP.NET Core on .NET Framework servicing release advisory: ASP.NET Core 2.3</h2>
            </a>
            <p class="mb-2">by Daniel Roth</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 04, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">ASP.NET Core 2.1 has been reshipped as ASP.NET Core 2.3 to help users on the unsupported ASP.NET Core 2.2 move to a supported version.</p>
        </article>
        <article id="article-238">
            <a href="https://andrewlock.net/creating-a-source-generator-part-14-supporting-multiple-sdk-versions-in-a-source-generator/" target="_blank">
                <h2 class="title mb-6" id="article-238">Supporting multiple .NET SDK versions in a source generator</h2>
            </a>
            <p class="mb-2">by Andrew Lock</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 04, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Creating a source generator - Part 14</p>
        </article>
        <article id="article-239">
            <a href="https://ayende.com/blog/201989-A/challenge-giving-file-system-developer-ulcer" target="_blank">
                <h2 class="title mb-6" id="article-239">Challenge</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 03, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I&#x2019;m trying to reason about the behavior of this code, and I can&#x2019;t decide if this is a stroke of genius or if I&#x2019;m suffering from a stroke. Take a look at the code, and then I&#x2019;ll discuss what I&#x2019;m trying to do below:HANDLE hFile = CreateFileA(&quot;R:/original_file.bin&quot;, &#xD;&#xA;GENERIC_READ | GENERIC_WRITE, &#xD;&#xA;FILE_SHARE_READ | FILE_SHARE_WRITE, &#xD;&#xA;NULL, &#xD;&#xA;OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, &#xD;&#xA;NULL);&#xD;&#xA;if (hFile == INVALID_HANDLE_VALUE) {&#xD;&#xA;    printf(&quot;Error creating file: %d\n&quot;, GetLastError());&#xD;&#xA;    exit(__LINE__);&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;HANDLE hMapFile = CreateFileMapping(hFile, NULL, &#xD;&#xA;PAGE_READWRITE, 0, 0, NULL);&#xD;&#xA;if (hMapFile == NULL) {&#xD;&#xA;    fprintf(stderr, &quot;Could not create file mapping object: %x\n&quot;, GetLastError());&#xD;&#xA;    exit(__LINE__);&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;char* lpMapAddress = MapViewOfFile(hMapFile, FILE_MAP_WRITE, 0, 0, 0);&#xD;&#xA;if (lpMapAddress == NULL) {&#xD;&#xA;    fprintf(stderr, &quot;Could not map view of file: %x\n&quot;, GetLastError());&#xD;&#xA;    exit(__LINE__);&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;for (size_t i = 2 * MB; i &lt; 4 * MB; i&#x2B;&#x2B;)&#xD;&#xA;{&#xD;&#xA;        lpMapAddress[i]&#x2B;&#x2B;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;HANDLE hDirect = CreateFileA(&quot;R:/original_file.bin&quot;, &#xD;&#xA;GENERIC_READ | GENERIC_WRITE, &#xD;&#xA;FILE_SHARE_READ | FILE_SHARE_WRITE, &#xD;&#xA;NULL, &#xD;&#xA;OPEN_ALWAYS, &#xD;&#xA;FILE_ATTRIBUTE_NORMAL, &#xD;&#xA;NULL);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;SetFilePointerEx(hDirect, (LARGE_INTEGER) { 6 * MB }, &amp; fileSize, FILE_BEGIN);&#xD;&#xA;for (i = 6 ; i &lt; 10 ; i&#x2B;&#x2B;) {&#xD;&#xA;    if (!WriteFile(hDirect, lpMapAddress &#x2B; i * MB, MB, &amp;bytesWritten, NULL)) {&#xD;&#xA;        fprintf(stderr, &quot;WriteFile direct failed on iteration %d: %x\n&quot;, i, GetLastError());&#xD;&#xA;        exit(__LINE__);&#xD;&#xA;    }&#xD;&#xA;}The idea is pretty simple, I&#x2019;m opening the same file twice. Once in buffered mode and mapping that memory for both reads &amp; writes. The problem is that to flush the data to disk, I have to either wait for the OS, or call FlushViewOfFile()&#xA0;and FlushFileBuffers()&#xA0;to actually flush it to disk explicitly.The problem with this approach is that FlushFileBuffers()&#xA0;has undesirable side effects. So I&#x2019;m opening the file again, this time for unbuffered&#xA0;I/O. I&#x2019;m writing to the memory&#xA0;map and then using the same&#xA0;mapping to write to the file itself. On Windows, that goes through a separate path (and may lose coherence with the memory map). The idea here is that since I&#x2019;m writing from the same location, I can&#x2019;t&#xA0;lose coherence. I either get the value from the file or from the memory map, and they are both the same. At least, that is what I hope&#xA0;will happen.For the purpose of discussion, I can ensure that there is no one else writing to this file while I&#x2019;m abusing the system in this manner. What do you think&#xA0;Windows will do in this case?I believe that when I&#x2019;m writing using unbuffered I/O in this manner, I&#x2019;m forcing the OS to drop the mapping and refresh from the disk. That is likely the reason why it may lose coherence, because there may be already reads that aren&#x2019;t served from main memory, or something like that.This isn&#x2019;t an approach that I would actually take for production usage, but it is a damn&#xA0;interesting thing to speculate on. If you have any idea what will actually happen, I would love to have your input.</p>
        </article>
        <article id="article-240">
            <a href="https://www.meziantou.net/migrate-from-mstest-to-xunit-using-a-roslyn-analyzer.htm" target="_blank">
                <h2 class="title mb-6" id="article-240">Migrate from MSTest to xUnit using a Roslyn analyzer</h2>
            </a>
            <p class="mb-2">by G&#xE9;rald Barr&#xE9;</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 03, 2025
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Both MSTest and xUnit are great test framework. If you are curious about, I&#x27;ve written many blog posts about themMSTest seriesQuick introduction to xUnit.netIf you want to migrate to xUnit from MSTest, I&#x27;ve written a Roslyn Analyzer. This analyzer reports all MSTest attributes and assertions in you</p>
        </article>
        <div class="button flex justify-between">
            <a href="23.html"><span class="back arrow"></span></a>

            <a href="25.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>

<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="about.html"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="/pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>
