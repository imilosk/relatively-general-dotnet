
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 612 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-6111">
            <a href="https://ayende.com/blog/3886/progressive-net-event" target="_blank">
                <h2 class="title mb-6" id="article-6111">Progressive.NET Event</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 21, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Skills Matter is co-organising The Progressive .NET Tutorials with some of us. This will be a really exciting 3 day long event with 2 tracks featuring half day and full day Tutorials by me, David Laribee, Gojko Adzic, Hammet, Ian Cooper, Mike Hadlow, Scott Belware and Sebastien Lambla.     For the full programme and description of the tutorials, check out: http://skillsmatter.com/event/open-source-dot-net/progressive-dot-net-exchange  If you are going to book before Feb 28th, just put SM1368-622459-33L (in the Promo Code field) and&#xA0; pay just &#xA3;350 (normal price &#xA3;1000). I hear that the tickets are going fast, so if you would like to secure a place and claim your discount &#x2013; do hurry up!   As a bonus, you can stay for the next week and enroll in the NHibernate course that I am also giving.    The last event where we did something similar was Kazien Conf, and we are going to try to reproduce the same thing in the Seattle ALT.Net conference in a week as well.   I can&#x2019;t talk about what will happen next week, but the previous workshops were a tremendous success. We are going to run 12 sessions during this event, and I am finding myself in the problematic position of wanting to be in at least three places at the same time, while I can only manage two (maybe I need to let Barid out as well*).  * Bonus points for anyone who manages to track down that reference.</p>
        </article>
        <article id="article-6112">
            <a href="https://ayende.com/blog/3885/dictionary-enum-t-puzzler" target="_blank">
                <h2 class="title mb-6" id="article-6112">Dictionary&lt;Enum,T&gt; Puzzler</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 21, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">A while ago in the NHibernate mailing list we got a report that NHibernate is making use of a dictionary with an enum as the key, and that is causing a big performance issue.  The response was almost unanimous, I think, &#x201C;what?! how can that be?!!?&#x201D;. Several people went in to and tried to figure out what is going on there. The answer is totally non oblivious, Dictionary&lt;K,V&gt; force boxing for any value type that is used as the key.  That sound completely contradictory to what you would expect, after all, one of the major points in generics was the elimination of boxing, so what happened?  Well, the issue is that Dictionary&lt;K,V&gt; has to compare the keys, and for that, it must make some assumptions about the actual key. It is abstracted into EqualityComparer, and that is where the actual problem starts. EqualityComparer has some special cases for the common types (anything that is IEquatable&lt;T&gt;, which most of the usual suspects implements), to speed this up.  The problem is that the fall back is to an ObjectComparer, and that, of course, will box any value type.  And enum does not implements IEquatable&lt;T&gt;&#x2026;  Omer has a good coverage on the subject, with really impressive results. Take a look at his results.     I am not going to steal his thunder, but I suggest going over and reading the code, it is very elegant.</p>
        </article>
        <article id="article-6113">
            <a href="https://ayende.com/blog/3884/unmanaged-api-fun-finding-out-msmq-subqueues-names-in-c" target="_blank">
                <h2 class="title mb-6" id="article-6113">Unmanaged API &#x201C;fun&#x201D;, finding out MSMQ subqueues names in C#</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 21, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I needed to get a list of subqueues of a queue, and there is no way of actually doing that in managed code. I decided that I can still use P/Invoke and just make the appropriate unmanaged calls. In hindsight, it would have been significantly simpler to just build an unmanaged DLL in C&#x2B;&#x2B;/CLR, but I was already too deep, and I can never remember how to properly compile a C&#x2B;&#x2B; app anymore.  I finally had to slap myself a couple of times and remind me that I was a C&#x2B;&#x2B; developer for a long time, and I damn well should remember how to treat memory like it was something both sacred and abused. I had tested that on a Windows 2008 64 bits machine. During this project, I also found out that there is basically no information at all about this sort of thing, so I am putting the code here.          public class MsmqUtil&#xA;&#xA;    {&#xA;&#xA;        internal const int PROPID_MGMT_QUEUE_SUBQUEUE_NAMES = 27;&#xA;&#xA;        internal const ushort VT_NULL = 1;&#xA;&#xA;    &#xA0;&#xA;&#xA;        public static unsafe string[] GetMsmqSubQueueNames(string queueFormatName)&#xA;&#xA;        {&#xA;&#xA;            var props = new MQMGMTPROPS {cProp = 1};&#xA;&#xA;            var variant = new MQPROPVariant {vt = VT_NULL};&#xA;&#xA;            try&#xA;&#xA;            {&#xA;&#xA;                props.aPropID = Marshal.AllocHGlobal(sizeof (int));&#xA;&#xA;                Marshal.WriteInt32(props.aPropID, PROPID_MGMT_QUEUE_SUBQUEUE_NAMES);&#xA;&#xA;    &#xA0;&#xA;&#xA;                props.aPropVar = Marshal.AllocHGlobal(Marshal.SizeOf(typeof (MQPROPVariant)));&#xA;&#xA;                Marshal.StructureToPtr(new MQPROPVariant {vt = VT_NULL}, props.aPropVar, false);&#xA;&#xA;    &#xA0;&#xA;&#xA;                props.status = Marshal.AllocHGlobal(sizeof (int));&#xA;&#xA;                Marshal.WriteInt32(props.status, 0);&#xA;&#xA;    &#xA0;&#xA;&#xA;                var result = MQMgmtGetInfo(null, &quot;queue=&quot; &#x2B; queueFormatName, ref props);&#xA;&#xA;                if (result != 0)&#xA;&#xA;                    throw new Win32Exception(result);&#xA;&#xA;    &#xA0;&#xA;&#xA;                if (Marshal.ReadInt32(props.status) != 0)&#xA;&#xA;                {&#xA;&#xA;                    return null;&#xA;&#xA;                }&#xA;&#xA;    &#xA0;&#xA;&#xA;                variant = (MQPROPVariant) Marshal.PtrToStructure(props.aPropVar, typeof (MQPROPVariant));&#xA;&#xA;    &#xA0;&#xA;&#xA;                var subQueues = new List&lt;string&gt;();&#xA;&#xA;                for (int i = 0; i &lt; variant.Val.calpwstr.cElems; i&#x2B;&#x2B;)&#xA;&#xA;                {&#xA;&#xA;                    var item = new string(variant.Val.calpwstr.pElems[i]);&#xA;&#xA;                    subQueues.Add(item);&#xA;&#xA;                }&#xA;&#xA;                return subQueues.ToArray();&#xA;&#xA;            }&#xA;&#xA;            finally&#xA;&#xA;            {&#xA;&#xA;                if (variant.vt != VT_NULL)&#xA;&#xA;                {&#xA;&#xA;                    for (var i = 0; i &lt; variant.Val.calpwstr.cElems; i&#x2B;&#x2B;)&#xA;&#xA;                    {&#xA;&#xA;                        MQFreeMemory(variant.Val.calpwstr.pElems[i]);&#xA;&#xA;                    }&#xA;&#xA;                    MQFreeMemory(variant.Val.calpwstr.pElems);&#xA;&#xA;                }&#xA;&#xA;                Marshal.FreeHGlobal(props.aPropID);&#xA;&#xA;                Marshal.FreeHGlobal(props.aPropVar);&#xA;&#xA;                Marshal.FreeHGlobal(props.status);&#xA;&#xA;            }&#xA;&#xA;        }&#xA;&#xA;    &#xA0;&#xA;&#xA;        [DllImport(&quot;mqrt.dll&quot;)]&#xA;&#xA;        internal static extern int MQMgmtGetInfo([MarshalAs(UnmanagedType.BStr)] string computerName,&#xA;&#xA;                                                 [MarshalAs(UnmanagedType.BStr)] string objectName,&#xA;&#xA;                                                 ref MQMGMTPROPS mgmtProps);&#xA;&#xA;    &#xA0;&#xA;&#xA;        [DllImport(&quot;mqrt.dll&quot;)]&#xA;&#xA;        internal static extern unsafe int MQFreeMemory(void* queue);&#xA;&#xA;    &#xA0;&#xA;&#xA;        [StructLayout(LayoutKind.Sequential)]&#xA;&#xA;        internal struct CALPWSTR&#xA;&#xA;        {&#xA;&#xA;            public uint cElems;&#xA;&#xA;            public unsafe char** pElems;&#xA;&#xA;        }&#xA;&#xA;    &#xA0;&#xA;&#xA;        [StructLayout(LayoutKind.Sequential)]&#xA;&#xA;        internal struct MQMGMTPROPS&#xA;&#xA;        {&#xA;&#xA;            public uint cProp;&#xA;&#xA;            public IntPtr aPropID;&#xA;&#xA;            public IntPtr aPropVar;&#xA;&#xA;            public IntPtr status;&#xA;&#xA;        }&#xA;&#xA;    &#xA0;&#xA;&#xA;        [StructLayout(LayoutKind.Sequential, Size = 16)]&#xA;&#xA;        internal struct MQPROPVariant&#xA;&#xA;        {&#xA;&#xA;            public ushort vt;&#xA;&#xA;            public ushort wReserved1;&#xA;&#xA;            public ushort wReserved2;&#xA;&#xA;            public ushort wReserved3;&#xA;&#xA;            public UnionedVariant Val; //8&#xA;&#xA;        }&#xA;&#xA;    &#xA0;&#xA;&#xA;        [StructLayout(LayoutKind.Explicit, Size = 8)]&#xA;&#xA;        internal struct UnionedVariant&#xA;&#xA;        {&#xA;&#xA;            [FieldOffset(0)] public uint ulVal; /* VT_UI4    */&#xA;&#xA;            [FieldOffset(0)] public CALPWSTR calpwstr; /* VT_VECTOR | VT_LPWSTR  */&#xA;&#xA;        }&#xA;&#xA;    }</p>
        </article>
        <article id="article-6114">
            <a href="https://ayende.com/blog/3883/challange-the-sample-legacy-database-from-hell" target="_blank">
                <h2 class="title mb-6" id="article-6114">Challange</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 18, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I need a legacy database for my NHibernate course. I can take some of the creepy ones in the NHibernate test suite, but I think that would be evil to the students.&#xA;Anyone can come up with a good (um, bad) legacy database that is also small enough to be a good example?</p>
        </article>
        <article id="article-6115">
            <a href="https://ayende.com/blog/3882/challenge-write-a-self-extracting-program" target="_blank">
                <h2 class="title mb-6" id="article-6115">Challenge</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 18, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I had to do this yesterday, and it was fun enough to post about it. Not only that, but the solution that I came up with is enough of a twist that I think would make this hard for many people.  Here is the challenge:     Given a zip file, produce an executable that when run on another machine, will unzip the content of the zip file on that machine. (nitpicker corner: yes, there are many ways to cheat this, but don&#x2019;t try to cheat). You may use any library and process that you want, but the end result must be a standalone file that can be copied to an separate machine and when execute will extract the content of the zip file.    You can assume that on that separate machine you will have the .Net framework installed, but you cannot depend on the presence of external libraries. I&#x2019;ll note that the default compression streams in the .Net framework are not applicable here, since they can&#x2019;t handle zip files (which contains a directory structure), they can only handle zip streams.   I took me roughly 30 minutes, most of which were spent dealing with ICSharpCode.SharpZipLib API, which is not something that I dealt with before.</p>
        </article>
        <article id="article-6116">
            <a href="https://ayende.com/blog/3881/production-errors-best-practices" target="_blank">
                <h2 class="title mb-6" id="article-6116">Production Errors Best Practices</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 18, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I have been practicing deployment lately, and today we have gotten everything squared away very nicely, only to be confronted with a failure when we actually run the app.  The error was: KeyNotFoundException, because we forgot to move some data to the QA database.&#xA0; We fixed the error, but I also change the error message that we were getting.  Now, we get the following error for this scenario:     Rhino.ServiceBus.Exceptins.InvalidDeploymentException: ERROR_ORDER_ATTRIB_NOT_FOUND: Could not find order attribute with the name: CorrelationId     This is usually an indication that the database has not been properly prepared for the deployment.      You need to add the order attribute to the appropriate table.      Important! If the order attribute &#x27;CorrelationId&#x27; is missing, it is likely that other required order attributes are also missing.      Please refer to the deployment guide about the required attributes. If you don&#x27;t find the required attributes in the deployment guide, please shout at the developer, preferably at 2 AM.   There are a couple of important things that I want to discuss about this error:     It is very explicit about what is going on.    It contains the information about how to fix the error.    It warns about additional problems that this may relate to.    It contains a uniquely identifying string that can be used to clearly communicate the error, placed in Google or put in a knowledge base.</p>
        </article>
        <article id="article-6117">
            <a href="https://ayende.com/blog/3880/resolving-graphics-problems-with-nh-prof" target="_blank">
                <h2 class="title mb-6" id="article-6117">Resolving graphics problems with NH Prof</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 17, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Christopher has good coverage on how we solved and isolated a problem that we&#xA0; run into using NH Prof. In essence, the issue was messed up text being reported by some of the users.  To be frank, it was a very frustrating issue, because none of us could come up with a repro, and the only thing that sometimes seemed to help is updating the graphic drivers. Having to update your graphic drivers to use NH Prof isn&#x2019;t something that I consider appropriate. It reminded me of the time that to deploy a system that I built, we had to replace the organization domain controller. It is&#x2026; not a place where you want to be.   We had accidently reproduced it in a SharedView session, and I got to see Christopher and Rob get to the root of the issue in a matter of minutes. It is not an area that I have any sort of expertise on, and it was fascinating to watch.   And, of course, we got rid of the problem that NH Prof had.</p>
        </article>
        <article id="article-6118">
            <a href="https://ardalis.com/lost-in-texas/" target="_blank">
                <h2 class="title mb-6" id="article-6118">Lost in Texas</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Last year Brendan and I had the privilege of attending Jeffrey Palermo&#x27;s agile bootcamp, put on by HeadSpring Systems in Austin, Texas. It&#x27;s&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-6119">
            <a href="https://ayende.com/blog/3879/reducing-the-cost-of-getting-a-stack-trace" target="_blank">
                <h2 class="title mb-6" id="article-6119">Reducing the cost of getting a stack trace</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am trying to find ways to reduce the cost of the stack trace used in NH Prof. The access to the stack trace is extremely valuable, but there is a significant cost of using it, so we need a better way of handling this. I decided to run a couple of experiment running this.  All experiments were run 5,000 times, on a stack trace of 7 levels.     new StackTrace(true) - ~600ms    new StackTrace(false) - ~150ms   So right there, we have a huge cost saving, but let us continue a bit.     throwing exception - ~400ms   That is not so good, I have to say.  Well, when in doubt, cheat!  Using reflector and some _really_ nasty stuff, I came up with this:                 var stackFrameHelperType = typeof(object).Assembly.GetType(&quot;System.Diagnostics.StackFrameHelper&quot;);&#xA;&#xA;      var GetStackFramesInternal = Type.GetType(&quot;System.Diagnostics.StackTrace, mscorlib&quot;).GetMethod(&quot;GetStackFramesInternal&quot;,BindingFlags.Static|BindingFlags.NonPublic);&#xA;&#xA;      &#xA0;&#xA;&#xA;      var method = new DynamicMethod(&quot;GetStackTraceFast&quot;,typeof(object),new Type[0],typeof(StackTrace),true);&#xA;&#xA;      &#xA0;&#xA;&#xA;      var generator = method.GetILGenerator();&#xA;&#xA;      generator.DeclareLocal(stackFrameHelperType);&#xA;&#xA;      generator.Emit(OpCodes.Ldc_I4_0);&#xA;&#xA;      generator.Emit(OpCodes.Ldnull);&#xA;&#xA;      generator.Emit(OpCodes.Newobj, stackFrameHelperType.GetConstructor(new[] { typeof(bool), typeof(Thread) }));&#xA;&#xA;      generator.Emit(OpCodes.Stloc_0);&#xA;&#xA;      generator.Emit(OpCodes.Ldloc_0);&#xA;&#xA;      generator.Emit(OpCodes.Ldc_I4_0);&#xA;&#xA;      generator.Emit(OpCodes.Ldnull);&#xA;&#xA;      generator.Emit(OpCodes.Call, GetStackFramesInternal);&#xA;&#xA;      generator.Emit(OpCodes.Ldloc_0);&#xA;&#xA;      generator.Emit(OpCodes.Ret);&#xA;&#xA;      getTheStackTrace = (Func&lt;object&gt;)method.CreateDelegate(typeof(Func&lt;object&gt;));&#xA;    &#xA;  &#xA;&#xA;&#xA;Calling getTheStackTrace 5000 times with depth of 7 frames is&#x2026; 54ms. And now that is a horse of a different color indeed.&#xA;&#xA;And the best part is, I can use the StackFrameHelper as a key into cached stack traces.&#xA;&#xA;And yes, I am aware that if anyone from the CLR team is reading this, a ninja team will be dispatched to&#x2026; discuss with me the notion of supported operations vs. unsupported operation.</p>
        </article>
        <article id="article-6120">
            <a href="https://ayende.com/blog/3878/presenting-nh-prof-at-virtual-alt-net" target="_blank">
                <h2 class="title mb-6" id="article-6120">Presenting NH Prof at Virtual ALT.Net</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: February 16, 2009
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">On Wednesday 18 Feb 21:00 (GMT-6) I will be joining the weekly VAN.&#xA;I am going to show off NH Prof in the context of a real application, discuss its features and how you can use it.</p>
        </article>
        <div class="button flex justify-between">
            <a href="611.html"><span class="back arrow"></span></a>

            <a href="613.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>