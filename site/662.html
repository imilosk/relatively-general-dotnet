
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 662 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-6611">
            <a href="https://ayende.com/blog/3479/rhino-queues-storage-disk" target="_blank">
                <h2 class="title mb-6" id="article-6611">Rhino.Queues.Storage.Disk</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 01, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The first thing you should know, the code for this is here: https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/experiments/Rhino.Queues.Storage.Disk  After my disastrous attempt to get an off the shelf embedded storage that can actually handle multiple threads with a half way decent performance, I decided that I really have to write my own.  I am pointing this out to all the people who think that my first instinct is to write my own.&#xA0; Here is the API that it has:     using (var queue = new PersistentQueue(path))&#xA;{&#xA;&#x9;using (var session = queue.OpenSession())&#xA;&#x9;{&#xA;&#x9;&#x9;session.Enqueue(new byte[] { 1, 2, 3, 4 });&#xA;&#x9;&#x9;session.Flush();&#xA;&#x9;}&#xA;&#xA;&#x9;using (var session = queue.OpenSession())&#xA;&#x9;{&#xA;&#x9;&#x9;CollectionAssert.AreEqual(new byte[] { 1, 2, 3, 4 }, session.Dequeue());&#xA;&#x9;&#x9;session.Flush();&#xA;&#x9;}&#xA;}&#xA;&#xA;&#xA;If it reminds you of something, that is intentional. :-)&#xA;&#xA;Persistent Queue is a singleton, which allow you to create sessions, which are thread local and contain the API to Enqueue and Dequeue from the queue. You can see the Flush() call there. This call persist the actual enqueuing or dequeuing. Our changes will revert if we will not call it.&#xA;&#xA;On of the design decisions that I wanted for this project was transaction support. That is, it should support ACID. This is not a trivial matter to decide to implement, but I decided that I wanted to try it.&#xA;&#xA;Let me describe how it works. The persistent queue is using three types of files:&#xA;&#xA;&#xA;  Transaction log&#xA;&#xA;  Data files&#xA;&#xA;  Lock file&#xA;&#xA;&#xA;The data file is a simply where I place the data from the user, nothing more. Basically, here is how it looks:&#xA;&#xA; &#xA;&#xA;There are several optimizations in the way that I write to the data file. First, writing is always done in sequential manner, and no editing of the file is ever done. That is, once something is on the file, it is never touched (except for read, of course). This allow to maintain a very high performance when writing to file. Combining writes and deciding when to use async I/O vs. sync I/O also has a significant implication.&#xA;&#xA;Of course, because I never edit the file, I need some way to deal with data overflow. Once the file exceed a predefined limit, I stop writing to it and start writing to a new file. Once all the items has been read from a file, and no more can be written to it, I delete it. This is a very simple strategy for managing the actual data. In fact, we use the current file size to size the next file, hopefully avoiding fragmentation this way, by simple heuristics.&#xA;&#xA;Of course, writing the data to disk is only half the problem. We need to manage that as well. For that, I have the transaction log. Because I have an extremely simple set of operations (Enqueue and Dequeue), it is very easy to deal with it. Here is a view of the transaction log:&#xA0;  &#xA;&#xA;The model is simple, each transaction is composed of a set of operations, and each operation contains the data in . When we commit a transaction, we wait for all write operation to complete, and then we append this data to the transaction log. The fact that we are only ever append to the transaction log also pay off in terms of how fast sequential writes are. Periodically and on graceful shutdown, we trim the transaction log, leaving only Enqueue operations there. &#xA;&#xA;This, in turn, allow us to restore ourselves in the case of an error. &#xA;&#xA;All writes to the disk are done with WriteThrough enabled, so we touch the platter, and writing to the transaction log is protected using a strategy similar to the one described here, so it can either succeed or fail.&#xA;&#xA;A lot of the complexity is simplified by serializing all writes to the disk. This has some implications in terms of the concurrency, but it is alleviated by using async I/O when it is appropriated. Overall performance is actually better in this scenario, because we are reduce the amount of seeks the disk has to do.&#xA;&#xA;Let me try to work through the ACID components and see if this works. &#xA;&#xA;Atomicity&#xA;&#xA;We should either complete succeed or completely fail. Let us assume that we have an error midway through a transaction. We have several options:&#xA;&#xA;&#xA;  The system has already written the transaction an all its operations to the disk, in which case we consider this a successful transaction.&#xA;&#xA;  No data was written to the transaction log about all the entries added / removed in this transaction, in which case, the transaction never actually occurred, so we are back to completely failed.&#xA;&#xA;  The most problematic part is handling partial transaction data written to the disk. Note that we have a count on the transaction log telling us how many operations to expect? We are using this to verify that the transaction has been successfully written to the disk. If we find a partially complete transaction, we ignore it and fix the transaction log. As far as we are concerned, the transaction never happened.&#xA;&#xA;&#xA;Since we use WriteThrough, we can be sure that when we finish a write, it is on the disk itself, and we will not loss it in case of a system crash.&#xA;&#xA;Note that there is one side affect of failed transactions, we do not recover disk space that went for data in lost transactions. This mean that if you written a 1MB chunk, then rolled the transaction back, that data file will not reclaim that MB of space that was lost. This is intentional, since it appears that it is actually more costly to perform the bookkeeping than merely lose the space temporarily.&#xA;&#xA;Consistency&#xA;&#xA;Will work with the guarantees that we have in place for atomicity.&#xA;&#xA;Isolation&#xA;&#xA;We only add the newly enqueued items to the global list (and the transaction log) when the transaction is committed. Dequeuing items, however, remove them from the global list and put them on hold, if the transaction is rolled back they return to the front of the queue, if the transaction is committed, their removal is logged to the transaction log.&#xA;&#xA;Durability&#xA;&#xA;All data is written to disk without buffers, so when the data write is complete, so we can ensure that a system failure will not wipe it. &#xA;&#xA;And that is how I implemented ACID for a system that has only two actions. But there was another challenge.&#xA;&#xA;Performance&#xA;&#xA;As you probably noticed, I put a lot of thought into performance. In particular, write batching and read ahead were important factors in significantly improving the performance of the system.&#xA;&#xA;Right now, the situation is good enough that I include the Performance Tests as part of the Unit Tests of the application. Those unit tests include several tests that read and write millions of items, and the total test suite completes in ~80 seconds.&#xA;&#xA;Below you can the profiler output of such a run. There are two things to note here, first, the amount of time spent calling to disk, and the number of calls that were made to the disk. I have put a lot of effort in minimizing the number of calls as much as possible, and it shows in the tests performance.&#xA;&#xA; &#xA;&#xA;Scale&#xA;&#xA;I tested this with 5,000 items of 512Kb - 1Mb in size, both read and write. The test completed within 5 minutes, giving us a roughly 12 MB/s processing time for a single queue.&#xA;&#xA;I think that this is enough for now, feel free to go through the code and rip it to pieces :-)</p>
        </article>
        <article id="article-6612">
            <a href="https://ayende.com/blog/3478/3-levels-of-failures" target="_blank">
                <h2 class="title mb-6" id="article-6612">3 Levels Of Failures</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 01, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">You have the no-failure, everything completed successfully and everyone is happy.    You have complete-failure, someone just pull the power cord off the machine.    And in the middle, you have partial-failure, something bad happened, (network is down, someone pulled the USB key out) but the system can (and should) keep running.    Most people give up on the complete failure scenario, leaving that up to transactional storage to handle this. That is usually the smartest solution.   The problem occur with partial failure, where you need to recover in meaningful ways. It is actually very easy to write a system where a complete failure is better than a partial failure.</p>
        </article>
        <article id="article-6613">
            <a href="https://ayende.com/blog/3477/how-many-rewrites" target="_blank">
                <h2 class="title mb-6" id="article-6613">How many rewrites?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 01, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I am working on a pet project for a while now, it is fun, and it is nice, but... takes a look how many times I had to rewrite it:     https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/branches/rhino-queues-1.0 &lt;-- final version branch    https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/branches/rhino-queues-bdb/ &lt;-- with Beckley DB    https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/branches/rhino-queues-firebird/ &lt;-- FireBird    https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/branches/rhino-queues-sqlite/ &lt;-- Sqlite    https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/branches/rhino-queues-with-disk/ &lt;-- custom persistence     https://rhino-tools.svn.sourceforge.net/svnroot/rhino-tools/experiments/rhino-queues/ &lt;-- initial playground   That was... interesting.  And I do think that there is value in restarting so many ways, because now I have a much better internal structure (and external one as well :-) ) .</p>
        </article>
        <article id="article-6614">
            <a href="https://ayende.com/blog/3476/reversibility" target="_blank">
                <h2 class="title mb-6" id="article-6614">Reversibility</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 01, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">No, I am not talking about Jeremey Miller&#x27;s reversibility. I am talking about another matter all together. I have an API that perform an operation. The problem is that based on the result of this operation, I may need to cancel that operation.   The main issue here is that in order to reverse this operation, I need to expose too much information to the client, which I rather not do. Let us take the following interface as an example:     public interface IActionStack&#xA;{&#xA;&#x9;ActionSpec Pop();&#xA;&#x9;void Push(ActionSpec action);&#xA;}&#xA;&#xA;&#xA;The code I would like to write is something like this:&#xA;&#xA;&#xA;  while(true)&#xA;{&#xA;&#x9;var action = actionStack.Pop();&#xA;&#x9;if (action.ExecuteAt &gt;= DateTime.Now )&#xA;&#x9;&#x9;action.Execute();&#xA;&#x9;else&#xA;&#x9;&#x9;actionStack.Push(action);&#xA;&#x9;Thread.Sleep(1000);&#xA;}&#xA;&#xA;&#xA;But there is meaning to the order of items in the stack, so I can just reorder it. Peek or PushFirst are not applicable here. What I came up with was:&#xA;&#xA;&#xA;  public interface IActionStack &#xA;{ &#xA;&#x9;ActionSpec Pop(); &#xA;&#x9;ActionSpec ReversiblePop(out System.Action reversePop); &#xA;&#x9;void Push(ActionSpec action); &#xA;}&#xA;&#xA;&#xA;And the client code is:&#xA;&#xA;&#xA;  while(true)&#xA;{&#xA;&#x9;System.Action reverse;&#xA;&#x9;var action = actionStack.ReversiblePop(out reverse);&#xA;&#x9;if (action.ExecuteAt &gt;= DateTime.Now )&#xA;&#x9;&#x9;action.Execute();&#xA;&#x9;else&#xA;&#x9;&#x9;reverse();&#xA;&#x9;Thread.Sleep(1000);&#xA;}&#xA;&#xA;&#xA;Thoughts?</p>
        </article>
        <article id="article-6615">
            <a href="https://ardalis.com/devexpress-earthquake-video/" target="_blank">
                <h2 class="title mb-6" id="article-6615">DevExpress Earthquake Video</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 31, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">DevExpress is one of several companies I work with via Lake Quincy Media, and it seems like a very fun place to work. Recently they launched&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-6616">
            <a href="https://ayende.com/blog/3475/code-reviews-are-not-just-about-the-code" target="_blank">
                <h2 class="title mb-6" id="article-6616">Code Reviews are not just about the code</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 31, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Usually when I am doing a code review, I ask not just access to the code, but to the source control repository as well. There are quite a lot that you can learn from the source control of a project.  Here is something that is both good and bad. It is bad because we have no checkin comments. It is good because we can see that we have very frequent checkins.  &#xA0;  Another thing that you want to check is the bug tracking system. Is there such a thing (including email thread or a post it notes or a story wall)? Is it relevant?  Is there a defined build process? How do you deploy to production? How do you manage DB changes? What is you back off strategy from an ambitious feature? How do you rollback a failed deployment? Do you have a physical deployment plan?  I don&#x27;t expect all projects to have detailed answers to the all the questions I put above, but I do expect to have a response. The worst possible thing that could happen is that there is no thought given to those.  My standard answer to &quot;How do you manage DB changes?&quot; is: I create a diff using SQL Compare and apply that when needing to update DB versions.   The most important thing in my opinion is the actual interaction in code reviews. I tend to have two stages of code review. The first is going over the code with only general idea about what is going on. This is to find if there are things that require special attention, if there are obvious issues there.  In general, you want to be able to view this from a clean mind. Then, you want to have a conversation with the developers. Based on that initial review. This allows you to capture more than just the code, it let you capture the actual dynamic of the team and how they work. During this phase I also get a lot more   The second phase of the code is much more in depth, I tend to try to go over every line in the code at least once. After that, I can sit with the developers again and discuss the overall impression.  Probably the most value in the process comes at this second state, I think.</p>
        </article>
        <article id="article-6617">
            <a href="https://ayende.com/blog/3474/logging-the-aop-way" target="_blank">
                <h2 class="title mb-6" id="article-6617">Logging - the AOP way</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 31, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Logging is probably the most mentioned sweet spot of AOP. Probably because it is the simplest and most straightforward example most people can think of. I remember going over a piece of code that handles billions of transactions a day(that is for you, Jdn), and seeing something like this:     public void DoSomethingInteresting(string arg1, int arg2)&#xA;{&#xA;&#x9;LogGateway.Enter(&quot;DoSomethingInteresting&quot;, arg1, arg2);&#xA;&#x9;try&#xA;&#x9;{&#xA;&#x9;&#x9;// actual method code &#xA;&#x9;&#x9;LogGateway.Success(&quot;DoSomethingInteresting&quot;, arg1, arg2);&#xA;&#x9;}&#xA;&#x9;catch(Exception e)&#xA;&#x9;{&#xA;&#x9;&#x9;LogGateway.Error(e, &quot;DoSomethingInteresting&quot;, arg1, arg2);&#xA;&#x9;&#x9;throw e;&#xA;&#x9;}&#xA;&#x9;finally&#xA;&#x9;{&#xA;&#x9;&#x9;LogGateway.Exit(&quot;DoSomethingInteresting&quot;, arg1, arg2);&#xA;&#x9;}&#xA;}&#xA;&#xA;&#xA;That was repeated for each and every method in the system. It was horrible. &#xA;&#xA;I don&#x27;t care how you do it, but there are at least 7 AOP approaches in the CLR, at least three of them are applicable in your environment.&#xA;&#xA;I am going to show how to handle that with Windsor&#x27;s AOP, but the same thing is applicable using other approaches. First, our service:&#xA;&#xA;&#xA;  public interface ISmsSender&#xA;{&#xA;&#x9;int Send(string to, string msg);&#xA;}&#xA;&#xA;public class SmsSender : ISmsSender&#xA;{&#xA;&#x9;public int Send(string to, string msg)&#xA;&#x9;{&#xA;&#x9;&#x9;if(msg.Length&gt;160)&#xA;&#x9;&#x9;&#x9;throw new ArgumentException(&quot;too long&quot;,&quot;msg&quot;);&#xA;&#x9;&#x9;return to.Length;&#xA;&#x9;}&#xA;}&#xA;&#xA;&#xA;And now we need to define the interceptor:&#xA;&#xA;&#xA;  public class LoggingInterceptor : IInterceptor&#xA;{&#xA;&#x9;public void Intercept(IInvocation invocation)&#xA;&#x9;{&#xA;&#x9;&#x9;var logger = LogManager.GetLogger(invocation.TargetType);&#xA;&#x9;&#x9;try&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;StringBuilder sb = null;&#xA;&#x9;&#x9;&#x9;if (logger.IsDebugEnabled)&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;sb = new StringBuilder(invocation.TargetType.FullName)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;.Append(&quot;.&quot;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;.Append(invocation.Method)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;.Append(&quot;(&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;for (int i = 0; i &lt; invocation.Arguments.Length; i&#x2B;&#x2B;)&#xA;&#x9;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if (i &gt; 0)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;sb.Append(&quot;, &quot;);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;sb.Append(invocation.Arguments[i]);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;sb.Append(&quot;)&quot;);&#xA;&#x9;&#x9;&#x9;&#x9;logger.Debug(sb);&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;invocation.Proceed();&#xA;&#x9;&#x9;&#x9;if(logger.IsDebugEnabled)&#xA;&#x9;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;logger.Debug(&quot;Result of &quot; &#x2B; sb &#x2B; &quot; is: &quot; &#x2B; invocation.ReturnValue);&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;catch (Exception e)&#xA;&#x9;&#x9;{&#xA;&#x9;&#x9;&#x9;logger.Error(e);&#xA;&#x9;&#x9;&#x9;throw;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;&#xA;&#xA;The code is really simple, we get the logger instance ( in this case, from log4net ), check if logging is enabled and if so, write the method and parameters to the log. We then execute the code and log the return value as well.&#xA;&#xA;If there was an error, we log that as well.&#xA;&#xA;Here is my test code:&#xA;&#xA;&#xA;  var container = new WindsorContainer()&#xA;&#x9;.Register(&#xA;&#x9;&#x9;Component.For&lt;LoggingInterceptor&gt;(),&#xA;&#x9;&#x9;Component.For&lt;ISmsSender&gt;().ImplementedBy&lt;SmsSender&gt;()&#xA;&#x9;&#x9;&#x9;.Interceptors(new InterceptorReference(typeof(LoggingInterceptor))).First&#xA;&#x9;);&#xA;BasicConfigurator.Configure(); // configure log4net&#xA;var sender = container.Resolve&lt;ISmsSender&gt;();&#xA;try&#xA;{&#xA;&#x9;sender.Send(&quot;ayende&quot;, &quot;short&quot;);&#xA;&#x9;sender.Send(&quot;rahien&quot;, new string(&#x27;q&#x27;, 161));&#xA;}&#xA;catch (Exception)&#xA;{&#xA;&#x9;&#xA;}&#xA;&#xA;&#xA;And the output for that is:&#xA;&#xA;&#xA;  241 [1] DEBUG ConsoleApplication9.SmsSender (null) - ConsoleApplication9.SmsSender.Int32 Send(System.String, System.String)(ayende, short)&#xA;    272 [1] DEBUG ConsoleApplication9.SmsSender (null) - Result of ConsoleApplication9.SmsSender.Int32 Send(System.String, System.String)(ayende, short) is: 6&#xA;&#xA;    272 [1] DEBUG ConsoleApplication9.SmsSender (null) - ConsoleApplication9.SmsSender.Int32 Send(System.String, System.String)(rahien, &#xA;&#xA;    &#xA0;&#xA0;&#xA0; qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq&#xA;&#xA;    &#xA0;&#xA0;&#xA0; qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq&#xA;&#xA;    &#xA0;&#xA0;&#xA0; qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq)&#xA;&#xA;    273 [1] ERROR ConsoleApplication9.SmsSender (null) - System.ArgumentException: too long&#xA;&#xA;    Parameter name: msg&#xA;&#xA;    &#xA0;&#xA0; at ConsoleApplication9.SmsSender.Send(String to, String msg) in C:\Users\ayende\Documents\Visual Studio 2008\Projects\ConsoleApplication9\ConsoleApplication9\ISmsSender.cs:line 15&#xA;&#xA;    &#xA0;&#xA0; at ISmsSenderProxyb24fc36182fb434fa7f466d148259c48.InvocationSend_1.InvokeMethodOnTarget()&#xA;&#xA;    &#xA0;&#xA0; at Castle.DynamicProxy.AbstractInvocation.Proceed() in e:\OSS\Castle\Tools\Castle.DynamicProxy2\Castle.DynamicProxy\AbstractInvocation.cs:line 140&#xA;&#xA;    &#xA0;&#xA0; at ConsoleApplication9.LoggingInterceptor.Intercept(IInvocation invocation) in C:\Users\ayende\Documents\Visual Studio 2008\Projects\ConsoleApplication9\ConsoleApplication9\Program.cs:line 65&#xA;&#xA;&#xA;Simple, elegant, and doesn&#x27;t clutter my code.</p>
        </article>
        <article id="article-6618">
            <a href="https://ayende.com/blog/3473/why-are-you-showing-such-a-contempt-for-my-time" target="_blank">
                <h2 class="title mb-6" id="article-6618">Why are you showing such a contempt for my time?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 31, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">This post just went over the line...     I mean, how do you expect me to respond to such a message?  In the old tradition of, don&#x27;t give the man a fish, here is how you find out.  There is this tool called Google. You can s-e-a-r-c-h things there. I used the advance technique of putting the search terms in the text box and clicked on Search.  Here is the result:    The third result, surprisingly enough, is from my site. You can see it right there in the link. Clicking on the link will lead you to this page:  &#xA0;     Do you see the big red arrow? It point to a new fangled concept called a link. If you click on it, it takes you somewhere.  Here is where it takes you in this situation:     Have fun sharing this with your team, but I suggest taking a Google 101 course at the same time.</p>
        </article>
        <article id="article-6619">
            <a href="https://ayende.com/blog/3472/entities-dependencies-best-practices" target="_blank">
                <h2 class="title mb-6" id="article-6619">Entities dependencies best practices</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 31, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The question came up in the ALT.Net list, and it is fairly common in the DDD circles as well.     I have an User with Email address, which I want to keep encrypted in the database, but visible to the application. How do I handle this scenario in the entity?   We can do it in our service layer, and encrypt / decrypt that outside the entity, but that has two issues. It couple the entity to the service and it means that we can forget to encrypt the email at some point.It also smells.  Another option, which I call the brute force option, is to pass the dependency to the entity and let it handle its own concerns. Here is implementation:     Yes, it is ugly, and even using this approach you can improve upon it, but let us focus on the interesting tidbits. First, not only does our entity know about an infrastructure service, it is also aware of how to create it. It has to do so, because we have to provide an empty ctor for NHibernate to use.  We can generalize this a bit, leading us to this scenario:     This piece of code is akin to nails on board to me. It isn&#x27;t how I want to see code written.  A better way exists. We will start by making a slight modification to the User class, we remove the empty ctor. Well, we can&#x27;t remove it at the moment, there is check in NHibernate for this, which I need to find and remove, so for now, we have this:     Note that this also requires that you&#x27;ll specify the unsaved value of the identifier in the configuration.  Now that we have established that we have no way of creating the User using the empty ctor, we let NHibernate know how it can create it:     public class EntityDependenciesInterceptor : EmptyInterceptor&#xA;{&#xA;    public override object Instantiate(string clazz, EntityMode entityMode, object id)&#xA;    {&#xA;        if(entityMode!=EntityMode.Poco)&#xA;            return base.Instantiate(clazz, entityMode, id);&#xA;        if(clazz != typeof(User).FullName)&#xA;            return base.Instantiate(clazz, entityMode, id);&#xA;        return new User(CryptoProvider.Instance);&#xA;    }&#xA;}&#xA;&#xA;&#xA;Just for User, we override the way NHibernate create entities. Now we can register it in the session, and we are done:&#xA;&#xA;&#xA;  using (ISession session = sessionFactory.OpenSession(new EntityDependenciesInterceptor()))&#xA;{&#xA;    IList list = session.CreateCriteria(typeof(User)).List();&#xA;}&#xA;&#xA;&#xA;This is still not something that I particularly like. I don&#x27;t see encryption as part of the responsibilities of the entity. It is just something we need in order to save encrypted values to the DB. So let make it explicit.&#xA;&#xA;NHibernate has the notion of IUserType, which let you take actions on save / load of values from the DB.&#xA;&#xA;First, we make User POCO again, remove all traces of the previous ugliness. Now, we change the mapping for User so the email property is defined so:&#xA;&#xA;&#xA;  &lt;property name=&quot;Email&quot; type=&quot;Samples.EncryptedStringUserType, Samples&quot; /&gt;&#x9;&#x9;&#xA;&#xA;&#xA;And now we need to create the user type:&#xA;&#xA;&#xA;  public class EncryptedStringUserType : IUserType&#xA;{&#xA;    public bool Equals(object x, object y)&#xA;    {&#xA;        return object.Equals(x, y);&#xA;    }&#xA;&#xA;    public int GetHashCode(object x)&#xA;    {&#xA;        return x.GetHashCode();&#xA;    }&#xA;&#xA;    public object NullSafeGet(IDataReader rs, string[] names, object owner)&#xA;    {&#xA;        object r = rs[names[0]];&#xA;        if (r == DBNull.Value)&#xA;            return null;&#xA;        return CryptoProvider.Instance.Decrypt((string) r);&#xA;    }&#xA;&#xA;    public void NullSafeSet(IDbCommand cmd, object value, int index)&#xA;    {&#xA;        object paramVal = DBNull.Value;&#xA;        if (value != null)&#xA;            paramVal = CryptoProvider.Instance.Encrypt((string) value);&#xA;        IDataParameter parameter = (IDataParameter)cmd.Parameters[index];&#xA;        parameter.Value = paramVal;&#xA;    }&#xA;&#xA;    public object DeepCopy(object value)&#xA;    {&#xA;        return value;&#xA;    }&#xA;&#xA;    public object Replace(object original, object target, object owner)&#xA;    {&#xA;        return original;&#xA;    }&#xA;&#xA;    public object Assemble(object cached, object owner)&#xA;    {&#xA;        return cached;&#xA;    }&#xA;&#xA;    public object Disassemble(object value)&#xA;    {&#xA;        return value;&#xA;    }&#xA;&#xA;    public SqlType[] SqlTypes&#xA;    {&#xA;        get { return new SqlType[]{new StringSqlType()}; }&#xA;    }&#xA;&#xA;    public Type ReturnedType&#xA;    {&#xA;        get { return typeof(string); }&#xA;    }&#xA;&#xA;    public bool IsMutable&#xA;    {&#xA;        get { return false; }&#xA;    }&#xA;}&#xA;&#xA;&#xA;And that is it, you can now get transparent encryption / decryption when you are going to the DB, at no cost to the application design.</p>
        </article>
        <article id="article-6620">
            <a href="https://ayende.com/blog/3471/the-secret-of-pretty-diagrams" target="_blank">
                <h2 class="title mb-6" id="article-6620">The secret of pretty diagrams</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: July 31, 2008
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Is not really such a big secret...</p>
        </article>
        <div class="button flex justify-between">
            <a href="661.html"><span class="back arrow"></span></a>

            <a href="663.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>