
<!DOCTYPE html>
<html class="scroll-smooth" lang="en-US" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, shrink-to-fit=no" name="viewport">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <title>Page 526 â€¢ Relatively General .NET</title>
    <link href="favicon.ico" rel="icon" sizes="any">
    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
    <meta content="hsl()" name="theme-color">
    <meta content="website" property="og:type">
    <meta content="Home" property="og:title">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="pagefind/pagefind-ui.css">
    <!-- Google Analytics -->
    <script>
        // Only load GA if consent is given
        function loadGA() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-MDFXJY3FCY';
            script.async = true;
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', 'G-MDFXJY3FCY');
        }

        // Check if consent was previously given
        if (localStorage.getItem('cookieConsent') === 'accepted') {
            loadGA();
        }
    </script>
    <!-- End Google Analytics -->
</head>
<body class="mx-auto flex min-h-screen max-w-3xl flex-col bg-bgColor px-4 pt-16 font-mono text-sm font-normal text-textColor antialiased sm:px-8">

<a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">
    skip to content
</a>
<header class="group relative mb-28 flex items-center sm:ps-[4.5rem]" id="main-header">
    <div class="flex sm:flex-col">
        <a aria-current="page" class="inline-flex items-center hover:filter-none sm:relative sm:inline-block"
           href="index.html">
            <img class="me-3 sm:absolute sm:start-[-4.5rem] sm:me-0 sm:h-16 sm:w-16 w-16" src="images/giphy.gif"
                 alt=""/>
            <span class="text-xl font-bold sm:text-2xl">Relatively General .NET</span>
        </a>
        <nav aria-label="Main menu"
             class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
             id="navigation-menu">
            <a aria-current="page" class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
               href="index.html"> Home </a><a
                class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline" href="/about/">
                About </a>
        </nav>
    </div>
    <site-search class="ms-auto" id="search">
        <button id="open-search"
                class="flex h-9 w-9 items-center justify-center rounded-md ring-zinc-400 transition-all hover:ring-2"
                data-open-modal="">
            <svg aria-label="search" class="h-7 w-7" fill="none" height="16" stroke="currentColor"
                 stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" stroke="none"></path>
                <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path>
            </svg>
        </button>
        <dialog aria-label="search"
                class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-bgColor shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md">
            <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6">
                <button id="close-search"
                        class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700"
                        data-close-modal="">Close
                </button>
                <div class="search-container">
                    <div id="cactus__search"/>
                </div>
            </div>
        </dialog>
    </site-search>
    <theme-toggle class="ms-2 sm:ms-4">
        <button id="theme-toggle" class="relative h-9 w-9 rounded-md p-2 ring-zinc-400 transition-all hover:ring-2"
                type="button">
            <span class="sr-only">Dark Theme</span>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-100 opacity-100 transition-all dark:scale-0 dark:opacity-0"
                 fill="none" focusable="false" id="sun-svg" stroke-width="1.5" viewBox="0 0 24 24"
                 xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z"
                    stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M22 12L23 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 2V1" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M12 23V22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 20L19 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M20 4L19 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 20L5 19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M4 4L5 5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M1 12L2 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-7 w-7 -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all dark:scale-100 dark:opacity-100"
                 fill="none" focusable="false" id="moon-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
                <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
                <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
                <path d="M19 11h2m-1 -1v2"></path>
            </svg>
        </button>
    </theme-toggle>
    <mobile-button>
        <button aria-expanded="false" aria-haspopup="menu" aria-label="Open main menu"
                class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button">
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
                 fill="none" focusable="false" id="line-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <svg aria-hidden="true"
                 class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
                 fill="none" focusable="false" id="cross-svg" stroke="currentColor" stroke-width="1.5"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
    </mobile-button>
</header>
<main id="main" data-pagefind-body>
    <section aria-label="Blog post list">
        <article id="article-5251">
            <a href="https://ayende.com/blog/4603/lightswitch-initial-thoughts" target="_blank">
                <h2 class="title mb-6" id="article-5251">LightSwitch</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 25, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">As promised, I intend to spend some time today with LightSwitch, and see how it works. Expect a series of post on the topic. In order to make this a read scenario, I decided that that a simple app recording animals and their feed schedule is appropriately simple.   I created the following table:     Note that it has a calculated field, which is computed using:     There are several things to note here:     ReSharper doesn&#x2019;t work with LightSwitch, which is a big minus to me.    The decision to use partial methods had resulted in really ugly code.     Why is the class called Animals? I would expect to find an inflector at work here.    Yes, the actual calculation is crap, I know.   This error kept appearing at random:     It appears to be a known issue, but it is incredibly annoying.  This is actually really interesting:            You can&#x2019;t really work with the app unless you are running in debug mode. That isn&#x2019;t the way I usually work, so it is a bit annoying.    More importantly, it confirms that this is indeed KittyHawk, which was a secret project in 2008 MVP Summit that had some hilarious aspects.   There is something that is really interesting, it takes roughly 5 &#x2013; 10 seconds to start a LS application. That is a huge amount of time. I am guessing, but I would say that a lot of that is because the entire UI is built dynamically from the data source.  That would be problematic, but acceptable, except that it takes seconds to load data even after the app has been running for a while. For example, take a look here:       This is running on a quad core, 8 GB machine, in 2 tiers mode. It takes about 1 &#x2013; 2 seconds to load each screen. I was actually able to capture a screen half way loaded. Yes, it is beta, I know. Yes, perf probably isn&#x2019;t a priority yet, but that is still worrying.  Another issue is that while Visual Studio is very slow, busy about 50% of the time. This is when the LS app is running or not. As an a side issue, it is hard to know if the problem is with LS or VS, because of all the problems that VS has normally.     As an example of that, this is me trying to open the UserCode, it took about 10 seconds to do so.  What I like about LS is that getting to a working CRUD sample is very quick. But the problems there are pretty big, even at a cursory examination. More detailed posts touching each topic are coming shortly.</p>
        </article>
        <article id="article-5252">
            <a href="https://ardalis.com/system-core-in-vs2010-projects/" target="_blank">
                <h2 class="title mb-6" id="article-5252">System.Core in VS2010 Projects</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 24, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I just ran into an odd issue with a VS2010 project. In my case it was an MVC 2 application I was upgrading from VS2008. One of the built-in&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-5253">
            <a href="https://ayende.com/blog/4602/runtime-code-compilation-collectible-assemblies-are-no-go" target="_blank">
                <h2 class="title mb-6" id="article-5253">Runtime code compilation &amp; collectible assemblies are no go</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 24, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The problem is quite simple, I want to be able to support certain operation on Raven. In order to support those operations, the user need to be able to submit a linq query to the server. In order to allow this, we need to accept a string, compile it and run it.  So far, it is pretty simple. The problem begins when you consider that assemblies can&#x2019;t be unloaded. I was very hopeful when I learned about collectible assemblies in .NET 4.0, but they focus exclusively on assemblies generated from System.Reflection.Emit, while my scenario is compiling code on the fly (so I invoke the C# compiler to generate an assembly, then use that).  Collectible assemblies doesn&#x2019;t help in this case. Maybe, in C# 5.0, the compiler will use SRE, which will help, but I don&#x2019;t hold much hope there. I also checked out Mono.CSharp assembly, hoping that maybe it can do what I wanted it to do, but that suffer from the memory leak as well.  So I turned to the one solution that I knew would work, generating those assemblies in another app domain, and unloading that when it became too full. I kept thinking that I can&#x2019;t do that because of the slowdown with cross app domain communication, but then I figured that I am violating one of the first rules of performance: You don&#x2019;t know until you measure it. So I set out to test it.  I am only interested in testing the speed of cross app domain communication, not anything else, so here is my test case:     public class RemoteTransformer : MarshalByRefObject&#xA;{&#xA;    private readonly Transformer transfomer = new Transformer();&#xA;&#xA;    public JObject Transform(JObject o)&#xA;    {&#xA;        return transfomer.Transform(o);&#xA;    }&#xA;}&#xA;&#xA;public class Transformer&#xA;{&#xA;    public JObject Transform(JObject o)&#xA;    {&#xA;        o[&quot;Modified&quot;] = new JValue(true);&#xA;        return o;&#xA;    }&#xA;}&#xA;  &#xA;&#xA;Running things in the same app domain (base line):&#xA;&#xA;&#xA;  static void Main(string[] args)&#xA;{&#xA;    var t = new RemoteTransformer();&#xA;    &#xA;    var startNew = Stopwatch.StartNew();&#xA;&#xA;    for (int i = 0; i &lt; 100000; i&#x2B;&#x2B;)&#xA;    {&#xA;        var jobj = new JObject(new JProperty(&quot;Hello&quot;, &quot;There&quot;));&#xA;&#xA;        t.Transform(jobj);&#xA;&#xA;    }&#xA;&#xA;    Console.WriteLine(startNew.ElapsedMilliseconds);&#xA;}&#xA;  &#xA;&#xA;This consistently gives results under 200 ms (185ms, 196ms, etc). In other words, we are talking about over 500 operations per millisecond.&#xA;&#xA;What happen when we do this over AppDomain boundary? The first problem I run into was that the Json objects were serializable, but that was easy to fix. Here is the code:&#xA;&#xA;&#xA;   static void Main(string[] args)&#xA; {&#xA;    var appDomain = AppDomain.CreateDomain(&quot;remote&quot;);&#xA;    var t = (RemoteTransformer)appDomain.CreateInstanceAndUnwrap(typeof(RemoteTransformer).Assembly.FullName, typeof(RemoteTransformer).FullName);&#xA;    &#xA;    var startNew = Stopwatch.StartNew();&#xA;     &#xA;     for (int i = 0; i &lt; 100000; i&#x2B;&#x2B;)&#xA;     {&#xA;         var jobj = new JObject(new JProperty(&quot;Hello&quot;, &quot;There&quot;));&#xA;&#xA;         t.Transform(jobj);&#xA;&#xA;     }&#xA;&#xA;     Console.WriteLine(startNew.ElapsedMilliseconds);&#xA; }&#xA;  &#xA;&#xA;And that run close to 8 seconds, (7871 ms). Or over 40 times slower, or just about 12 operations per millisecond.&#xA;&#xA;To give you some indication about the timing, this means that an operation over 1 million documents would spend about 1.3 minutes just serializing data across app domains.&#xA;&#xA;That is&#x2026; long, but it might be acceptable, I need to think about this more.</p>
        </article>
        <article id="article-5254">
            <a href="https://ardalis.com/using-cctray-with-jetbrains-teamcity/" target="_blank">
                <h2 class="title mb-6" id="article-5254">Using CCTray with JetBrains TeamCity</h2>
            </a>
            <p class="mb-2">by Ardalis</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 23, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">TeamCity is a great build server tool from JetBrains (makers of the awesome Visual Studio add-in, ReSharper). The user-interface and&#x2026;Keep Reading &#x2192;</p>
        </article>
        <article id="article-5255">
            <a href="https://ayende.com/blog/4601/database-assisted-denormalization" target="_blank">
                <h2 class="title mb-6" id="article-5255">Database assisted denormalization</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 23, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Let us say that I have the homepage of the application, where we display Blogs with their Post count, using the following query:     select &#xA;    dbo.Blogs.Id, &#xA;    dbo.Blogs.Title,&#xA;    dbo.Blogs.Subtitle,&#xA;    (select COUNT(*) from Posts where Posts.BlogId = Blogs.Id) as PostCount&#xA; from dbo.Blogs &#xA;  &#xA;&#xA;Given what I think thoughts of denormalization, and read vs. write costs, it seems a little wasteful to run the aggregate all the time.&#xA;&#xA;I can always add a PostCount property to the Blogs table, but that would require me to manage that myself, and I thought that I might see whatever the database can do it for me.&#xA;&#xA;&#xA;  This isn&#x2019;t a conclusive post, it details what I tried, and what I think is happening, but it isn&#x2019;t the end all be all. Moreover, I run my tests on SQL Server 2008 R2 only, not on anything else. I would like to hear what you think of this.&#xA;&#xA;&#xA;My first thought was to create this as a persisted computed column:&#xA;&#xA;&#xA;  ALTER TABLE Blogs&#xA;ADD PostCount AS (select COUNT(*) from Posts where Posts.BlogId = Blogs.Id) PERSISTED&#xA;  &#xA;&#xA;But you can&#x2019;t create computed columns that uses subqueries. I would understand easier why not if it was only for persisted computed columns, because that would give the database a hell of time figuring out when that computed column needs to be updated, but I am actually surprised that normal computed columns aren&#x2019;t supporting subqueries.&#xA;&#xA;Given that my first attempt failed, I decided to try to create a materialized view for the data that I needed. Materialized views in SQL Server are called indexed views, There are several things to note here. You can&#x2019;t use subqueries here either (likely because the DB couldn&#x2019;t figure which row in the index to update if you were using subqueries), but have to use joins.&#xA;&#xA;I created a data set of 1,048,576 rows in the blogs table and 20,971,520 posts, which I think should be enough to give me real data.&#xA;&#xA;Then, I issued the following query:&#xA;&#xA;&#xA;  select &#xA;        dbo.Blogs.Id, &#xA;        dbo.Blogs.Title,&#xA;        dbo.Blogs.Subtitle,&#xA;        count_big(*) as PostCount&#xA;from dbo.Blogs left join dbo.Posts&#xA;        on dbo.Blogs.Id = dbo.Posts.BlogId&#xA;where dbo.Blogs.Id = 365819&#xA;group by dbo.Blogs.Id,&#xA;        dbo.Blogs.Title,&#xA;        dbo.Blogs.Subtitle&#xA;  &#xA;&#xA;This is before I created anything, just to give me some idea about what kind of performance (and query plan) I can expect.&#xA;&#xA;Query duration: 13 seconds.&#xA;&#xA;And the execution plan:&#xA;&#xA; &#xA;&#xA;The suggest indexes feature is one of the best reasons to move to SSMS 2008, in my opinion.&#xA;&#xA;Following the suggestion, I created:&#xA;&#xA;&#xA;  CREATE NONCLUSTERED INDEX [IDX_Posts_ByBlogID]&#xA;ON [dbo].[Posts] ([BlogId])&#xA;  &#xA;&#xA;And then I reissued the query. It completed in 0 seconds with the following execution plan:&#xA;&#xA; &#xA;&#xA;After building Raven, I have a much better understanding of how databases operate internally, and I can completely follow how that introduction of this index can completely change the game for this query.&#xA;&#xA;Just to point out, the results of this query is:&#xA;&#xA;Id&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Title&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Subtitle&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; PostCount&#xA;    ----------- --------------------- ---------------------- --------------------&#xA;&#xA;  365819&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; The lazy blog&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; hibernating in summer&#xA0; 1310720&#xA;&#xA;I decided to see what using a view (and then indexed view) will give me. I dropped the IDX_Posts_ByBlogID index and created the following view:&#xA;&#xA;&#xA;  CREATE VIEW BlogsWithPostCount &#xA;WITH SCHEMABINDING&#xA;AS &#xA;select &#xA;    dbo.Blogs.Id, &#xA;    dbo.Blogs.Title,&#xA;    dbo.Blogs.Subtitle,&#xA;    count_big(*) as PostCount&#xA; from dbo.Blogs join dbo.Posts&#xA;    on dbo.Blogs.Id = dbo.Posts.BlogId&#xA; group by dbo.Blogs.Id,&#xA;    dbo.Blogs.Title,&#xA;    dbo.Blogs.Subtitle&#xA;&#xA;&#xA;&#xA;&#xA;After which I issued the following query:&#xA;&#xA;&#xA;  select &#xA;        Id, &#xA;        Title,&#xA;        Subtitle,&#xA;        PostCount&#xA;from BlogsWithPostCount&#xA;where Id = 365819&#xA;  &#xA;&#xA;This had the exact same behavior as the first query (13 seconds and the suggestion for adding the index).&#xA;&#xA;I then added the following index to the view:&#xA;&#xA;&#xA;  CREATE UNIQUE CLUSTERED INDEX IDX_BlogsWithPostCount&#xA;ON BlogsWithPostCount (Id)&#xA;  &#xA;&#xA;And then reissued the same query on the view. It had absolutely no affect on the query (13 seconds and the suggestion for adding the index). This make sense, if you understand how the database is actually treating this.&#xA;&#xA;The database just created an index on the results of the view, but it only indexed the columns that we told it about, which means that is still need to compute the PostCount. To make things more interesting, you can&#x2019;t add the PostCount to the index (thus saving the need to recalculate it).&#xA;&#xA;Some points that are worth talking about:&#xA;&#xA;&#xA;  Adding IDX_Posts_ByBlogID index resulted in a significant speed increase&#xA;&#xA;  There doesn&#x2019;t seem to be a good way to perform materialization of the query in the database (this applies to SQL Server only, mind you, maybe Oracle does better here, I am not sure).&#xA;&#xA;&#xA;In other words, the best solution that I have for this is to either accept the cost per read on the RDBMS and mitigate that with proper indexes or create a PostCount column in the Blogs table and manage that yourself. I would like your critique on my attempt, and additional information about whatever what I am trying to do is possible in other RDMBS.</p>
        </article>
        <article id="article-5256">
            <a href="https://ayende.com/blog/4600/finding-chrome-bugs" target="_blank">
                <h2 class="title mb-6" id="article-5256">Finding chrome bugs</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 22, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">That one was annoying to figure out. Take a look at the following code:     static void Main(string[] args)&#xA;{&#xA;    var listener = new HttpListener();&#xA;    listener.Prefixes.Add(&quot;http://&#x2B;:8080/&quot;);&#xA;    listener.Start();&#xA;&#xA;    Console.WriteLine(&quot;Started&quot;);&#xA;&#xA;    while(true)&#xA;    {&#xA;        var context = listener.GetContext();&#xA;        context.Response.Headers[&quot;Content-Encoding&quot;] = &quot;deflate&quot;;&#xA;        context.Response.ContentType = &quot;application/json&quot;;&#xA;        using(var gzip = new DeflateStream(context.Response.OutputStream, CompressionMode.Compress))&#xA;        using(var writer = new StreamWriter(gzip, Encoding.UTF8))&#xA;        {&#xA;            writer.Write(&quot;{\&quot;CountOfIndexes\&quot;:1,\&quot;ApproximateTaskCount\&quot;:0,\&quot;CountOfDocuments\&quot;:0}&quot;);&#xA;            writer.Flush();&#xA;            gzip.Flush();&#xA;        }&#xA;        context.Response.Close();&#xA;    }&#xA;}&#xA;  &#xA;&#xA;FireFox and IE have no trouble using this. But here is how it looks on Chrome.&#xA;&#xA; &#xA;&#xA;To make matter worse, pay attention to the conditions of the bug:&#xA;&#xA;&#xA;  If I use Gzip instead of deflate, it works.&#xA;&#xA;  If I use &quot;text/plain&#x201D; instead of &#x201C;application/json&#x201D;, it works.&#xA;&#xA;  If I tunnel this through Fiddler, it works.&#xA;&#xA;&#xA;I hate stupid bugs like that.</p>
        </article>
        <article id="article-5257">
            <a href="https://ayende.com/blog/4599/hunt-the-bug" target="_blank">
                <h2 class="title mb-6" id="article-5257">Hunt the bug</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 21, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">The following code will throw under certain circumstances, what are they?     public class Global : HttpApplication&#xA;{&#xA;       public void Application_Start(object sender, EventArgs e)&#xA;       {&#xA;            HttpUtility.UrlEncode(&quot;Error inside!&quot;);&#xA;       }&#xA;}&#xA;  &#xA;&#xA;Hint, the exception will not be raised because of transient conditions such as low memory.&#xA;&#xA;What are the conditions in which it would throw, and why?&#xA;&#xA;Hint #2, I had to write my own (well, take the one from Mono and modify it) HttpUtility to avoid this bug.&#xA;&#xA;ARGH!</p>
        </article>
        <article id="article-5258">
            <a href="https://ayende.com/blog/4598/application-databases-and-external-integration-points" target="_blank">
                <h2 class="title mb-6" id="article-5258">Application databases and external integration points</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 20, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">Dave has an interesting requirements in his project:     We&#x27;re not in control of where the data is located, how it&#x27;s stored and in what configuration. In most cases employees need to be retrieved from a Active Directory (There&#x27;s is no &#x27;login&#x27;, the Window Identity determines what a user can or can&#x27;t do). Customer contacts are usually handled by the helpdesk department and each contact moment is logged in a helpdesk database. The customer (account information) itself often needs to be retrieved from an IBM DB2 database.   What you have is not one application that needs to access different data sources. That would be the wrong way to think about this, because it introduce a whole lot of complexity into the application.      It is much better to structure the application as an independent application with each integration point made explicit. Instead of touch the DB/2 database, you put a service on it and access that.       This isn&#x2019;t just &#x201C;oh, SOA nonsense again&#x201D;, it is an important distinction. When you tie yourself directly to so many external integration points, you are also ensuring that whenever there is a change in one of them, you are going to be impacted. When you put a service boundary between you and the integration point (even if you have to build the service), the affect is much less noticeable.  Also, did you notice the blue lines going from the databases? Those are background ETL processes, replicating data to/from the databases. It allows us to handle situations where the integration points are not available.  In short, design you application so it doesn&#x2019;t stick its nose into other people&#x2019;s databases. If you need data from another database, put a service there, or replicate it. You&#x2019;ll thank me when you app stays up.</p>
        </article>
        <article id="article-5259">
            <a href="https://ayende.com/blog/4597/nh-prof-usage-data" target="_blank">
                <h2 class="title mb-6" id="article-5259">NH Prof &amp; usage data</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 19, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">There seems to be some suspicion about the usage data from NH Prof that I published recently.  I would like to apologize for responding late to the comments, I know that there are some people who believe that I have installed a 3G chip directly to my head, but I actually was busy in the real world and didn&#x2019;t look at my email until recently. The blog runs on auto pilot just so I&#x2019;ll be able to do that, but sometimes it does give the wrong impression.  So, what does NH Prof &#x201C;phone home&#x201D; about?  Well, the data is actually divided into two distinct pieces. Most of the data (numbers, usages, geographic location, etc) actually comes from looking at the server logs for the update check.   Another piece of data that the profiler reports is feature usage. There are about 20 &#x2013; 30 individual features that are being tracked for usage. What does it means, tracking a feature?  Well, here are three examples that shows what gets reported:           There is no way to correlate this data to an individual user, nor is there a way to track the behavior of a single user.   I use this data mainly in order to see what features are being used most often (therefore deserving the most attention, optimizations, etc).  Those are mentioned in the product documentation.   To summarize:     I am not stealing your connection strings.    I don&#x2019;t gather any personally identifying data (and I am at somewhat at a loss to understand what I would do with it even if I did).    There is never any data about what you are profiling being sent anywhere.   I hope this clear things out.</p>
        </article>
        <article id="article-5260">
            <a href="https://ayende.com/blog/4596/how-to-become-a-speaker" target="_blank">
                <h2 class="title mb-6" id="article-5260">How to become a speaker?</h2>
            </a>
            <p class="mb-2">by Oren Eini</p>
            <p class="mb-6 flex gap-1.5">
                    <span>
                        <svg width="1.25rem" fill="currentColor" viewBox="0 0 24 24"
                             xmlns="http://www.w3.org/2000/svg"><path
                                xmlns="http://www.w3.org/2000/svg"
                                d="M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM12 6C12.5523 6 13 6.44772 13 7V11.5858L15.7071 14.2929C16.0976 14.6834 16.0976 15.3166 15.7071 15.7071C15.3166 16.0976 14.6834 16.0976 14.2929 15.7071L11.2929 12.7071C11.1054 12.5196 11 12.2652 11 12V7C11 6.44772 11.4477 6 12 6Z"></path></svg>
                    </span>
                posted on: August 19, 2010
            </p>
            <p class="max-w-full w-full line-clamp-5 text-justify mb-20">I get asked that quite frequently. More to the point, how to become an international speaker?  I was recently at a gathering where no less than three different people asked me this question, so I thought that it might be a good post.     Note: this post isn&#x2019;t meant for someone who isn&#x2019;t already speaking. And if you are speaking but are bad at it, this isn&#x2019;t for you. The underlying assumption here is that you can speak and are reasonably good at it.    Note II: For this post, speaking is used to refer to presenting some technical content in front of an audience.    Why would you want to be a speaker anyway?  I heard that it is actually possible to make a living as a speaker. I haven&#x2019;t found it to be the case, but then again, while I speak frequently, I don&#x2019;t speak that frequently.   There are several reasons to want to be a speaker:     reputation (and in the end, good reputation means you get to raise your rates, get more work, etc).    contacts (speaking put you in front of dozens or hundreds of people, and afterward you get to talk with the people who are most interested in what you talked about)    advertising for your product (all those &#x201C;lap around Visual Studio 2010&#x201D; are actually an hour long ad that you paid to see :-) ).   I&#x2019;ll focus on the first two, reputation &amp; contacts gives you a much wider pool of potential work that you can choose from, increase the money you can make, etc.  So how do I do that, damn it?  Honestly, I have no idea. The first time that I presented at a technical conference, it was due to a mixup in communication. Apparently when in the US &#x201C;it would have been delightful&#x201D; means &#x201C;we regret to inform&#x201D;, but in Israel we read that as &#x201C;great, let us do it&#x201D;, and put the guy on the spot, so he had to scramble and do something.  Okay, I lied, I do have some idea about how to do this.  Again, I am assuming you are a reasonably good speaker (for myself, I know that my accent is a big problem when speaking English), but there are a lot of reasonably good speakers out there.  So, what is the answer? Make yourself different.  Pick a topic that is near &amp; dear to your heart (or to your purse, which also works) and prepare a few talks on it. Write about it in a blog, comment on other people blogs about the topic. Your goal should be that when people think about topic X, your name would be on that list.&#xA0; Forums like Stack Overflow can help, writing articles (whatever it is for pay or in places like CodeProject). Join a mailing list and be active there (and helpful). Don&#x2019;t focus on regionally associated forums / mailing list, though. The goal is international acknowledgement.   This will take at least a year, probably, for people to start recognizing your name (it took over 2 years for me). If it is possible, produce a set of tools that relate to your topic. Publish them for free, and write it off as an investment in your future.   For myself, NHibernate Query Analyzer would a huge boost in terms of getting recognized. And Rhino Mocks was probably what clinched the deal. I honestly have no idea how much time &amp; effort I put into Rhino Mocks, but Ohloh estimate that project at $ 12,502,089(!). While I disagree about that number, I did put a lot of effort into it, but it paid itself off several times over.  If you don&#x2019;t have a blog, get one. Don&#x2019;t get one at a community site, either. Community sites like blogs.microsoft.co.il are good to get your stuff read, but they have a big weakness in terms of branding yourself. You don&#x2019;t want to get lost in a crowd, you want people to notice who you are. And most people are going to read your posts in a feed reader, and they are going to notice that the community feed is interesting, not that you are interesting.  Post regularly. I try to have a daily post, but that would probably not be possible for you, try to post at least once a week, and try to time it so it is always on the same date &amp; time. Monday&#x2019;s midnight usually works.  Okay, I did all of that, what now?  Another note, this is something that you may want to do in parallel to the other efforts.  Unless you become very well known, you won&#x2019;t be approached, you&#x2019;ll have to submit session suggestions. Keep an eye on the conferences that interest you, and wait until they have a call for sessions. Submit your stuff. Don&#x2019;t get offended if they reject you.  If you live in a place that host international conferences (which usually rule Israel out), a good bet is to try to get accepted as a speaker there. You would be considerably cheaper than bringing someone from out of town/country. And that also play a role. Usually, if you managed to get into a conference once, they&#x2019;ll be much more likely to have you again. They have your speaker eval, and unless you truly sucked (like going on stage and starting to speak in Hebrew at Denmark), and that gives them more confidence in bringing you a second time.  And that is about it for now.</p>
        </article>
        <div class="button flex justify-between">
            <a href="525.html"><span class="back arrow"></span></a>

            <a href="527.html"><span class="next arrow"></span></a>
        </div>
    </section>
</main>
<footer
    class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pb-4 pt-20 text-center align-top font-semibold text-gray-600 dark:text-gray-400 sm:flex-row sm:justify-between sm:text-xs">
    <div class="me-0 sm:me-4">
        <div class="flex flex-wrap items-end gap-x-2">
            <ul class="flex flex-1 items-center gap-x-2 sm:flex-initial">
                <li class="flex">
                    <p class="flex items-end gap-2 justify-center flex-wrap	">Â© Relatively General
                        .NET 2025<span
                            class="inline-block">&nbsp;ðŸš€&nbsp;Theme: Astro Cactus</span>

                        <a class="inline-block sm:hover:text-link" href="https://github.com/chrismwilliams/astro-cactus"
                           rel="noopener noreferrer " target="_blank">
                            <svg width="1em" height="1em" viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6"
                                 focusable="false" data-icon="mdi:github">
                                <symbol id="ai:mdi:github">
                                    <path fill="currentColor"
                                          d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
                                </symbol>
                                <use xlink:href="#ai:mdi:github"></use>
                            </svg>
                            <span class="sr-only">Github</span>
                        </a>
                    </p>
                </li>
            </ul>
        </div>
    </div>
    <nav aria-label="More on this site" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
        <a class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="index.html"> Home </a><a
            class="px-4 py-2 sm:py-0 sm:hover:text-textColor sm:hover:underline" href="/about/"> About </a>
    </nav>
</footer>
<script src="js/script.js?id=af8f4559935e7bf5bf6015373793411d"></script>
<script src="pagefind/pagefind-ui.js"></script>

<!-- Cookie Consent Banner -->
<div class="cookie-consent" id="cookieConsent">
    <div>
        <p class="text-sm">We use cookies to analyze our website traffic and provide a better browsing experience. By
            continuing to use our site, you agree to our use of cookies.</p>
    </div>
    <div class="cookie-consent-buttons">
        <button class="cookie-consent-decline" onclick="declineCookies()">Decline</button>
        <button class="cookie-consent-accept" onclick="acceptCookies()">Accept</button>
    </div>
</div>

<script>
    // Cookie consent management
    function showCookieConsent() {
        const consent = localStorage.getItem('cookieConsent');
        if (!consent) {
            document.getElementById('cookieConsent').classList.add('show');
        }
    }

    function acceptCookies() {
        localStorage.setItem('cookieConsent', 'accepted');
        document.getElementById('cookieConsent').classList.remove('show');
        loadGA(); // Load Google Analytics after consent
    }

    function declineCookies() {
        localStorage.setItem('cookieConsent', 'declined');
        document.getElementById('cookieConsent').classList.remove('show');
    }

    // Show the consent banner only for EU visitors (you can add more country codes as needed)
    fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                const euCountries = ['AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'DE', 'GR', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PL', 'PT', 'RO', 'SK', 'SI', 'ES', 'SE'];
                if (euCountries.includes(data.country_code)) {
                    showCookieConsent();
                } else {
                    // For non-EU visitors, automatically load GA
                    if (!localStorage.getItem('cookieConsent')) {
                        localStorage.setItem('cookieConsent', 'accepted');
                        loadGA();
                    }
                }
            })
            .catch(() => {
                // If we can't determine location, show the consent banner to be safe
                showCookieConsent();
            });
</script>
</body>
</html>